[0m02:34:51.674126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c256cb0c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c256bf406b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c256bacd8b0>]}


============================== 02:34:51.677663 | bff75f5a-4575-4324-ae44-ededc7dcd341 ==============================
[0m02:34:51.677663 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:34:51.678133 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/chun/Develop/datacore', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'empty': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt debug', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'no_print': 'None', 'printer_width': '80', 'partial_parse': 'True', 'indirect_selection': 'eager'}
[0m02:34:51.685661 [info ] [MainThread]: dbt version: 1.10.13
[0m02:34:51.686033 [info ] [MainThread]: python version: 3.12.3
[0m02:34:51.686295 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m02:34:51.686559 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m02:34:51.786932 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m02:34:51.787393 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m02:34:51.787661 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m02:34:51.788829 [info ] [MainThread]: adapter type: duckdb
[0m02:34:51.789102 [info ] [MainThread]: adapter version: 1.10.0
[0m02:34:51.885721 [info ] [MainThread]: Configuration:
[0m02:34:51.886191 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:34:51.886471 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:34:51.886736 [info ] [MainThread]: Required dependencies:
[0m02:34:51.887022 [debug] [MainThread]: Executing "git --help"
[0m02:34:51.890799 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:34:51.891452 [debug] [MainThread]: STDERR: "b''"
[0m02:34:51.891804 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:34:51.892108 [info ] [MainThread]: Connection:
[0m02:34:51.892407 [info ] [MainThread]:   database: datacore
[0m02:34:51.892665 [info ] [MainThread]:   schema: main
[0m02:34:51.892918 [info ] [MainThread]:   path: datacore.duckdb
[0m02:34:51.893169 [info ] [MainThread]:   config_options: None
[0m02:34:51.893430 [info ] [MainThread]:   extensions: None
[0m02:34:51.893685 [info ] [MainThread]:   settings: {}
[0m02:34:51.893936 [info ] [MainThread]:   external_root: .
[0m02:34:51.894190 [info ] [MainThread]:   use_credential_provider: None
[0m02:34:51.894461 [info ] [MainThread]:   attach: None
[0m02:34:51.894711 [info ] [MainThread]:   filesystems: None
[0m02:34:51.894961 [info ] [MainThread]:   remote: None
[0m02:34:51.895213 [info ] [MainThread]:   plugins: None
[0m02:34:51.895490 [info ] [MainThread]:   disable_transactions: False
[0m02:34:51.895877 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:34:51.971497 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m02:34:51.995323 [debug] [MainThread]: Using duckdb connection "debug"
[0m02:34:51.995691 [debug] [MainThread]: On debug: select 1 as id
[0m02:34:51.995953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:34:52.010430 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m02:34:52.011395 [debug] [MainThread]: On debug: Close
[0m02:34:52.011756 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:34:52.012046 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:34:52.012877 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.39526767, "process_in_blocks": "3912", "process_kernel_time": 0.213427, "process_mem_max_rss": "140680", "process_out_blocks": "24", "process_user_time": 1.490998}
[0m02:34:52.013267 [debug] [MainThread]: Command `dbt debug` succeeded at 02:34:52.013185 after 0.40 seconds
[0m02:34:52.013546 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:34:52.013841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c256c3e2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255a324260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c256acaa1b0>]}
[0m02:34:52.014172 [debug] [MainThread]: Flushing usage events
[0m02:34:53.493517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:34:58.837081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9fd3fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9f77ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9f548f20>]}


============================== 02:34:58.841172 | 9185fe2d-257f-4b9b-959e-1ef7e3dc74eb ==============================
[0m02:34:58.841172 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:34:58.841651 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_cache_events': 'False'}
[0m02:34:59.041812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9ed22f90>]}
[0m02:34:59.100517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9fb4d250>]}
[0m02:34:59.102204 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:34:59.184093 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:34:59.184695 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:34:59.185011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e8eff4500>]}
[0m02:35:00.859322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2ca4b050>]}
[0m02:35:00.972701 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:00.974991 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:01.091880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2cbc5100>]}
[0m02:35:01.092452 [info ] [MainThread]: Found 18 models, 15 data tests, 1 seed, 4 sources, 463 macros
[0m02:35:01.092793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2c93c980>]}
[0m02:35:01.094643 [info ] [MainThread]: 
[0m02:35:01.094996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:35:01.095258 [info ] [MainThread]: 
[0m02:35:01.095750 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:35:01.100491 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:35:01.140469 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:01.140883 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:01.141179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:01.156734 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m02:35:01.158146 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:01.158837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_staging)
[0m02:35:01.159238 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m02:35:01.165485 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:01.165831 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:01.166099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.167202 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.168378 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:01.168649 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m02:35:01.169375 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:01.169627 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:01.169877 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m02:35:01.170342 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:01.171037 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:01.171313 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:01.171567 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:01.173366 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m02:35:01.173668 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m02:35:01.176864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now list_datacore_main_staging)
[0m02:35:01.182721 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:01.183047 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:35:01.183312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.184088 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.184356 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:01.184616 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.198177 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m02:35:01.199412 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:35:01.200507 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:35:01.200779 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:35:01.201365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_ods)
[0m02:35:01.204643 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:01.204974 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:35:01.205227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.206018 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.206282 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:01.206553 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.211154 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:01.212299 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:35:01.213131 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:35:01.213400 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:35:01.213942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_dwd)
[0m02:35:01.215669 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:01.215942 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:35:01.216198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.216836 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.217092 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:01.217357 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.221897 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:01.223018 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:35:01.223821 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:35:01.224082 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:35:01.224623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_ads)
[0m02:35:01.226376 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:01.226646 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:35:01.226895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.227513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.227767 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:01.228022 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.232285 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:01.233380 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:35:01.234169 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:35:01.234435 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:35:01.234972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main)
[0m02:35:01.236668 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:01.236937 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:35:01.237182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.237774 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.238026 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:01.238288 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.241221 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:01.242285 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:35:01.243089 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:35:01.243357 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:35:01.243901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_metadata)
[0m02:35:01.245638 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:01.245911 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:35:01.246159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.246821 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.247075 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:01.247341 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.250250 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:01.251333 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:35:01.252143 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:35:01.252412 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:35:01.253196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dws)
[0m02:35:01.254917 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:01.255186 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:35:01.255449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.256064 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.256323 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:01.256578 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.261075 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:01.262170 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:35:01.262972 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:35:01.263231 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:35:01.264129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2c9682f0>]}
[0m02:35:01.265071 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:01.265609 [debug] [MainThread]: On master: BEGIN
[0m02:35:01.266087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:35:01.267155 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:01.267664 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.268143 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:01.268621 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.269367 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:01.269857 [debug] [MainThread]: On master: Close
[0m02:35:01.273886 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m02:35:01.274791 [info ] [Thread-1 (]: 1 of 4 START sql view model main_staging.stg_payment_method_dict ............... [RUN]
[0m02:35:01.275565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now model.datacore.stg_payment_method_dict)
[0m02:35:01.276173 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m02:35:01.288259 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m02:35:01.289106 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m02:35:01.319926 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m02:35:01.320768 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:01.321129 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m02:35:01.321470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:01.322409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:01.322747 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:01.323099 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."payment_method_dict"
  );

[0m02:35:01.324013 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."payment_method_dict"
  );

[0m02:35:01.324389 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:01.324844 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: ROLLBACK
[0m02:35:01.328562 [debug] [Thread-1 (]: Failed to rollback 'model.datacore.stg_payment_method_dict'
[0m02:35:01.328923 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m02:35:01.331179 [debug] [Thread-1 (]: Runtime Error in model stg_payment_method_dict (models/staging/stg_payment_method_dict.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.332746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2c78c3e0>]}
[0m02:35:01.333391 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main_staging.stg_payment_method_dict ...... [[31mERROR[0m in 0.06s]
[0m02:35:01.333988 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m02:35:01.334400 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m02:35:01.335261 [debug] [Thread-4 (]: Marking all children of 'model.datacore.stg_payment_method_dict' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_payment_method_dict (models/staging/stg_payment_method_dict.sql)
  Binder Error: Catalog "main" does not exist!.
[0m02:35:01.336039 [info ] [Thread-1 (]: 2 of 4 START sql view model main_staging.stg_toll_station ...................... [RUN]
[0m02:35:01.338280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m02:35:01.338668 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m02:35:01.342062 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m02:35:01.342586 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m02:35:01.347206 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m02:35:01.347817 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:01.348177 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m02:35:01.348523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:01.349423 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:01.349764 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:01.350112 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."toll_station"
  );

[0m02:35:01.350886 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."toll_station"
  );

[0m02:35:01.351255 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:01.351708 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: ROLLBACK
[0m02:35:01.354274 [debug] [Thread-1 (]: Failed to rollback 'model.datacore.stg_toll_station'
[0m02:35:01.354612 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m02:35:01.357078 [debug] [Thread-1 (]: Runtime Error in model stg_toll_station (models/staging/stg_toll_station.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.357495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2c7ae930>]}
[0m02:35:01.358048 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main_staging.stg_toll_station ............. [[31mERROR[0m in 0.02s]
[0m02:35:01.358562 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m02:35:01.358925 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m02:35:01.359523 [debug] [Thread-4 (]: Marking all children of 'model.datacore.stg_toll_station' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_toll_station (models/staging/stg_toll_station.sql)
  Binder Error: Catalog "main" does not exist!.
[0m02:35:01.360045 [info ] [Thread-1 (]: 3 of 4 START sql view model main_staging.stg_toll_transaction .................. [RUN]
[0m02:35:01.360690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m02:35:01.361015 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m02:35:01.364419 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m02:35:01.364896 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m02:35:01.367370 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m02:35:01.367849 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:01.368171 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m02:35:01.368487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:01.369322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:01.369637 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:01.370033 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "main"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST((exit_time - entry_time) AS BIGINT) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:35:01.371240 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "main"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST((exit_time - entry_time) AS BIGINT) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:35:01.371672 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:01.372070 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: ROLLBACK
[0m02:35:01.374456 [debug] [Thread-1 (]: Failed to rollback 'model.datacore.stg_toll_transaction'
[0m02:35:01.374780 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m02:35:01.376785 [debug] [Thread-1 (]: Runtime Error in model stg_toll_transaction (models/staging/stg_toll_transaction.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.377172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2c77ec90>]}
[0m02:35:01.377719 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model main_staging.stg_toll_transaction ......... [[31mERROR[0m in 0.02s]
[0m02:35:01.378221 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m02:35:01.378574 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m02:35:01.379276 [debug] [Thread-4 (]: Marking all children of 'model.datacore.stg_toll_transaction' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_toll_transaction (models/staging/stg_toll_transaction.sql)
  Binder Error: Catalog "main" does not exist!.
[0m02:35:01.379942 [info ] [Thread-1 (]: 4 of 4 START sql view model main_staging.stg_vehicle_type_dict ................. [RUN]
[0m02:35:01.380672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m02:35:01.380987 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m02:35:01.383921 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:01.384401 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m02:35:01.386750 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:01.387222 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:01.387548 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m02:35:01.387855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:01.388671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:01.388980 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:01.389300 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."vehicle_type_dict"
  );

[0m02:35:01.390006 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."vehicle_type_dict"
  );

[0m02:35:01.390352 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:01.390745 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: ROLLBACK
[0m02:35:01.393176 [debug] [Thread-1 (]: Failed to rollback 'model.datacore.stg_vehicle_type_dict'
[0m02:35:01.393510 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m02:35:01.395529 [debug] [Thread-1 (]: Runtime Error in model stg_vehicle_type_dict (models/staging/stg_vehicle_type_dict.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.395921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2cafe930>]}
[0m02:35:01.396470 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model main_staging.stg_vehicle_type_dict ........ [[31mERROR[0m in 0.02s]
[0m02:35:01.396972 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m02:35:01.397771 [debug] [Thread-4 (]: Marking all children of 'model.datacore.stg_vehicle_type_dict' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_vehicle_type_dict (models/staging/stg_vehicle_type_dict.sql)
  Binder Error: Catalog "main" does not exist!.
[0m02:35:01.399638 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:01.400250 [debug] [MainThread]: On master: BEGIN
[0m02:35:01.400804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:35:01.401971 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:01.402550 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.403092 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:01.403637 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.404492 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:01.405043 [debug] [MainThread]: On master: Close
[0m02:35:01.405808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:01.406361 [debug] [MainThread]: Connection 'model.datacore.stg_vehicle_type_dict' was properly closed.
[0m02:35:01.407003 [info ] [MainThread]: 
[0m02:35:01.407654 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m02:35:01.409745 [debug] [MainThread]: Command end result
[0m02:35:01.457469 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:01.459369 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:01.464675 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:35:01.465010 [info ] [MainThread]: 
[0m02:35:01.465361 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m02:35:01.465647 [info ] [MainThread]: 
[0m02:35:01.466019 [error] [MainThread]: [31mFailure in model stg_payment_method_dict (models/staging/stg_payment_method_dict.sql)[0m
[0m02:35:01.466371 [error] [MainThread]:   Runtime Error in model stg_payment_method_dict (models/staging/stg_payment_method_dict.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.466629 [info ] [MainThread]: 
[0m02:35:01.466950 [info ] [MainThread]:   compiled code at target/compiled/datacore/models/staging/stg_payment_method_dict.sql
[0m02:35:01.467214 [info ] [MainThread]: 
[0m02:35:01.467543 [error] [MainThread]: [31mFailure in model stg_toll_station (models/staging/stg_toll_station.sql)[0m
[0m02:35:01.467864 [error] [MainThread]:   Runtime Error in model stg_toll_station (models/staging/stg_toll_station.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.468120 [info ] [MainThread]: 
[0m02:35:01.468450 [info ] [MainThread]:   compiled code at target/compiled/datacore/models/staging/stg_toll_station.sql
[0m02:35:01.468708 [info ] [MainThread]: 
[0m02:35:01.469029 [error] [MainThread]: [31mFailure in model stg_toll_transaction (models/staging/stg_toll_transaction.sql)[0m
[0m02:35:01.469356 [error] [MainThread]:   Runtime Error in model stg_toll_transaction (models/staging/stg_toll_transaction.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.469608 [info ] [MainThread]: 
[0m02:35:01.469918 [info ] [MainThread]:   compiled code at target/compiled/datacore/models/staging/stg_toll_transaction.sql
[0m02:35:01.470175 [info ] [MainThread]: 
[0m02:35:01.470526 [error] [MainThread]: [31mFailure in model stg_vehicle_type_dict (models/staging/stg_vehicle_type_dict.sql)[0m
[0m02:35:01.470848 [error] [MainThread]:   Runtime Error in model stg_vehicle_type_dict (models/staging/stg_vehicle_type_dict.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.471099 [info ] [MainThread]: 
[0m02:35:01.471410 [info ] [MainThread]:   compiled code at target/compiled/datacore/models/staging/stg_vehicle_type_dict.sql
[0m02:35:01.471666 [info ] [MainThread]: 
[0m02:35:01.471956 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=4
[0m02:35:01.472838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6919713, "process_in_blocks": "472", "process_kernel_time": 0.283924, "process_mem_max_rss": "161056", "process_out_blocks": "4056", "process_user_time": 3.773285}
[0m02:35:01.473241 [debug] [MainThread]: Command `dbt run` failed at 02:35:01.473151 after 2.69 seconds
[0m02:35:01.473598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9f7eb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9f7ea8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9f7e9490>]}
[0m02:35:01.473921 [debug] [MainThread]: Flushing usage events
[0m02:35:02.919842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:35:22.674247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c604ffe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c614dbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c617023c0>]}


============================== 02:35:22.678359 | bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110 ==============================
[0m02:35:22.678359 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:35:22.678906 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select staging', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'printer_width': '80'}
[0m02:35:22.899395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5fbfd8e0>]}
[0m02:35:22.959437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f737050>]}
[0m02:35:22.961113 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:35:23.043238 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:35:23.174436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:35:23.176352 [debug] [MainThread]: Partial parsing: updated file: datacore://models/sources.yml
[0m02:35:23.960366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f1da810>]}
[0m02:35:24.064407 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:24.066596 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:24.082318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f3daa50>]}
[0m02:35:24.082887 [info ] [MainThread]: Found 18 models, 1 seed, 15 data tests, 4 sources, 463 macros
[0m02:35:24.083234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f2c5bb0>]}
[0m02:35:24.085214 [info ] [MainThread]: 
[0m02:35:24.085577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:35:24.085871 [info ] [MainThread]: 
[0m02:35:24.086378 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:35:24.091577 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:35:24.125356 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:24.125752 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:24.126032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:24.143264 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m02:35:24.144623 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:24.145408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_staging)
[0m02:35:24.145798 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m02:35:24.151970 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:24.152289 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:24.152572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.153985 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.155139 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:24.155430 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m02:35:24.155875 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:24.156122 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:24.156382 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m02:35:24.156909 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:24.157599 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:24.157864 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:24.158112 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:24.158517 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:24.158772 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m02:35:24.161947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now list_datacore_main_ads)
[0m02:35:24.167094 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:24.167425 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:35:24.167683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.168763 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.169120 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:24.169458 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.183768 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m02:35:24.185065 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:35:24.186099 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:35:24.186376 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:35:24.186948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_ods)
[0m02:35:24.190043 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:24.190384 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:35:24.190731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.191669 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.192025 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:24.192393 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.197724 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:35:24.199277 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:35:24.200408 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:35:24.200761 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:35:24.201520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_dwd)
[0m02:35:24.203801 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:24.204176 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:35:24.204524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.205402 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.205761 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:24.206123 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.211515 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:35:24.213074 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:35:24.214154 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:35:24.214521 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:35:24.215274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_staging)
[0m02:35:24.217528 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:24.217905 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:35:24.218253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.219075 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.219374 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:24.219668 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.224568 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:35:24.225812 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:35:24.226684 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:35:24.226961 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:35:24.227584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main)
[0m02:35:24.229471 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:24.229767 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:35:24.230042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.230735 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.231015 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:24.231295 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.235076 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:24.236355 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:35:24.237233 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:35:24.237523 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:35:24.238437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_dws)
[0m02:35:24.240322 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:24.240617 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:35:24.240888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.241816 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.242093 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:24.242384 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.245649 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:24.246818 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:35:24.247703 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:35:24.247984 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:35:24.248563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_metadata)
[0m02:35:24.250390 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:24.250684 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:35:24.250955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.251661 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.251938 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:24.252222 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.257007 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:24.258164 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:35:24.259016 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:35:24.259295 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:35:24.260244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f21b3b0>]}
[0m02:35:24.261256 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:24.261830 [debug] [MainThread]: On master: BEGIN
[0m02:35:24.262354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:35:24.263461 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:24.263984 [debug] [MainThread]: On master: COMMIT
[0m02:35:24.264509 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:24.264998 [debug] [MainThread]: On master: COMMIT
[0m02:35:24.265808 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:24.266341 [debug] [MainThread]: On master: Close
[0m02:35:24.269658 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m02:35:24.270587 [info ] [Thread-1 (]: 1 of 4 START sql view model main_staging.stg_payment_method_dict ............... [RUN]
[0m02:35:24.271352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now model.datacore.stg_payment_method_dict)
[0m02:35:24.272032 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m02:35:24.285166 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m02:35:24.285778 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m02:35:24.313654 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m02:35:24.314287 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:24.314622 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m02:35:24.314925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:24.315836 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.316147 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:24.316475 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."payment_method_dict"
  );

[0m02:35:24.317373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.322814 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:24.323193 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" rename to "stg_payment_method_dict"
[0m02:35:24.324000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.333191 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:24.333569 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:24.333882 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:24.335621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.342143 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:24.342538 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

      drop view if exists "datacore"."main_staging"."stg_payment_method_dict__dbt_backup" cascade
    
[0m02:35:24.343332 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.345454 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m02:35:24.347337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c6013ca70>]}
[0m02:35:24.347890 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main_staging.stg_payment_method_dict .......... [[32mOK[0m in 0.08s]
[0m02:35:24.348418 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m02:35:24.348779 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m02:35:24.349250 [info ] [Thread-1 (]: 2 of 4 START sql view model main_staging.stg_toll_station ...................... [RUN]
[0m02:35:24.349629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m02:35:24.349948 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m02:35:24.352732 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m02:35:24.353253 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m02:35:24.355594 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m02:35:24.356089 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:24.356412 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m02:35:24.356718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:24.357820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.358129 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:24.358460 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."toll_station"
  );

[0m02:35:24.359395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.361819 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:24.362150 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station__dbt_tmp" rename to "stg_toll_station"
[0m02:35:24.362809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.363829 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:24.364155 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:24.364466 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:24.365762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.367630 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:24.367957 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

      drop view if exists "datacore"."main_staging"."stg_toll_station__dbt_backup" cascade
    
[0m02:35:24.368551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.369656 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m02:35:24.370221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777bec087c80>]}
[0m02:35:24.370743 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main_staging.stg_toll_station ................. [[32mOK[0m in 0.02s]
[0m02:35:24.371243 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m02:35:24.371604 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m02:35:24.372067 [info ] [Thread-1 (]: 3 of 4 START sql view model main_staging.stg_toll_transaction .................. [RUN]
[0m02:35:24.372435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m02:35:24.372751 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m02:35:24.375970 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m02:35:24.376504 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m02:35:24.378926 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m02:35:24.379440 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:24.379764 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m02:35:24.380074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:24.380909 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.381219 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:24.381626 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "datacore"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST((exit_time - entry_time) AS BIGINT) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:35:24.383622 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:24.386117 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:24.386472 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" rename to "stg_toll_transaction"
[0m02:35:24.387213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.388245 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:24.388583 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:24.388893 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:24.390513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.392425 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:24.392763 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

      drop view if exists "datacore"."main_staging"."stg_toll_transaction__dbt_backup" cascade
    
[0m02:35:24.393409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.394524 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m02:35:24.395093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777bec42f230>]}
[0m02:35:24.395618 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main_staging.stg_toll_transaction ............. [[32mOK[0m in 0.02s]
[0m02:35:24.396119 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m02:35:24.396476 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m02:35:24.396918 [info ] [Thread-1 (]: 4 of 4 START sql view model main_staging.stg_vehicle_type_dict ................. [RUN]
[0m02:35:24.397283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m02:35:24.397605 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m02:35:24.400332 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.400840 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m02:35:24.404887 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.405447 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.405774 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m02:35:24.406089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:24.406938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.407250 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.407578 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."vehicle_type_dict"
  );

[0m02:35:24.408480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.410839 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.411174 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" rename to "stg_vehicle_type_dict"
[0m02:35:24.411920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.412947 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:24.413277 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.413592 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:24.414873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.416699 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.417031 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

      drop view if exists "datacore"."main_staging"."stg_vehicle_type_dict__dbt_backup" cascade
    
[0m02:35:24.417628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.418726 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m02:35:24.419264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777bec0c7fb0>]}
[0m02:35:24.419788 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main_staging.stg_vehicle_type_dict ............ [[32mOK[0m in 0.02s]
[0m02:35:24.420284 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m02:35:24.422172 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:24.422889 [debug] [MainThread]: On master: BEGIN
[0m02:35:24.423404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:35:24.424526 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:24.425041 [debug] [MainThread]: On master: COMMIT
[0m02:35:24.425574 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:24.426064 [debug] [MainThread]: On master: COMMIT
[0m02:35:24.426937 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:24.427473 [debug] [MainThread]: On master: Close
[0m02:35:24.428213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:24.428711 [debug] [MainThread]: Connection 'model.datacore.stg_vehicle_type_dict' was properly closed.
[0m02:35:24.429342 [info ] [MainThread]: 
[0m02:35:24.429916 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m02:35:24.431826 [debug] [MainThread]: Command end result
[0m02:35:24.479673 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:24.481670 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:24.487095 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:35:24.487483 [info ] [MainThread]: 
[0m02:35:24.487825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:35:24.488096 [info ] [MainThread]: 
[0m02:35:24.488404 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m02:35:24.489262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8663715, "process_in_blocks": "0", "process_kernel_time": 0.280344, "process_mem_max_rss": "160052", "process_out_blocks": "4104", "process_user_time": 2.91799}
[0m02:35:24.489675 [debug] [MainThread]: Command `dbt run` succeeded at 02:35:24.489593 after 1.87 seconds
[0m02:35:24.490008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5fb0d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4c1e8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f2f78f0>]}
[0m02:35:24.490347 [debug] [MainThread]: Flushing usage events
[0m02:35:25.913844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:35:30.692445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca27b3c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca27c51cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca2781a6c0>]}


============================== 02:35:30.696022 | 56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff ==============================
[0m02:35:30.696022 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:35:30.696513 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'partial_parse': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'introspect': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False'}
[0m02:35:30.901543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca29c327b0>]}
[0m02:35:30.962112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca282f6f90>]}
[0m02:35:30.963827 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:35:31.045574 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:35:31.177898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:35:31.178314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:35:31.241808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca27c7d730>]}
[0m02:35:31.355513 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:31.357431 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:31.371830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca174ad190>]}
[0m02:35:31.372392 [info ] [MainThread]: Found 18 models, 1 seed, 15 data tests, 4 sources, 463 macros
[0m02:35:31.372723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca27383560>]}
[0m02:35:31.375123 [info ] [MainThread]: 
[0m02:35:31.375482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:35:31.375763 [info ] [MainThread]: 
[0m02:35:31.376265 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:35:31.382558 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:35:31.419242 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.419635 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.419908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:31.435315 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m02:35:31.436657 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.438666 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.439053 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.439339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.440339 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.441359 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.443065 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.443394 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.443652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.444586 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.445581 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.447262 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.447606 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.447861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.448780 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.449749 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.451418 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.451762 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.452021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.452958 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.453952 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.455655 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.455969 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.456227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.457181 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.458164 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.458890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_dws)
[0m02:35:31.459266 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dws"
"
[0m02:35:31.466213 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:31.466587 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.466847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.468244 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.469453 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:31.469714 [debug] [ThreadPool]: On create_datacore_main_dws: BEGIN
[0m02:35:31.470155 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.470409 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:31.470653 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
    
        create schema if not exists "datacore"."main_dws"
    
[0m02:35:31.471193 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.471874 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:35:31.472134 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:31.472381 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:35:31.474109 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.474539 [debug] [ThreadPool]: On create_datacore_main_dws: Close
[0m02:35:31.475259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dws, now create_datacore_main_metadata)
[0m02:35:31.475728 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:35:31.477295 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:31.477581 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.477833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.478781 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.479834 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:31.480096 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:35:31.480566 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.480817 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:31.481064 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:35:31.481513 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.482186 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:35:31.482455 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:31.482700 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:35:31.483745 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.484007 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:35:31.484554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now create_datacore_main_dwd)
[0m02:35:31.484946 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dwd"
"
[0m02:35:31.486464 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:31.486734 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.486987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.487898 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.488953 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:31.489212 [debug] [ThreadPool]: On create_datacore_main_dwd: BEGIN
[0m02:35:31.489681 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.489927 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:31.490173 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
    
        create schema if not exists "datacore"."main_dwd"
    
[0m02:35:31.490696 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.491371 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:35:31.491631 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:31.491874 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:35:31.492924 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.493184 [debug] [ThreadPool]: On create_datacore_main_dwd: Close
[0m02:35:31.493728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dwd, now create_datacore_main_ods)
[0m02:35:31.494133 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ods"
"
[0m02:35:31.495637 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:31.495902 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.496154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.497058 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.498085 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:31.498370 [debug] [ThreadPool]: On create_datacore_main_ods: BEGIN
[0m02:35:31.498798 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.499043 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:31.499286 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
    
        create schema if not exists "datacore"."main_ods"
    
[0m02:35:31.499731 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.500408 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:35:31.500665 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:31.500905 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:35:31.502625 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.502889 [debug] [ThreadPool]: On create_datacore_main_ods: Close
[0m02:35:31.503446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ods, now create_datacore_main_ads)
[0m02:35:31.503836 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ads"
"
[0m02:35:31.505356 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:31.505630 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.505882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.506790 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.507838 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:31.508096 [debug] [ThreadPool]: On create_datacore_main_ads: BEGIN
[0m02:35:31.508525 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.508770 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:31.509015 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
    
        create schema if not exists "datacore"."main_ads"
    
[0m02:35:31.509472 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.510148 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:35:31.510415 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:31.510658 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:35:31.512388 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.512651 [debug] [ThreadPool]: On create_datacore_main_ads: Close
[0m02:35:31.513191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ads, now create_datacore_main_staging)
[0m02:35:31.513598 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m02:35:31.515156 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:31.515436 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.515688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.516613 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.517669 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:31.517954 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m02:35:31.518383 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.518633 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:31.518880 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m02:35:31.519333 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.520008 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:31.520264 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:31.520514 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:31.520907 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.521162 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m02:35:31.524874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now list_datacore_main_dws)
[0m02:35:31.530091 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:31.530393 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:35:31.530641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.531294 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.531557 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:31.531812 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.545033 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m02:35:31.546172 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:35:31.547168 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:35:31.547437 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:35:31.548036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_metadata)
[0m02:35:31.549686 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:31.549959 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:35:31.550205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.550782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.551101 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:31.551369 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.554915 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:31.555998 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:35:31.556819 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:35:31.557074 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:35:31.557594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dwd)
[0m02:35:31.559158 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:31.559428 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:35:31.559672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.560332 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.560581 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:31.560838 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.563844 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:31.564890 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:35:31.565677 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:35:31.565924 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:35:31.566440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main)
[0m02:35:31.567995 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:31.568259 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:35:31.568514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.569059 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.569333 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:31.569598 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.574325 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:31.575384 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:35:31.576174 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:35:31.576437 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:35:31.576956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ods)
[0m02:35:31.579866 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:31.580146 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:35:31.580404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.581006 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.581259 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:31.581524 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.586440 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:35:31.587614 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:35:31.588457 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:35:31.588732 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:35:31.589348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_ads)
[0m02:35:31.655138 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:31.655582 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:35:31.655863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.656642 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.656922 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:31.657209 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.660650 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:31.661834 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:35:31.662689 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:35:31.662968 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:35:31.663915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_staging)
[0m02:35:31.665721 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:31.666011 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:35:31.666280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.666888 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.667166 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:31.667459 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.670769 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:31.672034 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:35:31.672879 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:35:31.673154 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:35:31.675335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca287923f0>]}
[0m02:35:31.676158 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:31.676670 [debug] [MainThread]: On master: BEGIN
[0m02:35:31.677145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:35:31.678193 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:31.678690 [debug] [MainThread]: On master: COMMIT
[0m02:35:31.679160 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:31.679631 [debug] [MainThread]: On master: COMMIT
[0m02:35:31.680390 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:31.680876 [debug] [MainThread]: On master: Close
[0m02:35:31.684266 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:35:31.685215 [info ] [Thread-1 (]: 1 of 18 START sql table model main_metadata.meta_data_lineage .................. [RUN]
[0m02:35:31.685984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now model.datacore.meta_data_lineage)
[0m02:35:31.686625 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:35:31.700097 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:35:31.701151 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:35:31.730998 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:35:31.731682 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:31.732004 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:35:31.732316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.733118 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.733435 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:31.733806 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª



-- ‰ªérawÂà∞stagingÁöÑË°ÄÁºò
SELECT 
    'raw.toll_transaction' AS source_table,
    'staging.stg_toll_transaction' AS target_table,
    'Ê∏ÖÊ¥ó' AS transformation_type,
    'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT 
    'raw.toll_station',
    'staging.stg_toll_station',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
UNION ALL
SELECT 
    'raw.vehicle_type_dict',
    'staging.stg_vehicle_type_dict',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
UNION ALL
SELECT 
    'raw.payment_method_dict',
    'staging.stg_payment_method_dict',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
-- ‰ªéstagingÂà∞odsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'staging.stg_toll_transaction',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®Âíå‰∏öÂä°Â≠óÊÆµÊâ©Â±ï'
UNION ALL
SELECT 
    'staging.stg_toll_station',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÊî∂Ë¥πÁ´ô‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_vehicle_type_dict',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîËΩ¶Âûã‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_payment_method_dict',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÊîØ‰ªòÊñπÂºè‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_toll_station',
    'ods.ods_toll_station',
    'ËΩ¨Êç¢',
    '‰∏öÂä°Â≠óÊÆµÊâ©Â±ï'
-- ‰ªéodsÂà∞dwdÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'ods.ods_toll_transaction',
    'dwd.dwd_toll_transaction_detail',
    'ËΩ¨Êç¢',
    '‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆËΩ¨Êç¢'
-- ‰ªédwdÂà∞dwsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_toll_revenue_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÊ±áÊÄª'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_traffic_flow_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÊ±áÊÄªËΩ¶ÊµÅÈáè'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_station_performance_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ôÊ±áÊÄªÁª©Êïà'
-- ‰ªédwsÂà∞adsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'dws.dws_toll_revenue_daily',
    'ads.ads_toll_revenue_report',
    'ËÅöÂêà',
    'ÁîüÊàêÊî∂ÂÖ•Êä•Ë°®'
UNION ALL
SELECT 
    'dws.dws_traffic_flow_daily',
    'ads.ads_traffic_trend_analysis',
    'ËÅöÂêà',
    'ÁîüÊàêËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'ads.ads_quality_monitoring_dashboard',
    'ËÅöÂêà',
    'ÁîüÊàêË¥®ÈáèÁõëÊéßÁúãÊùø'
    );
  
  
[0m02:35:31.737334 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:35:31.742842 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:31.743204 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:35:31.743943 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.755969 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:35:31.756359 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:31.756671 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:35:31.758398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.763237 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:31.763594 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:35:31.764328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.766602 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:35:31.768477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca28431fd0>]}
[0m02:35:31.769071 [info ] [Thread-1 (]: 1 of 18 OK created sql table model main_metadata.meta_data_lineage ............. [[32mOK[0m in 0.08s]
[0m02:35:31.769647 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:35:31.770041 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:35:31.770562 [info ] [Thread-1 (]: 2 of 18 START sql table model main_metadata.meta_table_info .................... [RUN]
[0m02:35:31.770969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_table_info)
[0m02:35:31.771322 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:35:31.774504 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:35:31.775050 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:35:31.777788 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:35:31.778349 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:31.778690 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:35:31.779019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.779850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.780177 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:31.780595 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ



SELECT 
    'staging' AS schema_name,
    'stg_toll_transaction' AS table_name,
    'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description,
    'Êî∂Ë¥π‰∏öÂä°' AS business_domain,
    'Êî∂Ë¥πÁ≥ªÁªü' AS data_source,
    'ÂÆûÊó∂' AS update_frequency,
    'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner,
    'staging' AS data_layer,
    CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 
    'staging',
    'stg_toll_station',
    'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç',
    'Ë∑ØÁΩëÁÆ°ÁêÜ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü',
    'ÊåâÈúÄ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®',
    'staging',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ods',
    'ods_toll_transaction',
    'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'ÂÆûÊó∂',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ods',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ods',
    'ods_toll_station',
    'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®',
    'Ë∑ØÁΩëÁÆ°ÁêÜ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü',
    'ÊåâÈúÄ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®',
    'ods',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dwd',
    'dwd_toll_transaction_detail',
    'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆ',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'ÂÆûÊó∂',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dwd',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_toll_revenue_daily',
    'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_traffic_flow_daily',
    'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_station_performance_daily',
    'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_toll_revenue_report',
    'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ads',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_traffic_trend_analysis',
    'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ads',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_quality_monitoring_dashboard',
    'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø',
    'Êï∞ÊçÆÁÆ°ÁêÜ',
    'Êï∞ÊçÆ‰∏≠Âè∞',
    'ÂÆûÊó∂',
    'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®',
    'ads',
    CURRENT_TIMESTAMP
    );
  
  
[0m02:35:31.784055 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:35:31.788358 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:31.788749 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:35:31.789540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.790722 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:35:31.791076 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:31.791411 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:35:31.792882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.794917 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:31.795269 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:35:31.795905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.797104 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:35:31.797762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca140e0980>]}
[0m02:35:31.798314 [info ] [Thread-1 (]: 2 of 18 OK created sql table model main_metadata.meta_table_info ............... [[32mOK[0m in 0.03s]
[0m02:35:31.798849 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:35:31.799225 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m02:35:31.799716 [info ] [Thread-1 (]: 3 of 18 START sql view model main_staging.stg_payment_method_dict .............. [RUN]
[0m02:35:31.800093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.stg_payment_method_dict)
[0m02:35:31.800442 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m02:35:31.803442 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m02:35:31.804022 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m02:35:31.820786 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m02:35:31.821505 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.821822 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m02:35:31.822118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.822961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.823265 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.823591 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."payment_method_dict"
  );

[0m02:35:31.824426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.826979 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.827346 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict" rename to "stg_payment_method_dict__dbt_backup"
[0m02:35:31.828076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.830406 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.830741 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" rename to "stg_payment_method_dict"
[0m02:35:31.831396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.834389 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:31.834753 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.835060 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:31.836459 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.838410 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.838734 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

      drop view if exists "datacore"."main_staging"."stg_payment_method_dict__dbt_backup" cascade
    
[0m02:35:31.840034 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.841176 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m02:35:31.841729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca17702c00>]}
[0m02:35:31.842243 [info ] [Thread-1 (]: 3 of 18 OK created sql view model main_staging.stg_payment_method_dict ......... [[32mOK[0m in 0.04s]
[0m02:35:31.842743 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m02:35:31.843091 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m02:35:31.843567 [info ] [Thread-1 (]: 4 of 18 START sql view model main_staging.stg_toll_station ..................... [RUN]
[0m02:35:31.843938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m02:35:31.844251 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m02:35:31.847039 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m02:35:31.847602 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m02:35:31.850071 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m02:35:31.850607 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.850921 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m02:35:31.851218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.851972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.852273 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.852593 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."toll_station"
  );

[0m02:35:31.853451 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.855912 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.856255 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station" rename to "stg_toll_station__dbt_backup"
[0m02:35:31.856952 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.860780 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.861174 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station__dbt_tmp" rename to "stg_toll_station"
[0m02:35:31.861962 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.863186 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:31.863629 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.863935 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:31.865437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.867765 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.868127 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

      drop view if exists "datacore"."main_staging"."stg_toll_station__dbt_backup" cascade
    
[0m02:35:31.869498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.870755 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m02:35:31.871559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca140b9ca0>]}
[0m02:35:31.872108 [info ] [Thread-1 (]: 4 of 18 OK created sql view model main_staging.stg_toll_station ................ [[32mOK[0m in 0.03s]
[0m02:35:31.872658 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m02:35:31.873039 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m02:35:31.873699 [info ] [Thread-1 (]: 5 of 18 START sql view model main_staging.stg_toll_transaction ................. [RUN]
[0m02:35:31.874105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m02:35:31.874457 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m02:35:31.877985 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m02:35:31.878580 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m02:35:31.881221 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m02:35:31.881774 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.882119 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m02:35:31.882457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.883252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.883592 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.884020 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "datacore"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST((exit_time - entry_time) AS BIGINT) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:35:31.885993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.888738 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.889104 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction" rename to "stg_toll_transaction__dbt_backup"
[0m02:35:31.889873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.892298 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.892666 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" rename to "stg_toll_transaction"
[0m02:35:31.893359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.894511 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:31.894862 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.895295 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:31.897005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.899063 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.899424 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

      drop view if exists "datacore"."main_staging"."stg_toll_transaction__dbt_backup" cascade
    
[0m02:35:31.900751 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.901955 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m02:35:31.902552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca140b29c0>]}
[0m02:35:31.903105 [info ] [Thread-1 (]: 5 of 18 OK created sql view model main_staging.stg_toll_transaction ............ [[32mOK[0m in 0.03s]
[0m02:35:31.903647 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m02:35:31.904022 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m02:35:31.904512 [info ] [Thread-1 (]: 6 of 18 START sql view model main_staging.stg_vehicle_type_dict ................ [RUN]
[0m02:35:31.904896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m02:35:31.905229 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m02:35:31.908213 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.908794 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m02:35:31.911331 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.911855 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.912192 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m02:35:31.912524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.913324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.913651 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.913992 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."vehicle_type_dict"
  );

[0m02:35:31.914862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.917504 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.917867 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict" rename to "stg_vehicle_type_dict__dbt_backup"
[0m02:35:31.918619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.921103 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.921480 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" rename to "stg_vehicle_type_dict"
[0m02:35:31.922177 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.923355 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:31.923698 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.924023 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:31.925341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.929133 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.929538 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

      drop view if exists "datacore"."main_staging"."stg_vehicle_type_dict__dbt_backup" cascade
    
[0m02:35:31.930936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.932152 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m02:35:31.932736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c9cc4ae330>]}
[0m02:35:31.933291 [info ] [Thread-1 (]: 6 of 18 OK created sql view model main_staging.stg_vehicle_type_dict ........... [[32mOK[0m in 0.03s]
[0m02:35:31.933838 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m02:35:31.934205 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_station
[0m02:35:31.934699 [info ] [Thread-1 (]: 7 of 18 START sql table model main_ods.ods_toll_station ........................ [RUN]
[0m02:35:31.935232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_vehicle_type_dict, now model.datacore.ods_toll_station)
[0m02:35:31.935592 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_station
[0m02:35:31.938639 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_station"
[0m02:35:31.939227 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_station
[0m02:35:31.941862 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_station"
[0m02:35:31.942420 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:31.942759 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: BEGIN
[0m02:35:31.943084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.943892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.944221 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:31.944582 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_station__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®



SELECT 
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    open_date,
    -- ‰∏öÂä°Â≠óÊÆµ
    CASE 
        WHEN station_type = '‰∏ªÁ∫øÊî∂Ë¥πÁ´ô' THEN 1
        ELSE 0
    END AS is_main_station,
    CURRENT_DATE - open_date AS days_since_open,
    etl_time
FROM "datacore"."main_staging"."stg_toll_station"
    );
  
  
[0m02:35:31.946920 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:31.949666 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:31.950020 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station__dbt_tmp" rename to "ods_toll_station"
[0m02:35:31.950716 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.951872 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:35:31.952215 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:31.952543 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:35:31.954015 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.956021 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:31.956377 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

      drop table if exists "datacore"."main_ods"."ods_toll_station__dbt_backup" cascade
    
[0m02:35:31.956976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.958163 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: Close
[0m02:35:31.958812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca141cf4d0>]}
[0m02:35:31.959368 [info ] [Thread-1 (]: 7 of 18 OK created sql table model main_ods.ods_toll_station ................... [[32mOK[0m in 0.02s]
[0m02:35:31.959903 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_station
[0m02:35:31.960283 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m02:35:31.960767 [info ] [Thread-1 (]: 8 of 18 START sql table model main_metadata.meta_data_dictionary ............... [RUN]
[0m02:35:31.961157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_station, now model.datacore.meta_data_dictionary)
[0m02:35:31.961515 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m02:35:31.965000 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m02:35:31.965546 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m02:35:31.968168 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m02:35:31.968717 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:31.969059 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m02:35:31.969396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.970203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.970549 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:31.970951 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m02:35:31.974969 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:35:31.977860 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:31.978229 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m02:35:31.978970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.980242 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:35:31.980604 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:31.980936 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:35:31.982354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.984332 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:31.984684 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m02:35:31.985282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.986474 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m02:35:31.987237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca179e6480>]}
[0m02:35:31.987789 [info ] [Thread-1 (]: 8 of 18 OK created sql table model main_metadata.meta_data_dictionary .......... [[32mOK[0m in 0.03s]
[0m02:35:31.988340 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m02:35:31.988719 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_transaction
[0m02:35:31.989185 [info ] [Thread-1 (]: 9 of 18 START sql table model main_ods.ods_toll_transaction .................... [RUN]
[0m02:35:31.989588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.ods_toll_transaction)
[0m02:35:31.989931 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_transaction
[0m02:35:31.993957 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_transaction"
[0m02:35:31.994490 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_transaction
[0m02:35:31.998722 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_transaction"
[0m02:35:31.999257 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:31.999600 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: BEGIN
[0m02:35:31.999920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:32.000737 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:32.001063 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:32.001454 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_transaction__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®
-- ÂäüËÉΩÔºö‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ



SELECT 
    t.transaction_id,
    t.station_id,
    s.station_name,
    s.city,
    s.highway_code,
    s.station_type,
    t.lane_id,
    t.vehicle_plate,
    t.vehicle_type_code,
    vt.vehicle_type_name,
    vt.vehicle_type_desc,
    t.entry_station_id,
    es.station_name AS entry_station_name,
    t.entry_time,
    t.exit_time,
    t.travel_minutes,
    t.payment_method_code,
    pm.payment_method_name,
    pm.payment_method_desc,
    t.toll_amount,
    t.actual_amount,
    t.discount_amount,
    t.transaction_status,
    t.data_quality_flag,
    -- ‰∏öÂä°Â≠óÊÆµ
    DATE(t.exit_time) AS transaction_date,
    EXTRACT(HOUR FROM t.exit_time) AS transaction_hour,
    EXTRACT(DOW FROM t.exit_time) AS day_of_week,
    CASE 
        WHEN t.transaction_status = 'Ê≠£Â∏∏' THEN 1 
        ELSE 0 
    END AS is_normal_transaction,
    t.create_time,
    t.update_time,
    t.etl_time
FROM "datacore"."main_staging"."stg_toll_transaction" t
LEFT JOIN "datacore"."main_staging"."stg_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_toll_station" es ON t.entry_station_id = es.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
    );
  
  
[0m02:35:32.012153 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_transaction__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®
-- ÂäüËÉΩÔºö‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ



SELECT 
    t.transaction_id,
    t.station_id,
    s.station_name,
    s.city,
    s.highway_code,
    s.station_type,
    t.lane_id,
    t.vehicle_plate,
    t.vehicle_type_code,
    vt.vehicle_type_name,
    vt.vehicle_type_desc,
    t.entry_station_id,
    es.station_name AS entry_station_name,
    t.entry_time,
    t.exit_time,
    t.travel_minutes,
    t.payment_method_code,
    pm.payment_method_name,
    pm.payment_method_desc,
    t.toll_amount,
    t.actual_amount,
    t.discount_amount,
    t.transaction_status,
    t.data_quality_flag,
    -- ‰∏öÂä°Â≠óÊÆµ
    DATE(t.exit_time) AS transaction_date,
    EXTRACT(HOUR FROM t.exit_time) AS transaction_hour,
    EXTRACT(DOW FROM t.exit_time) AS day_of_week,
    CASE 
        WHEN t.transaction_status = 'Ê≠£Â∏∏' THEN 1 
        ELSE 0 
    END AS is_normal_transaction,
    t.create_time,
    t.update_time,
    t.etl_time
FROM "datacore"."main_staging"."stg_toll_transaction" t
LEFT JOIN "datacore"."main_staging"."stg_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_toll_station" es ON t.entry_station_id = es.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
    );
  
  
[0m02:35:32.012717 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:32.013184 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: ROLLBACK
[0m02:35:32.016973 [debug] [Thread-1 (]: Failed to rollback 'model.datacore.ods_toll_transaction'
[0m02:35:32.017359 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: Close
[0m02:35:32.019980 [debug] [Thread-1 (]: Runtime Error in model ods_toll_transaction (models/ods/ods_toll_transaction.sql)
  Conversion Error: Unimplemented type for cast (INTERVAL -> BIGINT)
  
  LINE 55: LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict"...
               ^
[0m02:35:32.020438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c9cc4b8ad0>]}
[0m02:35:32.021003 [error] [Thread-1 (]: 9 of 18 ERROR creating sql table model main_ods.ods_toll_transaction ........... [[31mERROR[0m in 0.03s]
[0m02:35:32.021551 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_transaction
[0m02:35:32.022286 [debug] [Thread-4 (]: Marking all children of 'model.datacore.ods_toll_transaction' to be skipped because of status 'error'.  Reason: Runtime Error in model ods_toll_transaction (models/ods/ods_toll_transaction.sql)
  Conversion Error: Unimplemented type for cast (INTERVAL -> BIGINT)
  
  LINE 55: LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict"...
               ^.
[0m02:35:32.024376 [debug] [Thread-1 (]: Began running node model.datacore.dwd_toll_transaction_detail
[0m02:35:32.024738 [info ] [Thread-1 (]: 10 of 18 SKIP relation main_dwd.dwd_toll_transaction_detail .................... [[33mSKIP[0m]
[0m02:35:32.025104 [debug] [Thread-1 (]: Finished running node model.datacore.dwd_toll_transaction_detail
[0m02:35:32.025948 [debug] [Thread-1 (]: Began running node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:32.026379 [info ] [Thread-1 (]: 11 of 18 SKIP relation main_ads.ads_quality_monitoring_dashboard ............... [[33mSKIP[0m]
[0m02:35:32.026742 [debug] [Thread-1 (]: Finished running node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:32.027075 [debug] [Thread-1 (]: Began running node model.datacore.dws_station_performance_daily
[0m02:35:32.027480 [info ] [Thread-1 (]: 12 of 18 SKIP relation main_dws.dws_station_performance_daily .................. [[33mSKIP[0m]
[0m02:35:32.027839 [debug] [Thread-1 (]: Finished running node model.datacore.dws_station_performance_daily
[0m02:35:32.028170 [debug] [Thread-1 (]: Began running node model.datacore.dws_toll_revenue_daily
[0m02:35:32.028574 [info ] [Thread-1 (]: 13 of 18 SKIP relation main_dws.dws_toll_revenue_daily ......................... [[33mSKIP[0m]
[0m02:35:32.028928 [debug] [Thread-1 (]: Finished running node model.datacore.dws_toll_revenue_daily
[0m02:35:32.029255 [debug] [Thread-1 (]: Began running node model.datacore.dws_traffic_flow_daily
[0m02:35:32.029698 [info ] [Thread-1 (]: 14 of 18 SKIP relation main_dws.dws_traffic_flow_daily ......................... [[33mSKIP[0m]
[0m02:35:32.030073 [debug] [Thread-1 (]: Finished running node model.datacore.dws_traffic_flow_daily
[0m02:35:32.030409 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m02:35:32.030788 [info ] [Thread-1 (]: 15 of 18 SKIP relation main_metadata.meta_data_quality_metrics ................. [[33mSKIP[0m]
[0m02:35:32.031230 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m02:35:32.031587 [debug] [Thread-1 (]: Began running node model.datacore.ads_toll_revenue_report
[0m02:35:32.031959 [info ] [Thread-1 (]: 16 of 18 SKIP relation main_ads.ads_toll_revenue_report ........................ [[33mSKIP[0m]
[0m02:35:32.032328 [debug] [Thread-1 (]: Finished running node model.datacore.ads_toll_revenue_report
[0m02:35:32.032657 [debug] [Thread-1 (]: Began running node model.datacore.ads_traffic_trend_analysis
[0m02:35:32.033033 [info ] [Thread-1 (]: 17 of 18 SKIP relation main_ads.ads_traffic_trend_analysis ..................... [[33mSKIP[0m]
[0m02:35:32.033492 [debug] [Thread-1 (]: Finished running node model.datacore.ads_traffic_trend_analysis
[0m02:35:32.033835 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m02:35:32.034199 [info ] [Thread-1 (]: 18 of 18 SKIP relation main_metadata.meta_data_asset_catalog ................... [[33mSKIP[0m]
[0m02:35:32.034566 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m02:35:32.035978 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:32.036675 [debug] [MainThread]: On master: BEGIN
[0m02:35:32.037164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:35:32.038195 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:32.038702 [debug] [MainThread]: On master: COMMIT
[0m02:35:32.039185 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:32.039665 [debug] [MainThread]: On master: COMMIT
[0m02:35:32.040440 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:32.040926 [debug] [MainThread]: On master: Close
[0m02:35:32.041623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:32.042074 [debug] [MainThread]: Connection 'model.datacore.ods_toll_transaction' was properly closed.
[0m02:35:32.042711 [info ] [MainThread]: 
[0m02:35:32.043253 [info ] [MainThread]: Finished running 14 table models, 4 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m02:35:32.046705 [debug] [MainThread]: Command end result
[0m02:35:32.093541 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:32.095488 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:32.101190 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:35:32.101504 [info ] [MainThread]: 
[0m02:35:32.101831 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:35:32.102120 [info ] [MainThread]: 
[0m02:35:32.102470 [error] [MainThread]: [31mFailure in model ods_toll_transaction (models/ods/ods_toll_transaction.sql)[0m
[0m02:35:32.102801 [error] [MainThread]:   Runtime Error in model ods_toll_transaction (models/ods/ods_toll_transaction.sql)
  Conversion Error: Unimplemented type for cast (INTERVAL -> BIGINT)
  
  LINE 55: LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict"...
               ^
[0m02:35:32.103065 [info ] [MainThread]: 
[0m02:35:32.103382 [info ] [MainThread]:   compiled code at target/compiled/datacore/models/ods/ods_toll_transaction.sql
[0m02:35:32.103649 [info ] [MainThread]: 
[0m02:35:32.103943 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=9 NO-OP=0 TOTAL=18
[0m02:35:32.104798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4698493, "process_in_blocks": "0", "process_kernel_time": 0.234499, "process_mem_max_rss": "163540", "process_out_blocks": "3264", "process_user_time": 2.581488}
[0m02:35:32.105194 [debug] [MainThread]: Command `dbt run` failed at 02:35:32.105113 after 1.47 seconds
[0m02:35:32.105537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca291c78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca27ef3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca140aea80>]}
[0m02:35:32.105853 [debug] [MainThread]: Flushing usage events
[0m02:35:33.560171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:35:42.142134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c3644890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c5a6df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c38ead20>]}


============================== 02:35:42.146392 | 7f256e27-3177-431c-8c22-f1d85def646f ==============================
[0m02:35:42.146392 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:35:42.146868 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'static_parser': 'True', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'debug': 'False', 'invocation_command': 'dbt run --select staging.+', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': '/home/chun/Develop/datacore/logs', 'warn_error': 'None'}
[0m02:35:42.348058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f256e27-3177-431c-8c22-f1d85def646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c302a210>]}
[0m02:35:42.405981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f256e27-3177-431c-8c22-f1d85def646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c302b590>]}
[0m02:35:42.407515 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:35:42.488223 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:35:42.618893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:35:42.619635 [debug] [MainThread]: Partial parsing: updated file: datacore://models/staging/stg_toll_transaction.sql
[0m02:35:43.039847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f256e27-3177-431c-8c22-f1d85def646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6b0003530>]}
[0m02:35:43.209419 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:43.211191 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:43.225855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f256e27-3177-431c-8c22-f1d85def646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6b017fd10>]}
[0m02:35:43.226357 [info ] [MainThread]: Found 18 models, 1 seed, 15 data tests, 4 sources, 463 macros
[0m02:35:43.226699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f256e27-3177-431c-8c22-f1d85def646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f670d6ea20>]}
[0m02:35:43.227388 [warn ] [MainThread]: The selection criterion 'staging.+' does not match any enabled nodes
[0m02:35:43.228593 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:35:43.229075 [debug] [MainThread]: Command end result
[0m02:35:43.259049 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:43.260816 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:43.263682 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:35:43.264542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1734496, "process_in_blocks": "0", "process_kernel_time": 0.214818, "process_mem_max_rss": "145544", "process_out_blocks": "3896", "process_user_time": 2.224125}
[0m02:35:43.264950 [debug] [MainThread]: Command `dbt run` succeeded at 02:35:43.264864 after 1.17 seconds
[0m02:35:43.265291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c3e7a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6b0001490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6b019cef0>]}
[0m02:35:43.265633 [debug] [MainThread]: Flushing usage events
[0m02:35:44.398255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:35:48.838129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992e66bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992f021160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992e90f470>]}


============================== 02:35:48.842342 | 1287c672-0c8e-4c4b-a343-b8fa676f778c ==============================
[0m02:35:48.842342 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:35:48.842850 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'use_colors': 'True', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'write_json': 'True', 'warn_error': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'printer_width': '80', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'empty': 'False'}
[0m02:35:49.060911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992de1c320>]}
[0m02:35:49.130406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992e72e2a0>]}
[0m02:35:49.132095 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:35:49.215038 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:35:49.354320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:35:49.354730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:35:49.421679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991e2afb90>]}
[0m02:35:49.529667 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:49.531368 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:49.544350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991df61100>]}
[0m02:35:49.544814 [info ] [MainThread]: Found 18 models, 1 seed, 15 data tests, 4 sources, 463 macros
[0m02:35:49.545121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991dee5610>]}
[0m02:35:49.547223 [info ] [MainThread]: 
[0m02:35:49.547538 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:35:49.547797 [info ] [MainThread]: 
[0m02:35:49.548220 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:35:49.554114 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:35:49.597253 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.597676 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.597966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:49.615506 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m02:35:49.616993 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.619199 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.619546 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.619816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.620994 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.622082 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.623873 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.624199 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.624472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.625775 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.626818 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.628588 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.628908 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.629170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.630333 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.631380 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.633188 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.633527 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.633789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.635092 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.636141 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.637932 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.638219 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.638530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.639678 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.640726 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.641462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m02:35:49.641848 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:35:49.649198 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:49.649593 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.649873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.651219 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.652543 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:49.652813 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:35:49.653273 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.653531 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:49.653778 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:35:49.654263 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.654971 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:35:49.655236 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:49.655491 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:35:49.655938 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.656202 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:35:49.656776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now create_datacore_main_ods)
[0m02:35:49.657176 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ods"
"
[0m02:35:49.658836 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:49.659111 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.659377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.660700 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.661796 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:49.662059 [debug] [ThreadPool]: On create_datacore_main_ods: BEGIN
[0m02:35:49.662507 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.662756 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:49.663002 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
    
        create schema if not exists "datacore"."main_ods"
    
[0m02:35:49.663502 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.664193 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:35:49.664461 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:49.664705 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:35:49.665141 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.665405 [debug] [ThreadPool]: On create_datacore_main_ods: Close
[0m02:35:49.665921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ods, now create_datacore_main_staging)
[0m02:35:49.666307 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m02:35:49.667850 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:49.668129 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.668406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.669418 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.670517 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:49.670784 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m02:35:49.671227 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.671490 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:49.671741 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m02:35:49.672188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.672879 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:49.673140 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:49.673397 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:49.673794 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.674055 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m02:35:49.674601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now create_datacore_main_dws)
[0m02:35:49.674999 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dws"
"
[0m02:35:49.676516 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:49.676789 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.677046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.678040 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.679134 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:49.679405 [debug] [ThreadPool]: On create_datacore_main_dws: BEGIN
[0m02:35:49.679880 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.680129 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:49.680385 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
    
        create schema if not exists "datacore"."main_dws"
    
[0m02:35:49.680877 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.681572 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:35:49.681833 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:49.682082 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:35:49.682506 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.682766 [debug] [ThreadPool]: On create_datacore_main_dws: Close
[0m02:35:49.683297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dws, now create_datacore_main_dwd)
[0m02:35:49.683691 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dwd"
"
[0m02:35:49.685218 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:49.685500 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.685770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.686750 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.687830 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:49.688092 [debug] [ThreadPool]: On create_datacore_main_dwd: BEGIN
[0m02:35:49.688523 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.688773 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:49.689022 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
    
        create schema if not exists "datacore"."main_dwd"
    
[0m02:35:49.689473 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.690154 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:35:49.690420 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:49.690664 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:35:49.691058 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.691320 [debug] [ThreadPool]: On create_datacore_main_dwd: Close
[0m02:35:49.691847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dwd, now create_datacore_main_ads)
[0m02:35:49.692234 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ads"
"
[0m02:35:49.693857 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:49.694136 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.694404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.695393 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.696494 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:49.696758 [debug] [ThreadPool]: On create_datacore_main_ads: BEGIN
[0m02:35:49.697178 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.697437 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:49.697687 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
    
        create schema if not exists "datacore"."main_ads"
    
[0m02:35:49.698175 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.698873 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:35:49.699133 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:49.699387 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:35:49.699782 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.700042 [debug] [ThreadPool]: On create_datacore_main_ads: Close
[0m02:35:49.703637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ads, now list_datacore_main_metadata)
[0m02:35:49.715285 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:49.716009 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:35:49.716553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.717948 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.718497 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:49.719032 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.742958 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m02:35:49.744653 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:35:49.745732 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:35:49.746001 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:35:49.746646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_ods)
[0m02:35:49.749587 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:49.749925 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:35:49.750199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.750896 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.751168 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:49.751468 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.754890 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:49.756138 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:35:49.757041 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:35:49.757328 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:35:49.757884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_staging)
[0m02:35:49.760004 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:49.760318 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:35:49.760588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.761178 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.761464 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:49.761748 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.765657 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:49.766820 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:35:49.767637 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:35:49.767890 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:35:49.768415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main)
[0m02:35:49.771065 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:49.771358 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:35:49.771606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.772202 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.772459 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:49.772716 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.776186 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:49.777271 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:35:49.778077 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:35:49.778339 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:35:49.778851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_dws)
[0m02:35:49.781785 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:49.782074 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:35:49.782332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.782936 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.783189 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:49.783455 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.787004 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:49.788057 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:35:49.788861 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:35:49.789116 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:35:49.789634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_dwd)
[0m02:35:49.851997 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:49.852426 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:35:49.852685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.853381 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.853633 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:49.853891 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.857216 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:49.858335 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:35:49.859148 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:35:49.859416 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:35:49.860234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_ads)
[0m02:35:49.861850 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:49.862120 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:35:49.862373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.862942 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.863195 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:49.863464 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.866837 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:49.867905 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:35:49.868708 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:35:49.868963 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:35:49.869819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991dd394f0>]}
[0m02:35:49.870718 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:49.871245 [debug] [MainThread]: On master: BEGIN
[0m02:35:49.871754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:35:49.872915 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:49.873431 [debug] [MainThread]: On master: COMMIT
[0m02:35:49.873924 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:49.874420 [debug] [MainThread]: On master: COMMIT
[0m02:35:49.875207 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:49.875727 [debug] [MainThread]: On master: Close
[0m02:35:49.879007 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:35:49.879940 [info ] [Thread-1 (]: 1 of 18 START sql table model main_metadata.meta_data_lineage .................. [RUN]
[0m02:35:49.880700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now model.datacore.meta_data_lineage)
[0m02:35:49.881335 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:35:49.894756 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:35:49.895738 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:35:49.927002 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:35:49.927780 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.928137 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:35:49.928484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:49.929340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.929672 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.930080 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª



-- ‰ªérawÂà∞stagingÁöÑË°ÄÁºò
SELECT 
    'raw.toll_transaction' AS source_table,
    'staging.stg_toll_transaction' AS target_table,
    'Ê∏ÖÊ¥ó' AS transformation_type,
    'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT 
    'raw.toll_station',
    'staging.stg_toll_station',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
UNION ALL
SELECT 
    'raw.vehicle_type_dict',
    'staging.stg_vehicle_type_dict',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
UNION ALL
SELECT 
    'raw.payment_method_dict',
    'staging.stg_payment_method_dict',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
-- ‰ªéstagingÂà∞odsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'staging.stg_toll_transaction',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®Âíå‰∏öÂä°Â≠óÊÆµÊâ©Â±ï'
UNION ALL
SELECT 
    'staging.stg_toll_station',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÊî∂Ë¥πÁ´ô‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_vehicle_type_dict',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîËΩ¶Âûã‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_payment_method_dict',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÊîØ‰ªòÊñπÂºè‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_toll_station',
    'ods.ods_toll_station',
    'ËΩ¨Êç¢',
    '‰∏öÂä°Â≠óÊÆµÊâ©Â±ï'
-- ‰ªéodsÂà∞dwdÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'ods.ods_toll_transaction',
    'dwd.dwd_toll_transaction_detail',
    'ËΩ¨Êç¢',
    '‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆËΩ¨Êç¢'
-- ‰ªédwdÂà∞dwsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_toll_revenue_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÊ±áÊÄª'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_traffic_flow_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÊ±áÊÄªËΩ¶ÊµÅÈáè'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_station_performance_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ôÊ±áÊÄªÁª©Êïà'
-- ‰ªédwsÂà∞adsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'dws.dws_toll_revenue_daily',
    'ads.ads_toll_revenue_report',
    'ËÅöÂêà',
    'ÁîüÊàêÊî∂ÂÖ•Êä•Ë°®'
UNION ALL
SELECT 
    'dws.dws_traffic_flow_daily',
    'ads.ads_traffic_trend_analysis',
    'ËÅöÂêà',
    'ÁîüÊàêËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'ads.ads_quality_monitoring_dashboard',
    'ËÅöÂêà',
    'ÁîüÊàêË¥®ÈáèÁõëÊéßÁúãÊùø'
    );
  
  
[0m02:35:49.932907 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:49.938833 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.939284 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:35:49.940551 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.941882 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.942251 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:35:49.943439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.949822 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.950233 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m02:35:49.951182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.953834 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.954196 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:35:49.954936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:49.970127 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:35:49.970578 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.970921 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:35:49.972703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.978131 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.978545 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:35:49.979981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.982333 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:35:49.984176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be2db4d0>]}
[0m02:35:49.984793 [info ] [Thread-1 (]: 1 of 18 OK created sql table model main_metadata.meta_data_lineage ............. [[32mOK[0m in 0.10s]
[0m02:35:49.985372 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:35:49.985763 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:35:49.986268 [info ] [Thread-1 (]: 2 of 18 START sql table model main_metadata.meta_table_info .................... [RUN]
[0m02:35:49.986682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_table_info)
[0m02:35:49.987030 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:35:49.990025 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:35:49.990603 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:35:49.994758 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:35:49.995409 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:49.995759 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:35:49.996097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:49.996896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.997232 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:49.997647 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ



SELECT 
    'staging' AS schema_name,
    'stg_toll_transaction' AS table_name,
    'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description,
    'Êî∂Ë¥π‰∏öÂä°' AS business_domain,
    'Êî∂Ë¥πÁ≥ªÁªü' AS data_source,
    'ÂÆûÊó∂' AS update_frequency,
    'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner,
    'staging' AS data_layer,
    CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 
    'staging',
    'stg_toll_station',
    'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç',
    'Ë∑ØÁΩëÁÆ°ÁêÜ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü',
    'ÊåâÈúÄ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®',
    'staging',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ods',
    'ods_toll_transaction',
    'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'ÂÆûÊó∂',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ods',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ods',
    'ods_toll_station',
    'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®',
    'Ë∑ØÁΩëÁÆ°ÁêÜ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü',
    'ÊåâÈúÄ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®',
    'ods',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dwd',
    'dwd_toll_transaction_detail',
    'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆ',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'ÂÆûÊó∂',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dwd',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_toll_revenue_daily',
    'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_traffic_flow_daily',
    'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_station_performance_daily',
    'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_toll_revenue_report',
    'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ads',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_traffic_trend_analysis',
    'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ads',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_quality_monitoring_dashboard',
    'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø',
    'Êï∞ÊçÆÁÆ°ÁêÜ',
    'Êï∞ÊçÆ‰∏≠Âè∞',
    'ÂÆûÊó∂',
    'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®',
    'ads',
    CURRENT_TIMESTAMP
    );
  
  
[0m02:35:50.001187 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:35:50.002472 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.002832 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:35:50.003789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.004965 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.005329 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:35:50.006236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.009105 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.009480 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m02:35:50.010155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.012640 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.013001 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:35:50.013646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.014894 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:35:50.015248 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.015593 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:35:50.017017 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.019067 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.019442 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:35:50.020832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.022076 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:35:50.022759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be2bddc0>]}
[0m02:35:50.023351 [info ] [Thread-1 (]: 2 of 18 OK created sql table model main_metadata.meta_table_info ............... [[32mOK[0m in 0.04s]
[0m02:35:50.023902 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:35:50.024284 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m02:35:50.024803 [info ] [Thread-1 (]: 3 of 18 START sql view model main_staging.stg_payment_method_dict .............. [RUN]
[0m02:35:50.025226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.stg_payment_method_dict)
[0m02:35:50.025585 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m02:35:50.028717 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m02:35:50.029331 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m02:35:50.046287 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m02:35:50.046988 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.047321 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m02:35:50.047624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.048430 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.048736 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.049056 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."payment_method_dict"
  );

[0m02:35:50.049927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.052475 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.052820 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict" rename to "stg_payment_method_dict__dbt_backup"
[0m02:35:50.053490 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.055795 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.056127 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" rename to "stg_payment_method_dict"
[0m02:35:50.056753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.057817 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:50.058154 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.058485 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:50.059720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.061541 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.061869 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

      drop view if exists "datacore"."main_staging"."stg_payment_method_dict__dbt_backup" cascade
    
[0m02:35:50.063059 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.064173 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m02:35:50.064710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992fabf350>]}
[0m02:35:50.065230 [info ] [Thread-1 (]: 3 of 18 OK created sql view model main_staging.stg_payment_method_dict ......... [[32mOK[0m in 0.04s]
[0m02:35:50.065737 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m02:35:50.066084 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m02:35:50.066544 [info ] [Thread-1 (]: 4 of 18 START sql view model main_staging.stg_toll_station ..................... [RUN]
[0m02:35:50.066901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m02:35:50.067219 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m02:35:50.069984 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m02:35:50.070548 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m02:35:50.074452 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m02:35:50.075031 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.075358 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m02:35:50.075661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.076501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.076808 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.077123 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."toll_station"
  );

[0m02:35:50.077992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.080465 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.080814 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station" rename to "stg_toll_station__dbt_backup"
[0m02:35:50.081475 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.083729 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.084060 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station__dbt_tmp" rename to "stg_toll_station"
[0m02:35:50.084674 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.085833 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:50.086165 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.086558 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:50.087820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.089649 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.089975 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

      drop view if exists "datacore"."main_staging"."stg_toll_station__dbt_backup" cascade
    
[0m02:35:50.091199 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.092338 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m02:35:50.093078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198bded7f80>]}
[0m02:35:50.093618 [info ] [Thread-1 (]: 4 of 18 OK created sql view model main_staging.stg_toll_station ................ [[32mOK[0m in 0.03s]
[0m02:35:50.094122 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m02:35:50.094479 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m02:35:50.094942 [info ] [Thread-1 (]: 5 of 18 START sql view model main_staging.stg_toll_transaction ................. [RUN]
[0m02:35:50.095439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m02:35:50.095764 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m02:35:50.098975 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m02:35:50.099554 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m02:35:50.101910 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m02:35:50.102430 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.102752 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m02:35:50.103061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.103799 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.104222 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.104632 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "datacore"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST(EXTRACT(EPOCH FROM (exit_time - entry_time)) AS INTEGER) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:35:50.106550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.109124 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.109476 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction" rename to "stg_toll_transaction__dbt_backup"
[0m02:35:50.110224 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.112502 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.112842 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" rename to "stg_toll_transaction"
[0m02:35:50.113496 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.114582 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:50.114916 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.115226 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:50.116924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.119048 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.119424 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

      drop view if exists "datacore"."main_staging"."stg_toll_transaction__dbt_backup" cascade
    
[0m02:35:50.120946 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.122206 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m02:35:50.122825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198bdeacd40>]}
[0m02:35:50.123409 [info ] [Thread-1 (]: 5 of 18 OK created sql view model main_staging.stg_toll_transaction ............ [[32mOK[0m in 0.03s]
[0m02:35:50.123963 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m02:35:50.124357 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m02:35:50.124847 [info ] [Thread-1 (]: 6 of 18 START sql view model main_staging.stg_vehicle_type_dict ................ [RUN]
[0m02:35:50.125235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m02:35:50.125591 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m02:35:50.128587 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.129174 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m02:35:50.133595 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.134227 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.134587 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m02:35:50.134916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.135699 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.136033 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.136389 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."vehicle_type_dict"
  );

[0m02:35:50.137251 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.139948 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.140316 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict" rename to "stg_vehicle_type_dict__dbt_backup"
[0m02:35:50.140975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.143438 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.143793 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" rename to "stg_vehicle_type_dict"
[0m02:35:50.144419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.145585 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:50.145936 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.146272 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:50.148223 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:50.150221 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.150601 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

      drop view if exists "datacore"."main_staging"."stg_vehicle_type_dict__dbt_backup" cascade
    
[0m02:35:50.151829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.153044 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m02:35:50.153635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991c14ac90>]}
[0m02:35:50.154199 [info ] [Thread-1 (]: 6 of 18 OK created sql view model main_staging.stg_vehicle_type_dict ........... [[32mOK[0m in 0.03s]
[0m02:35:50.154760 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m02:35:50.155134 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_station
[0m02:35:50.155643 [info ] [Thread-1 (]: 7 of 18 START sql table model main_ods.ods_toll_station ........................ [RUN]
[0m02:35:50.156165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_vehicle_type_dict, now model.datacore.ods_toll_station)
[0m02:35:50.156522 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_station
[0m02:35:50.159527 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_station"
[0m02:35:50.160163 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_station
[0m02:35:50.162711 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_station"
[0m02:35:50.163243 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.163587 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: BEGIN
[0m02:35:50.163909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.164685 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.165011 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.165373 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_station__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®



SELECT 
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    open_date,
    -- ‰∏öÂä°Â≠óÊÆµ
    CASE 
        WHEN station_type = '‰∏ªÁ∫øÊî∂Ë¥πÁ´ô' THEN 1
        ELSE 0
    END AS is_main_station,
    CURRENT_DATE - open_date AS days_since_open,
    etl_time
FROM "datacore"."main_staging"."stg_toll_station"
    );
  
  
[0m02:35:50.167609 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:50.168898 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.169251 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m02:35:50.170206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.171401 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.171750 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m02:35:50.172729 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.175600 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.175966 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station" rename to "ods_toll_station__dbt_backup"
[0m02:35:50.176636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.179072 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.179429 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station__dbt_tmp" rename to "ods_toll_station"
[0m02:35:50.180030 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.181235 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:35:50.181590 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.181919 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:35:50.183337 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.185331 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.185680 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

      drop table if exists "datacore"."main_ods"."ods_toll_station__dbt_backup" cascade
    
[0m02:35:50.187022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.188285 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: Close
[0m02:35:50.188955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be2cd400>]}
[0m02:35:50.189523 [info ] [Thread-1 (]: 7 of 18 OK created sql table model main_ods.ods_toll_station ................... [[32mOK[0m in 0.03s]
[0m02:35:50.190061 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_station
[0m02:35:50.190503 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m02:35:50.190973 [info ] [Thread-1 (]: 8 of 18 START sql table model main_metadata.meta_data_dictionary ............... [RUN]
[0m02:35:50.191359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_station, now model.datacore.meta_data_dictionary)
[0m02:35:50.191698 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m02:35:50.195186 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m02:35:50.195784 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m02:35:50.198343 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m02:35:50.198880 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.199226 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m02:35:50.199569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.200355 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.200690 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.201094 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m02:35:50.206162 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m02:35:50.207243 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.207607 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:35:50.208522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.212489 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.213122 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:35:50.214532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.217549 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.217935 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary" rename to "meta_data_dictionary__dbt_backup"
[0m02:35:50.218625 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.221084 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.221457 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m02:35:50.222094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.223338 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:35:50.223697 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.224034 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:35:50.225432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.227443 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.227803 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m02:35:50.229113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.230339 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m02:35:50.231155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198bde9c4d0>]}
[0m02:35:50.231727 [info ] [Thread-1 (]: 8 of 18 OK created sql table model main_metadata.meta_data_dictionary .......... [[32mOK[0m in 0.04s]
[0m02:35:50.232269 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m02:35:50.232650 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_transaction
[0m02:35:50.233116 [info ] [Thread-1 (]: 9 of 18 START sql table model main_ods.ods_toll_transaction .................... [RUN]
[0m02:35:50.233512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.ods_toll_transaction)
[0m02:35:50.233852 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_transaction
[0m02:35:50.237925 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_transaction"
[0m02:35:50.238516 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_transaction
[0m02:35:50.241031 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_transaction"
[0m02:35:50.241574 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:50.241921 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: BEGIN
[0m02:35:50.242247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.242998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.243339 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:50.243727 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_transaction__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®
-- ÂäüËÉΩÔºö‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ



SELECT 
    t.transaction_id,
    t.station_id,
    s.station_name,
    s.city,
    s.highway_code,
    s.station_type,
    t.lane_id,
    t.vehicle_plate,
    t.vehicle_type_code,
    vt.vehicle_type_name,
    vt.vehicle_type_desc,
    t.entry_station_id,
    es.station_name AS entry_station_name,
    t.entry_time,
    t.exit_time,
    t.travel_minutes,
    t.payment_method_code,
    pm.payment_method_name,
    pm.payment_method_desc,
    t.toll_amount,
    t.actual_amount,
    t.discount_amount,
    t.transaction_status,
    t.data_quality_flag,
    -- ‰∏öÂä°Â≠óÊÆµ
    DATE(t.exit_time) AS transaction_date,
    EXTRACT(HOUR FROM t.exit_time) AS transaction_hour,
    EXTRACT(DOW FROM t.exit_time) AS day_of_week,
    CASE 
        WHEN t.transaction_status = 'Ê≠£Â∏∏' THEN 1 
        ELSE 0 
    END AS is_normal_transaction,
    t.create_time,
    t.update_time,
    t.etl_time
FROM "datacore"."main_staging"."stg_toll_transaction" t
LEFT JOIN "datacore"."main_staging"."stg_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_toll_station" es ON t.entry_station_id = es.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
    );
  
  
[0m02:35:50.472119 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m02:35:50.475160 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:50.475542 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */
alter table "datacore"."main_ods"."ods_toll_transaction__dbt_tmp" rename to "ods_toll_transaction"
[0m02:35:50.476392 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.477543 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m02:35:50.477890 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:50.478217 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m02:35:50.727573 [debug] [Thread-1 (]: SQL status: OK in 0.249 seconds
[0m02:35:50.729740 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:50.730074 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

      drop table if exists "datacore"."main_ods"."ods_toll_transaction__dbt_backup" cascade
    
[0m02:35:50.730711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.731872 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: Close
[0m02:35:50.741217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991e263b30>]}
[0m02:35:50.741838 [info ] [Thread-1 (]: 9 of 18 OK created sql table model main_ods.ods_toll_transaction ............... [[32mOK[0m in 0.51s]
[0m02:35:50.742356 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_transaction
[0m02:35:50.743444 [debug] [Thread-1 (]: Began running node model.datacore.dwd_toll_transaction_detail
[0m02:35:50.743852 [info ] [Thread-1 (]: 10 of 18 START sql table model main_dwd.dwd_toll_transaction_detail ............ [RUN]
[0m02:35:50.744240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_transaction, now model.datacore.dwd_toll_transaction_detail)
[0m02:35:50.744578 [debug] [Thread-1 (]: Began compiling node model.datacore.dwd_toll_transaction_detail
[0m02:35:50.747545 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dwd_toll_transaction_detail"
[0m02:35:50.748137 [debug] [Thread-1 (]: Began executing node model.datacore.dwd_toll_transaction_detail
[0m02:35:50.750528 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dwd_toll_transaction_detail"
[0m02:35:50.751055 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:35:50.751376 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: BEGIN
[0m02:35:50.751692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.752399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.752710 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:35:50.753060 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

  
    
    

    create  table
      "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp"
  
    as (
      -- DWDÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆ
-- ÂäüËÉΩÔºö‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÔºå‰æø‰∫éÂêéÁª≠ÂàÜÊûê



SELECT 
    transaction_id,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    vehicle_type_name,
    vehicle_type_desc,
    entry_station_id,
    entry_station_name,
    entry_time,
    exit_time,
    travel_minutes,
    -- ËÆ°ÁÆóÈÄöË°åË∑ùÁ¶ªÔºà‰º∞ÁÆóÔºåÂü∫‰∫éÊó∂Èó¥Ôºâ
    CASE 
        WHEN travel_minutes > 0 THEN 
            ROUND(travel_minutes * 60 / 100.0, 2)  -- ÂÅáËÆæÂπ≥ÂùáÈÄüÂ∫¶100km/h
        ELSE 0
    END AS estimated_distance_km,
    payment_method_code,
    payment_method_name,
    payment_method_desc,
    toll_amount,
    actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    transaction_date,
    transaction_hour,
    day_of_week,
    is_normal_transaction,
    -- ‰∏öÂä°ÂàÜÁ±ª
    CASE 
        WHEN transaction_hour BETWEEN 6 AND 9 THEN 'Êó©È´òÂ≥∞'
        WHEN transaction_hour BETWEEN 17 AND 20 THEN 'ÊôöÈ´òÂ≥∞'
        WHEN transaction_hour BETWEEN 22 AND 6 THEN 'Â§úÈó¥'
        ELSE 'Âπ≥Â≥∞'
    END AS time_period,
    CASE 
        WHEN day_of_week IN (0, 6) THEN 'Âë®Êú´'  -- DOW: 0=Âë®Êó•, 6=Âë®ÂÖ≠
        ELSE 'Â∑•‰ΩúÊó•'
    END AS day_type,
    create_time,
    update_time,
    etl_time
FROM "datacore"."main_ods"."ods_toll_transaction"
    );
  
  
[0m02:35:51.003953 [debug] [Thread-1 (]: SQL status: OK in 0.250 seconds
[0m02:35:51.007807 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:35:51.008179 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */
alter table "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp" rename to "dwd_toll_transaction_detail"
[0m02:35:51.009031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.010155 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m02:35:51.010499 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:35:51.010808 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m02:35:51.268900 [debug] [Thread-1 (]: SQL status: OK in 0.258 seconds
[0m02:35:51.272886 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:35:51.273254 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

      drop table if exists "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_backup" cascade
    
[0m02:35:51.273973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.275215 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: Close
[0m02:35:51.284911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be2c8440>]}
[0m02:35:51.285575 [info ] [Thread-1 (]: 10 of 18 OK created sql table model main_dwd.dwd_toll_transaction_detail ....... [[32mOK[0m in 0.54s]
[0m02:35:51.286104 [debug] [Thread-1 (]: Finished running node model.datacore.dwd_toll_transaction_detail
[0m02:35:51.287590 [debug] [Thread-1 (]: Began running node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:51.288272 [info ] [Thread-1 (]: 11 of 18 START sql table model main_ads.ads_quality_monitoring_dashboard ....... [RUN]
[0m02:35:51.288814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dwd_toll_transaction_detail, now model.datacore.ads_quality_monitoring_dashboard)
[0m02:35:51.289175 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:51.292484 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.293121 [debug] [Thread-1 (]: Began executing node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:51.295509 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.296034 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.296359 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: BEGIN
[0m02:35:51.296669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.297405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.297712 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.298093 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø
-- ÂäüËÉΩÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶



SELECT 
    transaction_date,
    -- ÊÄª‰ΩìË¥®ÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transactions,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal,
    -- Ë¥®ÈáèÁéá
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÂºÇÂ∏∏Á±ªÂûãÂàÜÂ∏É
    SUM(CASE WHEN transaction_status = 'ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS status_abnormal_count,
    SUM(CASE WHEN transaction_status = 'ÈÄÉË¥π' THEN 1 ELSE 0 END) AS status_evasion_count,
    SUM(CASE WHEN transaction_status = 'ËÆæÂ§áÊïÖÈöú' THEN 1 ELSE 0 END) AS status_equipment_failure_count,
    SUM(CASE WHEN transaction_status = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS status_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êî∂Ë¥πÁ´ôÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_station_missing_count,
    SUM(CASE WHEN data_quality_flag = 'ËΩ¶ÁâåÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_plate_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êó∂Èó¥ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_time_abnormal_count,
    SUM(CASE WHEN data_quality_flag = 'ÈáëÈ¢ùÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_amount_abnormal_count,
    -- ÂëäË≠¶Ê†áËÆ∞
    CASE 
        WHEN SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 90 THEN 'ÂëäË≠¶'
        WHEN SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 95 THEN 'ÂëäË≠¶'
        ELSE 'Ê≠£Â∏∏'
    END AS alert_status,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:35:51.307621 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m02:35:51.310140 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.310491 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */
alter table "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp" rename to "ads_quality_monitoring_dashboard"
[0m02:35:51.311176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.312232 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m02:35:51.312563 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.312866 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m02:35:51.314479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.316592 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.316926 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

      drop table if exists "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_backup" cascade
    
[0m02:35:51.317493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.318587 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: Close
[0m02:35:51.319224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be2ce9f0>]}
[0m02:35:51.319742 [info ] [Thread-1 (]: 11 of 18 OK created sql table model main_ads.ads_quality_monitoring_dashboard .. [[32mOK[0m in 0.03s]
[0m02:35:51.320254 [debug] [Thread-1 (]: Finished running node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:51.320611 [debug] [Thread-1 (]: Began running node model.datacore.dws_station_performance_daily
[0m02:35:51.321050 [info ] [Thread-1 (]: 12 of 18 START sql table model main_dws.dws_station_performance_daily .......... [RUN]
[0m02:35:51.321413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_quality_monitoring_dashboard, now model.datacore.dws_station_performance_daily)
[0m02:35:51.321726 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_station_performance_daily
[0m02:35:51.324558 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_station_performance_daily"
[0m02:35:51.325103 [debug] [Thread-1 (]: Began executing node model.datacore.dws_station_performance_daily
[0m02:35:51.327316 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_station_performance_daily"
[0m02:35:51.327814 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:35:51.328129 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: BEGIN
[0m02:35:51.328433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.329153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.329469 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:35:51.329818 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄª
-- ÂäüËÉΩÔºöÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    -- ‰∫§ÊòìÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    COUNT(DISTINCT lane_id) AS active_lanes,
    -- Êî∂ÂÖ•ÊåáÊ†á
    SUM(actual_amount) AS total_revenue,
    AVG(actual_amount) AS avg_revenue_per_transaction,
    -- ÊïàÁéáÊåáÊ†á
    AVG(travel_minutes) AS avg_processing_time_minutes,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS etc_rate,
    -- È´òÂ≥∞Êó∂ÊÆµÂç†ÊØî
    SUM(CASE WHEN time_period IN ('Êó©È´òÂ≥∞', 'ÊôöÈ´òÂ≥∞') THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS peak_hour_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type
    );
  
  
[0m02:35:51.390777 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m02:35:51.393901 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:35:51.394292 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */
alter table "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp" rename to "dws_station_performance_daily"
[0m02:35:51.395110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.396299 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m02:35:51.396677 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:35:51.397023 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m02:35:51.399982 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:35:51.402145 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:35:51.402522 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

      drop table if exists "datacore"."main_dws"."dws_station_performance_daily__dbt_backup" cascade
    
[0m02:35:51.403154 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.404387 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: Close
[0m02:35:51.413097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991df624b0>]}
[0m02:35:51.413767 [info ] [Thread-1 (]: 12 of 18 OK created sql table model main_dws.dws_station_performance_daily ..... [[32mOK[0m in 0.09s]
[0m02:35:51.414289 [debug] [Thread-1 (]: Finished running node model.datacore.dws_station_performance_daily
[0m02:35:51.414658 [debug] [Thread-1 (]: Began running node model.datacore.dws_toll_revenue_daily
[0m02:35:51.415108 [info ] [Thread-1 (]: 13 of 18 START sql table model main_dws.dws_toll_revenue_daily ................. [RUN]
[0m02:35:51.415484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_station_performance_daily, now model.datacore.dws_toll_revenue_daily)
[0m02:35:51.415807 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_toll_revenue_daily
[0m02:35:51.418865 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.419397 [debug] [Thread-1 (]: Began executing node model.datacore.dws_toll_revenue_daily
[0m02:35:51.423473 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.424040 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.424376 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: BEGIN
[0m02:35:51.424687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.425432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.425749 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.426130 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name,
    -- Ê±áÊÄªÊåáÊ†á
    COUNT(*) AS transaction_count,
    COUNT(DISTINCT vehicle_plate) AS vehicle_count,
    SUM(toll_amount) AS total_toll_amount,
    SUM(actual_amount) AS total_actual_amount,
    SUM(discount_amount) AS total_discount_amount,
    AVG(actual_amount) AS avg_transaction_amount,
    MAX(actual_amount) AS max_transaction_amount,
    MIN(actual_amount) AS min_transaction_amount,
    -- Ê≠£Â∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transaction_count,
    SUM(CASE WHEN is_normal_transaction = 1 THEN actual_amount ELSE 0 END) AS normal_transaction_amount,
    -- ÂºÇÂ∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transaction_count,
    -- Êï∞ÊçÆË¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal_count,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name
    );
  
  
[0m02:35:51.509362 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m02:35:51.512092 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.512447 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */
alter table "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp" rename to "dws_toll_revenue_daily"
[0m02:35:51.513192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.514277 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m02:35:51.514620 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.514931 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m02:35:51.526481 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m02:35:51.528671 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.529014 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

      drop table if exists "datacore"."main_dws"."dws_toll_revenue_daily__dbt_backup" cascade
    
[0m02:35:51.529669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.530809 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: Close
[0m02:35:51.545801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198bdef7770>]}
[0m02:35:51.546551 [info ] [Thread-1 (]: 13 of 18 OK created sql table model main_dws.dws_toll_revenue_daily ............ [[32mOK[0m in 0.13s]
[0m02:35:51.547104 [debug] [Thread-1 (]: Finished running node model.datacore.dws_toll_revenue_daily
[0m02:35:51.547499 [debug] [Thread-1 (]: Began running node model.datacore.dws_traffic_flow_daily
[0m02:35:51.548177 [info ] [Thread-1 (]: 14 of 18 START sql table model main_dws.dws_traffic_flow_daily ................. [RUN]
[0m02:35:51.548640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_toll_revenue_daily, now model.datacore.dws_traffic_flow_daily)
[0m02:35:51.548988 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_traffic_flow_daily
[0m02:35:51.552363 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.552961 [debug] [Thread-1 (]: Began executing node model.datacore.dws_traffic_flow_daily
[0m02:35:51.555744 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.556298 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.556662 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: BEGIN
[0m02:35:51.556998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.557853 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.558196 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.558591 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•ËΩ¶ÊµÅÈáèÊ±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type,
    -- ËΩ¶ÊµÅÈáèÊåáÊ†á
    COUNT(*) AS total_vehicles,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' THEN 1 ELSE 0 END) AS passenger_vehicle_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code != 'V01' THEN 1 ELSE 0 END) AS bus_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code >= 'V05' THEN 1 ELSE 0 END) AS truck_count,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(travel_minutes) AS avg_travel_minutes,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) AS etc_count,
    SUM(CASE WHEN payment_method_code != 'P01' THEN 1 ELSE 0 END) AS non_etc_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type
    );
  
  
[0m02:35:51.618297 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m02:35:51.621552 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.622005 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */
alter table "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp" rename to "dws_traffic_flow_daily"
[0m02:35:51.623164 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.624722 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m02:35:51.625125 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.625491 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m02:35:51.629273 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:35:51.631511 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.631878 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

      drop table if exists "datacore"."main_dws"."dws_traffic_flow_daily__dbt_backup" cascade
    
[0m02:35:51.632562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.633819 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: Close
[0m02:35:51.645633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991ddcef00>]}
[0m02:35:51.646394 [info ] [Thread-1 (]: 14 of 18 OK created sql table model main_dws.dws_traffic_flow_daily ............ [[32mOK[0m in 0.10s]
[0m02:35:51.646957 [debug] [Thread-1 (]: Finished running node model.datacore.dws_traffic_flow_daily
[0m02:35:51.647365 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m02:35:51.648060 [info ] [Thread-1 (]: 15 of 18 START sql table model main_metadata.meta_data_quality_metrics ......... [RUN]
[0m02:35:51.648482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_traffic_flow_daily, now model.datacore.meta_data_quality_metrics)
[0m02:35:51.648830 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_quality_metrics
[0m02:35:51.652239 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_quality_metrics"
[0m02:35:51.652815 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_quality_metrics
[0m02:35:51.655487 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_quality_metrics"
[0m02:35:51.656026 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:35:51.656389 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: BEGIN
[0m02:35:51.656725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.657520 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.657860 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:35:51.658281 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø



SELECT 
    transaction_date AS metric_date,
    'dwd_toll_transaction_detail' AS table_name,
    -- ÂÆåÊï¥ÊÄßÊåáÊ†á
    COUNT(*) AS total_records,
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_transaction_id,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_station_id,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) AS complete_vehicle_plate,
    -- ÂÆåÊï¥ÊÄßÁéá
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS transaction_id_completeness_rate,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS station_id_completeness_rate,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS vehicle_plate_completeness_rate,
    -- ÂáÜÁ°ÆÊÄßÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS accuracy_rate,
    -- ‰∏ÄËá¥ÊÄßÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS consistent_records,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS consistency_rate,
    -- ÂèäÊó∂ÊÄßÊåáÊ†á
    MAX(etl_time) AS last_etl_time,
    CURRENT_TIMESTAMP - MAX(etl_time) AS etl_delay,
    -- ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ
    (
        (SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2
    ) AS overall_quality_score,
    CURRENT_TIMESTAMP AS metric_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:35:51.669721 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m02:35:51.672668 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:35:51.673048 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp" rename to "meta_data_quality_metrics"
[0m02:35:51.673807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.674988 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:35:51.675350 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:35:51.675679 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:35:51.677201 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.679257 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:35:51.679627 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

      drop table if exists "datacore"."main_metadata"."meta_data_quality_metrics__dbt_backup" cascade
    
[0m02:35:51.680223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.681442 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: Close
[0m02:35:51.682176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be38f5c0>]}
[0m02:35:51.682746 [info ] [Thread-1 (]: 15 of 18 OK created sql table model main_metadata.meta_data_quality_metrics .... [[32mOK[0m in 0.03s]
[0m02:35:51.683293 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m02:35:51.683693 [debug] [Thread-1 (]: Began running node model.datacore.ads_toll_revenue_report
[0m02:35:51.684191 [info ] [Thread-1 (]: 16 of 18 START sql table model main_ads.ads_toll_revenue_report ................ [RUN]
[0m02:35:51.684597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_quality_metrics, now model.datacore.ads_toll_revenue_report)
[0m02:35:51.684948 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_toll_revenue_report
[0m02:35:51.689918 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_toll_revenue_report"
[0m02:35:51.690524 [debug] [Thread-1 (]: Began executing node model.datacore.ads_toll_revenue_report
[0m02:35:51.693174 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_toll_revenue_report"
[0m02:35:51.693708 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:35:51.694064 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: BEGIN
[0m02:35:51.694413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.695214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.695570 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:35:51.695958 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®
-- ÂäüËÉΩÔºöÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®



SELECT 
    transaction_date,
    city,
    highway_code,
    -- ÊÄª‰ΩìÊåáÊ†á
    SUM(total_actual_amount) AS daily_revenue,
    SUM(transaction_count) AS daily_transactions,
    SUM(vehicle_count) AS daily_vehicles,
    AVG(avg_transaction_amount) AS avg_transaction_amount,
    -- ÊåâÊîØ‰ªòÊñπÂºè
    SUM(CASE WHEN payment_method_code = 'P01' THEN total_actual_amount ELSE 0 END) AS etc_revenue,
    SUM(CASE WHEN payment_method_code != 'P01' THEN total_actual_amount ELSE 0 END) AS non_etc_revenue,
    -- ÊåâËΩ¶Âûã
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code < 'V05' THEN total_actual_amount ELSE 0 END) AS passenger_revenue,
    SUM(CASE WHEN vehicle_type_code >= 'V05' THEN total_actual_amount ELSE 0 END) AS truck_revenue,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(normal_transaction_count) * 100.0 / SUM(transaction_count) AS normal_rate,
    SUM(quality_normal_count) * 100.0 / SUM(transaction_count) AS data_quality_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_toll_revenue_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code
    );
  
  
[0m02:35:51.705567 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m02:35:51.708253 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:35:51.708605 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */
alter table "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp" rename to "ads_toll_revenue_report"
[0m02:35:51.709359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.710470 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m02:35:51.710804 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:35:51.711115 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m02:35:51.713485 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:51.715427 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:35:51.715768 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

      drop table if exists "datacore"."main_ads"."ads_toll_revenue_report__dbt_backup" cascade
    
[0m02:35:51.716371 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.717506 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: Close
[0m02:35:51.720516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991c149e20>]}
[0m02:35:51.721046 [info ] [Thread-1 (]: 16 of 18 OK created sql table model main_ads.ads_toll_revenue_report ........... [[32mOK[0m in 0.04s]
[0m02:35:51.721554 [debug] [Thread-1 (]: Finished running node model.datacore.ads_toll_revenue_report
[0m02:35:51.721906 [debug] [Thread-1 (]: Began running node model.datacore.ads_traffic_trend_analysis
[0m02:35:51.722554 [info ] [Thread-1 (]: 17 of 18 START sql table model main_ads.ads_traffic_trend_analysis ............. [RUN]
[0m02:35:51.722944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_toll_revenue_report, now model.datacore.ads_traffic_trend_analysis)
[0m02:35:51.723257 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_traffic_trend_analysis
[0m02:35:51.726130 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.726646 [debug] [Thread-1 (]: Began executing node model.datacore.ads_traffic_trend_analysis
[0m02:35:51.728967 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.729438 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.729759 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: BEGIN
[0m02:35:51.730067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.730796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.731111 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.731470 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê
-- ÂäüËÉΩÔºöËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê



SELECT 
    transaction_date,
    city,
    highway_code,
    day_type,
    -- ËΩ¶ÊµÅÈáèË∂ãÂäø
    SUM(total_vehicles) AS daily_vehicles,
    SUM(unique_vehicles) AS daily_unique_vehicles,
    -- Êó∂ÊÆµÂàÜÂ∏É
    SUM(CASE WHEN time_period = 'Êó©È´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS morning_peak_vehicles,
    SUM(CASE WHEN time_period = 'ÊôöÈ´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS evening_peak_vehicles,
    SUM(CASE WHEN time_period = 'Âπ≥Â≥∞' THEN total_vehicles ELSE 0 END) AS normal_vehicles,
    SUM(CASE WHEN time_period = 'Â§úÈó¥' THEN total_vehicles ELSE 0 END) AS night_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(passenger_vehicle_count) AS passenger_vehicles,
    SUM(bus_count) AS bus_vehicles,
    SUM(truck_count) AS truck_vehicles,
    -- ETC‰ΩøÁî®Áéá
    SUM(etc_count) * 100.0 / SUM(total_vehicles) AS etc_usage_rate,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(avg_travel_minutes) AS avg_travel_minutes,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_traffic_flow_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code,
    day_type
    );
  
  
[0m02:35:51.738912 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m02:35:51.741614 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.741953 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */
alter table "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp" rename to "ads_traffic_trend_analysis"
[0m02:35:51.742710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.743881 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m02:35:51.744221 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.744540 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m02:35:51.747034 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:51.748966 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.749320 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

      drop table if exists "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_backup" cascade
    
[0m02:35:51.749945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.751106 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: Close
[0m02:35:51.755347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991e260950>]}
[0m02:35:51.755980 [info ] [Thread-1 (]: 17 of 18 OK created sql table model main_ads.ads_traffic_trend_analysis ........ [[32mOK[0m in 0.03s]
[0m02:35:51.756513 [debug] [Thread-1 (]: Finished running node model.datacore.ads_traffic_trend_analysis
[0m02:35:51.756867 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m02:35:51.757261 [info ] [Thread-1 (]: 18 of 18 START sql table model main_metadata.meta_data_asset_catalog ........... [RUN]
[0m02:35:51.757710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_traffic_trend_analysis, now model.datacore.meta_data_asset_catalog)
[0m02:35:51.758027 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_asset_catalog
[0m02:35:51.761873 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_asset_catalog"
[0m02:35:51.762396 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_asset_catalog
[0m02:35:51.764718 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_asset_catalog"
[0m02:35:51.765187 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:35:51.765511 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: BEGIN
[0m02:35:51.765813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.766535 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.766848 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:35:51.767215 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï
-- ÂäüËÉΩÔºöÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞



WITH table_stats AS (
    SELECT 
        'dwd.dwd_toll_transaction_detail' AS table_name,
        COUNT(*) AS record_count,
        MAX(etl_time) AS last_update_time
    FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_toll_revenue_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_toll_revenue_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_traffic_flow_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_traffic_flow_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'ads.ads_toll_revenue_report',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_ads"."ads_toll_revenue_report"
    GROUP BY 1
)

SELECT 
    ti.schema_name,
    ti.table_name,
    ti.table_description,
    ti.business_domain,
    ti.data_layer,
    ti.owner,
    COALESCE(ts.record_count, 0) AS record_count,
    COALESCE(ts.last_update_time, CURRENT_TIMESTAMP) AS last_update_time,
    -- ËµÑ‰∫ßÁ≠âÁ∫ßËØÑ‰º∞
    CASE 
        WHEN ti.data_layer IN ('dwd', 'dws') THEN 'Ê†∏ÂøÉËµÑ‰∫ß'
        WHEN ti.data_layer = 'ads' THEN 'Â∫îÁî®ËµÑ‰∫ß'
        ELSE 'Âü∫Á°ÄËµÑ‰∫ß'
    END AS asset_level,
    -- ‰ΩøÁî®È¢ëÁéáËØÑ‰º∞ÔºàÂü∫‰∫éÊõ¥Êñ∞È¢ëÁéáÔºâ
    CASE 
        WHEN ti.update_frequency = 'ÂÆûÊó∂' THEN 'È´òÈ¢ë'
        WHEN ti.update_frequency = 'Êó•' THEN '‰∏≠È¢ë'
        ELSE '‰ΩéÈ¢ë'
    END AS usage_frequency,
    -- Êï∞ÊçÆÊñ∞È≤úÂ∫¶
    CASE 
        WHEN ts.last_update_time IS NULL THEN 'Êú™Áü•'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 1 DAY THEN 'Êñ∞È≤ú'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 7 DAY THEN 'ËæÉÊñ∞'
        ELSE 'ÈôàÊóß'
    END AS data_freshness,
    CURRENT_TIMESTAMP AS catalog_time
FROM "datacore"."main_metadata"."meta_table_info" ti
LEFT JOIN table_stats ts ON CONCAT(ti.schema_name, '.', ti.table_name) = ts.table_name
    );
  
  
[0m02:35:51.775907 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m02:35:51.780211 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:35:51.780610 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp" rename to "meta_data_asset_catalog"
[0m02:35:51.781389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.782523 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:35:51.782864 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:35:51.783178 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:35:51.784798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.786673 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:35:51.787007 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

      drop table if exists "datacore"."main_metadata"."meta_data_asset_catalog__dbt_backup" cascade
    
[0m02:35:51.787582 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.788696 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: Close
[0m02:35:51.791330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198bdf02d50>]}
[0m02:35:51.791858 [info ] [Thread-1 (]: 18 of 18 OK created sql table model main_metadata.meta_data_asset_catalog ...... [[32mOK[0m in 0.03s]
[0m02:35:51.792364 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m02:35:51.794882 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:51.795726 [debug] [MainThread]: On master: BEGIN
[0m02:35:51.796274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:35:51.798203 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:35:51.798777 [debug] [MainThread]: On master: COMMIT
[0m02:35:51.799330 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:51.799860 [debug] [MainThread]: On master: COMMIT
[0m02:35:51.800719 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:51.801279 [debug] [MainThread]: On master: Close
[0m02:35:51.802159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:51.802695 [debug] [MainThread]: Connection 'model.datacore.meta_data_asset_catalog' was properly closed.
[0m02:35:51.803557 [info ] [MainThread]: 
[0m02:35:51.804280 [info ] [MainThread]: Finished running 14 table models, 4 view models in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m02:35:51.810522 [debug] [MainThread]: Command end result
[0m02:35:51.856193 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:51.858778 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:51.866372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:35:51.866750 [info ] [MainThread]: 
[0m02:35:51.867158 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:35:51.867473 [info ] [MainThread]: 
[0m02:35:51.867840 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=18
[0m02:35:51.869201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0879946, "process_in_blocks": "0", "process_kernel_time": 0.920201, "process_mem_max_rss": "302064", "process_out_blocks": "30016", "process_user_time": 4.66102}
[0m02:35:51.869763 [debug] [MainThread]: Command `dbt run` succeeded at 02:35:51.869662 after 3.09 seconds
[0m02:35:51.870166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992de669c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992e90f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719929b5fe30>]}
[0m02:35:51.870538 [debug] [MainThread]: Flushing usage events
[0m02:35:53.331150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:36:01.131170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033a4d6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033beda300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033a4d5430>]}


============================== 02:36:01.135204 | 196bf73e-9045-4d2a-a5ad-8bf79e67208a ==============================
[0m02:36:01.135204 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:36:01.135704 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt test', 'log_path': '/home/chun/Develop/datacore/logs', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:36:01.356361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033bccae70>]}
[0m02:36:01.419334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0329958260>]}
[0m02:36:01.421014 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:36:01.502872 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:36:01.641007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:36:01.641459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:36:01.707602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03297122a0>]}
[0m02:36:01.821487 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:36:01.823419 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:36:01.846900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0328188f50>]}
[0m02:36:01.847470 [info ] [MainThread]: Found 18 models, 1 seed, 15 data tests, 4 sources, 463 macros
[0m02:36:01.847805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0329933f80>]}
[0m02:36:01.850387 [info ] [MainThread]: 
[0m02:36:01.850781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:36:01.851079 [info ] [MainThread]: 
[0m02:36:01.851597 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:36:01.857778 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore_main'
[0m02:36:01.897743 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:36:01.898126 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:36:01.898391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:01.916737 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:36:01.917168 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:36:01.917461 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.929688 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:36:01.930865 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:36:01.931852 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:36:01.932116 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:36:01.932670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_staging)
[0m02:36:01.934395 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:36:01.934663 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:36:01.934907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.935589 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.935839 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:36:01.936092 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.940431 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:36:01.941780 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:36:01.942613 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:36:01.942873 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:36:01.943442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_ods)
[0m02:36:01.946900 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:36:01.947235 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:36:01.947500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.948157 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.948422 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:36:01.948681 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.954128 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:36:01.955297 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:36:01.956101 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:36:01.956371 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:36:01.956920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_metadata)
[0m02:36:01.958912 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:36:01.959197 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:36:01.959454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.960012 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.960263 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:36:01.960531 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.963990 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:36:01.965185 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:36:01.965969 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:36:01.966225 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:36:01.966753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dwd)
[0m02:36:01.969568 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:36:01.969861 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:36:01.970111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.970674 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.970926 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:36:01.971180 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.976206 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:36:01.977332 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:36:01.978106 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:36:01.978363 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:36:01.978875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_dws)
[0m02:36:01.980857 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:36:01.981139 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:36:01.981392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.981942 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.982189 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:36:01.982454 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.987504 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:36:01.988648 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:36:01.989410 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:36:01.989661 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:36:01.990190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_ads)
[0m02:36:01.992628 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:36:01.992906 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:36:01.993148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.993694 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.993940 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:36:01.994190 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.997582 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:36:01.998714 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:36:01.999487 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:36:01.999735 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:36:02.001348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03281582f0>]}
[0m02:36:02.002198 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:02.002763 [debug] [MainThread]: On master: BEGIN
[0m02:36:02.003243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:36:02.004268 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:36:02.004778 [debug] [MainThread]: On master: COMMIT
[0m02:36:02.005268 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:02.005759 [debug] [MainThread]: On master: COMMIT
[0m02:36:02.006526 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:36:02.007021 [debug] [MainThread]: On master: Close
[0m02:36:02.010743 [debug] [Thread-1 (]: Began running node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:36:02.011161 [info ] [Thread-1 (]: 1 of 15 START test not_null_dwd_toll_transaction_detail_transaction_id ......... [RUN]
[0m02:36:02.011595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90)
[0m02:36:02.011910 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:36:02.026425 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:36:02.027060 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:36:02.042791 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:36:02.043411 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:36:02.043725 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: BEGIN
[0m02:36:02.044016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.044792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.045094 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:36:02.045400 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "datacore"."main_dwd"."dwd_toll_transaction_detail"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.046517 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.050076 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: ROLLBACK
[0m02:36:02.050921 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90'
[0m02:36:02.051228 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: Close
[0m02:36:02.052061 [info ] [Thread-1 (]: 1 of 15 PASS not_null_dwd_toll_transaction_detail_transaction_id ............... [[32mPASS[0m in 0.04s]
[0m02:36:02.052575 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:36:02.052918 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:36:02.053321 [info ] [Thread-1 (]: 2 of 15 START test not_null_stg_payment_method_dict_payment_method_code ........ [RUN]
[0m02:36:02.053679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90, now test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c)
[0m02:36:02.053981 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:36:02.057281 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:36:02.057846 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:36:02.059571 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:36:02.060074 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:36:02.060386 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: BEGIN
[0m02:36:02.060675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.061397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.061688 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:36:02.061986 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_method_code
from "datacore"."main_staging"."stg_payment_method_dict"
where payment_method_code is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.063117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.064426 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: ROLLBACK
[0m02:36:02.065266 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c'
[0m02:36:02.065580 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: Close
[0m02:36:02.066162 [info ] [Thread-1 (]: 2 of 15 PASS not_null_stg_payment_method_dict_payment_method_code .............. [[32mPASS[0m in 0.01s]
[0m02:36:02.066652 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:36:02.066989 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:36:02.067379 [info ] [Thread-1 (]: 3 of 15 START test not_null_stg_toll_station_station_id ........................ [RUN]
[0m02:36:02.067729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c, now test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2)
[0m02:36:02.068027 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:36:02.072914 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:36:02.073494 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:36:02.133328 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:36:02.133999 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:36:02.134328 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: BEGIN
[0m02:36:02.134630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.135400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.135701 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:36:02.136006 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select station_id
from "datacore"."main_staging"."stg_toll_station"
where station_id is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.137290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.138617 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: ROLLBACK
[0m02:36:02.139450 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2'
[0m02:36:02.139753 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: Close
[0m02:36:02.140332 [info ] [Thread-1 (]: 3 of 15 PASS not_null_stg_toll_station_station_id .............................. [[32mPASS[0m in 0.07s]
[0m02:36:02.140824 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:36:02.141160 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:36:02.141535 [info ] [Thread-1 (]: 4 of 15 START test not_null_stg_toll_transaction_station_id .................... [RUN]
[0m02:36:02.141894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2, now test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde)
[0m02:36:02.142196 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:36:02.145414 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:36:02.145891 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:36:02.147603 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:36:02.148047 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:36:02.148361 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: BEGIN
[0m02:36:02.148647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.149367 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.149660 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:36:02.149960 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select station_id
from "datacore"."main_staging"."stg_toll_transaction"
where station_id is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.152925 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:36:02.154232 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: ROLLBACK
[0m02:36:02.155054 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde'
[0m02:36:02.155359 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: Close
[0m02:36:02.156219 [info ] [Thread-1 (]: 4 of 15 PASS not_null_stg_toll_transaction_station_id .......................... [[32mPASS[0m in 0.01s]
[0m02:36:02.156710 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:36:02.157042 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:36:02.157413 [info ] [Thread-1 (]: 5 of 15 START test not_null_stg_toll_transaction_transaction_id ................ [RUN]
[0m02:36:02.157758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde, now test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b)
[0m02:36:02.158054 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:36:02.161339 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:36:02.161832 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:36:02.163534 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:36:02.163992 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:36:02.164294 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: BEGIN
[0m02:36:02.164589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.165330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.165638 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:36:02.165938 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "datacore"."main_staging"."stg_toll_transaction"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.168845 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:36:02.170296 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: ROLLBACK
[0m02:36:02.171139 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b'
[0m02:36:02.171446 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: Close
[0m02:36:02.172035 [info ] [Thread-1 (]: 5 of 15 PASS not_null_stg_toll_transaction_transaction_id ...................... [[32mPASS[0m in 0.01s]
[0m02:36:02.172528 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:36:02.172865 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:36:02.173226 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_vehicle_type_dict_vehicle_type_code ............ [RUN]
[0m02:36:02.173584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b, now test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728)
[0m02:36:02.173884 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:36:02.177132 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:36:02.177633 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:36:02.179331 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:36:02.179786 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:36:02.180091 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: BEGIN
[0m02:36:02.180387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.181102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.181405 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:36:02.181707 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vehicle_type_code
from "datacore"."main_staging"."stg_vehicle_type_dict"
where vehicle_type_code is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.182853 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.184121 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: ROLLBACK
[0m02:36:02.184935 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728'
[0m02:36:02.185250 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: Close
[0m02:36:02.185811 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_vehicle_type_dict_vehicle_type_code .................. [[32mPASS[0m in 0.01s]
[0m02:36:02.186299 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:36:02.186650 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_accuracy
[0m02:36:02.187011 [info ] [Thread-1 (]: 7 of 15 START test test_toll_transaction_accuracy .............................. [RUN]
[0m02:36:02.187363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728, now test.datacore.test_toll_transaction_accuracy)
[0m02:36:02.187659 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_accuracy
[0m02:36:02.189997 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_accuracy"
[0m02:36:02.190556 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_accuracy
[0m02:36:02.192231 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_accuracy"
[0m02:36:02.192751 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_accuracy"
[0m02:36:02.193062 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: BEGIN
[0m02:36:02.193363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.194073 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.194380 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_accuracy"
[0m02:36:02.194688 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_accuracy"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂáÜÁ°ÆÊÄß

SELECT 
    transaction_id,
    toll_amount,
    actual_amount,
    discount_amount
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    actual_amount < 0
    OR actual_amount > toll_amount
    OR discount_amount < 0
    OR discount_amount > toll_amount
    OR (actual_amount + discount_amount) > toll_amount * 1.1  -- ÂÖÅËÆ∏10%ËØØÂ∑Æ
  
  
      
    ) dbt_internal_test
[0m02:36:02.197759 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:36:02.199124 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: ROLLBACK
[0m02:36:02.199957 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_accuracy'
[0m02:36:02.200255 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: Close
[0m02:36:02.200852 [info ] [Thread-1 (]: 7 of 15 PASS test_toll_transaction_accuracy .................................... [[32mPASS[0m in 0.01s]
[0m02:36:02.201337 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_accuracy
[0m02:36:02.201666 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_completeness
[0m02:36:02.201971 [info ] [Thread-1 (]: 8 of 15 START test test_toll_transaction_completeness .......................... [RUN]
[0m02:36:02.202380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_accuracy, now test.datacore.test_toll_transaction_completeness)
[0m02:36:02.202679 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_completeness
[0m02:36:02.204976 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_completeness"
[0m02:36:02.205448 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_completeness
[0m02:36:02.207119 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_completeness"
[0m02:36:02.207570 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:36:02.207873 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: BEGIN
[0m02:36:02.208160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.209102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.209407 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:36:02.209717 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_completeness"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂÆåÊï¥ÊÄß

SELECT 
    transaction_id,
    station_id,
    vehicle_plate,
    vehicle_type_code,
    payment_method_code
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    transaction_id IS NULL
    OR station_id IS NULL
    OR vehicle_plate IS NULL
    OR vehicle_plate = ''
    OR vehicle_type_code IS NULL
    OR payment_method_code IS NULL
  
  
      
    ) dbt_internal_test
[0m02:36:02.215894 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m02:36:02.217288 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: ROLLBACK
[0m02:36:02.218150 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_completeness'
[0m02:36:02.218462 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: Close
[0m02:36:02.219114 [info ] [Thread-1 (]: 8 of 15 PASS test_toll_transaction_completeness ................................ [[32mPASS[0m in 0.02s]
[0m02:36:02.219613 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_completeness
[0m02:36:02.219949 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_consistency
[0m02:36:02.220331 [info ] [Thread-1 (]: 9 of 15 START test test_toll_transaction_consistency ........................... [RUN]
[0m02:36:02.220681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_completeness, now test.datacore.test_toll_transaction_consistency)
[0m02:36:02.220981 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_consistency
[0m02:36:02.224886 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_consistency"
[0m02:36:02.225397 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_consistency
[0m02:36:02.227059 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_consistency"
[0m02:36:02.227511 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_consistency"
[0m02:36:02.227812 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: BEGIN
[0m02:36:02.228098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.228822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.229118 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_consistency"
[0m02:36:02.229428 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_consistency"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆ‰∏ÄËá¥ÊÄß

SELECT 
    transaction_id,
    entry_time,
    exit_time,
    travel_minutes
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    exit_time < entry_time
    OR travel_minutes < 0
    OR travel_minutes > 1440  -- Ë∂ÖËøá24Â∞èÊó∂ËßÜ‰∏∫ÂºÇÂ∏∏
  
  
      
    ) dbt_internal_test
[0m02:36:02.232504 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:36:02.233846 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: ROLLBACK
[0m02:36:02.234668 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_consistency'
[0m02:36:02.234966 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: Close
[0m02:36:02.235527 [info ] [Thread-1 (]: 9 of 15 PASS test_toll_transaction_consistency ................................. [[32mPASS[0m in 0.01s]
[0m02:36:02.236014 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_consistency
[0m02:36:02.236357 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_referential_integrity
[0m02:36:02.236727 [info ] [Thread-1 (]: 10 of 15 START test test_toll_transaction_referential_integrity ................ [RUN]
[0m02:36:02.237072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_consistency, now test.datacore.test_toll_transaction_referential_integrity)
[0m02:36:02.237381 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_referential_integrity
[0m02:36:02.240393 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_referential_integrity"
[0m02:36:02.240879 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_referential_integrity
[0m02:36:02.242579 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_referential_integrity"
[0m02:36:02.243021 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_referential_integrity"
[0m02:36:02.243330 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: BEGIN
[0m02:36:02.243618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.244342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.244639 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_referential_integrity"
[0m02:36:02.244960 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_referential_integrity"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂºïÁî®ÂÆåÊï¥ÊÄß

SELECT 
    t.transaction_id,
    t.station_id,
    t.vehicle_type_code,
    t.payment_method_code
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail" t
LEFT JOIN "datacore"."main_ods"."ods_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
WHERE 
    s.station_id IS NULL
    OR vt.vehicle_type_code IS NULL
    OR pm.payment_method_code IS NULL
  
  
      
    ) dbt_internal_test
[0m02:36:02.252781 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m02:36:02.254233 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: ROLLBACK
[0m02:36:02.255079 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_referential_integrity'
[0m02:36:02.255395 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: Close
[0m02:36:02.256400 [info ] [Thread-1 (]: 10 of 15 PASS test_toll_transaction_referential_integrity ...................... [[32mPASS[0m in 0.02s]
[0m02:36:02.256893 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_referential_integrity
[0m02:36:02.257234 [debug] [Thread-1 (]: Began running node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:36:02.257611 [info ] [Thread-1 (]: 11 of 15 START test unique_dwd_toll_transaction_detail_transaction_id .......... [RUN]
[0m02:36:02.257963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_referential_integrity, now test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716)
[0m02:36:02.258267 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:36:02.263803 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:36:02.264337 [debug] [Thread-1 (]: Began executing node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:36:02.266116 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:36:02.266579 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:36:02.266888 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: BEGIN
[0m02:36:02.267180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.267921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.268217 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:36:02.268530 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "datacore"."main_dwd"."dwd_toll_transaction_detail"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:36:02.287129 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m02:36:02.288765 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: ROLLBACK
[0m02:36:02.289612 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716'
[0m02:36:02.289920 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: Close
[0m02:36:02.292233 [info ] [Thread-1 (]: 11 of 15 PASS unique_dwd_toll_transaction_detail_transaction_id ................ [[32mPASS[0m in 0.03s]
[0m02:36:02.292739 [debug] [Thread-1 (]: Finished running node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:36:02.293082 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:36:02.293475 [info ] [Thread-1 (]: 12 of 15 START test unique_stg_payment_method_dict_payment_method_code ......... [RUN]
[0m02:36:02.293830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716, now test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1)
[0m02:36:02.294135 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:36:02.297367 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:36:02.297860 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:36:02.299571 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:36:02.300054 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:36:02.300374 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: BEGIN
[0m02:36:02.300670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.301438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.301740 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:36:02.302051 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_method_code as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_payment_method_dict"
where payment_method_code is not null
group by payment_method_code
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:36:02.304919 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:36:02.306379 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: ROLLBACK
[0m02:36:02.307208 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1'
[0m02:36:02.307522 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: Close
[0m02:36:02.308414 [info ] [Thread-1 (]: 12 of 15 PASS unique_stg_payment_method_dict_payment_method_code ............... [[32mPASS[0m in 0.01s]
[0m02:36:02.308905 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:36:02.309244 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:36:02.309634 [info ] [Thread-1 (]: 13 of 15 START test unique_stg_toll_station_station_id ......................... [RUN]
[0m02:36:02.309985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1, now test.datacore.unique_stg_toll_station_station_id.7201f48e61)
[0m02:36:02.310287 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:36:02.313520 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:36:02.314020 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:36:02.315788 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:36:02.316270 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:36:02.316581 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: BEGIN
[0m02:36:02.316870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.317631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.317952 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:36:02.318299 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_toll_station_station_id.7201f48e61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    station_id as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_toll_station"
where station_id is not null
group by station_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:36:02.321029 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:36:02.322605 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: ROLLBACK
[0m02:36:02.323529 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_toll_station_station_id.7201f48e61'
[0m02:36:02.323861 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: Close
[0m02:36:02.324934 [info ] [Thread-1 (]: 13 of 15 PASS unique_stg_toll_station_station_id ............................... [[32mPASS[0m in 0.01s]
[0m02:36:02.325478 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:36:02.325852 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:36:02.326251 [info ] [Thread-1 (]: 14 of 15 START test unique_stg_toll_transaction_transaction_id ................. [RUN]
[0m02:36:02.326646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_toll_station_station_id.7201f48e61, now test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27)
[0m02:36:02.326977 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:36:02.330597 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:36:02.331124 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:36:02.334948 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:36:02.335496 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:36:02.335831 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: BEGIN
[0m02:36:02.336146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.336945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.337267 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:36:02.337606 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_toll_transaction"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:36:02.359722 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m02:36:02.361549 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: ROLLBACK
[0m02:36:02.362482 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27'
[0m02:36:02.362822 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: Close
[0m02:36:02.366393 [info ] [Thread-1 (]: 14 of 15 PASS unique_stg_toll_transaction_transaction_id ....................... [[32mPASS[0m in 0.04s]
[0m02:36:02.366988 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:36:02.367374 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:36:02.367784 [info ] [Thread-1 (]: 15 of 15 START test unique_stg_vehicle_type_dict_vehicle_type_code ............. [RUN]
[0m02:36:02.368184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27, now test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd)
[0m02:36:02.368534 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:36:02.372359 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:36:02.372884 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:36:02.374823 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:36:02.375322 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:36:02.375661 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: BEGIN
[0m02:36:02.375976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.376778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.377099 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:36:02.377443 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vehicle_type_code as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_vehicle_type_dict"
where vehicle_type_code is not null
group by vehicle_type_code
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:36:02.379816 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:36:02.381363 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: ROLLBACK
[0m02:36:02.382270 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd'
[0m02:36:02.382609 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: Close
[0m02:36:02.383680 [info ] [Thread-1 (]: 15 of 15 PASS unique_stg_vehicle_type_dict_vehicle_type_code ................... [[32mPASS[0m in 0.02s]
[0m02:36:02.384217 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:36:02.386045 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:02.386757 [debug] [MainThread]: On master: BEGIN
[0m02:36:02.387237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:36:02.388365 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:36:02.388899 [debug] [MainThread]: On master: COMMIT
[0m02:36:02.389434 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:02.389941 [debug] [MainThread]: On master: COMMIT
[0m02:36:02.390740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:36:02.391324 [debug] [MainThread]: On master: Close
[0m02:36:02.392096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:02.392603 [debug] [MainThread]: Connection 'test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd' was properly closed.
[0m02:36:02.393179 [info ] [MainThread]: 
[0m02:36:02.393785 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m02:36:02.398675 [debug] [MainThread]: Command end result
[0m02:36:02.447328 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:36:02.449484 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:36:02.456563 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:36:02.456896 [info ] [MainThread]: 
[0m02:36:02.457264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:36:02.457615 [info ] [MainThread]: 
[0m02:36:02.457945 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m02:36:02.458884 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3833071, "process_in_blocks": "880", "process_kernel_time": 0.293089, "process_mem_max_rss": "187472", "process_out_blocks": "3088", "process_user_time": 2.535126}
[0m02:36:02.459324 [debug] [MainThread]: Command `dbt test` succeeded at 02:36:02.459229 after 1.38 seconds
[0m02:36:02.459689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0339aaf4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033b3caf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033983f830>]}
[0m02:36:02.460047 [debug] [MainThread]: Flushing usage events
[0m02:36:03.632750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:40:54.752850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7aec206690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae95e5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae8b27ce0>]}


============================== 02:40:54.757000 | e4710e71-4775-438f-8675-49424c781218 ==============================
[0m02:40:54.757000 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:40:54.757481 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/chun/Develop/datacore/logs', 'profiles_dir': '/home/chun/Develop/datacore', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select metadata.meta_table_info', 'no_print': 'None', 'version_check': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default'}
[0m02:40:54.959664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4710e71-4775-438f-8675-49424c781218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae899dc70>]}
[0m02:40:55.017844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4710e71-4775-438f-8675-49424c781218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae93001a0>]}
[0m02:40:55.019377 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:40:55.101437 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:40:55.234084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 3 files changed.
[0m02:40:55.234696 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/get_model_lineage.sql
[0m02:40:55.235002 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/generate_table_info.sql
[0m02:40:55.235337 [debug] [MainThread]: Partial parsing: added file: datacore://models/ods/schema.yml
[0m02:40:55.235619 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/get_all_models.sql
[0m02:40:55.235912 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/generate_lineage.sql
[0m02:40:55.236565 [debug] [MainThread]: Partial parsing: updated file: datacore://models/staging/schema.yml
[0m02:40:55.236937 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/meta_data_lineage.sql
[0m02:40:55.237293 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/meta_table_info.sql
[0m02:40:55.481079 [error] [MainThread]: Encountered an error:
Compilation Error in model meta_data_lineage (models/metadata/meta_data_lineage.sql)
  'dict object' has no attribute 'nodes'
[0m02:40:55.482144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.78061324, "process_in_blocks": "0", "process_kernel_time": 0.205928, "process_mem_max_rss": "142000", "process_out_blocks": "16", "process_user_time": 1.839294}
[0m02:40:55.482609 [debug] [MainThread]: Command `dbt run` failed at 02:40:55.482519 after 0.78 seconds
[0m02:40:55.483031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae8e18e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ad845ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae8485760>]}
[0m02:40:55.483387 [debug] [MainThread]: Flushing usage events
[0m02:40:56.618573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:41:58.096366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19111990a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19117d2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d191119bda0>]}


============================== 02:41:58.099238 | 545a6c3e-73bb-4bc8-aa31-87fcff043430 ==============================
[0m02:41:58.099238 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:41:58.099707 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'no_print': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'log_path': '/home/chun/Develop/datacore/logs', 'debug': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select metadata.meta_table_info', 'log_format': 'default', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m02:41:58.302083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1910880050>]}
[0m02:41:58.361123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19112a0b60>]}
[0m02:41:58.362551 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:41:58.443648 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:41:58.576091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 3 files changed.
[0m02:41:58.576653 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/get_model_lineage.sql
[0m02:41:58.576955 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/generate_table_info.sql
[0m02:41:58.577248 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/generate_lineage.sql
[0m02:41:58.577533 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/get_all_models.sql
[0m02:41:58.577850 [debug] [MainThread]: Partial parsing: added file: datacore://models/ods/schema.yml
[0m02:41:58.578472 [debug] [MainThread]: Partial parsing: updated file: datacore://models/staging/schema.yml
[0m02:41:58.578836 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/meta_table_info.sql
[0m02:41:58.579187 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/meta_data_lineage.sql
[0m02:41:59.147488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1913038fe0>]}
[0m02:41:59.254331 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:41:59.256549 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:41:59.271654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d190018b560>]}
[0m02:41:59.272157 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 467 macros
[0m02:41:59.272512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d190072ade0>]}
[0m02:41:59.274210 [info ] [MainThread]: 
[0m02:41:59.274562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:41:59.274883 [info ] [MainThread]: 
[0m02:41:59.275354 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:41:59.276599 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:41:59.316319 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:41:59.316738 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:41:59.317010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:41:59.337337 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m02:41:59.338902 [debug] [ThreadPool]: On list_datacore: Close
[0m02:41:59.339726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m02:41:59.340158 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:41:59.346949 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:41:59.347299 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:41:59.347595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.348791 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.350042 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:41:59.350333 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:41:59.351020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:41:59.351285 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:41:59.351578 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:41:59.352053 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:41:59.352794 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:41:59.353075 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:41:59.353348 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:41:59.353870 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:41:59.354153 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:41:59.360761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_dwd)
[0m02:41:59.370239 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:41:59.370829 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:41:59.371361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.372497 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.373037 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:41:59.373608 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.397764 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m02:41:59.400207 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:41:59.402218 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:41:59.402788 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:41:59.403886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_staging)
[0m02:41:59.407760 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:41:59.408339 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:41:59.408865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.410157 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.410698 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:41:59.411242 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.417699 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m02:41:59.418933 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:41:59.419781 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:41:59.420037 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:41:59.420610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main)
[0m02:41:59.423597 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:41:59.423889 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:41:59.424166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.424745 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.424996 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:41:59.425282 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.430760 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:41:59.431866 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:41:59.432678 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:41:59.432934 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:41:59.433857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_dws)
[0m02:41:59.437246 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:41:59.437672 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:41:59.437953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.438705 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.438979 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:41:59.439264 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.443031 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:41:59.444372 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:41:59.445229 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:41:59.445513 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:41:59.446114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_metadata)
[0m02:41:59.448857 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:41:59.449170 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:41:59.449450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.450124 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.450409 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:41:59.450697 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.455949 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:41:59.457275 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:41:59.458084 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:41:59.458366 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:41:59.458987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_ads)
[0m02:41:59.462210 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:41:59.462531 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:41:59.462810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.463442 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.463717 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:41:59.464005 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.467627 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:41:59.468974 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:41:59.469852 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:41:59.470135 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:41:59.470765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_ods)
[0m02:41:59.473513 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:41:59.473825 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:41:59.474101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.474770 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.475050 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:41:59.475355 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.479820 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:41:59.481252 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:41:59.482137 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:41:59.482426 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:41:59.483879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1900085d60>]}
[0m02:41:59.484701 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:59.485221 [debug] [MainThread]: On master: BEGIN
[0m02:41:59.485720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:41:59.486751 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:41:59.487242 [debug] [MainThread]: On master: COMMIT
[0m02:41:59.487743 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:59.488213 [debug] [MainThread]: On master: COMMIT
[0m02:41:59.489006 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:41:59.489518 [debug] [MainThread]: On master: Close
[0m02:41:59.492844 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:41:59.493946 [info ] [Thread-1 (]: 1 of 1 START sql table model main_metadata.meta_table_info ..................... [RUN]
[0m02:41:59.494869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now model.datacore.meta_table_info)
[0m02:41:59.495626 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:41:59.512762 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:41:59.513661 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:41:59.544417 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:41:59.545149 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.545500 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:41:59.545814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:41:59.546665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:41:59.547010 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.547538 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m02:41:59.552563 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:41:59.558399 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.558803 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:41:59.559921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:41:59.561182 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.561552 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:41:59.562844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:41:59.569109 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.569547 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m02:41:59.570334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:41:59.573024 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.573396 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:41:59.574045 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:41:59.588806 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:41:59.589240 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.589594 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:41:59.591907 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:41:59.598844 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.599296 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:41:59.600879 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:41:59.603271 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:41:59.605344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19130d1640>]}
[0m02:41:59.605982 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_metadata.meta_table_info ................ [[32mOK[0m in 0.11s]
[0m02:41:59.606562 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:41:59.608495 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:59.609152 [debug] [MainThread]: On master: BEGIN
[0m02:41:59.609652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:41:59.610687 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:41:59.611172 [debug] [MainThread]: On master: COMMIT
[0m02:41:59.611668 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:59.612137 [debug] [MainThread]: On master: COMMIT
[0m02:41:59.612916 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:41:59.613436 [debug] [MainThread]: On master: Close
[0m02:41:59.614120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:41:59.614586 [debug] [MainThread]: Connection 'model.datacore.meta_table_info' was properly closed.
[0m02:41:59.615107 [info ] [MainThread]: 
[0m02:41:59.615674 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m02:41:59.616751 [debug] [MainThread]: Command end result
[0m02:41:59.664654 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:41:59.666554 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:41:59.671677 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:41:59.671958 [info ] [MainThread]: 
[0m02:41:59.672314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:41:59.672589 [info ] [MainThread]: 
[0m02:41:59.672889 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:41:59.673676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.631898, "process_in_blocks": "0", "process_kernel_time": 0.245386, "process_mem_max_rss": "160832", "process_out_blocks": "4056", "process_user_time": 2.712215}
[0m02:41:59.674052 [debug] [MainThread]: Command `dbt run` succeeded at 02:41:59.673973 after 1.63 seconds
[0m02:41:59.674368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1910ca1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1911858530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19132e5970>]}
[0m02:41:59.674683 [debug] [MainThread]: Flushing usage events
[0m02:42:00.770247 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:42:09.348650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75576a033620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557693f13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75576a033320>]}


============================== 02:42:09.352897 | 52af4f9b-64fa-4e96-b0ac-f1d432634e26 ==============================
[0m02:42:09.352897 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:42:09.353374 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'quiet': 'False', 'empty': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'printer_width': '80', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select metadata.meta_data_lineage', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m02:42:09.555582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75576b8326f0>]}
[0m02:42:09.614479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557594f9eb0>]}
[0m02:42:09.616051 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:42:09.698869 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:42:09.835007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:42:09.835451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:42:09.898765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75575932dc10>]}
[0m02:42:10.015892 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:42:10.017825 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:42:10.033097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557590a2270>]}
[0m02:42:10.033692 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 467 macros
[0m02:42:10.034032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755758f46660>]}
[0m02:42:10.035834 [info ] [MainThread]: 
[0m02:42:10.036214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:42:10.036504 [info ] [MainThread]: 
[0m02:42:10.037019 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:42:10.038222 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:42:10.072383 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:42:10.072770 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:42:10.073041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:10.092031 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m02:42:10.093387 [debug] [ThreadPool]: On list_datacore: Close
[0m02:42:10.094098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m02:42:10.094506 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:42:10.100686 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:10.101009 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:42:10.101269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.102344 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.103447 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:10.103713 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:42:10.104130 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:10.104382 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:10.104630 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:42:10.105066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:10.105751 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:42:10.106014 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:10.106259 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:42:10.106721 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:10.106995 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:42:10.113224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_dws)
[0m02:42:10.118427 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:42:10.118732 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:42:10.118983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.119637 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.119891 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:42:10.120149 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.132213 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:42:10.133501 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:42:10.134512 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:42:10.134774 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:42:10.135308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_dwd)
[0m02:42:10.137972 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:42:10.138253 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:42:10.138507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.139186 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.139448 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:42:10.139700 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.144727 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:42:10.145872 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:42:10.146683 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:42:10.146940 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:42:10.147482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main)
[0m02:42:10.150912 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:42:10.151230 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:42:10.151488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.152153 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.152411 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:42:10.152665 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.156091 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:42:10.157173 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:42:10.157964 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:42:10.158217 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:42:10.158731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_metadata)
[0m02:42:10.160316 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:42:10.160579 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:42:10.160822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.161576 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.161823 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:42:10.162078 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.166168 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:42:10.167373 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:42:10.168137 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:42:10.168398 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:42:10.168922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_ads)
[0m02:42:10.171896 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:42:10.172182 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:42:10.172437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.173065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.173321 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:42:10.173577 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.178559 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:42:10.179716 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:42:10.180498 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:42:10.180752 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:42:10.181268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_ods)
[0m02:42:10.184001 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:42:10.184329 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:42:10.184595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.185393 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.185663 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:42:10.185937 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.190959 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:42:10.192219 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:42:10.193057 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:42:10.193337 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:42:10.194066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_staging)
[0m02:42:10.196561 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:42:10.196873 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:42:10.197136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.197755 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.198025 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:42:10.198312 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.201914 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:42:10.203178 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:42:10.204031 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:42:10.204319 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:42:10.206115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75575952e810>]}
[0m02:42:10.206976 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:10.207494 [debug] [MainThread]: On master: BEGIN
[0m02:42:10.207965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:10.209231 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:42:10.209747 [debug] [MainThread]: On master: COMMIT
[0m02:42:10.210231 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:10.210711 [debug] [MainThread]: On master: COMMIT
[0m02:42:10.211469 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:42:10.211960 [debug] [MainThread]: On master: Close
[0m02:42:10.215278 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:42:10.216171 [info ] [Thread-1 (]: 1 of 1 START sql table model main_metadata.meta_data_lineage ................... [RUN]
[0m02:42:10.217013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now model.datacore.meta_data_lineage)
[0m02:42:10.217688 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:42:10.252472 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:42:10.253123 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:42:10.282729 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:42:10.283439 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.283767 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:42:10.284069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:10.284878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:10.285183 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.285632 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª
-- Ëá™Âä®ËØÜÂà´ ref() Âíå source() ‰æùËµñÂÖ≥Á≥ª



SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_ads.ads_quality_monitoring_dashboard' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_station_performance_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ads.ads_toll_revenue_report' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_metadata.meta_table_info' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_ads.ads_toll_revenue_report' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_toll_revenue_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_ads.ads_traffic_trend_analysis' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_traffic_flow_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_quality_metrics' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ods.ods_toll_transaction' AS source_table, 'main_dwd.dwd_toll_transaction_detail' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_transaction' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_station' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_transaction' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_vehicle_type_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_station' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_payment_method_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
    );
  
  
[0m02:42:10.288990 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:42:10.294122 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.294489 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:42:10.295503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:10.296739 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.297072 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:42:10.298218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:10.303809 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.304185 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m02:42:10.304905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:10.307281 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.307624 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:42:10.308218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:10.322905 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:42:10.323321 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.323631 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:42:10.325398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:10.387687 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.388144 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:42:10.389992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:10.392112 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:42:10.394082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557591aa360>]}
[0m02:42:10.394644 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_metadata.meta_data_lineage .............. [[32mOK[0m in 0.18s]
[0m02:42:10.395229 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:42:10.397039 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:10.397737 [debug] [MainThread]: On master: BEGIN
[0m02:42:10.398221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:42:10.399374 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:42:10.399861 [debug] [MainThread]: On master: COMMIT
[0m02:42:10.400408 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:10.400869 [debug] [MainThread]: On master: COMMIT
[0m02:42:10.401619 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:42:10.402111 [debug] [MainThread]: On master: Close
[0m02:42:10.402896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:10.403360 [debug] [MainThread]: Connection 'model.datacore.meta_data_lineage' was properly closed.
[0m02:42:10.403862 [info ] [MainThread]: 
[0m02:42:10.404409 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m02:42:10.405509 [debug] [MainThread]: Command end result
[0m02:42:10.458812 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:42:10.462456 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:42:10.469261 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:42:10.469668 [info ] [MainThread]: 
[0m02:42:10.470184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:42:10.470478 [info ] [MainThread]: 
[0m02:42:10.470836 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:42:10.472254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1747735, "process_in_blocks": "0", "process_kernel_time": 0.223084, "process_mem_max_rss": "155400", "process_out_blocks": "2816", "process_user_time": 2.200829}
[0m02:42:10.472814 [debug] [MainThread]: Command `dbt run` succeeded at 02:42:10.472696 after 1.18 seconds
[0m02:42:10.473312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755769de79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755769495160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7556f909f140>]}
[0m02:42:10.473715 [debug] [MainThread]: Flushing usage events
[0m02:42:11.642178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:42:16.535274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759624be6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596244a3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596265e5e20>]}


============================== 02:42:16.539916 | 3613b94d-9d28-4356-b3cf-7105bdc1e4c8 ==============================
[0m02:42:16.539916 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:42:16.540394 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'empty': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'debug': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select metadata'}
[0m02:42:16.745044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759613f3c770>]}
[0m02:42:16.804901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596245c91f0>]}
[0m02:42:16.806521 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:42:16.888841 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:42:17.020349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:42:17.020748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:42:17.082792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759623c10890>]}
[0m02:42:17.188360 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:42:17.190124 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:42:17.203870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759613f5eea0>]}
[0m02:42:17.204392 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 467 macros
[0m02:42:17.204715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759613bac530>]}
[0m02:42:17.206494 [info ] [MainThread]: 
[0m02:42:17.206820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:42:17.207086 [info ] [MainThread]: 
[0m02:42:17.207562 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:42:17.212463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:42:17.253208 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:42:17.253594 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:42:17.253863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:17.272912 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m02:42:17.274233 [debug] [ThreadPool]: On list_datacore: Close
[0m02:42:17.275114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m02:42:17.275507 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:42:17.281585 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:17.281910 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:42:17.282168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.283235 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.284331 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:17.284589 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:42:17.285000 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:17.285245 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:17.285496 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:42:17.285927 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:17.286602 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:42:17.286860 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:17.287099 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:42:17.287482 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:17.287735 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:42:17.290084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_metadata)
[0m02:42:17.295288 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:42:17.295596 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:42:17.295844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.296537 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.296793 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:42:17.297048 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.309135 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:42:17.310439 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:42:17.311455 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:42:17.311719 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:42:17.312254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main)
[0m02:42:17.315136 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:42:17.315433 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:42:17.315678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.316257 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.316517 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:42:17.316771 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.320741 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:42:17.321853 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:42:17.322671 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:42:17.322930 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:42:17.323453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ads)
[0m02:42:17.326356 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:42:17.326673 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:42:17.326920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.327656 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.327908 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:42:17.328163 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.333260 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:42:17.334453 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:42:17.335220 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:42:17.335487 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:42:17.336013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_ods)
[0m02:42:17.338481 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:42:17.338776 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:42:17.339029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.339607 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.339859 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:42:17.340115 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.343431 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:42:17.344577 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:42:17.345361 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:42:17.345614 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:42:17.346135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_staging)
[0m02:42:17.348351 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:42:17.348635 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:42:17.348877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.349525 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.349789 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:42:17.350044 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.355426 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:42:17.356616 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:42:17.357391 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:42:17.357651 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:42:17.358176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_dws)
[0m02:42:17.360848 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:42:17.361131 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:42:17.361383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.362019 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.362269 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:42:17.362529 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.366892 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:42:17.368044 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:42:17.368820 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:42:17.369075 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:42:17.369735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_dwd)
[0m02:42:17.372193 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:42:17.372483 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:42:17.372726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.373369 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.373618 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:42:17.373869 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.377203 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:42:17.378333 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:42:17.379122 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:42:17.379381 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:42:17.380635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595fbe12870>]}
[0m02:42:17.381488 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:17.381994 [debug] [MainThread]: On master: BEGIN
[0m02:42:17.382486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:17.383489 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:42:17.383977 [debug] [MainThread]: On master: COMMIT
[0m02:42:17.384475 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:17.384943 [debug] [MainThread]: On master: COMMIT
[0m02:42:17.385680 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:42:17.386170 [debug] [MainThread]: On master: Close
[0m02:42:17.389412 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m02:42:17.389999 [info ] [Thread-1 (]: 1 of 5 START sql table model main_metadata.meta_data_dictionary ................ [RUN]
[0m02:42:17.390474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now model.datacore.meta_data_dictionary)
[0m02:42:17.390831 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m02:42:17.399311 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m02:42:17.399971 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m02:42:17.432847 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m02:42:17.433532 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.433882 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m02:42:17.434225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:17.435153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.435504 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.435916 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m02:42:17.439856 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:42:17.445592 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.445990 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:42:17.447032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.448234 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.448602 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:42:17.449741 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.456017 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.456455 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary" rename to "meta_data_dictionary__dbt_backup"
[0m02:42:17.457501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.460118 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.460491 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m02:42:17.461208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.476040 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:42:17.476459 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.476802 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:42:17.478600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.485294 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.485731 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m02:42:17.487299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.489596 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m02:42:17.491434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595fbaaf4d0>]}
[0m02:42:17.492033 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main_metadata.meta_data_dictionary ........... [[32mOK[0m in 0.10s]
[0m02:42:17.492600 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m02:42:17.492997 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:42:17.493500 [info ] [Thread-1 (]: 2 of 5 START sql table model main_metadata.meta_data_lineage ................... [RUN]
[0m02:42:17.493906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.meta_data_lineage)
[0m02:42:17.494251 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:42:17.576172 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:42:17.576860 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:42:17.579411 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:42:17.579933 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.580262 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:42:17.580590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:17.581398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.581734 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.582217 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª
-- Ëá™Âä®ËØÜÂà´ ref() Âíå source() ‰æùËµñÂÖ≥Á≥ª



SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_ads.ads_quality_monitoring_dashboard' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_station_performance_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ads.ads_toll_revenue_report' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_metadata.meta_table_info' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_ads.ads_toll_revenue_report' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_toll_revenue_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_ads.ads_traffic_trend_analysis' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_traffic_flow_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_quality_metrics' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ods.ods_toll_transaction' AS source_table, 'main_dwd.dwd_toll_transaction_detail' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_transaction' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_station' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_transaction' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_vehicle_type_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_station' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_payment_method_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
    );
  
  
[0m02:42:17.585939 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:42:17.586976 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.587343 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:42:17.588697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.589842 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.590195 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:42:17.591150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.594053 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.594437 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m02:42:17.595123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.597608 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.597969 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:42:17.598624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.599853 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:42:17.600215 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.600569 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:42:17.602086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.604269 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.604631 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:42:17.605997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.607322 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:42:17.608488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595fbee4590>]}
[0m02:42:17.609059 [info ] [Thread-1 (]: 2 of 5 OK created sql table model main_metadata.meta_data_lineage .............. [[32mOK[0m in 0.11s]
[0m02:42:17.609618 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:42:17.610007 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m02:42:17.610520 [info ] [Thread-1 (]: 3 of 5 START sql table model main_metadata.meta_data_quality_metrics ........... [RUN]
[0m02:42:17.610919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_data_quality_metrics)
[0m02:42:17.611270 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_quality_metrics
[0m02:42:17.614629 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_quality_metrics"
[0m02:42:17.615220 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_quality_metrics
[0m02:42:17.617871 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_quality_metrics"
[0m02:42:17.618449 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.618794 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: BEGIN
[0m02:42:17.619123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:17.619924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.620261 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.620681 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø



SELECT 
    transaction_date AS metric_date,
    'dwd_toll_transaction_detail' AS table_name,
    -- ÂÆåÊï¥ÊÄßÊåáÊ†á
    COUNT(*) AS total_records,
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_transaction_id,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_station_id,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) AS complete_vehicle_plate,
    -- ÂÆåÊï¥ÊÄßÁéá
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS transaction_id_completeness_rate,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS station_id_completeness_rate,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS vehicle_plate_completeness_rate,
    -- ÂáÜÁ°ÆÊÄßÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS accuracy_rate,
    -- ‰∏ÄËá¥ÊÄßÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS consistent_records,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS consistency_rate,
    -- ÂèäÊó∂ÊÄßÊåáÊ†á
    MAX(etl_time) AS last_etl_time,
    CURRENT_TIMESTAMP - MAX(etl_time) AS etl_delay,
    -- ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ
    (
        (SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2
    ) AS overall_quality_score,
    CURRENT_TIMESTAMP AS metric_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:42:17.633813 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m02:42:17.635041 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.635414 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:42:17.636453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.637583 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.637938 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:42:17.638913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.641851 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.642329 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics" rename to "meta_data_quality_metrics__dbt_backup"
[0m02:42:17.643031 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.646869 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.647260 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp" rename to "meta_data_quality_metrics"
[0m02:42:17.647985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.649236 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:42:17.649607 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.649948 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:42:17.651536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.653665 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.654026 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

      drop table if exists "datacore"."main_metadata"."meta_data_quality_metrics__dbt_backup" cascade
    
[0m02:42:17.655478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.656694 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: Close
[0m02:42:17.657395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759613aaac30>]}
[0m02:42:17.657955 [info ] [Thread-1 (]: 3 of 5 OK created sql table model main_metadata.meta_data_quality_metrics ...... [[32mOK[0m in 0.05s]
[0m02:42:17.658509 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m02:42:17.658889 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:42:17.659366 [info ] [Thread-1 (]: 4 of 5 START sql table model main_metadata.meta_table_info ..................... [RUN]
[0m02:42:17.659755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_quality_metrics, now model.datacore.meta_table_info)
[0m02:42:17.660101 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:42:17.671350 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:42:17.672008 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:42:17.674547 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:42:17.675078 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.675412 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:42:17.675723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:17.676527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.676867 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.677402 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m02:42:17.682314 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:42:17.683641 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.684011 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:42:17.685021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.686182 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.686550 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:42:17.687935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.690872 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.691253 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m02:42:17.692114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.694626 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.694994 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:42:17.695661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.696881 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:42:17.697235 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.697580 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:42:17.699087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.701123 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.701490 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:42:17.702828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.704043 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:42:17.704688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595fbf763f0>]}
[0m02:42:17.705246 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main_metadata.meta_table_info ................ [[32mOK[0m in 0.04s]
[0m02:42:17.705801 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:42:17.706688 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m02:42:17.707210 [info ] [Thread-1 (]: 5 of 5 START sql table model main_metadata.meta_data_asset_catalog ............. [RUN]
[0m02:42:17.707623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.meta_data_asset_catalog)
[0m02:42:17.707967 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_asset_catalog
[0m02:42:17.712120 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_asset_catalog"
[0m02:42:17.712748 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_asset_catalog
[0m02:42:17.715480 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_asset_catalog"
[0m02:42:17.716052 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.716410 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: BEGIN
[0m02:42:17.716744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:17.717556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.717895 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.718312 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï
-- ÂäüËÉΩÔºöÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞



WITH table_stats AS (
    SELECT 
        'dwd.dwd_toll_transaction_detail' AS table_name,
        COUNT(*) AS record_count,
        MAX(etl_time) AS last_update_time
    FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_toll_revenue_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_toll_revenue_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_traffic_flow_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_traffic_flow_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'ads.ads_toll_revenue_report',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_ads"."ads_toll_revenue_report"
    GROUP BY 1
)

SELECT 
    ti.schema_name,
    ti.table_name,
    ti.table_description,
    ti.business_domain,
    ti.data_layer,
    ti.owner,
    COALESCE(ts.record_count, 0) AS record_count,
    COALESCE(ts.last_update_time, CURRENT_TIMESTAMP) AS last_update_time,
    -- ËµÑ‰∫ßÁ≠âÁ∫ßËØÑ‰º∞
    CASE 
        WHEN ti.data_layer IN ('dwd', 'dws') THEN 'Ê†∏ÂøÉËµÑ‰∫ß'
        WHEN ti.data_layer = 'ads' THEN 'Â∫îÁî®ËµÑ‰∫ß'
        ELSE 'Âü∫Á°ÄËµÑ‰∫ß'
    END AS asset_level,
    -- ‰ΩøÁî®È¢ëÁéáËØÑ‰º∞ÔºàÂü∫‰∫éÊõ¥Êñ∞È¢ëÁéáÔºâ
    CASE 
        WHEN ti.update_frequency = 'ÂÆûÊó∂' THEN 'È´òÈ¢ë'
        WHEN ti.update_frequency = 'Êó•' THEN '‰∏≠È¢ë'
        ELSE '‰ΩéÈ¢ë'
    END AS usage_frequency,
    -- Êï∞ÊçÆÊñ∞È≤úÂ∫¶
    CASE 
        WHEN ts.last_update_time IS NULL THEN 'Êú™Áü•'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 1 DAY THEN 'Êñ∞È≤ú'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 7 DAY THEN 'ËæÉÊñ∞'
        ELSE 'ÈôàÊóß'
    END AS data_freshness,
    CURRENT_TIMESTAMP AS catalog_time
FROM "datacore"."main_metadata"."meta_table_info" ti
LEFT JOIN table_stats ts ON CONCAT(ti.schema_name, '.', ti.table_name) = ts.table_name
    );
  
  
[0m02:42:17.727572 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m02:42:17.728990 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.729372 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:42:17.730742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.731902 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.732262 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:42:17.733292 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.736175 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.736568 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog" rename to "meta_data_asset_catalog__dbt_backup"
[0m02:42:17.737264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.741363 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.741777 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp" rename to "meta_data_asset_catalog"
[0m02:42:17.742533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.743794 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:42:17.744158 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.744508 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:42:17.746163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.748263 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.748637 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

      drop table if exists "datacore"."main_metadata"."meta_data_asset_catalog__dbt_backup" cascade
    
[0m02:42:17.750057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.751271 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: Close
[0m02:42:17.753532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595fbeb5c10>]}
[0m02:42:17.754113 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main_metadata.meta_data_asset_catalog ........ [[32mOK[0m in 0.05s]
[0m02:42:17.754676 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m02:42:17.756107 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:17.756740 [debug] [MainThread]: On master: BEGIN
[0m02:42:17.757169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:42:17.758248 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:42:17.758819 [debug] [MainThread]: On master: COMMIT
[0m02:42:17.759382 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:17.759906 [debug] [MainThread]: On master: COMMIT
[0m02:42:17.760783 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:42:17.761347 [debug] [MainThread]: On master: Close
[0m02:42:17.762150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:17.762705 [debug] [MainThread]: Connection 'model.datacore.meta_data_asset_catalog' was properly closed.
[0m02:42:17.763392 [info ] [MainThread]: 
[0m02:42:17.764040 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m02:42:17.766479 [debug] [MainThread]: Command end result
[0m02:42:17.820508 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:42:17.823142 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:42:17.829575 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:42:17.829919 [info ] [MainThread]: 
[0m02:42:17.830314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:42:17.830622 [info ] [MainThread]: 
[0m02:42:17.830977 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m02:42:17.832073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3488854, "process_in_blocks": "0", "process_kernel_time": 0.269089, "process_mem_max_rss": "168852", "process_out_blocks": "3144", "process_user_time": 2.375617}
[0m02:42:17.832525 [debug] [MainThread]: Command `dbt run` succeeded at 02:42:17.832435 after 1.35 seconds
[0m02:42:17.832926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759624a496d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759624a4a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596240ef230>]}
[0m02:42:17.833280 [debug] [MainThread]: Flushing usage events
[0m02:42:19.219677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:43:01.359634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0972013da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a097290aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0971d4a510>]}


============================== 02:43:01.363689 | eb7b9c6f-1899-46ba-be4a-478d6eb130d7 ==============================
[0m02:43:01.363689 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:43:01.364167 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'fail_fast': 'False', 'empty': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'invocation_command': 'dbt run --select metadata', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None'}
[0m02:43:01.563764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0974262b10>]}
[0m02:43:01.622357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0971a291c0>]}
[0m02:43:01.623898 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:43:01.705209 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:43:01.837251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:43:01.837860 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/README.md
[0m02:43:01.942780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0961d3dd60>]}
[0m02:43:02.047629 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:43:02.049385 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:43:02.062422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0961af7c50>]}
[0m02:43:02.062912 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 467 macros
[0m02:43:02.063230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0961d3c5c0>]}
[0m02:43:02.064944 [info ] [MainThread]: 
[0m02:43:02.065262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:43:02.065534 [info ] [MainThread]: 
[0m02:43:02.065995 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:43:02.071130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:43:02.115488 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:43:02.115883 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:43:02.116158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:02.136650 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m02:43:02.138005 [debug] [ThreadPool]: On list_datacore: Close
[0m02:43:02.138701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m02:43:02.139097 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:43:02.145322 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:43:02.145638 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:43:02.145904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.147158 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.148286 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:43:02.148565 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:43:02.149126 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:43:02.149389 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:43:02.149642 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:43:02.150180 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:43:02.150881 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:43:02.151152 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:43:02.151408 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:43:02.151843 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:43:02.152107 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:43:02.154190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_dwd)
[0m02:43:02.159281 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:43:02.159595 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:43:02.159850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.160652 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.160910 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:43:02.161169 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.173577 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:43:02.174837 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:43:02.175849 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:43:02.176119 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:43:02.176683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_ods)
[0m02:43:02.178636 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:43:02.178922 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:43:02.179173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.179921 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.180176 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:43:02.180443 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.184032 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:43:02.185195 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:43:02.185992 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:43:02.186248 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:43:02.186786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main)
[0m02:43:02.188915 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:43:02.189202 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:43:02.189459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.190204 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.190462 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:43:02.190717 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.194189 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:43:02.195245 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:43:02.196035 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:43:02.196293 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:43:02.196821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ads)
[0m02:43:02.198399 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:43:02.198665 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:43:02.198912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.199568 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.199820 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:43:02.200078 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.205318 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:43:02.206486 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:43:02.207270 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:43:02.207532 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:43:02.208064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_staging)
[0m02:43:02.210435 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:43:02.210736 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:43:02.210982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.211655 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.211910 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:43:02.212170 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.217255 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:43:02.218464 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:43:02.219238 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:43:02.219501 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:43:02.220064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_metadata)
[0m02:43:02.222763 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:43:02.223049 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:43:02.223296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.223890 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.224144 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:43:02.224415 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.228053 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:43:02.229250 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:43:02.230047 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:43:02.230312 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:43:02.230981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dws)
[0m02:43:02.233990 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:43:02.234275 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:43:02.234531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.235180 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.235441 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:43:02.235699 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.239775 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:43:02.240940 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:43:02.241727 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:43:02.241980 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:43:02.243787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0960155070>]}
[0m02:43:02.244619 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:02.245136 [debug] [MainThread]: On master: BEGIN
[0m02:43:02.245632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:43:02.246616 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:43:02.247111 [debug] [MainThread]: On master: COMMIT
[0m02:43:02.247620 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:02.248093 [debug] [MainThread]: On master: COMMIT
[0m02:43:02.248868 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:43:02.249387 [debug] [MainThread]: On master: Close
[0m02:43:02.252747 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m02:43:02.253721 [info ] [Thread-1 (]: 1 of 5 START sql table model main_metadata.meta_data_dictionary ................ [RUN]
[0m02:43:02.254553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now model.datacore.meta_data_dictionary)
[0m02:43:02.255207 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m02:43:02.265790 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m02:43:02.266418 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m02:43:02.354211 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m02:43:02.354899 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.355233 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m02:43:02.355548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:02.356441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.356754 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.357124 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m02:43:02.362131 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m02:43:02.367534 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.367893 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:43:02.369030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.370139 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.370472 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:43:02.371522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.377202 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.377604 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary" rename to "meta_data_dictionary__dbt_backup"
[0m02:43:02.378481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.380941 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.381274 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m02:43:02.381935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.395920 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:43:02.396380 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.396703 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:43:02.398699 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:43:02.403930 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.404353 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m02:43:02.405983 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.408133 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m02:43:02.410066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0974261af0>]}
[0m02:43:02.410620 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main_metadata.meta_data_dictionary ........... [[32mOK[0m in 0.15s]
[0m02:43:02.411130 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m02:43:02.411492 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:43:02.411959 [info ] [Thread-1 (]: 2 of 5 START sql table model main_metadata.meta_data_lineage ................... [RUN]
[0m02:43:02.412343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.meta_data_lineage)
[0m02:43:02.412661 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:43:02.430339 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:43:02.430972 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:43:02.433524 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:43:02.434028 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.434350 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:43:02.434656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:02.435516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.435820 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.436253 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª
-- Ëá™Âä®ËØÜÂà´ ref() Âíå source() ‰æùËµñÂÖ≥Á≥ª



SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_ads.ads_quality_monitoring_dashboard' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_station_performance_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ads.ads_toll_revenue_report' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_metadata.meta_table_info' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_ads.ads_toll_revenue_report' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_toll_revenue_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_ads.ads_traffic_trend_analysis' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_traffic_flow_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_quality_metrics' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ods.ods_toll_transaction' AS source_table, 'main_dwd.dwd_toll_transaction_detail' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_transaction' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_station' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_transaction' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_vehicle_type_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_station' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_payment_method_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
    );
  
  
[0m02:43:02.440500 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:43:02.441549 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.441873 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:43:02.443215 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.444405 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.444740 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:43:02.445935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.448715 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.449063 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m02:43:02.449832 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.453511 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.453877 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:43:02.454670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.455866 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:43:02.456199 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.456518 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:43:02.457996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.460086 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.460440 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:43:02.461936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.463127 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:43:02.463764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0905ef1400>]}
[0m02:43:02.464288 [info ] [Thread-1 (]: 2 of 5 OK created sql table model main_metadata.meta_data_lineage .............. [[32mOK[0m in 0.05s]
[0m02:43:02.464793 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:43:02.465146 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m02:43:02.465630 [info ] [Thread-1 (]: 3 of 5 START sql table model main_metadata.meta_data_quality_metrics ........... [RUN]
[0m02:43:02.465992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_data_quality_metrics)
[0m02:43:02.466314 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_quality_metrics
[0m02:43:02.469348 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_quality_metrics"
[0m02:43:02.469863 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_quality_metrics
[0m02:43:02.472450 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_quality_metrics"
[0m02:43:02.472996 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.473320 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: BEGIN
[0m02:43:02.473630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:02.474482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.474790 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.475162 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø



SELECT 
    transaction_date AS metric_date,
    'dwd_toll_transaction_detail' AS table_name,
    -- ÂÆåÊï¥ÊÄßÊåáÊ†á
    COUNT(*) AS total_records,
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_transaction_id,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_station_id,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) AS complete_vehicle_plate,
    -- ÂÆåÊï¥ÊÄßÁéá
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS transaction_id_completeness_rate,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS station_id_completeness_rate,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS vehicle_plate_completeness_rate,
    -- ÂáÜÁ°ÆÊÄßÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS accuracy_rate,
    -- ‰∏ÄËá¥ÊÄßÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS consistent_records,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS consistency_rate,
    -- ÂèäÊó∂ÊÄßÊåáÊ†á
    MAX(etl_time) AS last_etl_time,
    CURRENT_TIMESTAMP - MAX(etl_time) AS etl_delay,
    -- ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ
    (
        (SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2
    ) AS overall_quality_score,
    CURRENT_TIMESTAMP AS metric_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:43:02.494137 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m02:43:02.495371 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.495730 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:43:02.496903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.498054 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.498414 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:43:02.499475 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.502387 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.502757 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics" rename to "meta_data_quality_metrics__dbt_backup"
[0m02:43:02.503509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.505974 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.506344 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp" rename to "meta_data_quality_metrics"
[0m02:43:02.506997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.508202 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:43:02.508562 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.508895 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:43:02.510456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.512546 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.512907 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

      drop table if exists "datacore"."main_metadata"."meta_data_quality_metrics__dbt_backup" cascade
    
[0m02:43:02.514371 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.515583 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: Close
[0m02:43:02.516631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a09619d7890>]}
[0m02:43:02.517212 [info ] [Thread-1 (]: 3 of 5 OK created sql table model main_metadata.meta_data_quality_metrics ...... [[32mOK[0m in 0.05s]
[0m02:43:02.517760 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m02:43:02.518142 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:43:02.518622 [info ] [Thread-1 (]: 4 of 5 START sql table model main_metadata.meta_table_info ..................... [RUN]
[0m02:43:02.519018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_quality_metrics, now model.datacore.meta_table_info)
[0m02:43:02.519371 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:43:02.531661 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:43:02.532338 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:43:02.535179 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:43:02.535724 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.536073 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:43:02.536405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:02.537299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.537642 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.538155 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m02:43:02.543254 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m02:43:02.544353 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.544707 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:43:02.545715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.546870 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.547221 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:43:02.548199 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.551095 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.551474 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m02:43:02.552195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.556454 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.556850 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:43:02.557624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.558842 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:43:02.559191 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.559529 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:43:02.561324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.563366 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.563719 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:43:02.565137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.566356 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:43:02.567064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0905ae6f00>]}
[0m02:43:02.567642 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main_metadata.meta_table_info ................ [[32mOK[0m in 0.05s]
[0m02:43:02.568181 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:43:02.569116 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m02:43:02.569568 [info ] [Thread-1 (]: 5 of 5 START sql table model main_metadata.meta_data_asset_catalog ............. [RUN]
[0m02:43:02.569981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.meta_data_asset_catalog)
[0m02:43:02.570350 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_asset_catalog
[0m02:43:02.574759 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_asset_catalog"
[0m02:43:02.575363 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_asset_catalog
[0m02:43:02.578115 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_asset_catalog"
[0m02:43:02.578667 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.579017 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: BEGIN
[0m02:43:02.579376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:02.580284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.580631 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.581041 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï
-- ÂäüËÉΩÔºöÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞



WITH table_stats AS (
    SELECT 
        'dwd.dwd_toll_transaction_detail' AS table_name,
        COUNT(*) AS record_count,
        MAX(etl_time) AS last_update_time
    FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_toll_revenue_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_toll_revenue_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_traffic_flow_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_traffic_flow_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'ads.ads_toll_revenue_report',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_ads"."ads_toll_revenue_report"
    GROUP BY 1
)

SELECT 
    ti.schema_name,
    ti.table_name,
    ti.table_description,
    ti.business_domain,
    ti.data_layer,
    ti.owner,
    COALESCE(ts.record_count, 0) AS record_count,
    COALESCE(ts.last_update_time, CURRENT_TIMESTAMP) AS last_update_time,
    -- ËµÑ‰∫ßÁ≠âÁ∫ßËØÑ‰º∞
    CASE 
        WHEN ti.data_layer IN ('dwd', 'dws') THEN 'Ê†∏ÂøÉËµÑ‰∫ß'
        WHEN ti.data_layer = 'ads' THEN 'Â∫îÁî®ËµÑ‰∫ß'
        ELSE 'Âü∫Á°ÄËµÑ‰∫ß'
    END AS asset_level,
    -- ‰ΩøÁî®È¢ëÁéáËØÑ‰º∞ÔºàÂü∫‰∫éÊõ¥Êñ∞È¢ëÁéáÔºâ
    CASE 
        WHEN ti.update_frequency = 'ÂÆûÊó∂' THEN 'È´òÈ¢ë'
        WHEN ti.update_frequency = 'Êó•' THEN '‰∏≠È¢ë'
        ELSE '‰ΩéÈ¢ë'
    END AS usage_frequency,
    -- Êï∞ÊçÆÊñ∞È≤úÂ∫¶
    CASE 
        WHEN ts.last_update_time IS NULL THEN 'Êú™Áü•'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 1 DAY THEN 'Êñ∞È≤ú'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 7 DAY THEN 'ËæÉÊñ∞'
        ELSE 'ÈôàÊóß'
    END AS data_freshness,
    CURRENT_TIMESTAMP AS catalog_time
FROM "datacore"."main_metadata"."meta_table_info" ti
LEFT JOIN table_stats ts ON CONCAT(ti.schema_name, '.', ti.table_name) = ts.table_name
    );
  
  
[0m02:43:02.591639 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m02:43:02.593038 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.593425 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:43:02.594549 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.595750 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.596106 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:43:02.597098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.600122 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.600514 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog" rename to "meta_data_asset_catalog__dbt_backup"
[0m02:43:02.601185 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.603715 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.604085 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp" rename to "meta_data_asset_catalog"
[0m02:43:02.604729 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.605963 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:43:02.606333 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.606673 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:43:02.608627 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.611102 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.611461 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

      drop table if exists "datacore"."main_metadata"."meta_data_asset_catalog__dbt_backup" cascade
    
[0m02:43:02.613039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.614258 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: Close
[0m02:43:02.615797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0905ac6480>]}
[0m02:43:02.616380 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main_metadata.meta_data_asset_catalog ........ [[32mOK[0m in 0.05s]
[0m02:43:02.616881 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m02:43:02.618430 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:02.619079 [debug] [MainThread]: On master: BEGIN
[0m02:43:02.619620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:43:02.620653 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:43:02.621188 [debug] [MainThread]: On master: COMMIT
[0m02:43:02.621730 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:02.622242 [debug] [MainThread]: On master: COMMIT
[0m02:43:02.623089 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:43:02.623640 [debug] [MainThread]: On master: Close
[0m02:43:02.625151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:02.625675 [debug] [MainThread]: Connection 'model.datacore.meta_data_asset_catalog' was properly closed.
[0m02:43:02.626323 [info ] [MainThread]: 
[0m02:43:02.626928 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m02:43:02.629176 [debug] [MainThread]: Command end result
[0m02:43:02.676619 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:43:02.678589 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:43:02.684072 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:43:02.684390 [info ] [MainThread]: 
[0m02:43:02.684734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:43:02.685009 [info ] [MainThread]: 
[0m02:43:02.685319 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m02:43:02.686143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3833032, "process_in_blocks": "0", "process_kernel_time": 0.283375, "process_mem_max_rss": "169296", "process_out_blocks": "4376", "process_user_time": 2.504481}
[0m02:43:02.686550 [debug] [MainThread]: Command `dbt run` succeeded at 02:43:02.686469 after 1.38 seconds
[0m02:43:02.686879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a09762db440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0971d4b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0971d4a510>]}
[0m02:43:02.687207 [debug] [MainThread]: Flushing usage events
[0m02:43:04.112206 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:43:57.178218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bcf6f63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bcec6fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bd1105190>]}


============================== 02:43:57.182999 | f6fc059a-8321-4e85-b7f6-cf7ee662979a ==============================
[0m02:43:57.182999 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:43:57.183518 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'debug': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'invocation_command': 'dbt test --select test_toll_transaction_completeness', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/chun/Develop/datacore'}
[0m02:43:57.392849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bd0ffe720>]}
[0m02:43:57.451156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bceb39c70>]}
[0m02:43:57.452723 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:43:57.534592 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:43:57.666119 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m02:43:57.666643 [debug] [MainThread]: Partial parsing: deleted file: datacore://macros/metadata/get_all_models.sql
[0m02:43:57.666921 [debug] [MainThread]: Partial parsing: deleted file: datacore://macros/metadata/get_model_lineage.sql
[0m02:43:57.774193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bbe77f590>]}
[0m02:43:57.878747 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:43:57.880512 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:43:57.902535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bbed52090>]}
[0m02:43:57.903073 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 465 macros
[0m02:43:57.903391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bbc1a7260>]}
[0m02:43:57.905003 [info ] [MainThread]: 
[0m02:43:57.905325 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:43:57.905588 [info ] [MainThread]: 
[0m02:43:57.906048 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:43:57.911871 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore_main_dws'
[0m02:43:57.951621 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:43:57.952013 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:43:57.952296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:57.970512 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:43:57.970950 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:43:57.971250 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:57.983546 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:43:57.984935 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:43:57.986004 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:43:57.986315 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:43:57.986912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main)
[0m02:43:57.989662 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:43:57.989976 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:43:57.990255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:57.990930 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:57.991210 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:43:57.991515 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:57.995579 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:43:57.996750 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:43:57.997610 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:43:57.997893 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:43:57.998481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_metadata)
[0m02:43:58.000176 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:43:58.000484 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:43:58.000757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:58.001346 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:58.001626 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:43:58.001924 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:58.005813 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:43:58.007125 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:43:58.007979 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:43:58.008261 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:43:58.008857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_staging)
[0m02:43:58.011513 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:43:58.011827 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:43:58.012102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:58.012762 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:58.013041 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:43:58.013336 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:58.017132 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:43:58.018295 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:43:58.019116 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:43:58.019408 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:43:58.019992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_dwd)
[0m02:43:58.022475 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:43:58.022771 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:43:58.023028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:58.023589 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:58.023849 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:43:58.024116 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:58.027820 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:43:58.029030 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:43:58.029867 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:43:58.030148 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:43:58.030723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_ods)
[0m02:43:58.033755 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:43:58.034655 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:43:58.034964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:58.035661 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:58.035947 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:43:58.036240 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:58.041441 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:43:58.042623 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:43:58.043394 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:43:58.043662 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:43:58.044197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_ads)
[0m02:43:58.104001 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:43:58.104413 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:43:58.104692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:58.105392 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:58.105653 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:43:58.105921 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:58.111002 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:43:58.112190 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:43:58.113016 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:43:58.113298 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:43:58.115451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bd10c57f0>]}
[0m02:43:58.116293 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:58.116801 [debug] [MainThread]: On master: BEGIN
[0m02:43:58.117269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:43:58.118403 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:43:58.118894 [debug] [MainThread]: On master: COMMIT
[0m02:43:58.119393 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:58.119866 [debug] [MainThread]: On master: COMMIT
[0m02:43:58.120637 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:43:58.121125 [debug] [MainThread]: On master: Close
[0m02:43:58.124475 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_completeness
[0m02:43:58.125202 [info ] [Thread-1 (]: 1 of 1 START test test_toll_transaction_completeness ........................... [RUN]
[0m02:43:58.125940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now test.datacore.test_toll_transaction_completeness)
[0m02:43:58.126556 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_completeness
[0m02:43:58.139047 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_completeness"
[0m02:43:58.140085 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_completeness
[0m02:43:58.159255 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_completeness"
[0m02:43:58.159924 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:43:58.160268 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: BEGIN
[0m02:43:58.160603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:58.161559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:58.161886 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:43:58.162227 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_completeness"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂÆåÊï¥ÊÄß

SELECT 
    transaction_id,
    station_id,
    vehicle_plate,
    vehicle_type_code,
    payment_method_code
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    transaction_id IS NULL
    OR station_id IS NULL
    OR vehicle_plate IS NULL
    OR vehicle_plate = ''
    OR vehicle_type_code IS NULL
    OR payment_method_code IS NULL
  
  
      
    ) dbt_internal_test
[0m02:43:58.169424 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m02:43:58.173692 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: ROLLBACK
[0m02:43:58.174660 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_completeness'
[0m02:43:58.175003 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: Close
[0m02:43:58.175753 [info ] [Thread-1 (]: 1 of 1 PASS test_toll_transaction_completeness ................................. [[32mPASS[0m in 0.05s]
[0m02:43:58.176318 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_completeness
[0m02:43:58.177895 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:58.178514 [debug] [MainThread]: On master: BEGIN
[0m02:43:58.179014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:43:58.179986 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:43:58.180487 [debug] [MainThread]: On master: COMMIT
[0m02:43:58.180986 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:58.181483 [debug] [MainThread]: On master: COMMIT
[0m02:43:58.182247 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:43:58.182789 [debug] [MainThread]: On master: Close
[0m02:43:58.183465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:58.183885 [debug] [MainThread]: Connection 'test.datacore.test_toll_transaction_completeness' was properly closed.
[0m02:43:58.184283 [info ] [MainThread]: 
[0m02:43:58.184719 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m02:43:58.185600 [debug] [MainThread]: Command end result
[0m02:43:58.228726 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:43:58.230616 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:43:58.236515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:43:58.236811 [info ] [MainThread]: 
[0m02:43:58.237143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:43:58.237423 [info ] [MainThread]: 
[0m02:43:58.237723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:43:58.238523 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.1158736, "process_in_blocks": "0", "process_kernel_time": 0.238987, "process_mem_max_rss": "159108", "process_out_blocks": "3960", "process_user_time": 2.164832}
[0m02:43:58.238918 [debug] [MainThread]: Command `dbt test` succeeded at 02:43:58.238836 after 1.12 seconds
[0m02:43:58.239248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bceb97590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bd2db3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bbc1fa9f0>]}
[0m02:43:58.239574 [debug] [MainThread]: Flushing usage events
[0m02:43:59.353241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:44:57.117663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a7a0e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a88bfa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a725a6f0>]}


============================== 02:44:57.122173 | daff4917-0991-4893-a77a-1f1e6b93d494 ==============================
[0m02:44:57.122173 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:44:57.122665 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'profiles_dir': '/home/chun/Develop/datacore', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'empty': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m02:44:57.323898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a725b380>]}
[0m02:44:57.381794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396f02f00>]}
[0m02:44:57.383326 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:44:57.466360 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:44:57.600018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:44:57.600428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:44:57.663850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a6b2bef0>]}
[0m02:44:57.767271 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:44:57.769062 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:44:57.782508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396c5d640>]}
[0m02:44:57.783015 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 465 macros
[0m02:44:57.783335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396a9c7a0>]}
[0m02:44:57.785527 [info ] [MainThread]: 
[0m02:44:57.785852 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:57.786117 [info ] [MainThread]: 
[0m02:44:57.786588 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:44:57.792369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:44:57.833651 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.834032 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.834298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:57.853468 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m02:44:57.854794 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.856818 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.857165 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.857459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.858502 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.859519 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.861217 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.861548 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.861802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.862751 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.863733 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.865436 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.865721 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.866032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.867273 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.868248 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.869933 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.870210 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.870526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.871504 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.872484 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.875361 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.875738 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.875999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.877380 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.878399 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.879244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_ods)
[0m02:44:57.879644 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ods"
"
[0m02:44:57.885471 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:44:57.885781 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.886039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.887259 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.888477 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:44:57.888738 [debug] [ThreadPool]: On create_datacore_main_ods: BEGIN
[0m02:44:57.889225 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.889481 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:44:57.889727 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
    
        create schema if not exists "datacore"."main_ods"
    
[0m02:44:57.890167 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.890855 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:44:57.891117 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:44:57.891371 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:44:57.891782 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.892037 [debug] [ThreadPool]: On create_datacore_main_ods: Close
[0m02:44:57.892569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ods, now create_datacore_main_staging)
[0m02:44:57.892967 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m02:44:57.894553 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:44:57.894823 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.895074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.896002 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.897050 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:44:57.897320 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m02:44:57.897806 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.898052 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:44:57.898297 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m02:44:57.898875 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.899566 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:44:57.899825 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:44:57.900068 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:44:57.900464 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.900721 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m02:44:57.901252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now create_datacore_main_ads)
[0m02:44:57.901678 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ads"
"
[0m02:44:57.903179 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:44:57.903456 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.903706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.904818 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.905870 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:44:57.906131 [debug] [ThreadPool]: On create_datacore_main_ads: BEGIN
[0m02:44:57.906551 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.906799 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:44:57.907045 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
    
        create schema if not exists "datacore"."main_ads"
    
[0m02:44:57.907484 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.908152 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:44:57.908414 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:44:57.908659 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:44:57.909048 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.909315 [debug] [ThreadPool]: On create_datacore_main_ads: Close
[0m02:44:57.909826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ads, now create_datacore_main_metadata)
[0m02:44:57.910221 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:44:57.911705 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:44:57.911972 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.912220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.913206 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.914259 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:44:57.914526 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:44:57.914930 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.915177 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:44:57.915442 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:44:57.915863 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.916531 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:44:57.916783 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:44:57.917025 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:44:57.917442 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.917691 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:44:57.918189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now create_datacore_main_dws)
[0m02:44:57.918595 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dws"
"
[0m02:44:57.920099 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:44:57.920374 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.920622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.921772 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.922825 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:44:57.923082 [debug] [ThreadPool]: On create_datacore_main_dws: BEGIN
[0m02:44:57.923501 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.923742 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:44:57.923984 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
    
        create schema if not exists "datacore"."main_dws"
    
[0m02:44:57.924412 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.925072 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:44:57.925334 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:44:57.925574 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:44:57.926034 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.926286 [debug] [ThreadPool]: On create_datacore_main_dws: Close
[0m02:44:57.926799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dws, now create_datacore_main_dwd)
[0m02:44:57.927183 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dwd"
"
[0m02:44:57.928693 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:44:57.928959 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.929209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.930328 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.931514 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:44:57.931831 [debug] [ThreadPool]: On create_datacore_main_dwd: BEGIN
[0m02:44:57.932373 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.932663 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:44:57.932908 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
    
        create schema if not exists "datacore"."main_dwd"
    
[0m02:44:57.933471 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.934161 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:44:57.934429 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:44:57.934672 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:44:57.935093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.935394 [debug] [ThreadPool]: On create_datacore_main_dwd: Close
[0m02:44:57.938859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dwd, now list_datacore_main_ods)
[0m02:44:57.948671 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:44:57.949240 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:44:57.949748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.950846 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.951355 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:44:57.951862 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:57.976944 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m02:44:57.978452 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:44:57.979482 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:44:57.979752 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:44:57.980461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_staging)
[0m02:44:57.982750 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:44:57.983037 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:44:57.983291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.983974 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.984251 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:44:57.984550 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:57.991772 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m02:44:57.993178 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:44:57.994094 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:44:57.994383 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:44:57.995002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main)
[0m02:44:57.997600 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:44:57.997916 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:44:57.998189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.998928 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.999205 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:44:57.999500 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:58.003244 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:44:58.004491 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:44:58.005364 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:44:58.005647 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:44:58.006242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ads)
[0m02:44:58.009490 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:44:58.009823 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:44:58.010101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:58.010808 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:58.011079 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:44:58.011373 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:58.015145 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:44:58.016483 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:44:58.017337 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:44:58.017620 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:44:58.018215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_metadata)
[0m02:44:58.087135 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:44:58.087568 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:44:58.087838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:58.088583 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:58.088855 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:44:58.089129 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:58.092844 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:44:58.094154 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:44:58.095009 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:44:58.095286 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:44:58.096219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dws)
[0m02:44:58.099613 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:44:58.099925 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:44:58.100191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:58.100820 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:58.101088 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:44:58.101373 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:58.104937 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:44:58.106163 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:44:58.106999 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:44:58.107272 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:44:58.107843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_dwd)
[0m02:44:58.110612 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:44:58.110915 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:44:58.111182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:58.111779 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:58.112047 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:44:58.112334 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:58.117479 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:44:58.118739 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:44:58.119517 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:44:58.119770 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:44:58.120905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a6986c90>]}
[0m02:44:58.121765 [debug] [MainThread]: Using duckdb connection "master"
[0m02:44:58.122267 [debug] [MainThread]: On master: BEGIN
[0m02:44:58.122752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:58.123868 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:44:58.124367 [debug] [MainThread]: On master: COMMIT
[0m02:44:58.124844 [debug] [MainThread]: Using duckdb connection "master"
[0m02:44:58.125300 [debug] [MainThread]: On master: COMMIT
[0m02:44:58.126086 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:44:58.126596 [debug] [MainThread]: On master: Close
[0m02:44:58.130064 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:44:58.131024 [info ] [Thread-1 (]: 1 of 18 START sql table model main_metadata.meta_data_lineage .................. [RUN]
[0m02:44:58.131821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now model.datacore.meta_data_lineage)
[0m02:44:58.132500 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:44:58.163748 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:44:58.164429 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:44:58.193647 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:44:58.194320 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.194640 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:44:58.194937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.195709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.196013 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.196455 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª
-- Ëá™Âä®ËØÜÂà´ ref() Âíå source() ‰æùËµñÂÖ≥Á≥ª



SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_ads.ads_quality_monitoring_dashboard' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_station_performance_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ads.ads_toll_revenue_report' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_metadata.meta_table_info' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_ads.ads_toll_revenue_report' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_toll_revenue_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_ads.ads_traffic_trend_analysis' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_traffic_flow_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_quality_metrics' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ods.ods_toll_transaction' AS source_table, 'main_dwd.dwd_toll_transaction_detail' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_transaction' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_station' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_transaction' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_vehicle_type_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_station' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_payment_method_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
    );
  
  
[0m02:44:58.200123 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:44:58.205308 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.205663 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:44:58.206702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.207810 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.208137 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:44:58.209214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.215005 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.215386 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m02:44:58.216165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.218528 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.218853 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:44:58.219472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.232899 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:44:58.233277 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.233591 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:44:58.235256 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.241495 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.241874 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:44:58.243403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.245539 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:44:58.247297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a6aba840>]}
[0m02:44:58.247858 [info ] [Thread-1 (]: 1 of 18 OK created sql table model main_metadata.meta_data_lineage ............. [[32mOK[0m in 0.11s]
[0m02:44:58.248374 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:44:58.248724 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:44:58.249195 [info ] [Thread-1 (]: 2 of 18 START sql table model main_metadata.meta_table_info .................... [RUN]
[0m02:44:58.249573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_table_info)
[0m02:44:58.249881 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:44:58.260459 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:44:58.261094 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:44:58.263616 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:44:58.264147 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.264462 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:44:58.264753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.265508 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.265809 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.266268 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m02:44:58.271040 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:44:58.272186 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.272520 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:44:58.273417 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.274471 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.274787 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:44:58.275702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.278277 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.278618 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m02:44:58.279254 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.281461 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.281784 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:44:58.282380 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.283510 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:44:58.283835 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.284135 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:44:58.285598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.287456 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.287770 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:44:58.289084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.290212 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:44:58.290847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396cbf710>]}
[0m02:44:58.291371 [info ] [Thread-1 (]: 2 of 18 OK created sql table model main_metadata.meta_table_info ............... [[32mOK[0m in 0.04s]
[0m02:44:58.291868 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:44:58.292215 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m02:44:58.292694 [info ] [Thread-1 (]: 3 of 18 START sql view model main_staging.stg_payment_method_dict .............. [RUN]
[0m02:44:58.293052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.stg_payment_method_dict)
[0m02:44:58.293372 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m02:44:58.296094 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m02:44:58.296634 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m02:44:58.312745 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m02:44:58.313413 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.313730 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m02:44:58.314027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.314778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.315078 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.315393 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."payment_method_dict"
  );

[0m02:44:58.316200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.318712 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.319045 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict" rename to "stg_payment_method_dict__dbt_backup"
[0m02:44:58.319706 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.321896 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.322226 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" rename to "stg_payment_method_dict"
[0m02:44:58.322826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.323902 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:44:58.324236 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.324547 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:44:58.325820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.329113 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.329477 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

      drop view if exists "datacore"."main_staging"."stg_payment_method_dict__dbt_backup" cascade
    
[0m02:44:58.330813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.331957 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m02:44:58.332503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e334851c230>]}
[0m02:44:58.333015 [info ] [Thread-1 (]: 3 of 18 OK created sql view model main_staging.stg_payment_method_dict ......... [[32mOK[0m in 0.04s]
[0m02:44:58.333514 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m02:44:58.333856 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m02:44:58.334320 [info ] [Thread-1 (]: 4 of 18 START sql view model main_staging.stg_toll_station ..................... [RUN]
[0m02:44:58.334676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m02:44:58.334983 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m02:44:58.337727 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m02:44:58.338270 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m02:44:58.340652 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m02:44:58.341147 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.341468 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m02:44:58.341766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.342612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.342923 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.343239 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."toll_station"
  );

[0m02:44:58.344086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.346511 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.346846 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station" rename to "stg_toll_station__dbt_backup"
[0m02:44:58.347505 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.349833 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.350202 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station__dbt_tmp" rename to "stg_toll_station"
[0m02:44:58.350946 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.352087 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:44:58.352423 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.352725 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:44:58.354112 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.356025 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.356352 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

      drop view if exists "datacore"."main_staging"."stg_toll_station__dbt_backup" cascade
    
[0m02:44:58.357609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.358710 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m02:44:58.359464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3348503410>]}
[0m02:44:58.359978 [info ] [Thread-1 (]: 4 of 18 OK created sql view model main_staging.stg_toll_station ................ [[32mOK[0m in 0.02s]
[0m02:44:58.360475 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m02:44:58.360821 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m02:44:58.361294 [info ] [Thread-1 (]: 5 of 18 START sql view model main_staging.stg_toll_transaction ................. [RUN]
[0m02:44:58.361812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m02:44:58.362123 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m02:44:58.365283 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m02:44:58.365824 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m02:44:58.368247 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m02:44:58.368783 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.369098 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m02:44:58.369401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.370137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.370459 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.370852 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "datacore"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST(EXTRACT(EPOCH FROM (exit_time - entry_time)) AS INTEGER) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:44:58.372732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.375247 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.375587 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction" rename to "stg_toll_transaction__dbt_backup"
[0m02:44:58.376331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.378544 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.378867 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" rename to "stg_toll_transaction"
[0m02:44:58.379586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.380868 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:44:58.381223 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.381558 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:44:58.383290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.386986 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.387370 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

      drop view if exists "datacore"."main_staging"."stg_toll_transaction__dbt_backup" cascade
    
[0m02:44:58.388812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.390046 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m02:44:58.390652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3348551880>]}
[0m02:44:58.391226 [info ] [Thread-1 (]: 5 of 18 OK created sql view model main_staging.stg_toll_transaction ............ [[32mOK[0m in 0.03s]
[0m02:44:58.391773 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m02:44:58.392148 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m02:44:58.392648 [info ] [Thread-1 (]: 6 of 18 START sql view model main_staging.stg_vehicle_type_dict ................ [RUN]
[0m02:44:58.393029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m02:44:58.393391 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m02:44:58.396408 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.396974 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m02:44:58.399650 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.400190 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.400540 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m02:44:58.400869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.401726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.402061 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.402418 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."vehicle_type_dict"
  );

[0m02:44:58.403326 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.406088 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.406455 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict" rename to "stg_vehicle_type_dict__dbt_backup"
[0m02:44:58.407144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.409658 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.410021 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" rename to "stg_vehicle_type_dict"
[0m02:44:58.410711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.411871 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:44:58.412218 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.412550 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:44:58.414295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.416179 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.416509 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

      drop view if exists "datacore"."main_staging"."stg_vehicle_type_dict__dbt_backup" cascade
    
[0m02:44:58.418438 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:44:58.419667 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m02:44:58.420253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e334af403b0>]}
[0m02:44:58.420823 [info ] [Thread-1 (]: 6 of 18 OK created sql view model main_staging.stg_vehicle_type_dict ........... [[32mOK[0m in 0.03s]
[0m02:44:58.421371 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m02:44:58.421754 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_station
[0m02:44:58.422399 [info ] [Thread-1 (]: 7 of 18 START sql table model main_ods.ods_toll_station ........................ [RUN]
[0m02:44:58.422812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_vehicle_type_dict, now model.datacore.ods_toll_station)
[0m02:44:58.423148 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_station
[0m02:44:58.426221 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_station"
[0m02:44:58.426791 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_station
[0m02:44:58.429430 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_station"
[0m02:44:58.429965 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.430311 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: BEGIN
[0m02:44:58.430636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.431471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.431798 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.432141 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_station__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®



SELECT 
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    open_date,
    -- ‰∏öÂä°Â≠óÊÆµ
    CASE 
        WHEN station_type = '‰∏ªÁ∫øÊî∂Ë¥πÁ´ô' THEN 1
        ELSE 0
    END AS is_main_station,
    CURRENT_DATE - open_date AS days_since_open,
    etl_time
FROM "datacore"."main_staging"."stg_toll_station"
    );
  
  
[0m02:44:58.434397 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:44:58.435467 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.435812 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m02:44:58.436736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.437889 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.438239 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m02:44:58.439173 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.442016 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.442395 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station" rename to "ods_toll_station__dbt_backup"
[0m02:44:58.443097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.445549 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.445904 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station__dbt_tmp" rename to "ods_toll_station"
[0m02:44:58.446541 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.447769 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:44:58.448118 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.448461 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:44:58.449835 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.451873 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.452233 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

      drop table if exists "datacore"."main_ods"."ods_toll_station__dbt_backup" cascade
    
[0m02:44:58.453688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.454956 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: Close
[0m02:44:58.455610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33485027b0>]}
[0m02:44:58.456172 [info ] [Thread-1 (]: 7 of 18 OK created sql table model main_ods.ods_toll_station ................... [[32mOK[0m in 0.03s]
[0m02:44:58.456719 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_station
[0m02:44:58.457100 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m02:44:58.457594 [info ] [Thread-1 (]: 8 of 18 START sql table model main_metadata.meta_data_dictionary ............... [RUN]
[0m02:44:58.457987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_station, now model.datacore.meta_data_dictionary)
[0m02:44:58.458335 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m02:44:58.463490 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m02:44:58.464119 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m02:44:58.466801 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m02:44:58.467351 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.467694 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m02:44:58.468028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.468827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.469161 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.469567 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m02:44:58.473885 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:44:58.475002 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.475368 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:44:58.476331 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.477490 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.477846 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:44:58.478788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.481669 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.482031 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary" rename to "meta_data_dictionary__dbt_backup"
[0m02:44:58.482724 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.485155 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.485508 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m02:44:58.486138 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.487366 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:44:58.487736 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.488066 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:44:58.489543 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.491600 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.491952 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m02:44:58.493341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.494547 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m02:44:58.495410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a8727260>]}
[0m02:44:58.495966 [info ] [Thread-1 (]: 8 of 18 OK created sql table model main_metadata.meta_data_dictionary .......... [[32mOK[0m in 0.04s]
[0m02:44:58.496506 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m02:44:58.496891 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_transaction
[0m02:44:58.497376 [info ] [Thread-1 (]: 9 of 18 START sql table model main_ods.ods_toll_transaction .................... [RUN]
[0m02:44:58.497765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.ods_toll_transaction)
[0m02:44:58.498113 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_transaction
[0m02:44:58.502287 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_transaction"
[0m02:44:58.502905 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_transaction
[0m02:44:58.505614 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_transaction"
[0m02:44:58.506155 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.506508 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: BEGIN
[0m02:44:58.506841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.507664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.508001 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.508397 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_transaction__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®
-- ÂäüËÉΩÔºö‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ



SELECT 
    t.transaction_id,
    t.station_id,
    s.station_name,
    s.city,
    s.highway_code,
    s.station_type,
    t.lane_id,
    t.vehicle_plate,
    t.vehicle_type_code,
    vt.vehicle_type_name,
    vt.vehicle_type_desc,
    t.entry_station_id,
    es.station_name AS entry_station_name,
    t.entry_time,
    t.exit_time,
    t.travel_minutes,
    t.payment_method_code,
    pm.payment_method_name,
    pm.payment_method_desc,
    t.toll_amount,
    t.actual_amount,
    t.discount_amount,
    t.transaction_status,
    t.data_quality_flag,
    -- ‰∏öÂä°Â≠óÊÆµ
    DATE(t.exit_time) AS transaction_date,
    EXTRACT(HOUR FROM t.exit_time) AS transaction_hour,
    EXTRACT(DOW FROM t.exit_time) AS day_of_week,
    CASE 
        WHEN t.transaction_status = 'Ê≠£Â∏∏' THEN 1 
        ELSE 0 
    END AS is_normal_transaction,
    t.create_time,
    t.update_time,
    t.etl_time
FROM "datacore"."main_staging"."stg_toll_transaction" t
LEFT JOIN "datacore"."main_staging"."stg_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_toll_station" es ON t.entry_station_id = es.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
    );
  
  
[0m02:44:58.720297 [debug] [Thread-1 (]: SQL status: OK in 0.211 seconds
[0m02:44:58.721588 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.721923 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_transaction'
  
[0m02:44:58.723005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.724104 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.724600 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_transaction'
  
[0m02:44:58.725544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.728159 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.728506 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */
alter table "datacore"."main_ods"."ods_toll_transaction" rename to "ods_toll_transaction__dbt_backup"
[0m02:44:58.729319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.731594 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.731923 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */
alter table "datacore"."main_ods"."ods_toll_transaction__dbt_tmp" rename to "ods_toll_transaction"
[0m02:44:58.732578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.733723 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m02:44:58.734052 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.734364 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m02:44:59.007292 [debug] [Thread-1 (]: SQL status: OK in 0.272 seconds
[0m02:44:59.009618 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:59.009955 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

      drop table if exists "datacore"."main_ods"."ods_toll_transaction__dbt_backup" cascade
    
[0m02:44:59.011732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.012958 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: Close
[0m02:44:59.022446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3348502db0>]}
[0m02:44:59.023096 [info ] [Thread-1 (]: 9 of 18 OK created sql table model main_ods.ods_toll_transaction ............... [[32mOK[0m in 0.52s]
[0m02:44:59.023612 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_transaction
[0m02:44:59.024581 [debug] [Thread-1 (]: Began running node model.datacore.dwd_toll_transaction_detail
[0m02:44:59.024991 [info ] [Thread-1 (]: 10 of 18 START sql table model main_dwd.dwd_toll_transaction_detail ............ [RUN]
[0m02:44:59.025379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_transaction, now model.datacore.dwd_toll_transaction_detail)
[0m02:44:59.025698 [debug] [Thread-1 (]: Began compiling node model.datacore.dwd_toll_transaction_detail
[0m02:44:59.030508 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.031126 [debug] [Thread-1 (]: Began executing node model.datacore.dwd_toll_transaction_detail
[0m02:44:59.033648 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.034195 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.034536 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: BEGIN
[0m02:44:59.034850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.035664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.035974 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.036330 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

  
    
    

    create  table
      "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp"
  
    as (
      -- DWDÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆ
-- ÂäüËÉΩÔºö‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÔºå‰æø‰∫éÂêéÁª≠ÂàÜÊûê



SELECT 
    transaction_id,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    vehicle_type_name,
    vehicle_type_desc,
    entry_station_id,
    entry_station_name,
    entry_time,
    exit_time,
    travel_minutes,
    -- ËÆ°ÁÆóÈÄöË°åË∑ùÁ¶ªÔºà‰º∞ÁÆóÔºåÂü∫‰∫éÊó∂Èó¥Ôºâ
    CASE 
        WHEN travel_minutes > 0 THEN 
            ROUND(travel_minutes * 60 / 100.0, 2)  -- ÂÅáËÆæÂπ≥ÂùáÈÄüÂ∫¶100km/h
        ELSE 0
    END AS estimated_distance_km,
    payment_method_code,
    payment_method_name,
    payment_method_desc,
    toll_amount,
    actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    transaction_date,
    transaction_hour,
    day_of_week,
    is_normal_transaction,
    -- ‰∏öÂä°ÂàÜÁ±ª
    CASE 
        WHEN transaction_hour BETWEEN 6 AND 9 THEN 'Êó©È´òÂ≥∞'
        WHEN transaction_hour BETWEEN 17 AND 20 THEN 'ÊôöÈ´òÂ≥∞'
        WHEN transaction_hour BETWEEN 22 AND 6 THEN 'Â§úÈó¥'
        ELSE 'Âπ≥Â≥∞'
    END AS time_period,
    CASE 
        WHEN day_of_week IN (0, 6) THEN 'Âë®Êú´'  -- DOW: 0=Âë®Êó•, 6=Âë®ÂÖ≠
        ELSE 'Â∑•‰ΩúÊó•'
    END AS day_type,
    create_time,
    update_time,
    etl_time
FROM "datacore"."main_ods"."ods_toll_transaction"
    );
  
  
[0m02:44:59.255749 [debug] [Thread-1 (]: SQL status: OK in 0.219 seconds
[0m02:44:59.257520 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.257859 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dwd'
      AND table_name = 'dwd_toll_transaction_detail'
  
[0m02:44:59.259255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.260432 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.260767 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dwd'
      AND table_name = 'dwd_toll_transaction_detail'
  
[0m02:44:59.261762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.264817 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.265178 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */
alter table "datacore"."main_dwd"."dwd_toll_transaction_detail" rename to "dwd_toll_transaction_detail__dbt_backup"
[0m02:44:59.265939 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.268285 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.268627 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */
alter table "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp" rename to "dwd_toll_transaction_detail"
[0m02:44:59.269297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.270532 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m02:44:59.270866 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.271176 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m02:44:59.541055 [debug] [Thread-1 (]: SQL status: OK in 0.269 seconds
[0m02:44:59.543451 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.543791 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

      drop table if exists "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_backup" cascade
    
[0m02:44:59.545453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.546829 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: Close
[0m02:44:59.554954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e334afb61b0>]}
[0m02:44:59.555842 [info ] [Thread-1 (]: 10 of 18 OK created sql table model main_dwd.dwd_toll_transaction_detail ....... [[32mOK[0m in 0.53s]
[0m02:44:59.556425 [debug] [Thread-1 (]: Finished running node model.datacore.dwd_toll_transaction_detail
[0m02:44:59.557886 [debug] [Thread-1 (]: Began running node model.datacore.ads_quality_monitoring_dashboard
[0m02:44:59.558299 [info ] [Thread-1 (]: 11 of 18 START sql table model main_ads.ads_quality_monitoring_dashboard ....... [RUN]
[0m02:44:59.558732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dwd_toll_transaction_detail, now model.datacore.ads_quality_monitoring_dashboard)
[0m02:44:59.559087 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_quality_monitoring_dashboard
[0m02:44:59.562939 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.563579 [debug] [Thread-1 (]: Began executing node model.datacore.ads_quality_monitoring_dashboard
[0m02:44:59.566256 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.566842 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.567170 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: BEGIN
[0m02:44:59.567512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.568392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.568708 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.569090 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø
-- ÂäüËÉΩÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶



SELECT 
    transaction_date,
    -- ÊÄª‰ΩìË¥®ÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transactions,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal,
    -- Ë¥®ÈáèÁéá
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÂºÇÂ∏∏Á±ªÂûãÂàÜÂ∏É
    SUM(CASE WHEN transaction_status = 'ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS status_abnormal_count,
    SUM(CASE WHEN transaction_status = 'ÈÄÉË¥π' THEN 1 ELSE 0 END) AS status_evasion_count,
    SUM(CASE WHEN transaction_status = 'ËÆæÂ§áÊïÖÈöú' THEN 1 ELSE 0 END) AS status_equipment_failure_count,
    SUM(CASE WHEN transaction_status = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS status_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êî∂Ë¥πÁ´ôÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_station_missing_count,
    SUM(CASE WHEN data_quality_flag = 'ËΩ¶ÁâåÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_plate_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êó∂Èó¥ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_time_abnormal_count,
    SUM(CASE WHEN data_quality_flag = 'ÈáëÈ¢ùÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_amount_abnormal_count,
    -- ÂëäË≠¶Ê†áËÆ∞
    CASE 
        WHEN SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 90 THEN 'ÂëäË≠¶'
        WHEN SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 95 THEN 'ÂëäË≠¶'
        ELSE 'Ê≠£Â∏∏'
    END AS alert_status,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:44:59.579221 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m02:44:59.580384 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.580722 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_quality_monitoring_dashboard'
  
[0m02:44:59.581734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.582842 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.583175 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_quality_monitoring_dashboard'
  
[0m02:44:59.584372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.586997 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.587352 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */
alter table "datacore"."main_ads"."ads_quality_monitoring_dashboard" rename to "ads_quality_monitoring_dashboard__dbt_backup"
[0m02:44:59.588160 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.590440 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.590774 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */
alter table "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp" rename to "ads_quality_monitoring_dashboard"
[0m02:44:59.591419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.592558 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m02:44:59.592891 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.593199 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m02:44:59.594817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.596746 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.597076 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

      drop table if exists "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_backup" cascade
    
[0m02:44:59.598465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.599646 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: Close
[0m02:44:59.600625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396bb4b60>]}
[0m02:44:59.601174 [info ] [Thread-1 (]: 11 of 18 OK created sql table model main_ads.ads_quality_monitoring_dashboard .. [[32mOK[0m in 0.04s]
[0m02:44:59.601685 [debug] [Thread-1 (]: Finished running node model.datacore.ads_quality_monitoring_dashboard
[0m02:44:59.602041 [debug] [Thread-1 (]: Began running node model.datacore.dws_station_performance_daily
[0m02:44:59.602525 [info ] [Thread-1 (]: 12 of 18 START sql table model main_dws.dws_station_performance_daily .......... [RUN]
[0m02:44:59.602889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_quality_monitoring_dashboard, now model.datacore.dws_station_performance_daily)
[0m02:44:59.603206 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_station_performance_daily
[0m02:44:59.607875 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_station_performance_daily"
[0m02:44:59.608471 [debug] [Thread-1 (]: Began executing node model.datacore.dws_station_performance_daily
[0m02:44:59.610978 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_station_performance_daily"
[0m02:44:59.611535 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.611859 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: BEGIN
[0m02:44:59.612171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.613069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.613386 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.613737 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄª
-- ÂäüËÉΩÔºöÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    -- ‰∫§ÊòìÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    COUNT(DISTINCT lane_id) AS active_lanes,
    -- Êî∂ÂÖ•ÊåáÊ†á
    SUM(actual_amount) AS total_revenue,
    AVG(actual_amount) AS avg_revenue_per_transaction,
    -- ÊïàÁéáÊåáÊ†á
    AVG(travel_minutes) AS avg_processing_time_minutes,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS etc_rate,
    -- È´òÂ≥∞Êó∂ÊÆµÂç†ÊØî
    SUM(CASE WHEN time_period IN ('Êó©È´òÂ≥∞', 'ÊôöÈ´òÂ≥∞') THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS peak_hour_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type
    );
  
  
[0m02:44:59.673476 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m02:44:59.674907 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.675286 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_station_performance_daily'
  
[0m02:44:59.676577 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.678015 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.678409 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_station_performance_daily'
  
[0m02:44:59.679634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.682745 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.683145 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */
alter table "datacore"."main_dws"."dws_station_performance_daily" rename to "dws_station_performance_daily__dbt_backup"
[0m02:44:59.683973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.686621 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.686997 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */
alter table "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp" rename to "dws_station_performance_daily"
[0m02:44:59.687728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.689026 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m02:44:59.689406 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.689749 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m02:44:59.692898 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:44:59.695287 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.695667 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

      drop table if exists "datacore"."main_dws"."dws_station_performance_daily__dbt_backup" cascade
    
[0m02:44:59.697177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.698526 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: Close
[0m02:44:59.708151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3348585580>]}
[0m02:44:59.708972 [info ] [Thread-1 (]: 12 of 18 OK created sql table model main_dws.dws_station_performance_daily ..... [[32mOK[0m in 0.11s]
[0m02:44:59.709543 [debug] [Thread-1 (]: Finished running node model.datacore.dws_station_performance_daily
[0m02:44:59.709941 [debug] [Thread-1 (]: Began running node model.datacore.dws_toll_revenue_daily
[0m02:44:59.710576 [info ] [Thread-1 (]: 13 of 18 START sql table model main_dws.dws_toll_revenue_daily ................. [RUN]
[0m02:44:59.711015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_station_performance_daily, now model.datacore.dws_toll_revenue_daily)
[0m02:44:59.711381 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_toll_revenue_daily
[0m02:44:59.715035 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.715665 [debug] [Thread-1 (]: Began executing node model.datacore.dws_toll_revenue_daily
[0m02:44:59.718443 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.719037 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.719403 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: BEGIN
[0m02:44:59.719739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.720636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.720972 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.721375 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name,
    -- Ê±áÊÄªÊåáÊ†á
    COUNT(*) AS transaction_count,
    COUNT(DISTINCT vehicle_plate) AS vehicle_count,
    SUM(toll_amount) AS total_toll_amount,
    SUM(actual_amount) AS total_actual_amount,
    SUM(discount_amount) AS total_discount_amount,
    AVG(actual_amount) AS avg_transaction_amount,
    MAX(actual_amount) AS max_transaction_amount,
    MIN(actual_amount) AS min_transaction_amount,
    -- Ê≠£Â∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transaction_count,
    SUM(CASE WHEN is_normal_transaction = 1 THEN actual_amount ELSE 0 END) AS normal_transaction_amount,
    -- ÂºÇÂ∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transaction_count,
    -- Êï∞ÊçÆË¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal_count,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name
    );
  
  
[0m02:44:59.817009 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m02:44:59.818327 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.818659 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_toll_revenue_daily'
  
[0m02:44:59.819762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.820856 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.821181 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_toll_revenue_daily'
  
[0m02:44:59.822131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.824882 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.825225 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */
alter table "datacore"."main_dws"."dws_toll_revenue_daily" rename to "dws_toll_revenue_daily__dbt_backup"
[0m02:44:59.826077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.828390 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.828720 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */
alter table "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp" rename to "dws_toll_revenue_daily"
[0m02:44:59.829361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.830541 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m02:44:59.830871 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.831179 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m02:44:59.843477 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m02:44:59.845778 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.846105 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

      drop table if exists "datacore"."main_dws"."dws_toll_revenue_daily__dbt_backup" cascade
    
[0m02:44:59.847563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.848777 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: Close
[0m02:44:59.862938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396f02870>]}
[0m02:44:59.863709 [info ] [Thread-1 (]: 13 of 18 OK created sql table model main_dws.dws_toll_revenue_daily ............ [[32mOK[0m in 0.15s]
[0m02:44:59.864220 [debug] [Thread-1 (]: Finished running node model.datacore.dws_toll_revenue_daily
[0m02:44:59.864581 [debug] [Thread-1 (]: Began running node model.datacore.dws_traffic_flow_daily
[0m02:44:59.865234 [info ] [Thread-1 (]: 14 of 18 START sql table model main_dws.dws_traffic_flow_daily ................. [RUN]
[0m02:44:59.865636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_toll_revenue_daily, now model.datacore.dws_traffic_flow_daily)
[0m02:44:59.865965 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_traffic_flow_daily
[0m02:44:59.870660 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.871257 [debug] [Thread-1 (]: Began executing node model.datacore.dws_traffic_flow_daily
[0m02:44:59.873713 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.874233 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.874566 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: BEGIN
[0m02:44:59.874874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.875839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.876148 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.876504 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•ËΩ¶ÊµÅÈáèÊ±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type,
    -- ËΩ¶ÊµÅÈáèÊåáÊ†á
    COUNT(*) AS total_vehicles,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' THEN 1 ELSE 0 END) AS passenger_vehicle_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code != 'V01' THEN 1 ELSE 0 END) AS bus_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code >= 'V05' THEN 1 ELSE 0 END) AS truck_count,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(travel_minutes) AS avg_travel_minutes,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) AS etc_count,
    SUM(CASE WHEN payment_method_code != 'P01' THEN 1 ELSE 0 END) AS non_etc_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type
    );
  
  
[0m02:44:59.932496 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m02:44:59.933821 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.934174 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_traffic_flow_daily'
  
[0m02:44:59.935339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.936478 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.936950 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_traffic_flow_daily'
  
[0m02:44:59.937989 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.940844 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.941230 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */
alter table "datacore"."main_dws"."dws_traffic_flow_daily" rename to "dws_traffic_flow_daily__dbt_backup"
[0m02:44:59.942318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.944865 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.945206 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */
alter table "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp" rename to "dws_traffic_flow_daily"
[0m02:44:59.945962 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.947111 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m02:44:59.947445 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.947746 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m02:44:59.951439 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:44:59.953569 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.953899 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

      drop table if exists "datacore"."main_dws"."dws_traffic_flow_daily__dbt_backup" cascade
    
[0m02:44:59.955247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.956460 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: Close
[0m02:44:59.967310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e334857e9c0>]}
[0m02:44:59.968044 [info ] [Thread-1 (]: 14 of 18 OK created sql table model main_dws.dws_traffic_flow_daily ............ [[32mOK[0m in 0.10s]
[0m02:44:59.968647 [debug] [Thread-1 (]: Finished running node model.datacore.dws_traffic_flow_daily
[0m02:44:59.969038 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m02:44:59.969640 [info ] [Thread-1 (]: 15 of 18 START sql table model main_metadata.meta_data_quality_metrics ......... [RUN]
[0m02:44:59.970191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_traffic_flow_daily, now model.datacore.meta_data_quality_metrics)
[0m02:44:59.970549 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_quality_metrics
[0m02:44:59.974144 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_quality_metrics"
[0m02:44:59.974766 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_quality_metrics
[0m02:44:59.977658 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_quality_metrics"
[0m02:44:59.978260 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:44:59.978623 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: BEGIN
[0m02:44:59.978957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.979941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.980276 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:44:59.980702 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø



SELECT 
    transaction_date AS metric_date,
    'dwd_toll_transaction_detail' AS table_name,
    -- ÂÆåÊï¥ÊÄßÊåáÊ†á
    COUNT(*) AS total_records,
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_transaction_id,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_station_id,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) AS complete_vehicle_plate,
    -- ÂÆåÊï¥ÊÄßÁéá
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS transaction_id_completeness_rate,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS station_id_completeness_rate,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS vehicle_plate_completeness_rate,
    -- ÂáÜÁ°ÆÊÄßÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS accuracy_rate,
    -- ‰∏ÄËá¥ÊÄßÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS consistent_records,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS consistency_rate,
    -- ÂèäÊó∂ÊÄßÊåáÊ†á
    MAX(etl_time) AS last_etl_time,
    CURRENT_TIMESTAMP - MAX(etl_time) AS etl_delay,
    -- ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ
    (
        (SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2
    ) AS overall_quality_score,
    CURRENT_TIMESTAMP AS metric_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:44:59.992906 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m02:44:59.994079 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:44:59.994416 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:44:59.995447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.996539 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:44:59.996867 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:44:59.997785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.000553 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:45:00.000901 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics" rename to "meta_data_quality_metrics__dbt_backup"
[0m02:45:00.001711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.004016 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:45:00.004362 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp" rename to "meta_data_quality_metrics"
[0m02:45:00.005004 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.006155 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:45:00.006495 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:45:00.006799 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:45:00.008411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.010404 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:45:00.010742 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

      drop table if exists "datacore"."main_metadata"."meta_data_quality_metrics__dbt_backup" cascade
    
[0m02:45:00.012079 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.013266 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: Close
[0m02:45:00.014097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396927110>]}
[0m02:45:00.014653 [info ] [Thread-1 (]: 15 of 18 OK created sql table model main_metadata.meta_data_quality_metrics .... [[32mOK[0m in 0.04s]
[0m02:45:00.015219 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m02:45:00.015589 [debug] [Thread-1 (]: Began running node model.datacore.ads_toll_revenue_report
[0m02:45:00.016082 [info ] [Thread-1 (]: 16 of 18 START sql table model main_ads.ads_toll_revenue_report ................ [RUN]
[0m02:45:00.016485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_quality_metrics, now model.datacore.ads_toll_revenue_report)
[0m02:45:00.016806 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_toll_revenue_report
[0m02:45:00.021710 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_toll_revenue_report"
[0m02:45:00.022455 [debug] [Thread-1 (]: Began executing node model.datacore.ads_toll_revenue_report
[0m02:45:00.025277 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_toll_revenue_report"
[0m02:45:00.025871 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.026274 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: BEGIN
[0m02:45:00.026649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:00.027565 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.027911 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.028299 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®
-- ÂäüËÉΩÔºöÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®



SELECT 
    transaction_date,
    city,
    highway_code,
    -- ÊÄª‰ΩìÊåáÊ†á
    SUM(total_actual_amount) AS daily_revenue,
    SUM(transaction_count) AS daily_transactions,
    SUM(vehicle_count) AS daily_vehicles,
    AVG(avg_transaction_amount) AS avg_transaction_amount,
    -- ÊåâÊîØ‰ªòÊñπÂºè
    SUM(CASE WHEN payment_method_code = 'P01' THEN total_actual_amount ELSE 0 END) AS etc_revenue,
    SUM(CASE WHEN payment_method_code != 'P01' THEN total_actual_amount ELSE 0 END) AS non_etc_revenue,
    -- ÊåâËΩ¶Âûã
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code < 'V05' THEN total_actual_amount ELSE 0 END) AS passenger_revenue,
    SUM(CASE WHEN vehicle_type_code >= 'V05' THEN total_actual_amount ELSE 0 END) AS truck_revenue,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(normal_transaction_count) * 100.0 / SUM(transaction_count) AS normal_rate,
    SUM(quality_normal_count) * 100.0 / SUM(transaction_count) AS data_quality_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_toll_revenue_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code
    );
  
  
[0m02:45:00.039471 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m02:45:00.040706 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.041043 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_toll_revenue_report'
  
[0m02:45:00.042131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.043269 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.043664 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_toll_revenue_report'
  
[0m02:45:00.045006 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.048089 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.048488 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */
alter table "datacore"."main_ads"."ads_toll_revenue_report" rename to "ads_toll_revenue_report__dbt_backup"
[0m02:45:00.049380 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.051918 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.052278 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */
alter table "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp" rename to "ads_toll_revenue_report"
[0m02:45:00.052951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.054205 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m02:45:00.054577 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.054911 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m02:45:00.057832 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:45:00.059883 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.060214 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

      drop table if exists "datacore"."main_ads"."ads_toll_revenue_report__dbt_backup" cascade
    
[0m02:45:00.061542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.062730 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: Close
[0m02:45:00.067369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3348533ad0>]}
[0m02:45:00.067999 [info ] [Thread-1 (]: 16 of 18 OK created sql table model main_ads.ads_toll_revenue_report ........... [[32mOK[0m in 0.05s]
[0m02:45:00.068610 [debug] [Thread-1 (]: Finished running node model.datacore.ads_toll_revenue_report
[0m02:45:00.069003 [debug] [Thread-1 (]: Began running node model.datacore.ads_traffic_trend_analysis
[0m02:45:00.069559 [info ] [Thread-1 (]: 17 of 18 START sql table model main_ads.ads_traffic_trend_analysis ............. [RUN]
[0m02:45:00.070147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_toll_revenue_report, now model.datacore.ads_traffic_trend_analysis)
[0m02:45:00.070514 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_traffic_trend_analysis
[0m02:45:00.074041 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.074678 [debug] [Thread-1 (]: Began executing node model.datacore.ads_traffic_trend_analysis
[0m02:45:00.077436 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.078003 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.078368 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: BEGIN
[0m02:45:00.078706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:00.079624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.079967 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.080362 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê
-- ÂäüËÉΩÔºöËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê



SELECT 
    transaction_date,
    city,
    highway_code,
    day_type,
    -- ËΩ¶ÊµÅÈáèË∂ãÂäø
    SUM(total_vehicles) AS daily_vehicles,
    SUM(unique_vehicles) AS daily_unique_vehicles,
    -- Êó∂ÊÆµÂàÜÂ∏É
    SUM(CASE WHEN time_period = 'Êó©È´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS morning_peak_vehicles,
    SUM(CASE WHEN time_period = 'ÊôöÈ´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS evening_peak_vehicles,
    SUM(CASE WHEN time_period = 'Âπ≥Â≥∞' THEN total_vehicles ELSE 0 END) AS normal_vehicles,
    SUM(CASE WHEN time_period = 'Â§úÈó¥' THEN total_vehicles ELSE 0 END) AS night_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(passenger_vehicle_count) AS passenger_vehicles,
    SUM(bus_count) AS bus_vehicles,
    SUM(truck_count) AS truck_vehicles,
    -- ETC‰ΩøÁî®Áéá
    SUM(etc_count) * 100.0 / SUM(total_vehicles) AS etc_usage_rate,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(avg_travel_minutes) AS avg_travel_minutes,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_traffic_flow_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code,
    day_type
    );
  
  
[0m02:45:00.088268 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m02:45:00.089548 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.089887 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_traffic_trend_analysis'
  
[0m02:45:00.091019 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.092253 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.092632 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_traffic_trend_analysis'
  
[0m02:45:00.093703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.096792 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.097179 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */
alter table "datacore"."main_ads"."ads_traffic_trend_analysis" rename to "ads_traffic_trend_analysis__dbt_backup"
[0m02:45:00.097945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.100466 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.100828 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */
alter table "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp" rename to "ads_traffic_trend_analysis"
[0m02:45:00.101493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.102842 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m02:45:00.103200 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.103552 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m02:45:00.106390 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:45:00.108444 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.108778 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

      drop table if exists "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_backup" cascade
    
[0m02:45:00.110147 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.111349 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: Close
[0m02:45:00.114082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396f80ce0>]}
[0m02:45:00.114652 [info ] [Thread-1 (]: 17 of 18 OK created sql table model main_ads.ads_traffic_trend_analysis ........ [[32mOK[0m in 0.04s]
[0m02:45:00.115231 [debug] [Thread-1 (]: Finished running node model.datacore.ads_traffic_trend_analysis
[0m02:45:00.115593 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m02:45:00.116070 [info ] [Thread-1 (]: 18 of 18 START sql table model main_metadata.meta_data_asset_catalog ........... [RUN]
[0m02:45:00.116484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_traffic_trend_analysis, now model.datacore.meta_data_asset_catalog)
[0m02:45:00.116801 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_asset_catalog
[0m02:45:00.122773 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_asset_catalog"
[0m02:45:00.123484 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_asset_catalog
[0m02:45:00.126319 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_asset_catalog"
[0m02:45:00.126876 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.127230 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: BEGIN
[0m02:45:00.127622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:00.128541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.128882 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.129297 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï
-- ÂäüËÉΩÔºöÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞



WITH table_stats AS (
    SELECT 
        'dwd.dwd_toll_transaction_detail' AS table_name,
        COUNT(*) AS record_count,
        MAX(etl_time) AS last_update_time
    FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_toll_revenue_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_toll_revenue_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_traffic_flow_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_traffic_flow_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'ads.ads_toll_revenue_report',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_ads"."ads_toll_revenue_report"
    GROUP BY 1
)

SELECT 
    ti.schema_name,
    ti.table_name,
    ti.table_description,
    ti.business_domain,
    ti.data_layer,
    ti.owner,
    COALESCE(ts.record_count, 0) AS record_count,
    COALESCE(ts.last_update_time, CURRENT_TIMESTAMP) AS last_update_time,
    -- ËµÑ‰∫ßÁ≠âÁ∫ßËØÑ‰º∞
    CASE 
        WHEN ti.data_layer IN ('dwd', 'dws') THEN 'Ê†∏ÂøÉËµÑ‰∫ß'
        WHEN ti.data_layer = 'ads' THEN 'Â∫îÁî®ËµÑ‰∫ß'
        ELSE 'Âü∫Á°ÄËµÑ‰∫ß'
    END AS asset_level,
    -- ‰ΩøÁî®È¢ëÁéáËØÑ‰º∞ÔºàÂü∫‰∫éÊõ¥Êñ∞È¢ëÁéáÔºâ
    CASE 
        WHEN ti.update_frequency = 'ÂÆûÊó∂' THEN 'È´òÈ¢ë'
        WHEN ti.update_frequency = 'Êó•' THEN '‰∏≠È¢ë'
        ELSE '‰ΩéÈ¢ë'
    END AS usage_frequency,
    -- Êï∞ÊçÆÊñ∞È≤úÂ∫¶
    CASE 
        WHEN ts.last_update_time IS NULL THEN 'Êú™Áü•'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 1 DAY THEN 'Êñ∞È≤ú'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 7 DAY THEN 'ËæÉÊñ∞'
        ELSE 'ÈôàÊóß'
    END AS data_freshness,
    CURRENT_TIMESTAMP AS catalog_time
FROM "datacore"."main_metadata"."meta_table_info" ti
LEFT JOIN table_stats ts ON CONCAT(ti.schema_name, '.', ti.table_name) = ts.table_name
    );
  
  
[0m02:45:00.137441 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m02:45:00.138776 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.139117 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:45:00.140273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.141404 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.141733 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:45:00.142666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.145426 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.145780 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog" rename to "meta_data_asset_catalog__dbt_backup"
[0m02:45:00.146515 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.148847 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.149183 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp" rename to "meta_data_asset_catalog"
[0m02:45:00.149827 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.150983 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:45:00.151314 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.151617 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:45:00.153396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.155381 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.155716 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

      drop table if exists "datacore"."main_metadata"."meta_data_asset_catalog__dbt_backup" cascade
    
[0m02:45:00.157030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.158210 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: Close
[0m02:45:00.160915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e334854af00>]}
[0m02:45:00.161473 [info ] [Thread-1 (]: 18 of 18 OK created sql table model main_metadata.meta_data_asset_catalog ...... [[32mOK[0m in 0.04s]
[0m02:45:00.161970 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m02:45:00.163922 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:00.164551 [debug] [MainThread]: On master: BEGIN
[0m02:45:00.165072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:45:00.166689 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:45:00.167224 [debug] [MainThread]: On master: COMMIT
[0m02:45:00.167763 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:00.168277 [debug] [MainThread]: On master: COMMIT
[0m02:45:00.169187 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:45:00.169742 [debug] [MainThread]: On master: Close
[0m02:45:00.173355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:45:00.173982 [debug] [MainThread]: Connection 'model.datacore.meta_data_asset_catalog' was properly closed.
[0m02:45:00.175056 [info ] [MainThread]: 
[0m02:45:00.175779 [info ] [MainThread]: Finished running 14 table models, 4 view models in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m02:45:00.182095 [debug] [MainThread]: Command end result
[0m02:45:00.228992 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:45:00.231865 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:45:00.239420 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:45:00.239789 [info ] [MainThread]: 
[0m02:45:00.240223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:45:00.240572 [info ] [MainThread]: 
[0m02:45:00.240951 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=18
[0m02:45:00.242457 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1755335, "process_in_blocks": "0", "process_kernel_time": 0.904887, "process_mem_max_rss": "301924", "process_out_blocks": "33816", "process_user_time": 4.613822}
[0m02:45:00.243197 [debug] [MainThread]: Command `dbt run` succeeded at 02:45:00.243105 after 3.18 seconds
[0m02:45:00.243658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396fdc380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396cb35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396b3eae0>]}
[0m02:45:00.244018 [debug] [MainThread]: Flushing usage events
[0m02:45:02.032064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:45:06.521570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1345ea2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1345af3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1345d085f0>]}


============================== 02:45:06.525350 | 05702971-fb36-4ef4-865c-d218aace7e48 ==============================
[0m02:45:06.525350 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:45:06.525835 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'printer_width': '80', 'log_path': '/home/chun/Develop/datacore/logs', 'profiles_dir': '/home/chun/Develop/datacore', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'introspect': 'True', 'log_format': 'default', 'version_check': 'True'}
[0m02:45:06.728684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1335907b60>]}
[0m02:45:06.787902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d13455bd100>]}
[0m02:45:06.789507 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:45:06.874151 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:45:07.007025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:45:07.007434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:45:07.068258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d13359c0410>]}
[0m02:45:07.172523 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:45:07.174287 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:45:07.195679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d133538d280>]}
[0m02:45:07.196189 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 465 macros
[0m02:45:07.196514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1335360e60>]}
[0m02:45:07.198851 [info ] [MainThread]: 
[0m02:45:07.199189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:45:07.199464 [info ] [MainThread]: 
[0m02:45:07.199927 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:45:07.205678 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore_main_metadata'
[0m02:45:07.245987 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:45:07.246379 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:45:07.246656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:07.265071 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:45:07.265511 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:45:07.265829 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.279207 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m02:45:07.280671 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:45:07.281750 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:45:07.282038 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:45:07.282665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dwd)
[0m02:45:07.286998 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:45:07.287355 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:45:07.287618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.288514 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.288777 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:45:07.289045 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.294538 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:45:07.295703 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:45:07.296515 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:45:07.296781 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:45:07.297396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_staging)
[0m02:45:07.299535 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:45:07.299848 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:45:07.300120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.300801 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.301075 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:45:07.301366 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.305540 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:45:07.306828 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:45:07.307686 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:45:07.307968 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:45:07.308554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_dws)
[0m02:45:07.311076 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:45:07.311394 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:45:07.311670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.312440 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.312712 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:45:07.312998 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.316618 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:45:07.317887 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:45:07.318742 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:45:07.319023 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:45:07.319595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_ads)
[0m02:45:07.322176 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:45:07.322496 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:45:07.322769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.323389 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.323662 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:45:07.323948 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.327939 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:45:07.329197 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:45:07.330034 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:45:07.330311 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:45:07.330878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main)
[0m02:45:07.333568 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:45:07.333876 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:45:07.334146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.334827 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.335095 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:45:07.335401 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.340502 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:45:07.341561 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:45:07.342372 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:45:07.342644 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:45:07.343221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ods)
[0m02:45:07.345028 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:45:07.345330 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:45:07.345602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.346230 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.346514 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:45:07.346799 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.351350 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:45:07.352573 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:45:07.353402 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:45:07.353676 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:45:07.355075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1347c9da30>]}
[0m02:45:07.356030 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:07.356518 [debug] [MainThread]: On master: BEGIN
[0m02:45:07.356894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:45:07.357844 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:45:07.358236 [debug] [MainThread]: On master: COMMIT
[0m02:45:07.358628 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:07.359122 [debug] [MainThread]: On master: COMMIT
[0m02:45:07.359909 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:45:07.360448 [debug] [MainThread]: On master: Close
[0m02:45:07.365076 [debug] [Thread-1 (]: Began running node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:45:07.365863 [info ] [Thread-1 (]: 1 of 15 START test not_null_dwd_toll_transaction_detail_transaction_id ......... [RUN]
[0m02:45:07.366767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90)
[0m02:45:07.367448 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:45:07.397285 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:45:07.398397 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:45:07.415771 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:45:07.416372 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:45:07.416686 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: BEGIN
[0m02:45:07.416980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.417770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.418074 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:45:07.418385 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "datacore"."main_dwd"."dwd_toll_transaction_detail"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.419370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.422930 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: ROLLBACK
[0m02:45:07.423779 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90'
[0m02:45:07.424091 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: Close
[0m02:45:07.424807 [info ] [Thread-1 (]: 1 of 15 PASS not_null_dwd_toll_transaction_detail_transaction_id ............... [[32mPASS[0m in 0.06s]
[0m02:45:07.425398 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:45:07.425784 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:45:07.426237 [info ] [Thread-1 (]: 2 of 15 START test not_null_stg_payment_method_dict_payment_method_code ........ [RUN]
[0m02:45:07.426718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90, now test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c)
[0m02:45:07.427060 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:45:07.430825 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:45:07.431426 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:45:07.433433 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:45:07.433960 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:45:07.434300 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: BEGIN
[0m02:45:07.434636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.435467 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.435799 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:45:07.436138 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_method_code
from "datacore"."main_staging"."stg_payment_method_dict"
where payment_method_code is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.437688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.439108 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: ROLLBACK
[0m02:45:07.440016 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c'
[0m02:45:07.440365 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: Close
[0m02:45:07.441000 [info ] [Thread-1 (]: 2 of 15 PASS not_null_stg_payment_method_dict_payment_method_code .............. [[32mPASS[0m in 0.01s]
[0m02:45:07.441581 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:45:07.441956 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:45:07.442378 [info ] [Thread-1 (]: 3 of 15 START test not_null_stg_toll_station_station_id ........................ [RUN]
[0m02:45:07.442786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c, now test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2)
[0m02:45:07.443121 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:45:07.508694 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:45:07.509422 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:45:07.511428 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:45:07.511941 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:45:07.512275 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: BEGIN
[0m02:45:07.512604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.513581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.513908 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:45:07.514237 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select station_id
from "datacore"."main_staging"."stg_toll_station"
where station_id is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.515470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.516856 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: ROLLBACK
[0m02:45:07.517762 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2'
[0m02:45:07.518089 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: Close
[0m02:45:07.519076 [info ] [Thread-1 (]: 3 of 15 PASS not_null_stg_toll_station_station_id .............................. [[32mPASS[0m in 0.08s]
[0m02:45:07.519654 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:45:07.520026 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:45:07.520426 [info ] [Thread-1 (]: 4 of 15 START test not_null_stg_toll_transaction_station_id .................... [RUN]
[0m02:45:07.520825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2, now test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde)
[0m02:45:07.521164 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:45:07.524798 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:45:07.525364 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:45:07.527287 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:45:07.527835 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:45:07.528223 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: BEGIN
[0m02:45:07.528558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.529353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.529676 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:45:07.530006 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select station_id
from "datacore"."main_staging"."stg_toll_transaction"
where station_id is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.533252 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:45:07.534724 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: ROLLBACK
[0m02:45:07.535619 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde'
[0m02:45:07.535953 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: Close
[0m02:45:07.536589 [info ] [Thread-1 (]: 4 of 15 PASS not_null_stg_toll_transaction_station_id .......................... [[32mPASS[0m in 0.02s]
[0m02:45:07.537148 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:45:07.537527 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:45:07.537916 [info ] [Thread-1 (]: 5 of 15 START test not_null_stg_toll_transaction_transaction_id ................ [RUN]
[0m02:45:07.538322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde, now test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b)
[0m02:45:07.538660 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:45:07.542285 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:45:07.542863 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:45:07.544739 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:45:07.545332 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:45:07.545670 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: BEGIN
[0m02:45:07.545996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.546770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.547093 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:45:07.547433 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "datacore"."main_staging"."stg_toll_transaction"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.550557 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:45:07.551970 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: ROLLBACK
[0m02:45:07.552878 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b'
[0m02:45:07.553214 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: Close
[0m02:45:07.553853 [info ] [Thread-1 (]: 5 of 15 PASS not_null_stg_toll_transaction_transaction_id ...................... [[32mPASS[0m in 0.02s]
[0m02:45:07.554426 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:45:07.554802 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:45:07.555200 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_vehicle_type_dict_vehicle_type_code ............ [RUN]
[0m02:45:07.555617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b, now test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728)
[0m02:45:07.555953 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:45:07.559660 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:45:07.560244 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:45:07.562171 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:45:07.562709 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:45:07.563052 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: BEGIN
[0m02:45:07.563394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.564171 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.564513 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:45:07.564855 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vehicle_type_code
from "datacore"."main_staging"."stg_vehicle_type_dict"
where vehicle_type_code is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.566183 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.567570 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: ROLLBACK
[0m02:45:07.568471 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728'
[0m02:45:07.568807 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: Close
[0m02:45:07.569434 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_vehicle_type_dict_vehicle_type_code .................. [[32mPASS[0m in 0.01s]
[0m02:45:07.569999 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:45:07.570392 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_accuracy
[0m02:45:07.570815 [info ] [Thread-1 (]: 7 of 15 START test test_toll_transaction_accuracy .............................. [RUN]
[0m02:45:07.571236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728, now test.datacore.test_toll_transaction_accuracy)
[0m02:45:07.571580 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_accuracy
[0m02:45:07.574226 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_accuracy"
[0m02:45:07.574853 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_accuracy
[0m02:45:07.577098 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_accuracy"
[0m02:45:07.577690 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_accuracy"
[0m02:45:07.578021 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: BEGIN
[0m02:45:07.578350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.579138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.579467 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_accuracy"
[0m02:45:07.579830 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_accuracy"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂáÜÁ°ÆÊÄß

SELECT 
    transaction_id,
    toll_amount,
    actual_amount,
    discount_amount
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    actual_amount < 0
    OR actual_amount > toll_amount
    OR discount_amount < 0
    OR discount_amount > toll_amount
    OR (actual_amount + discount_amount) > toll_amount * 1.1  -- ÂÖÅËÆ∏10%ËØØÂ∑Æ
  
  
      
    ) dbt_internal_test
[0m02:45:07.583280 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:45:07.584820 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: ROLLBACK
[0m02:45:07.585730 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_accuracy'
[0m02:45:07.586064 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: Close
[0m02:45:07.586712 [info ] [Thread-1 (]: 7 of 15 PASS test_toll_transaction_accuracy .................................... [[32mPASS[0m in 0.02s]
[0m02:45:07.587285 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_accuracy
[0m02:45:07.587669 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_completeness
[0m02:45:07.588078 [info ] [Thread-1 (]: 8 of 15 START test test_toll_transaction_completeness .......................... [RUN]
[0m02:45:07.588483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_accuracy, now test.datacore.test_toll_transaction_completeness)
[0m02:45:07.588814 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_completeness
[0m02:45:07.591414 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_completeness"
[0m02:45:07.591975 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_completeness
[0m02:45:07.595603 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_completeness"
[0m02:45:07.596162 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:45:07.596509 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: BEGIN
[0m02:45:07.596833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.597621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.597946 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:45:07.598292 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_completeness"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂÆåÊï¥ÊÄß

SELECT 
    transaction_id,
    station_id,
    vehicle_plate,
    vehicle_type_code,
    payment_method_code
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    transaction_id IS NULL
    OR station_id IS NULL
    OR vehicle_plate IS NULL
    OR vehicle_plate = ''
    OR vehicle_type_code IS NULL
    OR payment_method_code IS NULL
  
  
      
    ) dbt_internal_test
[0m02:45:07.607223 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m02:45:07.608748 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: ROLLBACK
[0m02:45:07.609646 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_completeness'
[0m02:45:07.609976 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: Close
[0m02:45:07.610603 [info ] [Thread-1 (]: 8 of 15 PASS test_toll_transaction_completeness ................................ [[32mPASS[0m in 0.02s]
[0m02:45:07.611181 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_completeness
[0m02:45:07.611564 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_consistency
[0m02:45:07.611956 [info ] [Thread-1 (]: 9 of 15 START test test_toll_transaction_consistency ........................... [RUN]
[0m02:45:07.612361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_completeness, now test.datacore.test_toll_transaction_consistency)
[0m02:45:07.612699 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_consistency
[0m02:45:07.615320 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_consistency"
[0m02:45:07.615878 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_consistency
[0m02:45:07.617776 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_consistency"
[0m02:45:07.618286 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_consistency"
[0m02:45:07.618630 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: BEGIN
[0m02:45:07.618951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.619893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.620222 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_consistency"
[0m02:45:07.620571 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_consistency"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆ‰∏ÄËá¥ÊÄß

SELECT 
    transaction_id,
    entry_time,
    exit_time,
    travel_minutes
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    exit_time < entry_time
    OR travel_minutes < 0
    OR travel_minutes > 1440  -- Ë∂ÖËøá24Â∞èÊó∂ËßÜ‰∏∫ÂºÇÂ∏∏
  
  
      
    ) dbt_internal_test
[0m02:45:07.623441 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:45:07.624923 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: ROLLBACK
[0m02:45:07.625821 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_consistency'
[0m02:45:07.626153 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: Close
[0m02:45:07.627097 [info ] [Thread-1 (]: 9 of 15 PASS test_toll_transaction_consistency ................................. [[32mPASS[0m in 0.01s]
[0m02:45:07.627696 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_consistency
[0m02:45:07.628067 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_referential_integrity
[0m02:45:07.628475 [info ] [Thread-1 (]: 10 of 15 START test test_toll_transaction_referential_integrity ................ [RUN]
[0m02:45:07.628867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_consistency, now test.datacore.test_toll_transaction_referential_integrity)
[0m02:45:07.629210 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_referential_integrity
[0m02:45:07.632674 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_referential_integrity"
[0m02:45:07.633280 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_referential_integrity
[0m02:45:07.635322 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_referential_integrity"
[0m02:45:07.635868 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_referential_integrity"
[0m02:45:07.636211 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: BEGIN
[0m02:45:07.636556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.637358 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.637693 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_referential_integrity"
[0m02:45:07.638058 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_referential_integrity"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂºïÁî®ÂÆåÊï¥ÊÄß

SELECT 
    t.transaction_id,
    t.station_id,
    t.vehicle_type_code,
    t.payment_method_code
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail" t
LEFT JOIN "datacore"."main_ods"."ods_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
WHERE 
    s.station_id IS NULL
    OR vt.vehicle_type_code IS NULL
    OR pm.payment_method_code IS NULL
  
  
      
    ) dbt_internal_test
[0m02:45:07.646454 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m02:45:07.647931 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: ROLLBACK
[0m02:45:07.648798 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_referential_integrity'
[0m02:45:07.649115 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: Close
[0m02:45:07.649884 [info ] [Thread-1 (]: 10 of 15 PASS test_toll_transaction_referential_integrity ...................... [[32mPASS[0m in 0.02s]
[0m02:45:07.650414 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_referential_integrity
[0m02:45:07.650791 [debug] [Thread-1 (]: Began running node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:45:07.651194 [info ] [Thread-1 (]: 11 of 15 START test unique_dwd_toll_transaction_detail_transaction_id .......... [RUN]
[0m02:45:07.651594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_referential_integrity, now test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716)
[0m02:45:07.651930 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:45:07.657841 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:45:07.658427 [debug] [Thread-1 (]: Began executing node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:45:07.660393 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:45:07.660913 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:45:07.661251 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: BEGIN
[0m02:45:07.661582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.662370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.662799 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:45:07.663140 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "datacore"."main_dwd"."dwd_toll_transaction_detail"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:45:07.698185 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m02:45:07.699850 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: ROLLBACK
[0m02:45:07.700707 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716'
[0m02:45:07.701025 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: Close
[0m02:45:07.703589 [info ] [Thread-1 (]: 11 of 15 PASS unique_dwd_toll_transaction_detail_transaction_id ................ [[32mPASS[0m in 0.05s]
[0m02:45:07.704107 [debug] [Thread-1 (]: Finished running node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:45:07.704478 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:45:07.704889 [info ] [Thread-1 (]: 12 of 15 START test unique_stg_payment_method_dict_payment_method_code ......... [RUN]
[0m02:45:07.705281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716, now test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1)
[0m02:45:07.705636 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:45:07.709440 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:45:07.710031 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:45:07.711982 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:45:07.712517 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:45:07.712862 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: BEGIN
[0m02:45:07.713198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.713994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.714339 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:45:07.714686 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_method_code as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_payment_method_dict"
where payment_method_code is not null
group by payment_method_code
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:45:07.717015 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:45:07.718577 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: ROLLBACK
[0m02:45:07.719488 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1'
[0m02:45:07.719829 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: Close
[0m02:45:07.720845 [info ] [Thread-1 (]: 12 of 15 PASS unique_stg_payment_method_dict_payment_method_code ............... [[32mPASS[0m in 0.02s]
[0m02:45:07.721403 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:45:07.721784 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:45:07.722186 [info ] [Thread-1 (]: 13 of 15 START test unique_stg_toll_station_station_id ......................... [RUN]
[0m02:45:07.722607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1, now test.datacore.unique_stg_toll_station_station_id.7201f48e61)
[0m02:45:07.722950 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:45:07.726591 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:45:07.727177 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:45:07.729191 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:45:07.729758 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:45:07.730097 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: BEGIN
[0m02:45:07.730434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.731243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.731579 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:45:07.731915 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_toll_station_station_id.7201f48e61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    station_id as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_toll_station"
where station_id is not null
group by station_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:45:07.735295 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:45:07.736846 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: ROLLBACK
[0m02:45:07.737771 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_toll_station_station_id.7201f48e61'
[0m02:45:07.738114 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: Close
[0m02:45:07.739679 [info ] [Thread-1 (]: 13 of 15 PASS unique_stg_toll_station_station_id ............................... [[32mPASS[0m in 0.02s]
[0m02:45:07.740229 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:45:07.740622 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:45:07.741022 [info ] [Thread-1 (]: 14 of 15 START test unique_stg_toll_transaction_transaction_id ................. [RUN]
[0m02:45:07.741424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_toll_station_station_id.7201f48e61, now test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27)
[0m02:45:07.741769 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:45:07.747346 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:45:07.747965 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:45:07.749872 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:45:07.750405 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:45:07.750746 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: BEGIN
[0m02:45:07.751073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.751874 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.752205 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:45:07.752554 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_toll_transaction"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:45:07.777739 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m02:45:07.779623 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: ROLLBACK
[0m02:45:07.780586 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27'
[0m02:45:07.780933 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: Close
[0m02:45:07.783859 [info ] [Thread-1 (]: 14 of 15 PASS unique_stg_toll_transaction_transaction_id ....................... [[32mPASS[0m in 0.04s]
[0m02:45:07.784391 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:45:07.784746 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:45:07.785131 [info ] [Thread-1 (]: 15 of 15 START test unique_stg_vehicle_type_dict_vehicle_type_code ............. [RUN]
[0m02:45:07.785537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27, now test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd)
[0m02:45:07.785877 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:45:07.789580 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:45:07.790165 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:45:07.792136 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:45:07.792688 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:45:07.793031 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: BEGIN
[0m02:45:07.793370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.794177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.794516 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:45:07.794857 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vehicle_type_code as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_vehicle_type_dict"
where vehicle_type_code is not null
group by vehicle_type_code
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:45:07.797133 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:45:07.798671 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: ROLLBACK
[0m02:45:07.799597 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd'
[0m02:45:07.799935 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: Close
[0m02:45:07.801040 [info ] [Thread-1 (]: 15 of 15 PASS unique_stg_vehicle_type_dict_vehicle_type_code ................... [[32mPASS[0m in 0.02s]
[0m02:45:07.801591 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:45:07.803599 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:07.804401 [debug] [MainThread]: On master: BEGIN
[0m02:45:07.804893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:45:07.805859 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:45:07.806250 [debug] [MainThread]: On master: COMMIT
[0m02:45:07.806646 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:07.807014 [debug] [MainThread]: On master: COMMIT
[0m02:45:07.807686 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:45:07.808080 [debug] [MainThread]: On master: Close
[0m02:45:07.808657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:45:07.809019 [debug] [MainThread]: Connection 'test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd' was properly closed.
[0m02:45:07.809458 [info ] [MainThread]: 
[0m02:45:07.809896 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m02:45:07.813402 [debug] [MainThread]: Command end result
[0m02:45:07.844369 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:45:07.846410 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:45:07.852965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:45:07.853284 [info ] [MainThread]: 
[0m02:45:07.853648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:45:07.853928 [info ] [MainThread]: 
[0m02:45:07.854238 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m02:45:07.855140 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3859557, "process_in_blocks": "0", "process_kernel_time": 0.323683, "process_mem_max_rss": "189624", "process_out_blocks": "3080", "process_user_time": 2.6056}
[0m02:45:07.855563 [debug] [MainThread]: Command `dbt test` succeeded at 02:45:07.855478 after 1.39 seconds
[0m02:45:07.855906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1345af20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d12ed48aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1335961a30>]}
[0m02:45:07.856244 [debug] [MainThread]: Flushing usage events
[0m02:45:09.035570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:12:33.477695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff811dc0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff80e616d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff818e5c40>]}


============================== 03:12:33.482046 | de6b10e5-7f65-4710-9e37-ed8c60706693 ==============================
[0m03:12:33.482046 [info ] [MainThread]: Running with dbt=1.10.13
[0m03:12:33.482575 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/chun/Develop/datacore', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt run --select meta_table_info meta_column_info', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m03:12:33.702472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff80e1f290>]}
[0m03:12:33.767188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff7cb143e0>]}
[0m03:12:33.768918 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:12:33.852134 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m03:12:33.988533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 7 files changed.
[0m03:12:33.989152 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/generate_column_info.sql
[0m03:12:33.989479 [debug] [MainThread]: Partial parsing: added file: datacore://models/metadata/meta_column_info.sql
[0m03:12:33.990246 [debug] [MainThread]: Partial parsing: updated file: datacore://models/staging/schema.yml
[0m03:12:33.990796 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/schema.yml
[0m03:12:33.991442 [debug] [MainThread]: Partial parsing: updated file: datacore://models/dws/schema.yml
[0m03:12:33.991936 [debug] [MainThread]: Partial parsing: updated file: datacore://models/ods/schema.yml
[0m03:12:33.992555 [debug] [MainThread]: Partial parsing: updated file: datacore://models/ads/schema.yml
[0m03:12:33.993042 [debug] [MainThread]: Partial parsing: updated file: datacore://models/dwd/schema.yml
[0m03:12:33.993434 [debug] [MainThread]: Partial parsing: updated file: datacore://macros/metadata/generate_table_info.sql
[0m03:12:34.645290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff70037ef0>]}
[0m03:12:34.754035 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:12:34.756088 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:12:34.770148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff7009adb0>]}
[0m03:12:34.770618 [info ] [MainThread]: Found 1 seed, 19 models, 15 data tests, 4 sources, 466 macros
[0m03:12:34.770925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff81727890>]}
[0m03:12:34.772649 [info ] [MainThread]: 
[0m03:12:34.772959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:34.773221 [info ] [MainThread]: 
[0m03:12:34.773642 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:12:34.778056 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m03:12:34.813532 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:12:34.813957 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:12:34.814231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:34.833799 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m03:12:34.835261 [debug] [ThreadPool]: On list_datacore: Close
[0m03:12:34.836219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m03:12:34.836625 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m03:12:34.842815 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:12:34.843154 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:12:34.843427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.844610 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.845790 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:12:34.846059 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m03:12:34.846585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:12:34.846839 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:12:34.847099 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m03:12:34.847608 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:12:34.848310 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:12:34.848577 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:12:34.848821 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:12:34.849245 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:12:34.849519 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m03:12:34.852598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_ods)
[0m03:12:34.858972 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:12:34.859365 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m03:12:34.859626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.860370 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.860629 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:12:34.860891 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.872762 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m03:12:34.874089 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m03:12:34.875108 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m03:12:34.875385 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m03:12:34.875935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_staging)
[0m03:12:34.878198 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:12:34.878489 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m03:12:34.878738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.879572 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.879825 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:12:34.880081 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.884254 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:12:34.885533 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m03:12:34.886369 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m03:12:34.886626 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m03:12:34.887164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main)
[0m03:12:34.889907 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:12:34.890201 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m03:12:34.890470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.891044 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.891295 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:12:34.891559 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.896874 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:12:34.898015 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m03:12:34.898844 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m03:12:34.899104 [debug] [ThreadPool]: On list_datacore_main: Close
[0m03:12:34.899671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_dwd)
[0m03:12:34.901273 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:12:34.901550 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m03:12:34.901799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.902382 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.902631 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:12:34.902884 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.906341 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:12:34.907518 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m03:12:34.908339 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m03:12:34.908597 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m03:12:34.909127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_dws)
[0m03:12:34.911142 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:12:34.911431 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m03:12:34.911678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.912239 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.912502 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:12:34.912761 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.916904 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:12:34.918149 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m03:12:34.918966 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m03:12:34.919224 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m03:12:34.919801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_ads)
[0m03:12:34.922272 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:12:34.922556 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m03:12:34.922803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.923592 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.923843 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:12:34.924099 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.927540 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:12:34.928758 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m03:12:34.929551 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m03:12:34.929806 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m03:12:34.930573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_metadata)
[0m03:12:34.933067 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:12:34.933357 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m03:12:34.933605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.934178 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.934437 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:12:34.934692 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.939516 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:12:34.940781 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m03:12:34.941597 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m03:12:34.941853 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m03:12:34.944181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff70f65a30>]}
[0m03:12:34.945071 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:34.945640 [debug] [MainThread]: On master: BEGIN
[0m03:12:34.946159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:34.947384 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:12:34.947914 [debug] [MainThread]: On master: COMMIT
[0m03:12:34.948450 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:34.948959 [debug] [MainThread]: On master: COMMIT
[0m03:12:34.949815 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:12:34.950381 [debug] [MainThread]: On master: Close
[0m03:12:34.953812 [debug] [Thread-1 (]: Began running node model.datacore.meta_column_info
[0m03:12:34.954410 [info ] [Thread-1 (]: 1 of 2 START sql table model main_metadata.meta_column_info .................... [RUN]
[0m03:12:34.954881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now model.datacore.meta_column_info)
[0m03:12:34.955229 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_column_info
[0m03:12:34.965906 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_column_info"
[0m03:12:34.966528 [debug] [Thread-1 (]: Began executing node model.datacore.meta_column_info
[0m03:12:34.997096 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_column_info"
[0m03:12:34.997767 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:12:34.998082 [debug] [Thread-1 (]: On model.datacore.meta_column_info: BEGIN
[0m03:12:34.998386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:34.999207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:34.999513 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:12:35.000366 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_column_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÂ≠óÊÆµ‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®Â≠óÊÆµÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- Â≠óÊÆµ‰∏≠ÊñáÂêç‰ªé schema.yml ÁöÑ columns meta Â≠óÊÆµËé∑Âèñ



SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'schema_name' AS column_name, 'Ê®°ÂºèÂêçÁß∞' AS column_name_cn, 'Ê®°ÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'asset_level' AS column_name, 'ËµÑ‰∫ßÁ≠âÁ∫ßÔºöÊ†∏ÂøÉËµÑ‰∫ß/Â∫îÁî®ËµÑ‰∫ß/Âü∫Á°ÄËµÑ‰∫ß' AS column_name_cn, 'ËµÑ‰∫ßÁ≠âÁ∫ßÔºöÊ†∏ÂøÉËµÑ‰∫ß/Â∫îÁî®ËµÑ‰∫ß/Âü∫Á°ÄËµÑ‰∫ß' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'usage_frequency' AS column_name, '‰ΩøÁî®È¢ëÁéáÔºöÈ´òÈ¢ë/‰∏≠È¢ë/‰ΩéÈ¢ë' AS column_name_cn, '‰ΩøÁî®È¢ëÁéáÔºöÈ´òÈ¢ë/‰∏≠È¢ë/‰ΩéÈ¢ë' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'data_freshness' AS column_name, 'Êï∞ÊçÆÊñ∞È≤úÂ∫¶ÔºöÊñ∞È≤ú/ËæÉÊñ∞/ÈôàÊóß' AS column_name_cn, 'Êï∞ÊçÆÊñ∞È≤úÂ∫¶ÔºöÊñ∞È≤ú/ËæÉÊñ∞/ÈôàÊóß' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'metric_date' AS column_name, 'ÊåáÊ†áÊó•Êúü' AS column_name_cn, 'ÊåáÊ†áÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'overall_quality_score' AS column_name, 'ÁªºÂêàË¥®ÈáèÂæóÂàÜ' AS column_name_cn, 'ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'completeness_rate' AS column_name, 'ÂÆåÊï¥ÊÄßÁéá' AS column_name_cn, 'ÂÆåÊï¥ÊÄßÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'accuracy_rate' AS column_name, 'ÂáÜÁ°ÆÁéá' AS column_name_cn, 'ÂáÜÁ°ÆÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'consistency_rate' AS column_name, '‰∏ÄËá¥Áéá' AS column_name_cn, '‰∏ÄËá¥Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_type' AS column_name, 'Â≠óÂÖ∏Á±ªÂûã' AS column_name_cn, 'Â≠óÂÖ∏Á±ªÂûã' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_code' AS column_name, 'Â≠óÂÖ∏ÁºñÁ†Å' AS column_name_cn, 'Â≠óÂÖ∏ÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_name' AS column_name, 'Â≠óÂÖ∏ÂêçÁß∞' AS column_name_cn, 'Â≠óÂÖ∏ÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_desc' AS column_name, 'Â≠óÂÖ∏ÊèèËø∞' AS column_name_cn, 'Â≠óÂÖ∏ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_value' AS column_name, 'Â≠óÂÖ∏ÂÄº' AS column_name_cn, 'Â≠óÂÖ∏ÂÄº' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_source' AS column_name, 'Â≠óÂÖ∏Êù•Ê∫ê' AS column_name_cn, 'Â≠óÂÖ∏Êù•Ê∫ê' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'source_table' AS column_name, 'Ê∫êË°®' AS column_name_cn, 'Ê∫êË°®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'target_table' AS column_name, 'ÁõÆÊ†áË°®' AS column_name_cn, 'ÁõÆÊ†áË°®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'transformation_type' AS column_name, 'ËΩ¨Êç¢Á±ªÂûãÔºöÊ∏ÖÊ¥ó/ÂÖ≥ËÅî/ËΩ¨Êç¢/Ê±áÊÄª/ËÅöÂêà' AS column_name_cn, 'ËΩ¨Êç¢Á±ªÂûãÔºöÊ∏ÖÊ¥ó/ÂÖ≥ËÅî/ËΩ¨Êç¢/Ê±áÊÄª/ËÅöÂêà' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'transformation_desc' AS column_name, 'ËΩ¨Êç¢ÊèèËø∞' AS column_name_cn, 'ËΩ¨Êç¢ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôIDÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'station_name' AS column_name, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_name_cn, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'city' AS column_name, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_name_cn, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'highway_code' AS column_name, 'È´òÈÄüÂÖ¨Ë∑ØÁºñÁ†Å' AS column_name_cn, 'È´òÈÄüÂÖ¨Ë∑ØÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'transaction_id' AS column_name, '‰∫§ÊòìID' AS column_name_cn, '‰∫§ÊòìIDÔºåÂîØ‰∏ÄÊ†áËØÜ‰∏ÄÁ¨î‰∫§Êòì' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'vehicle_plate' AS column_name, 'ËΩ¶ÁâåÂè∑' AS column_name_cn, 'ËΩ¶ÁâåÂè∑ÔºàÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'vehicle_type_code' AS column_name, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_name_cn, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'entry_time' AS column_name, 'ÂÖ•Âè£Êó∂Èó¥' AS column_name_cn, 'ÂÖ•Âè£Êó∂Èó¥' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'exit_time' AS column_name, 'Âá∫Âè£Êó∂Èó¥' AS column_name_cn, 'Âá∫Âè£Êó∂Èó¥ÔºàÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'travel_minutes' AS column_name, 'ÈÄöË°åÊó∂Èïø' AS column_name_cn, 'ÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'toll_amount' AS column_name, 'Â∫îÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Â∫îÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'actual_amount' AS column_name, 'ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'ÂÆûÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºåÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'data_quality_flag' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞ÔºöÊ≠£Â∏∏/Êï∞ÊçÆÁº∫Â§±/Êî∂Ë¥πÁ´ôÁº∫Â§±/ËΩ¶ÁâåÁº∫Â§±/Êó∂Èó¥ÂºÇÂ∏∏/ÈáëÈ¢ùÂºÇÂ∏∏' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'payment_method_code' AS column_name, 'ÊîØ‰ªòÊñπÂºèÁºñÁ†Å' AS column_name_cn, 'ÊîØ‰ªòÊñπÂºèÁºñÁ†ÅÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'payment_method_name' AS column_name, 'ÊîØ‰ªòÊñπÂºèÂêçÁß∞' AS column_name_cn, 'ÊîØ‰ªòÊñπÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'vehicle_type_code' AS column_name, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_name_cn, 'ËΩ¶ÂûãÁºñÁ†ÅÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'vehicle_type_name' AS column_name, 'ËΩ¶ÂûãÂêçÁß∞' AS column_name_cn, 'ËΩ¶ÂûãÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'toll_rate_multiplier' AS column_name, 'Êî∂Ë¥πË¥πÁéáÁ≥ªÊï∞' AS column_name_cn, 'Êî∂Ë¥πË¥πÁéáÁ≥ªÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'schema_name' AS column_name, 'Ê®°ÂºèÂêçÁß∞' AS column_name_cn, 'Ê®°ÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_name_cn' AS column_name, '‰∏≠ÊñáË°®Âêç' AS column_name_cn, '‰∏≠ÊñáË°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_description' AS column_name, 'Ë°®ÊèèËø∞' AS column_name_cn, 'Ë°®ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'business_domain' AS column_name, '‰∏öÂä°Âüü' AS column_name_cn, '‰∏öÂä°Âüü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'data_source' AS column_name, 'Êï∞ÊçÆÊ∫ê' AS column_name_cn, 'Êï∞ÊçÆÊ∫ê' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'update_frequency' AS column_name, 'Êõ¥Êñ∞È¢ëÁéá' AS column_name_cn, 'Êõ¥Êñ∞È¢ëÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'owner' AS column_name, 'Ë¥üË¥£‰∫∫' AS column_name_cn, 'Ë¥üË¥£‰∫∫/ÈÉ®Èó®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'data_layer' AS column_name, 'Êï∞ÊçÆÂàÜÂ±Ç' AS column_name_cn, 'Êï∞ÊçÆÂàÜÂ±Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'total_actual_amount' AS column_name, 'Êó•ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Êó•ÂÆûÊî∂ÈáëÈ¢ùÊ±áÊÄªÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'transaction_count' AS column_name, '‰∫§ÊòìÁ¨îÊï∞' AS column_name_cn, '‰∫§ÊòìÁ¨îÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'vehicle_count' AS column_name, 'ËΩ¶ËæÜÊï∞' AS column_name_cn, 'ËΩ¶ËæÜÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'total_revenue' AS column_name, 'Êó•Êî∂ÂÖ•' AS column_name_cn, 'Êó•Êî∂ÂÖ•ÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'data_quality_rate' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'etc_rate' AS column_name, 'ETC‰ΩøÁî®Áéá' AS column_name_cn, 'ETC‰ΩøÁî®Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'total_vehicles' AS column_name, 'ÊÄªËΩ¶ÊµÅÈáè' AS column_name_cn, 'ÊÄªËΩ¶ÊµÅÈáè' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'unique_vehicles' AS column_name, 'ÂîØ‰∏ÄËΩ¶ËæÜÊï∞' AS column_name_cn, 'ÂîØ‰∏ÄËΩ¶ËæÜÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'time_period' AS column_name, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_name_cn, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'daily_vehicles' AS column_name, 'Êó•ËΩ¶ÊµÅÈáè' AS column_name_cn, 'Êó•ËΩ¶ÊµÅÈáè' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'etc_usage_rate' AS column_name, 'ETC‰ΩøÁî®Áéá' AS column_name_cn, 'ETC‰ΩøÁî®Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'city' AS column_name, 'ÂüéÂ∏Ç' AS column_name_cn, 'ÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'daily_revenue' AS column_name, 'Êó•Êî∂ÂÖ•' AS column_name_cn, 'Êó•Êî∂ÂÖ•ÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'daily_transactions' AS column_name, 'Êó•‰∫§ÊòìÁ¨îÊï∞' AS column_name_cn, 'Êó•‰∫§ÊòìÁ¨îÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'data_quality_rate' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'alert_status' AS column_name, 'ÂëäË≠¶Áä∂ÊÄÅ' AS column_name_cn, 'ÂëäË≠¶Áä∂ÊÄÅÔºöÊ≠£Â∏∏/ÂëäË≠¶' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'transaction_id' AS column_name, '‰∫§ÊòìID' AS column_name_cn, '‰∫§ÊòìID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'station_name' AS column_name, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_name_cn, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'city' AS column_name, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_name_cn, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'vehicle_plate' AS column_name, 'ËΩ¶ÁâåÂè∑' AS column_name_cn, 'ËΩ¶ÁâåÂè∑' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'vehicle_type_name' AS column_name, 'ËΩ¶ÂûãÂêçÁß∞' AS column_name_cn, 'ËΩ¶ÂûãÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'toll_amount' AS column_name, 'Â∫îÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Â∫îÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'actual_amount' AS column_name, 'ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'ÂÆûÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'time_period' AS column_name, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_name_cn, 'Êó∂ÊÆµÂàÜÁ±ªÔºöÊó©È´òÂ≥∞/ÊôöÈ´òÂ≥∞/Âπ≥Â≥∞/Â§úÈó¥' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'day_type' AS column_name, 'Êó•ÊúüÁ±ªÂûã' AS column_name_cn, 'Êó•ÊúüÁ±ªÂûãÔºöÂ∑•‰ΩúÊó•/Âë®Êú´' AS column_description, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m03:12:35.016858 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m03:12:35.022781 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:12:35.023164 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */
alter table "datacore"."main_metadata"."meta_column_info__dbt_tmp" rename to "meta_column_info"
[0m03:12:35.024178 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.037679 [debug] [Thread-1 (]: On model.datacore.meta_column_info: COMMIT
[0m03:12:35.038115 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:12:35.038432 [debug] [Thread-1 (]: On model.datacore.meta_column_info: COMMIT
[0m03:12:35.040522 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:12:35.045520 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:12:35.045879 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

      drop table if exists "datacore"."main_metadata"."meta_column_info__dbt_backup" cascade
    
[0m03:12:35.046570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:12:35.048725 [debug] [Thread-1 (]: On model.datacore.meta_column_info: Close
[0m03:12:35.050700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff29caba70>]}
[0m03:12:35.051277 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main_metadata.meta_column_info ............... [[32mOK[0m in 0.09s]
[0m03:12:35.051799 [debug] [Thread-1 (]: Finished running node model.datacore.meta_column_info
[0m03:12:35.052165 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m03:12:35.052646 [info ] [Thread-1 (]: 2 of 2 START sql table model main_metadata.meta_table_info ..................... [RUN]
[0m03:12:35.053017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_column_info, now model.datacore.meta_table_info)
[0m03:12:35.053345 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m03:12:35.057619 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m03:12:35.058227 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m03:12:35.061054 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m03:12:35.061644 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.061994 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m03:12:35.062345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:35.063376 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.063715 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.064277 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï' AS table_name_cn, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®' AS table_name_cn, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®' AS table_name_cn, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_column_info' AS table_name, 'meta_column_info' AS table_name_cn, '' AS table_description, 'Êú™ÂàÜÁ±ª' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®' AS table_name_cn, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªË°®' AS table_name_cn, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªË°®' AS table_name_cn, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêË°®' AS table_name_cn, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®' AS table_name_cn, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m03:12:35.071246 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m03:12:35.077294 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.077709 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:12:35.078870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.080128 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.080495 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:12:35.081460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.084485 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.084862 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m03:12:35.085656 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:12:35.088179 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.088552 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m03:12:35.089214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:12:35.092573 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:12:35.092955 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.093298 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:12:35.094868 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.097104 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.097470 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m03:12:35.098880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.100178 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m03:12:35.100906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff2a06b020>]}
[0m03:12:35.101521 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main_metadata.meta_table_info ................ [[32mOK[0m in 0.05s]
[0m03:12:35.102066 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m03:12:35.103669 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:35.104288 [debug] [MainThread]: On master: BEGIN
[0m03:12:35.104797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:35.105729 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:12:35.106224 [debug] [MainThread]: On master: COMMIT
[0m03:12:35.106728 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:35.107205 [debug] [MainThread]: On master: COMMIT
[0m03:12:35.107990 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:12:35.108504 [debug] [MainThread]: On master: Close
[0m03:12:35.109182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:35.109662 [debug] [MainThread]: Connection 'model.datacore.meta_table_info' was properly closed.
[0m03:12:35.110231 [info ] [MainThread]: 
[0m03:12:35.110791 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m03:12:35.112115 [debug] [MainThread]: Command end result
[0m03:12:35.161144 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:12:35.162859 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:12:35.168017 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m03:12:35.168325 [info ] [MainThread]: 
[0m03:12:35.168650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:35.168923 [info ] [MainThread]: 
[0m03:12:35.169224 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m03:12:35.170018 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7442186, "process_in_blocks": "1104", "process_kernel_time": 0.232362, "process_mem_max_rss": "161872", "process_out_blocks": "4424", "process_user_time": 2.814394}
[0m03:12:35.170414 [debug] [MainThread]: Command `dbt run` succeeded at 03:12:35.170329 after 1.74 seconds
[0m03:12:35.170725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff8573f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff70d9ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff836099d0>]}
[0m03:12:35.171035 [debug] [MainThread]: Flushing usage events
[0m03:12:36.605126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:14:09.324247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035ad4e6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035aaac0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035ab603bc0>]}


============================== 03:14:09.327870 | d534b6c9-6ee9-4ce7-a897-c32e3b830165 ==============================
[0m03:14:09.327870 [info ] [MainThread]: Running with dbt=1.10.13
[0m03:14:09.328348 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select meta_table_info', 'log_path': '/home/chun/Develop/datacore/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'False'}
[0m03:14:09.531044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035a6720890>]}
[0m03:14:09.591726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035ab0a7080>]}
[0m03:14:09.593924 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:14:09.692464 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m03:14:09.832320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:14:09.833149 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/schema.yml
[0m03:14:09.833480 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/meta_data_lineage.sql
[0m03:14:09.833830 [debug] [MainThread]: Partial parsing: updated file: datacore://macros/metadata/generate_lineage.sql
[0m03:14:10.221762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035981b6de0>]}
[0m03:14:10.422817 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:14:10.424773 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:14:10.439314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035980f4b90>]}
[0m03:14:10.439854 [info ] [MainThread]: Found 1 seed, 19 models, 15 data tests, 4 sources, 466 macros
[0m03:14:10.440165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035aefdbd70>]}
[0m03:14:10.441774 [info ] [MainThread]: 
[0m03:14:10.442091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:14:10.442367 [info ] [MainThread]: 
[0m03:14:10.442814 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:14:10.444027 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m03:14:10.484157 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:14:10.484552 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:14:10.484825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:14:10.504436 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m03:14:10.505777 [debug] [ThreadPool]: On list_datacore: Close
[0m03:14:10.506483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m03:14:10.506874 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m03:14:10.512916 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:14:10.513230 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:14:10.513501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.514823 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.515929 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:14:10.516206 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m03:14:10.516644 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:14:10.516894 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:14:10.517145 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m03:14:10.517602 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:14:10.518289 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:14:10.518566 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:14:10.518816 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:14:10.519203 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:14:10.519473 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m03:14:10.526260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_metadata)
[0m03:14:10.535319 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:14:10.535868 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m03:14:10.536363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.537446 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.537931 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:14:10.538444 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.553296 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m03:14:10.554589 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m03:14:10.555576 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m03:14:10.555848 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m03:14:10.556385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main)
[0m03:14:10.559667 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:14:10.559952 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m03:14:10.560195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.560759 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.561009 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:14:10.561266 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.564602 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:14:10.565654 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m03:14:10.566434 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m03:14:10.566688 [debug] [ThreadPool]: On list_datacore_main: Close
[0m03:14:10.567207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ods)
[0m03:14:10.570111 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:14:10.570440 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m03:14:10.570693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.571408 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.571668 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:14:10.571930 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.577854 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m03:14:10.579024 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m03:14:10.579811 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m03:14:10.580071 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m03:14:10.580625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_ads)
[0m03:14:10.582815 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:14:10.583106 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m03:14:10.583363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.583940 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.584196 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:14:10.584467 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.588329 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:14:10.589489 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m03:14:10.590254 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m03:14:10.590700 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m03:14:10.591232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_staging)
[0m03:14:10.593552 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:14:10.593832 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m03:14:10.594076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.594621 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.594874 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:14:10.595133 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.599228 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:14:10.600410 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m03:14:10.601187 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m03:14:10.601447 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m03:14:10.602228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_dws)
[0m03:14:10.605084 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:14:10.605372 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m03:14:10.605616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.606164 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.606423 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:14:10.606683 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.610072 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:14:10.611224 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m03:14:10.612013 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m03:14:10.612266 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m03:14:10.612784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_dwd)
[0m03:14:10.615334 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:14:10.615623 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m03:14:10.615868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.616476 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.616730 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:14:10.616985 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.620292 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:14:10.621537 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m03:14:10.622341 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m03:14:10.622598 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m03:14:10.623707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70359805ad50>]}
[0m03:14:10.624596 [debug] [MainThread]: Using duckdb connection "master"
[0m03:14:10.625119 [debug] [MainThread]: On master: BEGIN
[0m03:14:10.625649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:14:10.626698 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:14:10.627241 [debug] [MainThread]: On master: COMMIT
[0m03:14:10.627803 [debug] [MainThread]: Using duckdb connection "master"
[0m03:14:10.628333 [debug] [MainThread]: On master: COMMIT
[0m03:14:10.629202 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:14:10.629766 [debug] [MainThread]: On master: Close
[0m03:14:10.633339 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m03:14:10.634252 [info ] [Thread-1 (]: 1 of 1 START sql table model main_metadata.meta_table_info ..................... [RUN]
[0m03:14:10.634999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now model.datacore.meta_table_info)
[0m03:14:10.635617 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m03:14:10.667898 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m03:14:10.668632 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m03:14:10.702018 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m03:14:10.702778 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.703147 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m03:14:10.703508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:10.704380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.704733 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.705296 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï' AS table_name_cn, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®' AS table_name_cn, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_column_info' AS table_name, 'meta_column_info' AS table_name_cn, '' AS table_description, 'Êú™ÂàÜÁ±ª' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®' AS table_name_cn, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªË°®' AS table_name_cn, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªË°®' AS table_name_cn, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêË°®' AS table_name_cn, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®' AS table_name_cn, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆÊ∫ØÊ∫êÂÖ≥Á≥ªË°®' AS table_name_cn, 'Êï∞ÊçÆÊ∫ØÊ∫êÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑÊ∫ØÊ∫êÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m03:14:10.713620 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m03:14:10.719689 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.720091 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:14:10.721236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.722475 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.722833 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:14:10.723864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.730373 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.730836 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m03:14:10.731768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.735994 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.736406 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m03:14:10.737362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.752624 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:14:10.753103 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.753469 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:14:10.755546 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:14:10.761849 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.762318 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m03:14:10.763962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.766319 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m03:14:10.768488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703558575340>]}
[0m03:14:10.769096 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_metadata.meta_table_info ................ [[32mOK[0m in 0.13s]
[0m03:14:10.769666 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m03:14:10.771161 [debug] [MainThread]: Using duckdb connection "master"
[0m03:14:10.771970 [debug] [MainThread]: On master: BEGIN
[0m03:14:10.772547 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:14:10.773740 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:14:10.774297 [debug] [MainThread]: On master: COMMIT
[0m03:14:10.774869 [debug] [MainThread]: Using duckdb connection "master"
[0m03:14:10.775424 [debug] [MainThread]: On master: COMMIT
[0m03:14:10.776346 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:14:10.776911 [debug] [MainThread]: On master: Close
[0m03:14:10.777711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:14:10.778227 [debug] [MainThread]: Connection 'model.datacore.meta_table_info' was properly closed.
[0m03:14:10.778812 [info ] [MainThread]: 
[0m03:14:10.779445 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m03:14:10.780679 [debug] [MainThread]: Command end result
[0m03:14:10.830579 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:14:10.832425 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:14:10.837559 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m03:14:10.837857 [info ] [MainThread]: 
[0m03:14:10.838215 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:14:10.838497 [info ] [MainThread]: 
[0m03:14:10.838797 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:14:10.839617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5676045, "process_in_blocks": "0", "process_kernel_time": 0.246135, "process_mem_max_rss": "160004", "process_out_blocks": "4168", "process_user_time": 2.597876}
[0m03:14:10.840014 [debug] [MainThread]: Command `dbt run` succeeded at 03:14:10.839931 after 1.57 seconds
[0m03:14:10.840352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035aa9dffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035aa9959d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035aa995490>]}
[0m03:14:10.840673 [debug] [MainThread]: Flushing usage events
[0m03:14:11.976048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:23:31.395942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9357923e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9356e5ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9357ee5430>]}


============================== 07:23:31.400547 | 00778916-211f-47a8-8934-7694728b51a4 ==============================
[0m07:23:31.400547 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:23:31.400974 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'quiet': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'invocation_command': 'dbt list metrics', 'empty': 'None', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m07:23:31.411428 [info ] [MainThread]: dbt version: 1.10.13
[0m07:23:31.411763 [info ] [MainThread]: python version: 3.12.3
[0m07:23:31.412004 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:23:31.412239 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:23:31.511314 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:23:31.511710 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:23:31.511950 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:23:31.513047 [info ] [MainThread]: adapter type: duckdb
[0m07:23:31.513289 [info ] [MainThread]: adapter version: 1.10.0
[0m07:23:31.609708 [info ] [MainThread]: Configuration:
[0m07:23:31.610131 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:23:31.610385 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:23:31.610619 [info ] [MainThread]: Required dependencies:
[0m07:23:31.610879 [debug] [MainThread]: Executing "git --help"
[0m07:23:31.613870 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:23:31.614537 [debug] [MainThread]: STDERR: "b''"
[0m07:23:31.614956 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:23:31.615348 [info ] [MainThread]: Connection:
[0m07:23:31.615775 [info ] [MainThread]:   database: datacore
[0m07:23:31.616157 [info ] [MainThread]:   schema: main
[0m07:23:31.616573 [info ] [MainThread]:   path: datacore.duckdb
[0m07:23:31.616915 [info ] [MainThread]:   config_options: None
[0m07:23:31.617168 [info ] [MainThread]:   extensions: None
[0m07:23:31.617430 [info ] [MainThread]:   settings: {}
[0m07:23:31.617686 [info ] [MainThread]:   external_root: .
[0m07:23:31.617938 [info ] [MainThread]:   use_credential_provider: None
[0m07:23:31.618193 [info ] [MainThread]:   attach: None
[0m07:23:31.618452 [info ] [MainThread]:   filesystems: None
[0m07:23:31.618702 [info ] [MainThread]:   remote: None
[0m07:23:31.618951 [info ] [MainThread]:   plugins: None
[0m07:23:31.619203 [info ] [MainThread]:   disable_transactions: False
[0m07:23:31.619607 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:23:31.724748 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:23:31.751300 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:23:31.751719 [debug] [MainThread]: On debug: select 1 as id
[0m07:23:31.752027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:23:31.771129 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m07:23:31.772189 [debug] [MainThread]: On debug: Close
[0m07:23:31.772590 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:23:31.772865 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:23:31.773722 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42879307, "process_in_blocks": "4472", "process_kernel_time": 0.224179, "process_mem_max_rss": "152536", "process_out_blocks": "32", "process_user_time": 1.737388}
[0m07:23:31.774162 [debug] [MainThread]: Command `cli debug` succeeded at 07:23:31.774071 after 0.43 seconds
[0m07:23:31.774458 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:23:31.774776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9356e3aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d935726f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9355e2f6e0>]}
[0m07:23:31.775155 [debug] [MainThread]: Flushing usage events
[0m07:23:33.609527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:24:00.511359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f11ae1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0f238cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0f23bd40>]}


============================== 07:24:00.515385 | 3077ae62-f28a-4b5d-9377-9da1f2c77b87 ==============================
[0m07:24:00.515385 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:24:00.515851 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'quiet': 'False', 'log_format': 'default', 'empty': 'None', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt parse --profiles-dir .', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m07:24:00.721496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3077ae62-f28a-4b5d-9377-9da1f2c77b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0f2f6ae0>]}
[0m07:24:00.779001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3077ae62-f28a-4b5d-9377-9da1f2c77b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0f027920>]}
[0m07:24:00.780564 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:24:00.861576 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m07:24:01.015533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m07:24:01.016228 [debug] [MainThread]: Partial parsing: added file: datacore://models/metrics.yml
[0m07:24:01.016738 [debug] [MainThread]: Partial parsing: updated file: datacore://models/dws/schema.yml
[0m07:24:01.017088 [debug] [MainThread]: Partial parsing: updated file: datacore://macros/metadata/README.md
[0m07:24:01.164701 [error] [MainThread]: Encountered an error:
Parsing Error in metric normal_transaction_rate (models/metrics.yml)
  The metric `normal_transaction_count` does not exist but was referenced.
[0m07:24:01.165983 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.70703304, "process_in_blocks": "3312", "process_kernel_time": 0.190114, "process_mem_max_rss": "137432", "process_out_blocks": "8", "process_user_time": 1.712031}
[0m07:24:01.166454 [debug] [MainThread]: Command `dbt parse` failed at 07:24:01.166360 after 0.71 seconds
[0m07:24:01.166828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0f25d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0ef797c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1f0ef7b680>]}
[0m07:24:01.167178 [debug] [MainThread]: Flushing usage events
[0m07:24:02.658510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:28:21.881407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7447a337be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7447a396b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7447a4a796d0>]}


============================== 07:28:21.884459 | 63982d84-bfe3-4aed-ade2-bc8bb9364cb5 ==============================
[0m07:28:21.884459 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:28:21.884879 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt list metrics', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'printer_width': '80', 'log_path': '/home/chun/Develop/datacore/logs', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None'}
[0m07:28:21.892208 [info ] [MainThread]: dbt version: 1.10.13
[0m07:28:21.892565 [info ] [MainThread]: python version: 3.12.3
[0m07:28:21.892806 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:28:21.893044 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:28:21.997413 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:28:21.997788 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:28:21.998032 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:28:21.999118 [info ] [MainThread]: adapter type: duckdb
[0m07:28:21.999385 [info ] [MainThread]: adapter version: 1.10.0
[0m07:28:22.104645 [info ] [MainThread]: Configuration:
[0m07:28:22.105059 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:28:22.105332 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:28:22.105587 [info ] [MainThread]: Required dependencies:
[0m07:28:22.105858 [debug] [MainThread]: Executing "git --help"
[0m07:28:22.108869 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:28:22.109515 [debug] [MainThread]: STDERR: "b''"
[0m07:28:22.109884 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:28:22.110233 [info ] [MainThread]: Connection:
[0m07:28:22.110540 [info ] [MainThread]:   database: datacore
[0m07:28:22.110767 [info ] [MainThread]:   schema: main
[0m07:28:22.110992 [info ] [MainThread]:   path: datacore.duckdb
[0m07:28:22.111218 [info ] [MainThread]:   config_options: None
[0m07:28:22.111450 [info ] [MainThread]:   extensions: None
[0m07:28:22.111677 [info ] [MainThread]:   settings: {}
[0m07:28:22.111903 [info ] [MainThread]:   external_root: .
[0m07:28:22.112126 [info ] [MainThread]:   use_credential_provider: None
[0m07:28:22.112356 [info ] [MainThread]:   attach: None
[0m07:28:22.112578 [info ] [MainThread]:   filesystems: None
[0m07:28:22.112799 [info ] [MainThread]:   remote: None
[0m07:28:22.113020 [info ] [MainThread]:   plugins: None
[0m07:28:22.113243 [info ] [MainThread]:   disable_transactions: False
[0m07:28:22.113641 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:28:22.215871 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:28:22.237836 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:28:22.238241 [debug] [MainThread]: On debug: select 1 as id
[0m07:28:22.238510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:28:22.256222 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m07:28:22.257271 [debug] [MainThread]: On debug: Close
[0m07:28:22.257628 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:28:22.257882 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:28:22.258704 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4282023, "process_in_blocks": "0", "process_kernel_time": 0.205744, "process_mem_max_rss": "153248", "process_out_blocks": "32", "process_user_time": 1.70089}
[0m07:28:22.259116 [debug] [MainThread]: Command `cli debug` succeeded at 07:28:22.259031 after 0.43 seconds
[0m07:28:22.259400 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:28:22.259696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7447a3204f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7447a269abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7447a286e930>]}
[0m07:28:22.260046 [debug] [MainThread]: Flushing usage events
[0m07:28:23.750363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:28:26.642606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af1843e4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af184d89a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af1843750a0>]}


============================== 07:28:26.645979 | ef896f99-c066-4a93-b9ae-350dae49fe59 ==============================
[0m07:28:26.645979 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:28:26.646402 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'debug': 'False', 'empty': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'target_path': 'None', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'invocation_command': 'dbt list metrics', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'introspect': 'True'}
[0m07:28:26.653243 [info ] [MainThread]: dbt version: 1.10.13
[0m07:28:26.653547 [info ] [MainThread]: python version: 3.12.3
[0m07:28:26.653784 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:28:26.654017 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:28:26.751624 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:28:26.751992 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:28:26.752230 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:28:26.753283 [info ] [MainThread]: adapter type: duckdb
[0m07:28:26.753528 [info ] [MainThread]: adapter version: 1.10.0
[0m07:28:26.848770 [info ] [MainThread]: Configuration:
[0m07:28:26.849155 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:28:26.849403 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:28:26.849636 [info ] [MainThread]: Required dependencies:
[0m07:28:26.849883 [debug] [MainThread]: Executing "git --help"
[0m07:28:26.853096 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:28:26.853690 [debug] [MainThread]: STDERR: "b''"
[0m07:28:26.853961 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:28:26.854208 [info ] [MainThread]: Connection:
[0m07:28:26.854472 [info ] [MainThread]:   database: datacore
[0m07:28:26.854698 [info ] [MainThread]:   schema: main
[0m07:28:26.854922 [info ] [MainThread]:   path: datacore.duckdb
[0m07:28:26.855145 [info ] [MainThread]:   config_options: None
[0m07:28:26.855373 [info ] [MainThread]:   extensions: None
[0m07:28:26.855597 [info ] [MainThread]:   settings: {}
[0m07:28:26.855821 [info ] [MainThread]:   external_root: .
[0m07:28:26.856039 [info ] [MainThread]:   use_credential_provider: None
[0m07:28:26.856260 [info ] [MainThread]:   attach: None
[0m07:28:26.856487 [info ] [MainThread]:   filesystems: None
[0m07:28:26.856707 [info ] [MainThread]:   remote: None
[0m07:28:26.856925 [info ] [MainThread]:   plugins: None
[0m07:28:26.857143 [info ] [MainThread]:   disable_transactions: False
[0m07:28:26.857532 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:28:26.958475 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:28:26.979690 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:28:26.980085 [debug] [MainThread]: On debug: select 1 as id
[0m07:28:26.980352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:28:26.998236 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m07:28:26.999290 [debug] [MainThread]: On debug: Close
[0m07:28:26.999665 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:28:26.999922 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:28:27.000766 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.40932745, "process_in_blocks": "0", "process_kernel_time": 0.206687, "process_mem_max_rss": "153152", "process_out_blocks": "16", "process_user_time": 1.662487}
[0m07:28:27.001169 [debug] [MainThread]: Command `cli debug` succeeded at 07:28:27.001086 after 0.41 seconds
[0m07:28:27.001455 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:28:27.001749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af1840fadb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af183fabe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af183fab6e0>]}
[0m07:28:27.002107 [debug] [MainThread]: Flushing usage events
[0m07:28:28.112894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:29:37.045232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a775d9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a762917f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a772f5c40>]}


============================== 07:29:37.048118 | da54d47e-06c7-4e41-8a87-cc68f0514410 ==============================
[0m07:29:37.048118 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:29:37.048544 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'target_path': 'None', 'empty': 'None', 'version_check': 'True', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'warn_error': 'None', 'quiet': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt list metrics', 'printer_width': '80', 'indirect_selection': 'eager'}
[0m07:29:37.055392 [info ] [MainThread]: dbt version: 1.10.13
[0m07:29:37.055708 [info ] [MainThread]: python version: 3.12.3
[0m07:29:37.055948 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:29:37.056182 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:29:37.154800 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:29:37.155172 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:29:37.155420 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:29:37.156476 [info ] [MainThread]: adapter type: duckdb
[0m07:29:37.156716 [info ] [MainThread]: adapter version: 1.10.0
[0m07:29:37.251968 [info ] [MainThread]: Configuration:
[0m07:29:37.252364 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:29:37.252605 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:29:37.252836 [info ] [MainThread]: Required dependencies:
[0m07:29:37.253086 [debug] [MainThread]: Executing "git --help"
[0m07:29:37.256059 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:29:37.256741 [debug] [MainThread]: STDERR: "b''"
[0m07:29:37.257107 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:29:37.257410 [info ] [MainThread]: Connection:
[0m07:29:37.257658 [info ] [MainThread]:   database: datacore
[0m07:29:37.257881 [info ] [MainThread]:   schema: main
[0m07:29:37.258100 [info ] [MainThread]:   path: datacore.duckdb
[0m07:29:37.258327 [info ] [MainThread]:   config_options: None
[0m07:29:37.258547 [info ] [MainThread]:   extensions: None
[0m07:29:37.258767 [info ] [MainThread]:   settings: {}
[0m07:29:37.258987 [info ] [MainThread]:   external_root: .
[0m07:29:37.259205 [info ] [MainThread]:   use_credential_provider: None
[0m07:29:37.259432 [info ] [MainThread]:   attach: None
[0m07:29:37.259649 [info ] [MainThread]:   filesystems: None
[0m07:29:37.259866 [info ] [MainThread]:   remote: None
[0m07:29:37.260082 [info ] [MainThread]:   plugins: None
[0m07:29:37.260308 [info ] [MainThread]:   disable_transactions: False
[0m07:29:37.260688 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:29:37.361045 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:29:37.382269 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:29:37.382679 [debug] [MainThread]: On debug: select 1 as id
[0m07:29:37.382938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:37.401095 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m07:29:37.402236 [debug] [MainThread]: On debug: Close
[0m07:29:37.402642 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:29:37.402919 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:29:37.403826 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41434056, "process_in_blocks": "0", "process_kernel_time": 0.207512, "process_mem_max_rss": "152644", "process_out_blocks": "24", "process_user_time": 1.773834}
[0m07:29:37.404254 [debug] [MainThread]: Command `cli debug` succeeded at 07:29:37.404166 after 0.41 seconds
[0m07:29:37.404559 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:29:37.404871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a775f9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a662aab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769a76228cb0>]}
[0m07:29:37.405237 [debug] [MainThread]: Flushing usage events
[0m07:29:38.574535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:31:30.137094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f35bb17fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f35ad8dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f35c5dc2f0>]}


============================== 07:31:30.140516 | fd0f79fb-234f-46a8-a6cd-3195d6dbbeba ==============================
[0m07:31:30.140516 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:31:30.140932 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt list metrics', 'indirect_selection': 'eager', 'warn_error': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'empty': 'None', 'version_check': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'cache_selected_only': 'False', 'static_parser': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'quiet': 'True', 'printer_width': '80'}
[0m07:31:30.148123 [info ] [MainThread]: dbt version: 1.10.13
[0m07:31:30.148440 [info ] [MainThread]: python version: 3.12.3
[0m07:31:30.148677 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:31:30.148908 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:31:30.248879 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:31:30.249273 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:31:30.249523 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:31:30.250620 [info ] [MainThread]: adapter type: duckdb
[0m07:31:30.250859 [info ] [MainThread]: adapter version: 1.10.0
[0m07:31:30.348440 [info ] [MainThread]: Configuration:
[0m07:31:30.348852 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:31:30.349092 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:31:30.349327 [info ] [MainThread]: Required dependencies:
[0m07:31:30.349579 [debug] [MainThread]: Executing "git --help"
[0m07:31:30.352078 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:31:30.352648 [debug] [MainThread]: STDERR: "b''"
[0m07:31:30.352947 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:31:30.353215 [info ] [MainThread]: Connection:
[0m07:31:30.353495 [info ] [MainThread]:   database: datacore
[0m07:31:30.353744 [info ] [MainThread]:   schema: main
[0m07:31:30.353987 [info ] [MainThread]:   path: datacore.duckdb
[0m07:31:30.354227 [info ] [MainThread]:   config_options: None
[0m07:31:30.354480 [info ] [MainThread]:   extensions: None
[0m07:31:30.354722 [info ] [MainThread]:   settings: {}
[0m07:31:30.354969 [info ] [MainThread]:   external_root: .
[0m07:31:30.355210 [info ] [MainThread]:   use_credential_provider: None
[0m07:31:30.355463 [info ] [MainThread]:   attach: None
[0m07:31:30.355703 [info ] [MainThread]:   filesystems: None
[0m07:31:30.355943 [info ] [MainThread]:   remote: None
[0m07:31:30.356183 [info ] [MainThread]:   plugins: None
[0m07:31:30.356435 [info ] [MainThread]:   disable_transactions: False
[0m07:31:30.356831 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:31:30.458079 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:31:30.478843 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:31:30.479206 [debug] [MainThread]: On debug: select 1 as id
[0m07:31:30.479467 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:30.497257 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m07:31:30.498218 [debug] [MainThread]: On debug: Close
[0m07:31:30.498584 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:31:30.498833 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:31:30.499604 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41337636, "process_in_blocks": "0", "process_kernel_time": 0.216984, "process_mem_max_rss": "153184", "process_out_blocks": "32", "process_user_time": 1.69188}
[0m07:31:30.499985 [debug] [MainThread]: Command `cli debug` succeeded at 07:31:30.499904 after 0.41 seconds
[0m07:31:30.500249 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:31:30.500544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f35a070ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f35ac8bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f35f7b3440>]}
[0m07:31:30.500871 [debug] [MainThread]: Flushing usage events
[0m07:31:31.631971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:31:44.229649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250eb4033e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250eb4026c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250eb402f00>]}


============================== 07:31:44.233131 | bf443689-d26e-4986-8731-d41f98f25ad2 ==============================
[0m07:31:44.233131 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:31:44.233569 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'log_format': 'default', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'True', 'introspect': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'invocation_command': 'dbt query --metrics daily_revenue --group-by city,transaction_date --start-time 2025-11-01 --end-time 2025-11-29 --explain', 'static_parser': 'True'}
[0m07:31:44.240524 [info ] [MainThread]: dbt version: 1.10.13
[0m07:31:44.240816 [info ] [MainThread]: python version: 3.12.3
[0m07:31:44.241059 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:31:44.241291 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:31:44.341010 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:31:44.341395 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:31:44.341635 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:31:44.342691 [info ] [MainThread]: adapter type: duckdb
[0m07:31:44.342938 [info ] [MainThread]: adapter version: 1.10.0
[0m07:31:44.438589 [info ] [MainThread]: Configuration:
[0m07:31:44.438967 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:31:44.439208 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:31:44.439446 [info ] [MainThread]: Required dependencies:
[0m07:31:44.439694 [debug] [MainThread]: Executing "git --help"
[0m07:31:44.442781 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:31:44.443614 [debug] [MainThread]: STDERR: "b''"
[0m07:31:44.443978 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:31:44.444326 [info ] [MainThread]: Connection:
[0m07:31:44.444670 [info ] [MainThread]:   database: datacore
[0m07:31:44.444987 [info ] [MainThread]:   schema: main
[0m07:31:44.445321 [info ] [MainThread]:   path: datacore.duckdb
[0m07:31:44.445635 [info ] [MainThread]:   config_options: None
[0m07:31:44.445945 [info ] [MainThread]:   extensions: None
[0m07:31:44.446257 [info ] [MainThread]:   settings: {}
[0m07:31:44.446581 [info ] [MainThread]:   external_root: .
[0m07:31:44.446888 [info ] [MainThread]:   use_credential_provider: None
[0m07:31:44.447197 [info ] [MainThread]:   attach: None
[0m07:31:44.447515 [info ] [MainThread]:   filesystems: None
[0m07:31:44.447822 [info ] [MainThread]:   remote: None
[0m07:31:44.448129 [info ] [MainThread]:   plugins: None
[0m07:31:44.448449 [info ] [MainThread]:   disable_transactions: False
[0m07:31:44.448895 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:31:44.550222 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:31:44.571725 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:31:44.572119 [debug] [MainThread]: On debug: select 1 as id
[0m07:31:44.572384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:44.579410 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m07:31:44.579774 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m07:31:44.580110 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m07:31:44.580364 [info ] [MainThread]: [31m1 check failed:[0m
[0m07:31:44.580601 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 331140) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m07:31:44.581384 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.40277553, "process_in_blocks": "1032", "process_kernel_time": 0.196119, "process_mem_max_rss": "149276", "process_out_blocks": "24", "process_user_time": 1.695034}
[0m07:31:44.581780 [debug] [MainThread]: Command `cli debug` failed at 07:31:44.581699 after 0.40 seconds
[0m07:31:44.582060 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:31:44.582350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250eb403b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250eb2941d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250eda381d0>]}
[0m07:31:44.582707 [debug] [MainThread]: Flushing usage events
[0m07:31:45.708340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:31:48.397060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ec86493fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ec856300b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ec86048620>]}


============================== 07:31:48.400500 | db6572b5-06dd-4d81-9767-688e6bd2b098 ==============================
[0m07:31:48.400500 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:31:48.400968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt list metrics', 'log_path': '/home/chun/Develop/datacore/logs', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'no_print': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'True', 'empty': 'None', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m07:31:48.408808 [info ] [MainThread]: dbt version: 1.10.13
[0m07:31:48.409134 [info ] [MainThread]: python version: 3.12.3
[0m07:31:48.409405 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:31:48.409665 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:31:48.510405 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:31:48.510811 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:31:48.511079 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:31:48.512223 [info ] [MainThread]: adapter type: duckdb
[0m07:31:48.512481 [info ] [MainThread]: adapter version: 1.10.0
[0m07:31:48.608806 [info ] [MainThread]: Configuration:
[0m07:31:48.609226 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:31:48.609503 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:31:48.609747 [info ] [MainThread]: Required dependencies:
[0m07:31:48.610017 [debug] [MainThread]: Executing "git --help"
[0m07:31:48.612579 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:31:48.613093 [debug] [MainThread]: STDERR: "b''"
[0m07:31:48.613398 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:31:48.613663 [info ] [MainThread]: Connection:
[0m07:31:48.613932 [info ] [MainThread]:   database: datacore
[0m07:31:48.614177 [info ] [MainThread]:   schema: main
[0m07:31:48.614435 [info ] [MainThread]:   path: datacore.duckdb
[0m07:31:48.614678 [info ] [MainThread]:   config_options: None
[0m07:31:48.614922 [info ] [MainThread]:   extensions: None
[0m07:31:48.615179 [info ] [MainThread]:   settings: {}
[0m07:31:48.615435 [info ] [MainThread]:   external_root: .
[0m07:31:48.615674 [info ] [MainThread]:   use_credential_provider: None
[0m07:31:48.615915 [info ] [MainThread]:   attach: None
[0m07:31:48.616152 [info ] [MainThread]:   filesystems: None
[0m07:31:48.616400 [info ] [MainThread]:   remote: None
[0m07:31:48.616638 [info ] [MainThread]:   plugins: None
[0m07:31:48.616877 [info ] [MainThread]:   disable_transactions: False
[0m07:31:48.617256 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:31:48.717568 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:31:48.738343 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:31:48.738707 [debug] [MainThread]: On debug: select 1 as id
[0m07:31:48.738962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:48.756749 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m07:31:48.757721 [debug] [MainThread]: On debug: Close
[0m07:31:48.758072 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:31:48.758327 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:31:48.759111 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41798255, "process_in_blocks": "0", "process_kernel_time": 0.21107, "process_mem_max_rss": "153076", "process_out_blocks": "24", "process_user_time": 1.678561}
[0m07:31:48.759496 [debug] [MainThread]: Command `cli debug` succeeded at 07:31:48.759416 after 0.42 seconds
[0m07:31:48.759759 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:31:48.760042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ec860f3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ec74cb29c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ec84a515b0>]}
[0m07:31:48.760377 [debug] [MainThread]: Flushing usage events
[0m07:31:49.930059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:32:40.628703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0573d1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05841f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc057e9bcb0>]}


============================== 07:32:40.632272 | 4121a1c5-fb76-400f-846a-f8a513b9b142 ==============================
[0m07:32:40.632272 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:32:40.632706 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'profiles_dir': '/home/chun/Develop/datacore', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'quiet': 'True', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'printer_width': '80', 'invocation_command': 'dbt query --metrics daily_revenue --group-by city,vehicle_type_name,transaction_date --start-time 2025-11-01 --end-time 2025-11-29 --explain', 'version_check': 'True', 'target_path': 'None', 'no_print': 'None', 'introspect': 'True', 'write_json': 'True'}
[0m07:32:40.639576 [info ] [MainThread]: dbt version: 1.10.13
[0m07:32:40.639870 [info ] [MainThread]: python version: 3.12.3
[0m07:32:40.640116 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:32:40.640358 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:32:40.737710 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:32:40.738097 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:32:40.738342 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:32:40.739381 [info ] [MainThread]: adapter type: duckdb
[0m07:32:40.739622 [info ] [MainThread]: adapter version: 1.10.0
[0m07:32:40.835248 [info ] [MainThread]: Configuration:
[0m07:32:40.835641 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:32:40.835882 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:32:40.836113 [info ] [MainThread]: Required dependencies:
[0m07:32:40.836378 [debug] [MainThread]: Executing "git --help"
[0m07:32:40.839420 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:32:40.840169 [debug] [MainThread]: STDERR: "b''"
[0m07:32:40.840548 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:32:40.840886 [info ] [MainThread]: Connection:
[0m07:32:40.841206 [info ] [MainThread]:   database: datacore
[0m07:32:40.841439 [info ] [MainThread]:   schema: main
[0m07:32:40.841663 [info ] [MainThread]:   path: datacore.duckdb
[0m07:32:40.841887 [info ] [MainThread]:   config_options: None
[0m07:32:40.842110 [info ] [MainThread]:   extensions: None
[0m07:32:40.842340 [info ] [MainThread]:   settings: {}
[0m07:32:40.842565 [info ] [MainThread]:   external_root: .
[0m07:32:40.842786 [info ] [MainThread]:   use_credential_provider: None
[0m07:32:40.843009 [info ] [MainThread]:   attach: None
[0m07:32:40.843226 [info ] [MainThread]:   filesystems: None
[0m07:32:40.843451 [info ] [MainThread]:   remote: None
[0m07:32:40.843667 [info ] [MainThread]:   plugins: None
[0m07:32:40.843885 [info ] [MainThread]:   disable_transactions: False
[0m07:32:40.844268 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:32:40.945316 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:32:40.966570 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:32:40.966971 [debug] [MainThread]: On debug: select 1 as id
[0m07:32:40.967238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:32:40.972976 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m07:32:40.973361 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m07:32:40.973694 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m07:32:40.973942 [info ] [MainThread]: [31m1 check failed:[0m
[0m07:32:40.974179 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 331140) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m07:32:40.974962 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.3975958, "process_in_blocks": "0", "process_kernel_time": 0.20797, "process_mem_max_rss": "149668", "process_out_blocks": "32", "process_user_time": 1.701758}
[0m07:32:40.975376 [debug] [MainThread]: Command `cli debug` failed at 07:32:40.975285 after 0.40 seconds
[0m07:32:40.975663 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:32:40.975947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0577b6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0566bfec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc056459d60>]}
[0m07:32:40.976293 [debug] [MainThread]: Flushing usage events
[0m07:32:42.094971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:32:54.764441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5450666780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5450f22f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5450fb5100>]}


============================== 07:32:54.767597 | 1c516ae7-f0f2-4ad4-9af0-a07ede497364 ==============================
[0m07:32:54.767597 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:32:54.768019 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'target_path': 'None', 'quiet': 'True', 'debug': 'False', 'introspect': 'True', 'empty': 'None', 'write_json': 'True', 'use_colors': 'True', 'invocation_command': 'dbt query --metrics avg_transaction_amount --group-by vehicle_type_name,transaction_date --start-time 2025-11-01 --end-time 2025-11-29 --explain', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_format': 'default', 'profiles_dir': '/home/chun/Develop/datacore', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False'}
[0m07:32:54.775198 [info ] [MainThread]: dbt version: 1.10.13
[0m07:32:54.775527 [info ] [MainThread]: python version: 3.12.3
[0m07:32:54.775762 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:32:54.775989 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:32:54.876164 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:32:54.876568 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:32:54.876818 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:32:54.877924 [info ] [MainThread]: adapter type: duckdb
[0m07:32:54.878169 [info ] [MainThread]: adapter version: 1.10.0
[0m07:32:54.973924 [info ] [MainThread]: Configuration:
[0m07:32:54.974346 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:32:54.974587 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:32:54.974814 [info ] [MainThread]: Required dependencies:
[0m07:32:54.975066 [debug] [MainThread]: Executing "git --help"
[0m07:32:54.978191 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:32:54.978845 [debug] [MainThread]: STDERR: "b''"
[0m07:32:54.979211 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:32:54.979571 [info ] [MainThread]: Connection:
[0m07:32:54.979892 [info ] [MainThread]:   database: datacore
[0m07:32:54.980126 [info ] [MainThread]:   schema: main
[0m07:32:54.980355 [info ] [MainThread]:   path: datacore.duckdb
[0m07:32:54.980575 [info ] [MainThread]:   config_options: None
[0m07:32:54.980796 [info ] [MainThread]:   extensions: None
[0m07:32:54.981020 [info ] [MainThread]:   settings: {}
[0m07:32:54.981243 [info ] [MainThread]:   external_root: .
[0m07:32:54.981551 [info ] [MainThread]:   use_credential_provider: None
[0m07:32:54.981772 [info ] [MainThread]:   attach: None
[0m07:32:54.981990 [info ] [MainThread]:   filesystems: None
[0m07:32:54.982207 [info ] [MainThread]:   remote: None
[0m07:32:54.982433 [info ] [MainThread]:   plugins: None
[0m07:32:54.982652 [info ] [MainThread]:   disable_transactions: False
[0m07:32:54.983008 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:32:55.083672 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:32:55.104514 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:32:55.104892 [debug] [MainThread]: On debug: select 1 as id
[0m07:32:55.105149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:32:55.111229 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m07:32:55.111612 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m07:32:55.111937 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m07:32:55.112181 [info ] [MainThread]: [31m1 check failed:[0m
[0m07:32:55.112426 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 331140) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m07:32:55.113158 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.39964703, "process_in_blocks": "0", "process_kernel_time": 0.218909, "process_mem_max_rss": "149408", "process_out_blocks": "24", "process_user_time": 1.643317}
[0m07:32:55.113535 [debug] [MainThread]: Command `cli debug` failed at 07:32:55.113456 after 0.40 seconds
[0m07:32:55.113806 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:32:55.114082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5450786b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544f821100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fbf8440>]}
[0m07:32:55.114411 [debug] [MainThread]: Flushing usage events
[0m07:32:56.289594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:33:06.606902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4f1dd393d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4f1da081a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4f1e89fe60>]}


============================== 07:33:06.610742 | 4d421efa-a889-4849-9da7-19153c52db96 ==============================
[0m07:33:06.610742 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:33:06.611349 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'quiet': 'True', 'use_colors': 'True', 'version_check': 'True', 'invocation_command': 'dbt query --metrics avg_transaction_amount --group-by payment_method_name,transaction_date --start-time 2025-11-01 --end-time 2025-11-29 --explain', 'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80', 'empty': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'debug': 'False', 'warn_error': 'None', 'introspect': 'True', 'partial_parse': 'True'}
[0m07:33:06.618414 [info ] [MainThread]: dbt version: 1.10.13
[0m07:33:06.618705 [info ] [MainThread]: python version: 3.12.3
[0m07:33:06.618945 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:33:06.619181 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:33:06.716876 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:33:06.717248 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:33:06.717494 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:33:06.718567 [info ] [MainThread]: adapter type: duckdb
[0m07:33:06.718808 [info ] [MainThread]: adapter version: 1.10.0
[0m07:33:06.814628 [info ] [MainThread]: Configuration:
[0m07:33:06.815014 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:33:06.815257 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:33:06.815497 [info ] [MainThread]: Required dependencies:
[0m07:33:06.815751 [debug] [MainThread]: Executing "git --help"
[0m07:33:06.818788 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:33:06.819578 [debug] [MainThread]: STDERR: "b''"
[0m07:33:06.819984 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:33:06.820364 [info ] [MainThread]: Connection:
[0m07:33:06.820738 [info ] [MainThread]:   database: datacore
[0m07:33:06.821084 [info ] [MainThread]:   schema: main
[0m07:33:06.821443 [info ] [MainThread]:   path: datacore.duckdb
[0m07:33:06.821719 [info ] [MainThread]:   config_options: None
[0m07:33:06.821941 [info ] [MainThread]:   extensions: None
[0m07:33:06.822165 [info ] [MainThread]:   settings: {}
[0m07:33:06.822400 [info ] [MainThread]:   external_root: .
[0m07:33:06.822621 [info ] [MainThread]:   use_credential_provider: None
[0m07:33:06.822843 [info ] [MainThread]:   attach: None
[0m07:33:06.823067 [info ] [MainThread]:   filesystems: None
[0m07:33:06.823287 [info ] [MainThread]:   remote: None
[0m07:33:06.823514 [info ] [MainThread]:   plugins: None
[0m07:33:06.823735 [info ] [MainThread]:   disable_transactions: False
[0m07:33:06.824119 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:33:06.925102 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:33:06.946563 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:33:06.946969 [debug] [MainThread]: On debug: select 1 as id
[0m07:33:06.947243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:33:06.953203 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m07:33:06.953667 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m07:33:06.954038 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m07:33:06.954317 [info ] [MainThread]: [31m1 check failed:[0m
[0m07:33:06.954617 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 331140) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m07:33:06.955497 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.40491638, "process_in_blocks": "0", "process_kernel_time": 0.203038, "process_mem_max_rss": "149472", "process_out_blocks": "24", "process_user_time": 1.704327}
[0m07:33:06.955936 [debug] [MainThread]: Command `cli debug` failed at 07:33:06.955846 after 0.41 seconds
[0m07:33:06.956257 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:33:06.956576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4f1e89fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4f1cbc2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4f0cef7b00>]}
[0m07:33:06.956954 [debug] [MainThread]: Flushing usage events
[0m07:33:08.048764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:33:15.330681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4813d5e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48139d4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4813173aa0>]}


============================== 07:33:15.334478 | 96888c11-eb45-4a27-b122-2e01b4e3e824 ==============================
[0m07:33:15.334478 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:33:15.334905 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'quiet': 'True', 'warn_error': 'None', 'invocation_command': 'dbt list metrics', 'log_format': 'default', 'profiles_dir': '/home/chun/Develop/datacore', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'log_path': '/home/chun/Develop/datacore/logs', 'send_anonymous_usage_stats': 'True', 'empty': 'None'}
[0m07:33:15.341844 [info ] [MainThread]: dbt version: 1.10.13
[0m07:33:15.342145 [info ] [MainThread]: python version: 3.12.3
[0m07:33:15.342389 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:33:15.342619 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:33:15.443624 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:33:15.444028 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:33:15.444286 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:33:15.445441 [info ] [MainThread]: adapter type: duckdb
[0m07:33:15.445703 [info ] [MainThread]: adapter version: 1.10.0
[0m07:33:15.549449 [info ] [MainThread]: Configuration:
[0m07:33:15.549869 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:33:15.550127 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:33:15.550382 [info ] [MainThread]: Required dependencies:
[0m07:33:15.550653 [debug] [MainThread]: Executing "git --help"
[0m07:33:15.553299 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:33:15.554036 [debug] [MainThread]: STDERR: "b''"
[0m07:33:15.554308 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:33:15.554552 [info ] [MainThread]: Connection:
[0m07:33:15.554800 [info ] [MainThread]:   database: datacore
[0m07:33:15.555024 [info ] [MainThread]:   schema: main
[0m07:33:15.555245 [info ] [MainThread]:   path: datacore.duckdb
[0m07:33:15.555473 [info ] [MainThread]:   config_options: None
[0m07:33:15.555692 [info ] [MainThread]:   extensions: None
[0m07:33:15.555913 [info ] [MainThread]:   settings: {}
[0m07:33:15.556135 [info ] [MainThread]:   external_root: .
[0m07:33:15.556361 [info ] [MainThread]:   use_credential_provider: None
[0m07:33:15.556588 [info ] [MainThread]:   attach: None
[0m07:33:15.556804 [info ] [MainThread]:   filesystems: None
[0m07:33:15.557024 [info ] [MainThread]:   remote: None
[0m07:33:15.557241 [info ] [MainThread]:   plugins: None
[0m07:33:15.557471 [info ] [MainThread]:   disable_transactions: False
[0m07:33:15.557851 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:33:15.657130 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:33:15.678673 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:33:15.679083 [debug] [MainThread]: On debug: select 1 as id
[0m07:33:15.679355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:33:15.698275 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m07:33:15.699333 [debug] [MainThread]: On debug: Close
[0m07:33:15.699703 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:33:15.699961 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:33:15.700794 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42128834, "process_in_blocks": "0", "process_kernel_time": 0.206005, "process_mem_max_rss": "153064", "process_out_blocks": "32", "process_user_time": 1.720042}
[0m07:33:15.701199 [debug] [MainThread]: Command `cli debug` succeeded at 07:33:15.701116 after 0.42 seconds
[0m07:33:15.701482 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:33:15.701771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4813f96480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48127e96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48133caf00>]}
[0m07:33:15.702114 [debug] [MainThread]: Flushing usage events
[0m07:33:16.908325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:33:28.325536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f42ec47a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f42e3cd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f42f066f00>]}


============================== 07:33:28.329102 | 19ee8c92-d8e7-40d6-93f9-e7685342d455 ==============================
[0m07:33:28.329102 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:33:28.329531 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'True', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt query --metrics avg_transaction_amount --group-by vehicle_type_name,transaction_date --start-time 2025-11-01 --end-time 2025-12-31 --explain', 'target_path': 'None', 'empty': 'None', 'use_colors': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'write_json': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m07:33:28.336402 [info ] [MainThread]: dbt version: 1.10.13
[0m07:33:28.336698 [info ] [MainThread]: python version: 3.12.3
[0m07:33:28.336936 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:33:28.337170 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:33:28.440180 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:33:28.440593 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:33:28.440850 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:33:28.441995 [info ] [MainThread]: adapter type: duckdb
[0m07:33:28.442253 [info ] [MainThread]: adapter version: 1.10.0
[0m07:33:28.547335 [info ] [MainThread]: Configuration:
[0m07:33:28.547748 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:33:28.548011 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:33:28.548261 [info ] [MainThread]: Required dependencies:
[0m07:33:28.548541 [debug] [MainThread]: Executing "git --help"
[0m07:33:28.551318 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:33:28.551677 [debug] [MainThread]: STDERR: "b''"
[0m07:33:28.551942 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:33:28.552200 [info ] [MainThread]: Connection:
[0m07:33:28.552471 [info ] [MainThread]:   database: datacore
[0m07:33:28.552716 [info ] [MainThread]:   schema: main
[0m07:33:28.552958 [info ] [MainThread]:   path: datacore.duckdb
[0m07:33:28.553203 [info ] [MainThread]:   config_options: None
[0m07:33:28.553455 [info ] [MainThread]:   extensions: None
[0m07:33:28.553698 [info ] [MainThread]:   settings: {}
[0m07:33:28.553942 [info ] [MainThread]:   external_root: .
[0m07:33:28.554185 [info ] [MainThread]:   use_credential_provider: None
[0m07:33:28.554438 [info ] [MainThread]:   attach: None
[0m07:33:28.554680 [info ] [MainThread]:   filesystems: None
[0m07:33:28.554920 [info ] [MainThread]:   remote: None
[0m07:33:28.555162 [info ] [MainThread]:   plugins: None
[0m07:33:28.555414 [info ] [MainThread]:   disable_transactions: False
[0m07:33:28.555789 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:33:28.656217 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:33:28.677241 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:33:28.677651 [debug] [MainThread]: On debug: select 1 as id
[0m07:33:28.677937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:33:28.684038 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m07:33:28.684439 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m07:33:28.684800 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m07:33:28.685068 [info ] [MainThread]: [31m1 check failed:[0m
[0m07:33:28.685339 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 331140) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m07:33:28.686148 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.4168273, "process_in_blocks": "0", "process_kernel_time": 0.198731, "process_mem_max_rss": "149708", "process_out_blocks": "24", "process_user_time": 1.700704}
[0m07:33:28.686563 [debug] [MainThread]: Command `cli debug` failed at 07:33:28.686478 after 0.42 seconds
[0m07:33:28.686859 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:33:28.687156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f42ecc2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f42dc9fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f42dd51370>]}
[0m07:33:28.687509 [debug] [MainThread]: Flushing usage events
[0m07:33:29.778428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:47:57.473062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400ee628620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400ef2af2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400eed452e0>]}


============================== 07:47:57.479001 | 76cc0a43-7fe6-44d0-bff2-3786ff929c8a ==============================
[0m07:47:57.479001 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:47:57.479508 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'version_check': 'True', 'invocation_command': 'dbt list metrics', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'empty': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'printer_width': '80'}
[0m07:47:57.488032 [info ] [MainThread]: dbt version: 1.10.13
[0m07:47:57.488479 [info ] [MainThread]: python version: 3.12.3
[0m07:47:57.488749 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:47:57.489008 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:47:57.609640 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:47:57.610119 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:47:57.610397 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:47:57.611736 [info ] [MainThread]: adapter type: duckdb
[0m07:47:57.612027 [info ] [MainThread]: adapter version: 1.10.0
[0m07:47:57.727155 [info ] [MainThread]: Configuration:
[0m07:47:57.727707 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:47:57.727982 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:47:57.728244 [info ] [MainThread]: Required dependencies:
[0m07:47:57.728553 [debug] [MainThread]: Executing "git --help"
[0m07:47:57.731749 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:47:57.732527 [debug] [MainThread]: STDERR: "b''"
[0m07:47:57.732793 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:47:57.733040 [info ] [MainThread]: Connection:
[0m07:47:57.733287 [info ] [MainThread]:   database: datacore
[0m07:47:57.733526 [info ] [MainThread]:   schema: main
[0m07:47:57.733756 [info ] [MainThread]:   path: datacore.duckdb
[0m07:47:57.733981 [info ] [MainThread]:   config_options: None
[0m07:47:57.734207 [info ] [MainThread]:   extensions: None
[0m07:47:57.734441 [info ] [MainThread]:   settings: {}
[0m07:47:57.734669 [info ] [MainThread]:   external_root: .
[0m07:47:57.734892 [info ] [MainThread]:   use_credential_provider: None
[0m07:47:57.735116 [info ] [MainThread]:   attach: None
[0m07:47:57.735351 [info ] [MainThread]:   filesystems: None
[0m07:47:57.735575 [info ] [MainThread]:   remote: None
[0m07:47:57.735797 [info ] [MainThread]:   plugins: None
[0m07:47:57.736020 [info ] [MainThread]:   disable_transactions: False
[0m07:47:57.736378 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:47:57.845960 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:47:57.870105 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:47:57.870503 [debug] [MainThread]: On debug: select 1 as id
[0m07:47:57.870771 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:47:57.890037 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m07:47:57.891046 [debug] [MainThread]: On debug: Close
[0m07:47:57.891422 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:47:57.891681 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:47:57.892465 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.48178387, "process_in_blocks": "48", "process_kernel_time": 0.239254, "process_mem_max_rss": "153208", "process_out_blocks": "24", "process_user_time": 2.156295}
[0m07:47:57.892865 [debug] [MainThread]: Command `cli debug` succeeded at 07:47:57.892779 after 0.48 seconds
[0m07:47:57.893138 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:47:57.893434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400ef3c3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400f0a2b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400eda32c30>]}
[0m07:47:57.893783 [debug] [MainThread]: Flushing usage events
[0m07:47:59.449544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:49:46.408770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c800dffce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c801d5f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c800dffcb0>]}


============================== 07:49:46.412566 | 67ac5437-6c30-4789-9365-3611e9160d24 ==============================
[0m07:49:46.412566 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:49:46.413032 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'static_parser': 'True', 'write_json': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'invocation_command': 'dbt list metrics', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'debug': 'False', 'quiet': 'True', 'empty': 'None', 'use_colors': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'indirect_selection': 'eager', 'cache_selected_only': 'False'}
[0m07:49:46.420584 [info ] [MainThread]: dbt version: 1.10.13
[0m07:49:46.420905 [info ] [MainThread]: python version: 3.12.3
[0m07:49:46.421164 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:49:46.421427 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:49:46.529854 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:49:46.530256 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:49:46.530528 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:49:46.531686 [info ] [MainThread]: adapter type: duckdb
[0m07:49:46.531952 [info ] [MainThread]: adapter version: 1.10.0
[0m07:49:46.638034 [info ] [MainThread]: Configuration:
[0m07:49:46.638451 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:49:46.638717 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:49:46.638974 [info ] [MainThread]: Required dependencies:
[0m07:49:46.639250 [debug] [MainThread]: Executing "git --help"
[0m07:49:46.641813 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:49:46.642630 [debug] [MainThread]: STDERR: "b''"
[0m07:49:46.643032 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:49:46.643415 [info ] [MainThread]: Connection:
[0m07:49:46.643793 [info ] [MainThread]:   database: datacore
[0m07:49:46.644140 [info ] [MainThread]:   schema: main
[0m07:49:46.644481 [info ] [MainThread]:   path: datacore.duckdb
[0m07:49:46.644722 [info ] [MainThread]:   config_options: None
[0m07:49:46.644949 [info ] [MainThread]:   extensions: None
[0m07:49:46.645178 [info ] [MainThread]:   settings: {}
[0m07:49:46.645415 [info ] [MainThread]:   external_root: .
[0m07:49:46.645640 [info ] [MainThread]:   use_credential_provider: None
[0m07:49:46.645866 [info ] [MainThread]:   attach: None
[0m07:49:46.646089 [info ] [MainThread]:   filesystems: None
[0m07:49:46.646320 [info ] [MainThread]:   remote: None
[0m07:49:46.646547 [info ] [MainThread]:   plugins: None
[0m07:49:46.646772 [info ] [MainThread]:   disable_transactions: False
[0m07:49:46.647161 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:49:46.747755 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:49:46.768780 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:49:46.769186 [debug] [MainThread]: On debug: select 1 as id
[0m07:49:46.769459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:49:46.788362 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m07:49:46.789434 [debug] [MainThread]: On debug: Close
[0m07:49:46.789828 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:49:46.790087 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:49:46.790947 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43276387, "process_in_blocks": "0", "process_kernel_time": 0.193826, "process_mem_max_rss": "153116", "process_out_blocks": "24", "process_user_time": 1.773414}
[0m07:49:46.791376 [debug] [MainThread]: Command `cli debug` succeeded at 07:49:46.791282 after 0.43 seconds
[0m07:49:46.791659 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:49:46.791958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8000fbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c80008e8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c80008e000>]}
[0m07:49:46.792316 [debug] [MainThread]: Flushing usage events
[0m07:49:48.291428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:49:51.410432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427f4909940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427f3970260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427f4cdbda0>]}


============================== 07:49:51.413885 | 049e704d-3d5a-4f58-95da-d10993f85767 ==============================
[0m07:49:51.413885 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:49:51.414328 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_path': '/home/chun/Develop/datacore/logs', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt list metrics', 'quiet': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'empty': 'None', 'log_cache_events': 'False'}
[0m07:49:51.421292 [info ] [MainThread]: dbt version: 1.10.13
[0m07:49:51.421595 [info ] [MainThread]: python version: 3.12.3
[0m07:49:51.421837 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:49:51.422074 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:49:51.522291 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:49:51.522671 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:49:51.522916 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:49:51.523979 [info ] [MainThread]: adapter type: duckdb
[0m07:49:51.524226 [info ] [MainThread]: adapter version: 1.10.0
[0m07:49:51.620635 [info ] [MainThread]: Configuration:
[0m07:49:51.621058 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:49:51.621354 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:49:51.621617 [info ] [MainThread]: Required dependencies:
[0m07:49:51.621899 [debug] [MainThread]: Executing "git --help"
[0m07:49:51.625044 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:49:51.625849 [debug] [MainThread]: STDERR: "b''"
[0m07:49:51.626265 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:49:51.626650 [info ] [MainThread]: Connection:
[0m07:49:51.626995 [info ] [MainThread]:   database: datacore
[0m07:49:51.627227 [info ] [MainThread]:   schema: main
[0m07:49:51.627469 [info ] [MainThread]:   path: datacore.duckdb
[0m07:49:51.627704 [info ] [MainThread]:   config_options: None
[0m07:49:51.627935 [info ] [MainThread]:   extensions: None
[0m07:49:51.628169 [info ] [MainThread]:   settings: {}
[0m07:49:51.628411 [info ] [MainThread]:   external_root: .
[0m07:49:51.628640 [info ] [MainThread]:   use_credential_provider: None
[0m07:49:51.628869 [info ] [MainThread]:   attach: None
[0m07:49:51.629094 [info ] [MainThread]:   filesystems: None
[0m07:49:51.629329 [info ] [MainThread]:   remote: None
[0m07:49:51.629558 [info ] [MainThread]:   plugins: None
[0m07:49:51.629790 [info ] [MainThread]:   disable_transactions: False
[0m07:49:51.630184 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:49:51.741325 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:49:51.767359 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:49:51.767964 [debug] [MainThread]: On debug: select 1 as id
[0m07:49:51.768394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:49:51.788546 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m07:49:51.789704 [debug] [MainThread]: On debug: Close
[0m07:49:51.790129 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:49:51.790427 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:49:51.791372 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4318132, "process_in_blocks": "0", "process_kernel_time": 0.21174, "process_mem_max_rss": "153476", "process_out_blocks": "24", "process_user_time": 1.702912}
[0m07:49:51.791831 [debug] [MainThread]: Command `cli debug` succeeded at 07:49:51.791737 after 0.43 seconds
[0m07:49:51.792145 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:49:51.792490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427f48b1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427f335d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427f24d6db0>]}
[0m07:49:51.792887 [debug] [MainThread]: Flushing usage events
[0m07:49:52.916370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:53:44.298985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75423b717b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75423b3cb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75423cc52870>]}


============================== 07:53:44.302443 | bc4016c3-3a44-4cb0-9053-82a1dff25bc2 ==============================
[0m07:53:44.302443 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:53:44.302869 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'True', 'warn_error': 'None', 'empty': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/chun/Develop/datacore', 'invocation_command': 'dbt list metrics', 'printer_width': '80', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'target_path': 'None', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default', 'version_check': 'True', 'no_print': 'None'}
[0m07:53:44.309802 [info ] [MainThread]: dbt version: 1.10.13
[0m07:53:44.310109 [info ] [MainThread]: python version: 3.12.3
[0m07:53:44.310357 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:53:44.310592 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:53:44.409132 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:53:44.409518 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:53:44.409759 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:53:44.410819 [info ] [MainThread]: adapter type: duckdb
[0m07:53:44.411069 [info ] [MainThread]: adapter version: 1.10.0
[0m07:53:44.506553 [info ] [MainThread]: Configuration:
[0m07:53:44.506946 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:53:44.507188 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:53:44.507428 [info ] [MainThread]: Required dependencies:
[0m07:53:44.507678 [debug] [MainThread]: Executing "git --help"
[0m07:53:44.510298 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:53:44.510962 [debug] [MainThread]: STDERR: "b''"
[0m07:53:44.511255 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:53:44.511532 [info ] [MainThread]: Connection:
[0m07:53:44.511803 [info ] [MainThread]:   database: datacore
[0m07:53:44.512050 [info ] [MainThread]:   schema: main
[0m07:53:44.512294 [info ] [MainThread]:   path: datacore.duckdb
[0m07:53:44.512549 [info ] [MainThread]:   config_options: None
[0m07:53:44.512790 [info ] [MainThread]:   extensions: None
[0m07:53:44.513037 [info ] [MainThread]:   settings: {}
[0m07:53:44.513291 [info ] [MainThread]:   external_root: .
[0m07:53:44.513541 [info ] [MainThread]:   use_credential_provider: None
[0m07:53:44.513781 [info ] [MainThread]:   attach: None
[0m07:53:44.514021 [info ] [MainThread]:   filesystems: None
[0m07:53:44.514259 [info ] [MainThread]:   remote: None
[0m07:53:44.514504 [info ] [MainThread]:   plugins: None
[0m07:53:44.514746 [info ] [MainThread]:   disable_transactions: False
[0m07:53:44.515170 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:53:44.616214 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:53:44.637517 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:53:44.637915 [debug] [MainThread]: On debug: select 1 as id
[0m07:53:44.638176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:53:44.655925 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m07:53:44.656972 [debug] [MainThread]: On debug: Close
[0m07:53:44.657335 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:53:44.657621 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:53:44.658450 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41585273, "process_in_blocks": "0", "process_kernel_time": 0.18619, "process_mem_max_rss": "153184", "process_out_blocks": "32", "process_user_time": 1.698737}
[0m07:53:44.658858 [debug] [MainThread]: Command `cli debug` succeeded at 07:53:44.658776 after 0.42 seconds
[0m07:53:44.659134 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:53:44.659442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75423bb65e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75423b4a29c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75423b3fc170>]}
[0m07:53:44.659785 [debug] [MainThread]: Flushing usage events
[0m07:53:46.182328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:54:11.734577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599ce416b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599cf5af290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599cda0fb30>]}


============================== 07:54:11.738048 | ed9cf8f8-0690-4d12-96cd-46417a761df4 ==============================
[0m07:54:11.738048 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:54:11.738491 [debug] [MainThread]: running dbt with arguments {'quiet': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'fail_fast': 'False', 'invocation_command': 'dbt list metrics', 'printer_width': '80', 'profiles_dir': '/home/chun/Develop/datacore', 'no_print': 'None', 'write_json': 'True', 'version_check': 'True', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'empty': 'None', 'log_path': '/home/chun/Develop/datacore/logs'}
[0m07:54:11.745711 [info ] [MainThread]: dbt version: 1.10.13
[0m07:54:11.746032 [info ] [MainThread]: python version: 3.12.3
[0m07:54:11.746272 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:54:11.746522 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:54:11.846067 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:54:11.846487 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:54:11.846731 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:54:11.847879 [info ] [MainThread]: adapter type: duckdb
[0m07:54:11.848123 [info ] [MainThread]: adapter version: 1.10.0
[0m07:54:11.944642 [info ] [MainThread]: Configuration:
[0m07:54:11.945068 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:54:11.945325 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:54:11.945566 [info ] [MainThread]: Required dependencies:
[0m07:54:11.945827 [debug] [MainThread]: Executing "git --help"
[0m07:54:11.949060 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:54:11.949396 [debug] [MainThread]: STDERR: "b''"
[0m07:54:11.949648 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:54:11.949890 [info ] [MainThread]: Connection:
[0m07:54:11.950140 [info ] [MainThread]:   database: datacore
[0m07:54:11.950382 [info ] [MainThread]:   schema: main
[0m07:54:11.950612 [info ] [MainThread]:   path: datacore.duckdb
[0m07:54:11.950841 [info ] [MainThread]:   config_options: None
[0m07:54:11.951073 [info ] [MainThread]:   extensions: None
[0m07:54:11.951316 [info ] [MainThread]:   settings: {}
[0m07:54:11.951550 [info ] [MainThread]:   external_root: .
[0m07:54:11.951779 [info ] [MainThread]:   use_credential_provider: None
[0m07:54:11.952008 [info ] [MainThread]:   attach: None
[0m07:54:11.952236 [info ] [MainThread]:   filesystems: None
[0m07:54:11.952473 [info ] [MainThread]:   remote: None
[0m07:54:11.952731 [info ] [MainThread]:   plugins: None
[0m07:54:11.952966 [info ] [MainThread]:   disable_transactions: False
[0m07:54:11.953349 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:54:12.053879 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:54:12.075057 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:54:12.075465 [debug] [MainThread]: On debug: select 1 as id
[0m07:54:12.075743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:54:12.093628 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m07:54:12.094669 [debug] [MainThread]: On debug: Close
[0m07:54:12.095035 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:54:12.095297 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:54:12.096139 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41292396, "process_in_blocks": "0", "process_kernel_time": 0.225866, "process_mem_max_rss": "153192", "process_out_blocks": "24", "process_user_time": 1.77795}
[0m07:54:12.096556 [debug] [MainThread]: Command `cli debug` succeeded at 07:54:12.096472 after 0.41 seconds
[0m07:54:12.096832 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:54:12.097124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599cd6c1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599bcf61910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599ccc5d760>]}
[0m07:54:12.097481 [debug] [MainThread]: Flushing usage events
[0m07:54:13.216999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:54:50.386651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4efd0bddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4efda65400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4efe618350>]}


============================== 07:54:50.389906 | 1c689b26-ee1f-433e-adf0-d879e3e2b166 ==============================
[0m07:54:50.389906 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:54:50.390345 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'True', 'introspect': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'no_print': 'None', 'invocation_command': 'dbt list metrics', 'profiles_dir': '/home/chun/Develop/datacore', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'empty': 'None', 'indirect_selection': 'eager'}
[0m07:54:50.397276 [info ] [MainThread]: dbt version: 1.10.13
[0m07:54:50.397582 [info ] [MainThread]: python version: 3.12.3
[0m07:54:50.397828 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m07:54:50.398068 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m07:54:50.497009 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m07:54:50.497394 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m07:54:50.497638 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m07:54:50.498719 [info ] [MainThread]: adapter type: duckdb
[0m07:54:50.498969 [info ] [MainThread]: adapter version: 1.10.0
[0m07:54:50.595285 [info ] [MainThread]: Configuration:
[0m07:54:50.595684 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:54:50.596160 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:54:50.596405 [info ] [MainThread]: Required dependencies:
[0m07:54:50.596663 [debug] [MainThread]: Executing "git --help"
[0m07:54:50.599823 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:54:50.600418 [debug] [MainThread]: STDERR: "b''"
[0m07:54:50.600722 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:54:50.600997 [info ] [MainThread]: Connection:
[0m07:54:50.601275 [info ] [MainThread]:   database: datacore
[0m07:54:50.601533 [info ] [MainThread]:   schema: main
[0m07:54:50.601782 [info ] [MainThread]:   path: datacore.duckdb
[0m07:54:50.602031 [info ] [MainThread]:   config_options: None
[0m07:54:50.602278 [info ] [MainThread]:   extensions: None
[0m07:54:50.602542 [info ] [MainThread]:   settings: {}
[0m07:54:50.602794 [info ] [MainThread]:   external_root: .
[0m07:54:50.603046 [info ] [MainThread]:   use_credential_provider: None
[0m07:54:50.603292 [info ] [MainThread]:   attach: None
[0m07:54:50.603544 [info ] [MainThread]:   filesystems: None
[0m07:54:50.603790 [info ] [MainThread]:   remote: None
[0m07:54:50.604035 [info ] [MainThread]:   plugins: None
[0m07:54:50.604283 [info ] [MainThread]:   disable_transactions: False
[0m07:54:50.604712 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:54:50.707742 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m07:54:50.729167 [debug] [MainThread]: Using duckdb connection "debug"
[0m07:54:50.729574 [debug] [MainThread]: On debug: select 1 as id
[0m07:54:50.729840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:54:50.748045 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m07:54:50.749200 [debug] [MainThread]: On debug: Close
[0m07:54:50.749594 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:54:50.749875 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:54:50.750791 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41525945, "process_in_blocks": "0", "process_kernel_time": 0.206826, "process_mem_max_rss": "153228", "process_out_blocks": "24", "process_user_time": 1.682585}
[0m07:54:50.751243 [debug] [MainThread]: Command `cli debug` succeeded at 07:54:50.751153 after 0.42 seconds
[0m07:54:50.751572 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:54:50.751900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4efbd47ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4efd71aae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4eec1e46b0>]}
[0m07:54:50.752291 [debug] [MainThread]: Flushing usage events
[0m07:54:51.995180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:04:12.554609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff100eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff21bfb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff20cfda0>]}


============================== 08:04:12.558857 | 24f91a24-0d24-4206-a188-c702c61209f7 ==============================
[0m08:04:12.558857 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:04:12.559279 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'no_print': 'None', 'warn_error': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'log_path': '/home/chun/Develop/datacore/logs', 'log_format': 'default', 'use_colors': 'True', 'invocation_command': 'dbt list metrics', 'partial_parse': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'True', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'empty': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'debug': 'False'}
[0m08:04:12.566180 [info ] [MainThread]: dbt version: 1.10.13
[0m08:04:12.566486 [info ] [MainThread]: python version: 3.12.3
[0m08:04:12.566726 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:04:12.566961 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:04:12.666414 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:04:12.666778 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:04:12.667020 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:04:12.668081 [info ] [MainThread]: adapter type: duckdb
[0m08:04:12.668332 [info ] [MainThread]: adapter version: 1.10.0
[0m08:04:12.763983 [info ] [MainThread]: Configuration:
[0m08:04:12.764362 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:04:12.764605 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:04:12.764836 [info ] [MainThread]: Required dependencies:
[0m08:04:12.765086 [debug] [MainThread]: Executing "git --help"
[0m08:04:12.768299 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:04:12.769091 [debug] [MainThread]: STDERR: "b''"
[0m08:04:12.769553 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:04:12.769977 [info ] [MainThread]: Connection:
[0m08:04:12.770412 [info ] [MainThread]:   database: datacore
[0m08:04:12.770759 [info ] [MainThread]:   schema: main
[0m08:04:12.771043 [info ] [MainThread]:   path: datacore.duckdb
[0m08:04:12.771283 [info ] [MainThread]:   config_options: None
[0m08:04:12.771509 [info ] [MainThread]:   extensions: None
[0m08:04:12.771732 [info ] [MainThread]:   settings: {}
[0m08:04:12.771959 [info ] [MainThread]:   external_root: .
[0m08:04:12.772180 [info ] [MainThread]:   use_credential_provider: None
[0m08:04:12.772413 [info ] [MainThread]:   attach: None
[0m08:04:12.772633 [info ] [MainThread]:   filesystems: None
[0m08:04:12.772853 [info ] [MainThread]:   remote: None
[0m08:04:12.773072 [info ] [MainThread]:   plugins: None
[0m08:04:12.773292 [info ] [MainThread]:   disable_transactions: False
[0m08:04:12.773682 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:04:12.874947 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:04:12.896205 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:04:12.896620 [debug] [MainThread]: On debug: select 1 as id
[0m08:04:12.896883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:04:12.915137 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m08:04:12.916181 [debug] [MainThread]: On debug: Close
[0m08:04:12.916560 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:04:12.916818 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:04:12.917664 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4187003, "process_in_blocks": "0", "process_kernel_time": 0.212884, "process_mem_max_rss": "153088", "process_out_blocks": "24", "process_user_time": 1.811015}
[0m08:04:12.918069 [debug] [MainThread]: Command `cli debug` succeeded at 08:04:12.917987 after 0.42 seconds
[0m08:04:12.918352 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:04:12.918646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff1855e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff028a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718fefe41610>]}
[0m08:04:12.918993 [debug] [MainThread]: Flushing usage events
[0m08:04:14.311188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:04:27.085062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74859489ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748595759670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74859494ecf0>]}


============================== 08:04:27.088396 | a65f8c01-00fe-4518-9efd-3fbe85e2e041 ==============================
[0m08:04:27.088396 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:04:27.088820 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'debug': 'False', 'quiet': 'True', 'invocation_command': 'dbt list metrics', 'log_path': '/home/chun/Develop/datacore/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'no_print': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/chun/Develop/datacore'}
[0m08:04:27.095734 [info ] [MainThread]: dbt version: 1.10.13
[0m08:04:27.096030 [info ] [MainThread]: python version: 3.12.3
[0m08:04:27.096266 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:04:27.096504 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:04:27.195370 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:04:27.195745 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:04:27.195985 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:04:27.197045 [info ] [MainThread]: adapter type: duckdb
[0m08:04:27.197288 [info ] [MainThread]: adapter version: 1.10.0
[0m08:04:27.292978 [info ] [MainThread]: Configuration:
[0m08:04:27.293362 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:04:27.293606 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:04:27.293838 [info ] [MainThread]: Required dependencies:
[0m08:04:27.294087 [debug] [MainThread]: Executing "git --help"
[0m08:04:27.297243 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:04:27.297929 [debug] [MainThread]: STDERR: "b''"
[0m08:04:27.298333 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:04:27.298699 [info ] [MainThread]: Connection:
[0m08:04:27.299072 [info ] [MainThread]:   database: datacore
[0m08:04:27.299433 [info ] [MainThread]:   schema: main
[0m08:04:27.299752 [info ] [MainThread]:   path: datacore.duckdb
[0m08:04:27.300064 [info ] [MainThread]:   config_options: None
[0m08:04:27.300388 [info ] [MainThread]:   extensions: None
[0m08:04:27.300706 [info ] [MainThread]:   settings: {}
[0m08:04:27.301026 [info ] [MainThread]:   external_root: .
[0m08:04:27.301345 [info ] [MainThread]:   use_credential_provider: None
[0m08:04:27.301661 [info ] [MainThread]:   attach: None
[0m08:04:27.301971 [info ] [MainThread]:   filesystems: None
[0m08:04:27.302281 [info ] [MainThread]:   remote: None
[0m08:04:27.302603 [info ] [MainThread]:   plugins: None
[0m08:04:27.302919 [info ] [MainThread]:   disable_transactions: False
[0m08:04:27.303416 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:04:27.404276 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:04:27.426186 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:04:27.426604 [debug] [MainThread]: On debug: select 1 as id
[0m08:04:27.426870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:04:27.444252 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m08:04:27.445300 [debug] [MainThread]: On debug: Close
[0m08:04:27.445665 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:04:27.445923 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:04:27.446747 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41210052, "process_in_blocks": "0", "process_kernel_time": 0.236851, "process_mem_max_rss": "152816", "process_out_blocks": "24", "process_user_time": 1.664956}
[0m08:04:27.447145 [debug] [MainThread]: Command `cli debug` succeeded at 08:04:27.447064 after 0.41 seconds
[0m08:04:27.447428 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:04:27.447722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748595a164e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748593d4bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74859459ee10>]}
[0m08:04:27.448070 [debug] [MainThread]: Flushing usage events
[0m08:04:28.599344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:05:07.958880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7428cccb0290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7428caed47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7428cd0d4200>]}


============================== 08:05:07.962465 | 3e42cca7-8611-497b-910d-a574cc80fe67 ==============================
[0m08:05:07.962465 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:05:07.962888 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'quiet': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt list metrics', 'empty': 'None', 'profiles_dir': '/home/chun/Develop/datacore'}
[0m08:05:07.969736 [info ] [MainThread]: dbt version: 1.10.13
[0m08:05:07.970024 [info ] [MainThread]: python version: 3.12.3
[0m08:05:07.970264 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:05:07.970505 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:05:08.068485 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:05:08.068856 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:05:08.069100 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:05:08.070152 [info ] [MainThread]: adapter type: duckdb
[0m08:05:08.070407 [info ] [MainThread]: adapter version: 1.10.0
[0m08:05:08.166377 [info ] [MainThread]: Configuration:
[0m08:05:08.166761 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:05:08.167005 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:05:08.167238 [info ] [MainThread]: Required dependencies:
[0m08:05:08.167496 [debug] [MainThread]: Executing "git --help"
[0m08:05:08.170506 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:05:08.171218 [debug] [MainThread]: STDERR: "b''"
[0m08:05:08.171599 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:05:08.171940 [info ] [MainThread]: Connection:
[0m08:05:08.172242 [info ] [MainThread]:   database: datacore
[0m08:05:08.172485 [info ] [MainThread]:   schema: main
[0m08:05:08.172708 [info ] [MainThread]:   path: datacore.duckdb
[0m08:05:08.172930 [info ] [MainThread]:   config_options: None
[0m08:05:08.173157 [info ] [MainThread]:   extensions: None
[0m08:05:08.173388 [info ] [MainThread]:   settings: {}
[0m08:05:08.173613 [info ] [MainThread]:   external_root: .
[0m08:05:08.173835 [info ] [MainThread]:   use_credential_provider: None
[0m08:05:08.174055 [info ] [MainThread]:   attach: None
[0m08:05:08.174273 [info ] [MainThread]:   filesystems: None
[0m08:05:08.174499 [info ] [MainThread]:   remote: None
[0m08:05:08.174718 [info ] [MainThread]:   plugins: None
[0m08:05:08.174938 [info ] [MainThread]:   disable_transactions: False
[0m08:05:08.175320 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:05:08.274586 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:05:08.295849 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:05:08.296244 [debug] [MainThread]: On debug: select 1 as id
[0m08:05:08.296514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:05:08.314113 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m08:05:08.315163 [debug] [MainThread]: On debug: Close
[0m08:05:08.315521 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:05:08.315774 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:05:08.316590 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41522855, "process_in_blocks": "0", "process_kernel_time": 0.202824, "process_mem_max_rss": "152988", "process_out_blocks": "32", "process_user_time": 1.74649}
[0m08:05:08.316988 [debug] [MainThread]: Command `cli debug` succeeded at 08:05:08.316906 after 0.42 seconds
[0m08:05:08.317263 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:05:08.317560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7428cc228bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7428baabcb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7428ca849580>]}
[0m08:05:08.317907 [debug] [MainThread]: Flushing usage events
[0m08:05:09.447069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:06:43.410426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748704e902f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748705bab1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748704da1d60>]}


============================== 08:06:43.413820 | 0898137b-0fd7-4235-92ec-7083a3dc91d8 ==============================
[0m08:06:43.413820 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:06:43.414250 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'True', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'invocation_command': 'dbt list metrics', 'fail_fast': 'False'}
[0m08:06:43.421341 [info ] [MainThread]: dbt version: 1.10.13
[0m08:06:43.421645 [info ] [MainThread]: python version: 3.12.3
[0m08:06:43.421892 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:06:43.422135 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:06:43.524687 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:06:43.525088 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:06:43.525357 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:06:43.526517 [info ] [MainThread]: adapter type: duckdb
[0m08:06:43.526781 [info ] [MainThread]: adapter version: 1.10.0
[0m08:06:43.634498 [info ] [MainThread]: Configuration:
[0m08:06:43.634915 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:06:43.635184 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:06:43.635455 [info ] [MainThread]: Required dependencies:
[0m08:06:43.635733 [debug] [MainThread]: Executing "git --help"
[0m08:06:43.638766 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:06:43.639114 [debug] [MainThread]: STDERR: "b''"
[0m08:06:43.639394 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:06:43.639653 [info ] [MainThread]: Connection:
[0m08:06:43.639920 [info ] [MainThread]:   database: datacore
[0m08:06:43.640175 [info ] [MainThread]:   schema: main
[0m08:06:43.640432 [info ] [MainThread]:   path: datacore.duckdb
[0m08:06:43.640684 [info ] [MainThread]:   config_options: None
[0m08:06:43.640930 [info ] [MainThread]:   extensions: None
[0m08:06:43.641179 [info ] [MainThread]:   settings: {}
[0m08:06:43.641443 [info ] [MainThread]:   external_root: .
[0m08:06:43.641691 [info ] [MainThread]:   use_credential_provider: None
[0m08:06:43.641938 [info ] [MainThread]:   attach: None
[0m08:06:43.642185 [info ] [MainThread]:   filesystems: None
[0m08:06:43.642438 [info ] [MainThread]:   remote: None
[0m08:06:43.642682 [info ] [MainThread]:   plugins: None
[0m08:06:43.642926 [info ] [MainThread]:   disable_transactions: False
[0m08:06:43.643325 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:06:43.745719 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:06:43.768495 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:06:43.768893 [debug] [MainThread]: On debug: select 1 as id
[0m08:06:43.769171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:06:43.787728 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m08:06:43.788692 [debug] [MainThread]: On debug: Close
[0m08:06:43.789052 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:06:43.789313 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:06:43.790091 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43097615, "process_in_blocks": "0", "process_kernel_time": 0.200872, "process_mem_max_rss": "153320", "process_out_blocks": "32", "process_user_time": 1.817844}
[0m08:06:43.790494 [debug] [MainThread]: Command `cli debug` succeeded at 08:06:43.790412 after 0.43 seconds
[0m08:06:43.790766 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:06:43.791053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748704a28770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748703e29d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748709773470>]}
[0m08:06:43.791393 [debug] [MainThread]: Flushing usage events
[0m08:06:44.926896 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:08:11.067136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05d3554260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05d3ccc530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05d2d380b0>]}


============================== 08:08:11.070234 | 3cd9d3f0-0584-494f-a582-cc73b977c703 ==============================
[0m08:08:11.070234 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:08:11.070669 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'invocation_command': 'dbt list metrics', 'printer_width': '80'}
[0m08:08:11.077824 [info ] [MainThread]: dbt version: 1.10.13
[0m08:08:11.078146 [info ] [MainThread]: python version: 3.12.3
[0m08:08:11.078393 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:08:11.078628 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:08:11.179618 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:08:11.180023 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:08:11.180265 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:08:11.181390 [info ] [MainThread]: adapter type: duckdb
[0m08:08:11.181633 [info ] [MainThread]: adapter version: 1.10.0
[0m08:08:11.278187 [info ] [MainThread]: Configuration:
[0m08:08:11.278610 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:08:11.278856 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:08:11.279103 [info ] [MainThread]: Required dependencies:
[0m08:08:11.279368 [debug] [MainThread]: Executing "git --help"
[0m08:08:11.282376 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:08:11.282973 [debug] [MainThread]: STDERR: "b''"
[0m08:08:11.283346 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:08:11.283688 [info ] [MainThread]: Connection:
[0m08:08:11.284037 [info ] [MainThread]:   database: datacore
[0m08:08:11.284368 [info ] [MainThread]:   schema: main
[0m08:08:11.284685 [info ] [MainThread]:   path: datacore.duckdb
[0m08:08:11.285001 [info ] [MainThread]:   config_options: None
[0m08:08:11.285326 [info ] [MainThread]:   extensions: None
[0m08:08:11.285645 [info ] [MainThread]:   settings: {}
[0m08:08:11.285967 [info ] [MainThread]:   external_root: .
[0m08:08:11.286282 [info ] [MainThread]:   use_credential_provider: None
[0m08:08:11.286611 [info ] [MainThread]:   attach: None
[0m08:08:11.286922 [info ] [MainThread]:   filesystems: None
[0m08:08:11.287234 [info ] [MainThread]:   remote: None
[0m08:08:11.287559 [info ] [MainThread]:   plugins: None
[0m08:08:11.287872 [info ] [MainThread]:   disable_transactions: False
[0m08:08:11.288372 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:08:11.388665 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:08:11.409856 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:08:11.410218 [debug] [MainThread]: On debug: select 1 as id
[0m08:08:11.410482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:08:11.429083 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m08:08:11.430068 [debug] [MainThread]: On debug: Close
[0m08:08:11.430446 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:08:11.430696 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:08:11.431483 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4157623, "process_in_blocks": "0", "process_kernel_time": 0.205896, "process_mem_max_rss": "153388", "process_out_blocks": "24", "process_user_time": 1.690146}
[0m08:08:11.431875 [debug] [MainThread]: Command `cli debug` succeeded at 08:08:11.431794 after 0.42 seconds
[0m08:08:11.432141 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:08:11.432442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05d1ab2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05c1d350a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05d18145c0>]}
[0m08:08:11.432772 [debug] [MainThread]: Flushing usage events
[0m08:08:12.526879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:08:41.576869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e5d65d32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e5d6eab1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e5d6ea8f20>]}


============================== 08:08:41.580353 | 57b88e3a-8ffa-4820-a666-de364fe57471 ==============================
[0m08:08:41.580353 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:08:41.580781 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'partial_parse': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt list metrics', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'indirect_selection': 'eager', 'version_check': 'True', 'quiet': 'True', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True'}
[0m08:08:41.587716 [info ] [MainThread]: dbt version: 1.10.13
[0m08:08:41.588009 [info ] [MainThread]: python version: 3.12.3
[0m08:08:41.588251 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:08:41.588497 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:08:41.688875 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:08:41.689249 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:08:41.689496 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:08:41.690544 [info ] [MainThread]: adapter type: duckdb
[0m08:08:41.690786 [info ] [MainThread]: adapter version: 1.10.0
[0m08:08:41.789875 [info ] [MainThread]: Configuration:
[0m08:08:41.790266 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:08:41.790517 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:08:41.790750 [info ] [MainThread]: Required dependencies:
[0m08:08:41.791000 [debug] [MainThread]: Executing "git --help"
[0m08:08:41.794069 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:08:41.794732 [debug] [MainThread]: STDERR: "b''"
[0m08:08:41.795102 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:08:41.795433 [info ] [MainThread]: Connection:
[0m08:08:41.795696 [info ] [MainThread]:   database: datacore
[0m08:08:41.795923 [info ] [MainThread]:   schema: main
[0m08:08:41.796149 [info ] [MainThread]:   path: datacore.duckdb
[0m08:08:41.796381 [info ] [MainThread]:   config_options: None
[0m08:08:41.796604 [info ] [MainThread]:   extensions: None
[0m08:08:41.796829 [info ] [MainThread]:   settings: {}
[0m08:08:41.797056 [info ] [MainThread]:   external_root: .
[0m08:08:41.797276 [info ] [MainThread]:   use_credential_provider: None
[0m08:08:41.797505 [info ] [MainThread]:   attach: None
[0m08:08:41.797725 [info ] [MainThread]:   filesystems: None
[0m08:08:41.797944 [info ] [MainThread]:   remote: None
[0m08:08:41.798163 [info ] [MainThread]:   plugins: None
[0m08:08:41.798395 [info ] [MainThread]:   disable_transactions: False
[0m08:08:41.798777 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:08:41.899150 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:08:41.922267 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:08:41.922700 [debug] [MainThread]: On debug: select 1 as id
[0m08:08:41.922986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:08:41.942164 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m08:08:41.943318 [debug] [MainThread]: On debug: Close
[0m08:08:41.943701 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:08:41.943986 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:08:41.944894 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42403734, "process_in_blocks": "0", "process_kernel_time": 0.202106, "process_mem_max_rss": "152784", "process_out_blocks": "16", "process_user_time": 1.770935}
[0m08:08:41.945368 [debug] [MainThread]: Command `cli debug` succeeded at 08:08:41.945247 after 0.42 seconds
[0m08:08:41.945679 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:08:41.946004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e5d58e2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e5d69738c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e5d6971820>]}
[0m08:08:41.946404 [debug] [MainThread]: Flushing usage events
[0m08:08:43.058889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:16:28.480553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f82b7244d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f82a111280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f82afef3b0>]}


============================== 08:16:28.483940 | 1281b739-48ad-4f90-b274-96370d35dbec ==============================
[0m08:16:28.483940 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:16:28.484375 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'quiet': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'introspect': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt list metrics', 'log_cache_events': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/chun/Develop/datacore'}
[0m08:16:28.491541 [info ] [MainThread]: dbt version: 1.10.13
[0m08:16:28.491862 [info ] [MainThread]: python version: 3.12.3
[0m08:16:28.492111 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:16:28.492360 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:16:28.591841 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:16:28.592239 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:16:28.592488 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:16:28.593586 [info ] [MainThread]: adapter type: duckdb
[0m08:16:28.593831 [info ] [MainThread]: adapter version: 1.10.0
[0m08:16:28.688926 [info ] [MainThread]: Configuration:
[0m08:16:28.689348 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:16:28.689593 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:16:28.689828 [info ] [MainThread]: Required dependencies:
[0m08:16:28.690084 [debug] [MainThread]: Executing "git --help"
[0m08:16:28.692612 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:16:28.693482 [debug] [MainThread]: STDERR: "b''"
[0m08:16:28.693918 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:16:28.694300 [info ] [MainThread]: Connection:
[0m08:16:28.694593 [info ] [MainThread]:   database: datacore
[0m08:16:28.694842 [info ] [MainThread]:   schema: main
[0m08:16:28.695089 [info ] [MainThread]:   path: datacore.duckdb
[0m08:16:28.695342 [info ] [MainThread]:   config_options: None
[0m08:16:28.695591 [info ] [MainThread]:   extensions: None
[0m08:16:28.695841 [info ] [MainThread]:   settings: {}
[0m08:16:28.696090 [info ] [MainThread]:   external_root: .
[0m08:16:28.696344 [info ] [MainThread]:   use_credential_provider: None
[0m08:16:28.696589 [info ] [MainThread]:   attach: None
[0m08:16:28.696831 [info ] [MainThread]:   filesystems: None
[0m08:16:28.697073 [info ] [MainThread]:   remote: None
[0m08:16:28.697326 [info ] [MainThread]:   plugins: None
[0m08:16:28.697566 [info ] [MainThread]:   disable_transactions: False
[0m08:16:28.697948 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:16:28.799227 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:16:28.821152 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:16:28.821549 [debug] [MainThread]: On debug: select 1 as id
[0m08:16:28.821817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:16:28.840720 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m08:16:28.841686 [debug] [MainThread]: On debug: Close
[0m08:16:28.842065 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:16:28.842336 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:16:28.843136 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41387197, "process_in_blocks": "0", "process_kernel_time": 0.22488, "process_mem_max_rss": "153224", "process_out_blocks": "24", "process_user_time": 1.760064}
[0m08:16:28.843554 [debug] [MainThread]: Command `cli debug` succeeded at 08:16:28.843468 after 0.41 seconds
[0m08:16:28.843830 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:16:28.844130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f82add7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f819d84aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f82b094fe0>]}
[0m08:16:28.844490 [debug] [MainThread]: Flushing usage events
[0m08:16:30.238818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:19:58.182323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7482bf444200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7482c00dbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7482c0fc7d40>]}


============================== 08:19:58.185212 | c03b438a-3e6f-4e5f-8a34-0f7d181d658e ==============================
[0m08:19:58.185212 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:19:58.185660 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'empty': 'None', 'debug': 'False', 'invocation_command': 'dbt list metrics', 'fail_fast': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'log_path': '/home/chun/Develop/datacore/logs', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'version_check': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'quiet': 'True', 'write_json': 'True', 'introspect': 'True'}
[0m08:19:58.193548 [info ] [MainThread]: dbt version: 1.10.13
[0m08:19:58.193874 [info ] [MainThread]: python version: 3.12.3
[0m08:19:58.194122 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:19:58.194367 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:19:58.291988 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:19:58.292361 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:19:58.292602 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:19:58.293664 [info ] [MainThread]: adapter type: duckdb
[0m08:19:58.293906 [info ] [MainThread]: adapter version: 1.10.0
[0m08:19:58.388842 [info ] [MainThread]: Configuration:
[0m08:19:58.389221 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:19:58.389472 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:19:58.389702 [info ] [MainThread]: Required dependencies:
[0m08:19:58.389949 [debug] [MainThread]: Executing "git --help"
[0m08:19:58.393229 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:19:58.394015 [debug] [MainThread]: STDERR: "b''"
[0m08:19:58.394400 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:19:58.394722 [info ] [MainThread]: Connection:
[0m08:19:58.394991 [info ] [MainThread]:   database: datacore
[0m08:19:58.395214 [info ] [MainThread]:   schema: main
[0m08:19:58.395442 [info ] [MainThread]:   path: datacore.duckdb
[0m08:19:58.395666 [info ] [MainThread]:   config_options: None
[0m08:19:58.395884 [info ] [MainThread]:   extensions: None
[0m08:19:58.396108 [info ] [MainThread]:   settings: {}
[0m08:19:58.396336 [info ] [MainThread]:   external_root: .
[0m08:19:58.396556 [info ] [MainThread]:   use_credential_provider: None
[0m08:19:58.396775 [info ] [MainThread]:   attach: None
[0m08:19:58.396993 [info ] [MainThread]:   filesystems: None
[0m08:19:58.397208 [info ] [MainThread]:   remote: None
[0m08:19:58.397450 [info ] [MainThread]:   plugins: None
[0m08:19:58.397669 [info ] [MainThread]:   disable_transactions: False
[0m08:19:58.398047 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:19:58.498564 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:19:58.519985 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:19:58.520391 [debug] [MainThread]: On debug: select 1 as id
[0m08:19:58.520655 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:19:58.538652 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m08:19:58.539696 [debug] [MainThread]: On debug: Close
[0m08:19:58.540057 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:19:58.540322 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:19:58.541142 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4145072, "process_in_blocks": "0", "process_kernel_time": 0.198822, "process_mem_max_rss": "153604", "process_out_blocks": "32", "process_user_time": 1.751436}
[0m08:19:58.541559 [debug] [MainThread]: Command `cli debug` succeeded at 08:19:58.541475 after 0.42 seconds
[0m08:19:58.541836 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:19:58.542131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7482c1116630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7482bed9fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7482c0e3c0b0>]}
[0m08:19:58.542490 [debug] [MainThread]: Flushing usage events
[0m08:19:59.758961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:20:56.537201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a95cfaa600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a95df69520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a95df6ba10>]}


============================== 08:20:56.540458 | 70330bf3-948d-41d1-a438-7c59ace680bc ==============================
[0m08:20:56.540458 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:20:56.540879 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'static_parser': 'True', 'debug': 'False', 'version_check': 'True', 'log_format': 'default', 'use_colors': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'invocation_command': 'dbt list metrics', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'quiet': 'True', 'target_path': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'no_print': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False'}
[0m08:20:56.549554 [info ] [MainThread]: dbt version: 1.10.13
[0m08:20:56.549881 [info ] [MainThread]: python version: 3.12.3
[0m08:20:56.550122 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:20:56.550366 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:20:56.646852 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:20:56.647229 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:20:56.647477 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:20:56.648526 [info ] [MainThread]: adapter type: duckdb
[0m08:20:56.648773 [info ] [MainThread]: adapter version: 1.10.0
[0m08:20:56.745115 [info ] [MainThread]: Configuration:
[0m08:20:56.745544 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:20:56.745810 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:20:56.746064 [info ] [MainThread]: Required dependencies:
[0m08:20:56.746347 [debug] [MainThread]: Executing "git --help"
[0m08:20:56.749743 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:20:56.750399 [debug] [MainThread]: STDERR: "b''"
[0m08:20:56.750697 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:20:56.750947 [info ] [MainThread]: Connection:
[0m08:20:56.751202 [info ] [MainThread]:   database: datacore
[0m08:20:56.751437 [info ] [MainThread]:   schema: main
[0m08:20:56.751663 [info ] [MainThread]:   path: datacore.duckdb
[0m08:20:56.751884 [info ] [MainThread]:   config_options: None
[0m08:20:56.752108 [info ] [MainThread]:   extensions: None
[0m08:20:56.752345 [info ] [MainThread]:   settings: {}
[0m08:20:56.752572 [info ] [MainThread]:   external_root: .
[0m08:20:56.752791 [info ] [MainThread]:   use_credential_provider: None
[0m08:20:56.753020 [info ] [MainThread]:   attach: None
[0m08:20:56.753240 [info ] [MainThread]:   filesystems: None
[0m08:20:56.753478 [info ] [MainThread]:   remote: None
[0m08:20:56.753702 [info ] [MainThread]:   plugins: None
[0m08:20:56.753928 [info ] [MainThread]:   disable_transactions: False
[0m08:20:56.754319 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:20:56.855643 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:20:56.877099 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:20:56.877503 [debug] [MainThread]: On debug: select 1 as id
[0m08:20:56.877764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:20:56.895440 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m08:20:56.896474 [debug] [MainThread]: On debug: Close
[0m08:20:56.896825 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:20:56.897082 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:20:56.897938 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41166762, "process_in_blocks": "0", "process_kernel_time": 0.228971, "process_mem_max_rss": "152716", "process_out_blocks": "32", "process_user_time": 1.764782}
[0m08:20:56.898346 [debug] [MainThread]: Command `cli debug` succeeded at 08:20:56.898257 after 0.41 seconds
[0m08:20:56.898620 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:20:56.898910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a95ce00650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a95e0fd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a95dbcb530>]}
[0m08:20:56.899258 [debug] [MainThread]: Flushing usage events
[0m08:20:58.063935 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:21:00.136084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da9a21b0140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da9a2d175f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da9a1cd73b0>]}


============================== 08:21:00.139923 | 2458ccbf-c8a7-4151-9923-c490c08536b1 ==============================
[0m08:21:00.139923 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:21:00.140385 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt list metrics', 'profiles_dir': '/home/chun/Develop/datacore', 'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'quiet': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/chun/Develop/datacore/logs', 'indirect_selection': 'eager', 'debug': 'False', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'empty': 'None'}
[0m08:21:00.149331 [info ] [MainThread]: dbt version: 1.10.13
[0m08:21:00.149722 [info ] [MainThread]: python version: 3.12.3
[0m08:21:00.149967 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:21:00.150207 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:21:00.259407 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:21:00.259842 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:21:00.260099 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:21:00.261324 [info ] [MainThread]: adapter type: duckdb
[0m08:21:00.261601 [info ] [MainThread]: adapter version: 1.10.0
[0m08:21:00.366872 [info ] [MainThread]: Configuration:
[0m08:21:00.367332 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:21:00.367596 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:21:00.367852 [info ] [MainThread]: Required dependencies:
[0m08:21:00.368132 [debug] [MainThread]: Executing "git --help"
[0m08:21:00.370852 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:21:00.371447 [debug] [MainThread]: STDERR: "b''"
[0m08:21:00.371808 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:21:00.372134 [info ] [MainThread]: Connection:
[0m08:21:00.372406 [info ] [MainThread]:   database: datacore
[0m08:21:00.372635 [info ] [MainThread]:   schema: main
[0m08:21:00.372864 [info ] [MainThread]:   path: datacore.duckdb
[0m08:21:00.373089 [info ] [MainThread]:   config_options: None
[0m08:21:00.373324 [info ] [MainThread]:   extensions: None
[0m08:21:00.373553 [info ] [MainThread]:   settings: {}
[0m08:21:00.373780 [info ] [MainThread]:   external_root: .
[0m08:21:00.374003 [info ] [MainThread]:   use_credential_provider: None
[0m08:21:00.374225 [info ] [MainThread]:   attach: None
[0m08:21:00.374457 [info ] [MainThread]:   filesystems: None
[0m08:21:00.374679 [info ] [MainThread]:   remote: None
[0m08:21:00.374901 [info ] [MainThread]:   plugins: None
[0m08:21:00.375125 [info ] [MainThread]:   disable_transactions: False
[0m08:21:00.375481 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:21:00.473887 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:21:00.494878 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:21:00.495254 [debug] [MainThread]: On debug: select 1 as id
[0m08:21:00.495526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:21:00.513398 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m08:21:00.514398 [debug] [MainThread]: On debug: Close
[0m08:21:00.514770 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:21:00.515026 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:21:00.515814 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43219334, "process_in_blocks": "0", "process_kernel_time": 0.209071, "process_mem_max_rss": "153232", "process_out_blocks": "24", "process_user_time": 1.691581}
[0m08:21:00.516193 [debug] [MainThread]: Command `cli debug` succeeded at 08:21:00.516114 after 0.43 seconds
[0m08:21:00.516471 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:21:00.516757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da9909b8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da9a17342f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da9a063cec0>]}
[0m08:21:00.517090 [debug] [MainThread]: Flushing usage events
[0m08:21:01.737768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:24:05.566124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09b489bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09b3a80080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09b335f410>]}


============================== 08:24:05.569565 | 44db86c3-1321-45ad-a90e-f9c709f81499 ==============================
[0m08:24:05.569565 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:24:05.569991 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/chun/Develop/datacore', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'True', 'empty': 'None', 'invocation_command': 'dbt list metrics', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'use_experimental_parser': 'False'}
[0m08:24:05.578341 [info ] [MainThread]: dbt version: 1.10.13
[0m08:24:05.578665 [info ] [MainThread]: python version: 3.12.3
[0m08:24:05.578900 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:24:05.579130 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:24:05.677603 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:24:05.677968 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:24:05.678208 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:24:05.679263 [info ] [MainThread]: adapter type: duckdb
[0m08:24:05.679513 [info ] [MainThread]: adapter version: 1.10.0
[0m08:24:05.776406 [info ] [MainThread]: Configuration:
[0m08:24:05.776789 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:24:05.777038 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:24:05.777273 [info ] [MainThread]: Required dependencies:
[0m08:24:05.777534 [debug] [MainThread]: Executing "git --help"
[0m08:24:05.779743 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:24:05.780072 [debug] [MainThread]: STDERR: "b''"
[0m08:24:05.780427 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:24:05.780771 [info ] [MainThread]: Connection:
[0m08:24:05.781125 [info ] [MainThread]:   database: datacore
[0m08:24:05.781370 [info ] [MainThread]:   schema: main
[0m08:24:05.781595 [info ] [MainThread]:   path: datacore.duckdb
[0m08:24:05.781820 [info ] [MainThread]:   config_options: None
[0m08:24:05.782044 [info ] [MainThread]:   extensions: None
[0m08:24:05.782271 [info ] [MainThread]:   settings: {}
[0m08:24:05.782507 [info ] [MainThread]:   external_root: .
[0m08:24:05.782732 [info ] [MainThread]:   use_credential_provider: None
[0m08:24:05.782957 [info ] [MainThread]:   attach: None
[0m08:24:05.783182 [info ] [MainThread]:   filesystems: None
[0m08:24:05.783415 [info ] [MainThread]:   remote: None
[0m08:24:05.783639 [info ] [MainThread]:   plugins: None
[0m08:24:05.783864 [info ] [MainThread]:   disable_transactions: False
[0m08:24:05.784211 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:24:05.886266 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:24:05.907406 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:24:05.907773 [debug] [MainThread]: On debug: select 1 as id
[0m08:24:05.908032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:24:05.925986 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m08:24:05.926961 [debug] [MainThread]: On debug: Close
[0m08:24:05.927328 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:24:05.927585 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:24:05.928355 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41288465, "process_in_blocks": "0", "process_kernel_time": 0.207787, "process_mem_max_rss": "154352", "process_out_blocks": "32", "process_user_time": 1.797166}
[0m08:24:05.928735 [debug] [MainThread]: Command `cli debug` succeeded at 08:24:05.928657 after 0.41 seconds
[0m08:24:05.929006 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:24:05.929300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09b2bfc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09b2108590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09b2097890>]}
[0m08:24:05.929639 [debug] [MainThread]: Flushing usage events
[0m08:24:07.083956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:28:10.715168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c96eff5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c98acbc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c96ece000>]}


============================== 08:28:10.719012 | 59b319a3-bcb2-4584-b84f-b2e65a680fa9 ==============================
[0m08:28:10.719012 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:28:10.719447 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'quiet': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None', 'empty': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'invocation_command': 'dbt list metrics', 'cache_selected_only': 'False'}
[0m08:28:10.727848 [info ] [MainThread]: dbt version: 1.10.13
[0m08:28:10.728180 [info ] [MainThread]: python version: 3.12.3
[0m08:28:10.728435 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:28:10.728680 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:28:10.828046 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:28:10.828427 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:28:10.828670 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:28:10.829733 [info ] [MainThread]: adapter type: duckdb
[0m08:28:10.829977 [info ] [MainThread]: adapter version: 1.10.0
[0m08:28:10.928772 [info ] [MainThread]: Configuration:
[0m08:28:10.929162 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:28:10.929417 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:28:10.929652 [info ] [MainThread]: Required dependencies:
[0m08:28:10.929905 [debug] [MainThread]: Executing "git --help"
[0m08:28:10.933342 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:28:10.933971 [debug] [MainThread]: STDERR: "b''"
[0m08:28:10.934257 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:28:10.934512 [info ] [MainThread]: Connection:
[0m08:28:10.934765 [info ] [MainThread]:   database: datacore
[0m08:28:10.934996 [info ] [MainThread]:   schema: main
[0m08:28:10.935223 [info ] [MainThread]:   path: datacore.duckdb
[0m08:28:10.935457 [info ] [MainThread]:   config_options: None
[0m08:28:10.935682 [info ] [MainThread]:   extensions: None
[0m08:28:10.935909 [info ] [MainThread]:   settings: {}
[0m08:28:10.936138 [info ] [MainThread]:   external_root: .
[0m08:28:10.936369 [info ] [MainThread]:   use_credential_provider: None
[0m08:28:10.936593 [info ] [MainThread]:   attach: None
[0m08:28:10.936815 [info ] [MainThread]:   filesystems: None
[0m08:28:10.937038 [info ] [MainThread]:   remote: None
[0m08:28:10.937260 [info ] [MainThread]:   plugins: None
[0m08:28:10.937490 [info ] [MainThread]:   disable_transactions: False
[0m08:28:10.937874 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:28:11.039286 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:28:11.060661 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:28:11.061054 [debug] [MainThread]: On debug: select 1 as id
[0m08:28:11.061325 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:28:11.078870 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m08:28:11.079897 [debug] [MainThread]: On debug: Close
[0m08:28:11.080246 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:28:11.080508 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:28:11.081322 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4229401, "process_in_blocks": "0", "process_kernel_time": 0.211027, "process_mem_max_rss": "152936", "process_out_blocks": "24", "process_user_time": 1.782234}
[0m08:28:11.081714 [debug] [MainThread]: Command `cli debug` succeeded at 08:28:11.081630 after 0.42 seconds
[0m08:28:11.081990 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:28:11.082283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c971e9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c86780b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c9656d9a0>]}
[0m08:28:11.082642 [debug] [MainThread]: Flushing usage events
[0m08:28:12.368827 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:28:48.865986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04af247fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04ae525a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04ae7f0350>]}


============================== 08:28:48.869008 | 0b6553b9-fb7c-4554-924a-5e2136af476a ==============================
[0m08:28:48.869008 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:28:48.869453 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/chun/Develop/datacore', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/chun/Develop/datacore/logs', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'True', 'invocation_command': 'dbt list metrics', 'use_colors': 'True', 'version_check': 'True'}
[0m08:28:48.877788 [info ] [MainThread]: dbt version: 1.10.13
[0m08:28:48.878123 [info ] [MainThread]: python version: 3.12.3
[0m08:28:48.878383 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:28:48.878630 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:28:48.982500 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:28:48.982885 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:28:48.983138 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:28:48.984265 [info ] [MainThread]: adapter type: duckdb
[0m08:28:48.984527 [info ] [MainThread]: adapter version: 1.10.0
[0m08:28:49.089447 [info ] [MainThread]: Configuration:
[0m08:28:49.089855 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:28:49.090114 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:28:49.090370 [info ] [MainThread]: Required dependencies:
[0m08:28:49.090642 [debug] [MainThread]: Executing "git --help"
[0m08:28:49.092924 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:28:49.093276 [debug] [MainThread]: STDERR: "b''"
[0m08:28:49.093543 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:28:49.093791 [info ] [MainThread]: Connection:
[0m08:28:49.094050 [info ] [MainThread]:   database: datacore
[0m08:28:49.094292 [info ] [MainThread]:   schema: main
[0m08:28:49.094542 [info ] [MainThread]:   path: datacore.duckdb
[0m08:28:49.094786 [info ] [MainThread]:   config_options: None
[0m08:28:49.095031 [info ] [MainThread]:   extensions: None
[0m08:28:49.095273 [info ] [MainThread]:   settings: {}
[0m08:28:49.095530 [info ] [MainThread]:   external_root: .
[0m08:28:49.095770 [info ] [MainThread]:   use_credential_provider: None
[0m08:28:49.096014 [info ] [MainThread]:   attach: None
[0m08:28:49.096252 [info ] [MainThread]:   filesystems: None
[0m08:28:49.096499 [info ] [MainThread]:   remote: None
[0m08:28:49.096737 [info ] [MainThread]:   plugins: None
[0m08:28:49.096977 [info ] [MainThread]:   disable_transactions: False
[0m08:28:49.097351 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:28:49.198622 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:28:49.219687 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:28:49.220046 [debug] [MainThread]: On debug: select 1 as id
[0m08:28:49.220307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:28:49.237919 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m08:28:49.238887 [debug] [MainThread]: On debug: Close
[0m08:28:49.239235 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:28:49.239492 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:28:49.240258 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42887032, "process_in_blocks": "0", "process_kernel_time": 0.209023, "process_mem_max_rss": "153388", "process_out_blocks": "32", "process_user_time": 1.763194}
[0m08:28:49.240639 [debug] [MainThread]: Command `cli debug` succeeded at 08:28:49.240559 after 0.43 seconds
[0m08:28:49.240903 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:28:49.241185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04ae503e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04ad8ed3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04ae77eff0>]}
[0m08:28:49.241533 [debug] [MainThread]: Flushing usage events
[0m08:28:51.646927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:06.231702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9584675f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b95abc69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b95847e090>]}


============================== 08:30:06.235099 | 41c6ec08-99a7-43d0-9ce2-cbbb9af80d5f ==============================
[0m08:30:06.235099 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:30:06.235527 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'printer_width': '80', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'invocation_command': 'dbt list metrics', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'quiet': 'True'}
[0m08:30:06.243508 [info ] [MainThread]: dbt version: 1.10.13
[0m08:30:06.243830 [info ] [MainThread]: python version: 3.12.3
[0m08:30:06.244074 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:30:06.244310 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:30:06.340372 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:30:06.340738 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:30:06.340974 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:30:06.342009 [info ] [MainThread]: adapter type: duckdb
[0m08:30:06.342248 [info ] [MainThread]: adapter version: 1.10.0
[0m08:30:06.437504 [info ] [MainThread]: Configuration:
[0m08:30:06.437881 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:30:06.438120 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:30:06.438355 [info ] [MainThread]: Required dependencies:
[0m08:30:06.438601 [debug] [MainThread]: Executing "git --help"
[0m08:30:06.441678 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:30:06.442259 [debug] [MainThread]: STDERR: "b''"
[0m08:30:06.442644 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:30:06.442989 [info ] [MainThread]: Connection:
[0m08:30:06.443345 [info ] [MainThread]:   database: datacore
[0m08:30:06.443666 [info ] [MainThread]:   schema: main
[0m08:30:06.443984 [info ] [MainThread]:   path: datacore.duckdb
[0m08:30:06.444322 [info ] [MainThread]:   config_options: None
[0m08:30:06.444637 [info ] [MainThread]:   extensions: None
[0m08:30:06.444953 [info ] [MainThread]:   settings: {}
[0m08:30:06.445270 [info ] [MainThread]:   external_root: .
[0m08:30:06.445593 [info ] [MainThread]:   use_credential_provider: None
[0m08:30:06.445907 [info ] [MainThread]:   attach: None
[0m08:30:06.446217 [info ] [MainThread]:   filesystems: None
[0m08:30:06.446535 [info ] [MainThread]:   remote: None
[0m08:30:06.446845 [info ] [MainThread]:   plugins: None
[0m08:30:06.447156 [info ] [MainThread]:   disable_transactions: False
[0m08:30:06.447662 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:30:06.549004 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:30:06.570032 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:30:06.570429 [debug] [MainThread]: On debug: select 1 as id
[0m08:30:06.570686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:30:06.588529 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m08:30:06.589554 [debug] [MainThread]: On debug: Close
[0m08:30:06.589920 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:30:06.590174 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:30:06.590998 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41019952, "process_in_blocks": "0", "process_kernel_time": 0.225718, "process_mem_max_rss": "153280", "process_out_blocks": "32", "process_user_time": 1.68889}
[0m08:30:06.591405 [debug] [MainThread]: Command `cli debug` succeeded at 08:30:06.591320 after 0.41 seconds
[0m08:30:06.591676 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:30:06.591969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9588a6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b94872abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b95821b9e0>]}
[0m08:30:06.592341 [debug] [MainThread]: Flushing usage events
[0m08:30:07.775927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:33:27.534662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aaef8857950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aaef86010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aaefa3b3140>]}


============================== 08:33:27.537945 | cc0050a6-9cea-4209-b41a-d2ca7e7b06a3 ==============================
[0m08:33:27.537945 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:33:27.538405 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt list metrics', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None'}
[0m08:33:27.546881 [info ] [MainThread]: dbt version: 1.10.13
[0m08:33:27.547224 [info ] [MainThread]: python version: 3.12.3
[0m08:33:27.547488 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:33:27.547739 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:33:27.653769 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:33:27.654168 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:33:27.654432 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:33:27.655585 [info ] [MainThread]: adapter type: duckdb
[0m08:33:27.655845 [info ] [MainThread]: adapter version: 1.10.0
[0m08:33:27.760438 [info ] [MainThread]: Configuration:
[0m08:33:27.760847 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:33:27.761102 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:33:27.761355 [info ] [MainThread]: Required dependencies:
[0m08:33:27.761625 [debug] [MainThread]: Executing "git --help"
[0m08:33:27.764213 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:33:27.764554 [debug] [MainThread]: STDERR: "b''"
[0m08:33:27.764813 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:33:27.765061 [info ] [MainThread]: Connection:
[0m08:33:27.765326 [info ] [MainThread]:   database: datacore
[0m08:33:27.765568 [info ] [MainThread]:   schema: main
[0m08:33:27.765807 [info ] [MainThread]:   path: datacore.duckdb
[0m08:33:27.766049 [info ] [MainThread]:   config_options: None
[0m08:33:27.766289 [info ] [MainThread]:   extensions: None
[0m08:33:27.766541 [info ] [MainThread]:   settings: {}
[0m08:33:27.766782 [info ] [MainThread]:   external_root: .
[0m08:33:27.767021 [info ] [MainThread]:   use_credential_provider: None
[0m08:33:27.767260 [info ] [MainThread]:   attach: None
[0m08:33:27.767505 [info ] [MainThread]:   filesystems: None
[0m08:33:27.767740 [info ] [MainThread]:   remote: None
[0m08:33:27.767977 [info ] [MainThread]:   plugins: None
[0m08:33:27.768217 [info ] [MainThread]:   disable_transactions: False
[0m08:33:27.768594 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:33:27.868559 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:33:27.889021 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:33:27.889384 [debug] [MainThread]: On debug: select 1 as id
[0m08:33:27.889637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:33:27.906696 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m08:33:27.907635 [debug] [MainThread]: On debug: Close
[0m08:33:27.907964 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:33:27.908210 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:33:27.908965 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42920893, "process_in_blocks": "0", "process_kernel_time": 0.200916, "process_mem_max_rss": "153396", "process_out_blocks": "32", "process_user_time": 1.792252}
[0m08:33:27.909342 [debug] [MainThread]: Command `cli debug` succeeded at 08:33:27.909256 after 0.43 seconds
[0m08:33:27.909604 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:33:27.909882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aaef86010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aaef70c1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aaef7150470>]}
[0m08:33:27.910205 [debug] [MainThread]: Flushing usage events
[0m08:33:29.000778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:57:53.615661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b277d9d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b27875ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2775de360>]}


============================== 08:57:53.618819 | 54179fa5-d61e-43b6-93bd-52153c2aa959 ==============================
[0m08:57:53.618819 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:57:53.619272 [debug] [MainThread]: running dbt with arguments {'quiet': 'True', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'empty': 'None', 'invocation_command': 'dbt list metrics', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'printer_width': '80', 'profiles_dir': '/home/chun/Develop/datacore'}
[0m08:57:53.627775 [info ] [MainThread]: dbt version: 1.10.13
[0m08:57:53.628119 [info ] [MainThread]: python version: 3.12.3
[0m08:57:53.628384 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:57:53.628638 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:57:53.735672 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:57:53.736061 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:57:53.736330 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:57:53.737484 [info ] [MainThread]: adapter type: duckdb
[0m08:57:53.737744 [info ] [MainThread]: adapter version: 1.10.0
[0m08:57:53.837199 [info ] [MainThread]: Configuration:
[0m08:57:53.837580 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:57:53.837820 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:57:53.838049 [info ] [MainThread]: Required dependencies:
[0m08:57:53.838296 [debug] [MainThread]: Executing "git --help"
[0m08:57:53.841411 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:57:53.841842 [debug] [MainThread]: STDERR: "b''"
[0m08:57:53.842178 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:57:53.842509 [info ] [MainThread]: Connection:
[0m08:57:53.842812 [info ] [MainThread]:   database: datacore
[0m08:57:53.843032 [info ] [MainThread]:   schema: main
[0m08:57:53.843252 [info ] [MainThread]:   path: datacore.duckdb
[0m08:57:53.843478 [info ] [MainThread]:   config_options: None
[0m08:57:53.843696 [info ] [MainThread]:   extensions: None
[0m08:57:53.843917 [info ] [MainThread]:   settings: {}
[0m08:57:53.844143 [info ] [MainThread]:   external_root: .
[0m08:57:53.844367 [info ] [MainThread]:   use_credential_provider: None
[0m08:57:53.844587 [info ] [MainThread]:   attach: None
[0m08:57:53.844803 [info ] [MainThread]:   filesystems: None
[0m08:57:53.845018 [info ] [MainThread]:   remote: None
[0m08:57:53.845235 [info ] [MainThread]:   plugins: None
[0m08:57:53.845457 [info ] [MainThread]:   disable_transactions: False
[0m08:57:53.845796 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:57:53.946821 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:57:53.967787 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:57:53.968151 [debug] [MainThread]: On debug: select 1 as id
[0m08:57:53.968419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:57:53.985719 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m08:57:53.986667 [debug] [MainThread]: On debug: Close
[0m08:57:53.986997 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:57:53.987240 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:57:53.987992 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42747974, "process_in_blocks": "0", "process_kernel_time": 0.21153, "process_mem_max_rss": "153080", "process_out_blocks": "24", "process_user_time": 1.759097}
[0m08:57:53.988379 [debug] [MainThread]: Command `cli debug` succeeded at 08:57:53.988291 after 0.43 seconds
[0m08:57:53.988637 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:57:53.988911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2770391f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b267205d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b267205e50>]}
[0m08:57:53.989231 [debug] [MainThread]: Flushing usage events
[0m08:57:55.200299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:11.215159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ffbd637bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ffbd6d9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ffbe0a27b0>]}


============================== 09:12:11.218414 | 44bf7c9d-75f5-4dba-be9d-981ef178b400 ==============================
[0m09:12:11.218414 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:12:11.218876 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt list metrics', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'fail_fast': 'False', 'target_path': 'None', 'empty': 'None'}
[0m09:12:11.227422 [info ] [MainThread]: dbt version: 1.10.13
[0m09:12:11.227774 [info ] [MainThread]: python version: 3.12.3
[0m09:12:11.228038 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m09:12:11.228292 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m09:12:11.334318 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m09:12:11.334710 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m09:12:11.334967 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m09:12:11.336155 [info ] [MainThread]: adapter type: duckdb
[0m09:12:11.336422 [info ] [MainThread]: adapter version: 1.10.0
[0m09:12:11.440587 [info ] [MainThread]: Configuration:
[0m09:12:11.440991 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:12:11.441263 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:12:11.441536 [info ] [MainThread]: Required dependencies:
[0m09:12:11.441815 [debug] [MainThread]: Executing "git --help"
[0m09:12:11.444698 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:12:11.445052 [debug] [MainThread]: STDERR: "b''"
[0m09:12:11.445326 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:12:11.445582 [info ] [MainThread]: Connection:
[0m09:12:11.445841 [info ] [MainThread]:   database: datacore
[0m09:12:11.446086 [info ] [MainThread]:   schema: main
[0m09:12:11.446335 [info ] [MainThread]:   path: datacore.duckdb
[0m09:12:11.446581 [info ] [MainThread]:   config_options: None
[0m09:12:11.446819 [info ] [MainThread]:   extensions: None
[0m09:12:11.447062 [info ] [MainThread]:   settings: {}
[0m09:12:11.447320 [info ] [MainThread]:   external_root: .
[0m09:12:11.447561 [info ] [MainThread]:   use_credential_provider: None
[0m09:12:11.447807 [info ] [MainThread]:   attach: None
[0m09:12:11.448049 [info ] [MainThread]:   filesystems: None
[0m09:12:11.448290 [info ] [MainThread]:   remote: None
[0m09:12:11.448536 [info ] [MainThread]:   plugins: None
[0m09:12:11.448778 [info ] [MainThread]:   disable_transactions: False
[0m09:12:11.449154 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m09:12:11.549432 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m09:12:11.570373 [debug] [MainThread]: Using duckdb connection "debug"
[0m09:12:11.570738 [debug] [MainThread]: On debug: select 1 as id
[0m09:12:11.570999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:11.588291 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m09:12:11.589265 [debug] [MainThread]: On debug: Close
[0m09:12:11.589617 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:12:11.589869 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:12:11.590640 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4311828, "process_in_blocks": "0", "process_kernel_time": 0.227999, "process_mem_max_rss": "153480", "process_out_blocks": "24", "process_user_time": 1.761996}
[0m09:12:11.591020 [debug] [MainThread]: Command `cli debug` succeeded at 09:12:11.590938 after 0.43 seconds
[0m09:12:11.591291 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:12:11.591584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ffbe0d3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ffac999a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ffbc73d0a0>]}
[0m09:12:11.591914 [debug] [MainThread]: Flushing usage events
[0m09:12:12.920157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:25.712325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e812611f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e812554f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8125e50a40>]}


============================== 09:12:25.715671 | ee88fe27-dff2-4eb7-adc4-253599cecae3 ==============================
[0m09:12:25.715671 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:12:25.716092 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'invocation_command': 'dbt query --metrics daily_revenue --group-by city,transaction_date --start-time 2025-11-14 --end-time 2025-11-29 --explain', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'True', 'no_print': 'None', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'debug': 'False', 'static_parser': 'True', 'empty': 'None', 'write_json': 'True', 'partial_parse': 'True', 'log_path': '/home/chun/Develop/datacore/logs'}
[0m09:12:25.723985 [info ] [MainThread]: dbt version: 1.10.13
[0m09:12:25.724315 [info ] [MainThread]: python version: 3.12.3
[0m09:12:25.724555 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m09:12:25.724790 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m09:12:25.821775 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m09:12:25.822129 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m09:12:25.822371 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m09:12:25.823413 [info ] [MainThread]: adapter type: duckdb
[0m09:12:25.823650 [info ] [MainThread]: adapter version: 1.10.0
[0m09:12:25.918503 [info ] [MainThread]: Configuration:
[0m09:12:25.918871 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:12:25.919110 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:12:25.919345 [info ] [MainThread]: Required dependencies:
[0m09:12:25.919592 [debug] [MainThread]: Executing "git --help"
[0m09:12:25.922727 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:12:25.923171 [debug] [MainThread]: STDERR: "b''"
[0m09:12:25.923522 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:12:25.923846 [info ] [MainThread]: Connection:
[0m09:12:25.924181 [info ] [MainThread]:   database: datacore
[0m09:12:25.924502 [info ] [MainThread]:   schema: main
[0m09:12:25.924757 [info ] [MainThread]:   path: datacore.duckdb
[0m09:12:25.924977 [info ] [MainThread]:   config_options: None
[0m09:12:25.925197 [info ] [MainThread]:   extensions: None
[0m09:12:25.925426 [info ] [MainThread]:   settings: {}
[0m09:12:25.925652 [info ] [MainThread]:   external_root: .
[0m09:12:25.925874 [info ] [MainThread]:   use_credential_provider: None
[0m09:12:25.926099 [info ] [MainThread]:   attach: None
[0m09:12:25.926325 [info ] [MainThread]:   filesystems: None
[0m09:12:25.926547 [info ] [MainThread]:   remote: None
[0m09:12:25.926767 [info ] [MainThread]:   plugins: None
[0m09:12:25.926987 [info ] [MainThread]:   disable_transactions: False
[0m09:12:25.927337 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m09:12:26.028962 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m09:12:26.049848 [debug] [MainThread]: Using duckdb connection "debug"
[0m09:12:26.050212 [debug] [MainThread]: On debug: select 1 as id
[0m09:12:26.050481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:26.056033 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m09:12:26.056380 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m09:12:26.056704 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m09:12:26.056953 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:12:26.057199 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 349101) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m09:12:26.057929 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.39659217, "process_in_blocks": "0", "process_kernel_time": 0.211005, "process_mem_max_rss": "149868", "process_out_blocks": "16", "process_user_time": 1.745049}
[0m09:12:26.058309 [debug] [MainThread]: Command `cli debug` failed at 09:12:26.058222 after 0.40 seconds
[0m09:12:26.058581 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:12:26.058858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8127243ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e811579c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8115464a10>]}
[0m09:12:26.059184 [debug] [MainThread]: Flushing usage events
[0m09:12:27.253967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:56.878441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbce259790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbce3c0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbce259ca0>]}


============================== 09:18:56.881315 | de68fd8a-359f-49a3-aa77-ae457dd06fd7 ==============================
[0m09:18:56.881315 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:18:56.881724 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True', 'empty': 'None', 'fail_fast': 'False', 'quiet': 'True', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt list metrics', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m09:18:56.889487 [info ] [MainThread]: dbt version: 1.10.13
[0m09:18:56.889812 [info ] [MainThread]: python version: 3.12.3
[0m09:18:56.890050 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m09:18:56.890279 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m09:18:56.987182 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m09:18:56.987544 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m09:18:56.987779 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m09:18:56.988826 [info ] [MainThread]: adapter type: duckdb
[0m09:18:56.989065 [info ] [MainThread]: adapter version: 1.10.0
[0m09:18:57.083537 [info ] [MainThread]: Configuration:
[0m09:18:57.083910 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:18:57.084149 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:18:57.084384 [info ] [MainThread]: Required dependencies:
[0m09:18:57.084629 [debug] [MainThread]: Executing "git --help"
[0m09:18:57.087687 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:18:57.088005 [debug] [MainThread]: STDERR: "b''"
[0m09:18:57.088244 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:18:57.088475 [info ] [MainThread]: Connection:
[0m09:18:57.088709 [info ] [MainThread]:   database: datacore
[0m09:18:57.088927 [info ] [MainThread]:   schema: main
[0m09:18:57.089147 [info ] [MainThread]:   path: datacore.duckdb
[0m09:18:57.089374 [info ] [MainThread]:   config_options: None
[0m09:18:57.089593 [info ] [MainThread]:   extensions: None
[0m09:18:57.089811 [info ] [MainThread]:   settings: {}
[0m09:18:57.090033 [info ] [MainThread]:   external_root: .
[0m09:18:57.090250 [info ] [MainThread]:   use_credential_provider: None
[0m09:18:57.090475 [info ] [MainThread]:   attach: None
[0m09:18:57.090692 [info ] [MainThread]:   filesystems: None
[0m09:18:57.090907 [info ] [MainThread]:   remote: None
[0m09:18:57.091130 [info ] [MainThread]:   plugins: None
[0m09:18:57.091353 [info ] [MainThread]:   disable_transactions: False
[0m09:18:57.091689 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m09:18:57.190898 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m09:18:57.212404 [debug] [MainThread]: Using duckdb connection "debug"
[0m09:18:57.212770 [debug] [MainThread]: On debug: select 1 as id
[0m09:18:57.213023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:18:57.230035 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m09:18:57.230990 [debug] [MainThread]: On debug: Close
[0m09:18:57.231334 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:18:57.231581 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:18:57.232342 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.40619516, "process_in_blocks": "0", "process_kernel_time": 0.182048, "process_mem_max_rss": "153416", "process_out_blocks": "24", "process_user_time": 1.697456}
[0m09:18:57.232709 [debug] [MainThread]: Command `cli debug` succeeded at 09:18:57.232630 after 0.41 seconds
[0m09:18:57.232971 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:18:57.233243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbcdebad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbcf3441d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbccf611c0>]}
[0m09:18:57.233575 [debug] [MainThread]: Flushing usage events
[0m09:18:58.418929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:36:32.006401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7149d58080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c714b589400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c714af16ae0>]}


============================== 09:36:32.009644 | e1857406-dcd9-4ba1-8ae2-0e9361c0c604 ==============================
[0m09:36:32.009644 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:36:32.010089 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'True', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt list metrics', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'write_json': 'True', 'version_check': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'log_format': 'default', 'fail_fast': 'False'}
[0m09:36:32.018764 [info ] [MainThread]: dbt version: 1.10.13
[0m09:36:32.019117 [info ] [MainThread]: python version: 3.12.3
[0m09:36:32.019379 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m09:36:32.019632 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m09:36:32.125217 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m09:36:32.125609 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m09:36:32.125864 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m09:36:32.127012 [info ] [MainThread]: adapter type: duckdb
[0m09:36:32.127270 [info ] [MainThread]: adapter version: 1.10.0
[0m09:36:32.234621 [info ] [MainThread]: Configuration:
[0m09:36:32.235028 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:36:32.235288 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:36:32.235549 [info ] [MainThread]: Required dependencies:
[0m09:36:32.235819 [debug] [MainThread]: Executing "git --help"
[0m09:36:32.238700 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:36:32.239035 [debug] [MainThread]: STDERR: "b''"
[0m09:36:32.239295 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:36:32.239564 [info ] [MainThread]: Connection:
[0m09:36:32.239824 [info ] [MainThread]:   database: datacore
[0m09:36:32.240072 [info ] [MainThread]:   schema: main
[0m09:36:32.240318 [info ] [MainThread]:   path: datacore.duckdb
[0m09:36:32.240560 [info ] [MainThread]:   config_options: None
[0m09:36:32.240799 [info ] [MainThread]:   extensions: None
[0m09:36:32.241043 [info ] [MainThread]:   settings: {}
[0m09:36:32.241285 [info ] [MainThread]:   external_root: .
[0m09:36:32.241542 [info ] [MainThread]:   use_credential_provider: None
[0m09:36:32.241782 [info ] [MainThread]:   attach: None
[0m09:36:32.242022 [info ] [MainThread]:   filesystems: None
[0m09:36:32.242259 [info ] [MainThread]:   remote: None
[0m09:36:32.242508 [info ] [MainThread]:   plugins: None
[0m09:36:32.242746 [info ] [MainThread]:   disable_transactions: False
[0m09:36:32.243121 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m09:36:32.345279 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m09:36:32.366641 [debug] [MainThread]: Using duckdb connection "debug"
[0m09:36:32.367007 [debug] [MainThread]: On debug: select 1 as id
[0m09:36:32.367267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:36:32.384899 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m09:36:32.385861 [debug] [MainThread]: On debug: Close
[0m09:36:32.386200 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:36:32.386455 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:36:32.387222 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.45765346, "process_in_blocks": "0", "process_kernel_time": 0.212693, "process_mem_max_rss": "154640", "process_out_blocks": "40", "process_user_time": 1.796409}
[0m09:36:32.387607 [debug] [MainThread]: Command `cli debug` succeeded at 09:36:32.387528 after 0.46 seconds
[0m09:36:32.387872 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:36:32.388155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c714ad9b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c714ae6a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7149cab0e0>]}
[0m09:36:32.388497 [debug] [MainThread]: Flushing usage events
[0m09:36:34.338104 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:29.798903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49ad97a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49aead4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49adad83e0>]}


============================== 09:37:29.802558 | bc582fa6-42af-4751-8b00-5c234fe84152 ==============================
[0m09:37:29.802558 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:37:29.803011 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt list metrics', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'partial_parse': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'True', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/home/chun/Develop/datacore/logs'}
[0m09:37:29.811470 [info ] [MainThread]: dbt version: 1.10.13
[0m09:37:29.811815 [info ] [MainThread]: python version: 3.12.3
[0m09:37:29.812068 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m09:37:29.812333 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m09:37:29.918624 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m09:37:29.919012 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m09:37:29.919270 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m09:37:29.920424 [info ] [MainThread]: adapter type: duckdb
[0m09:37:29.920688 [info ] [MainThread]: adapter version: 1.10.0
[0m09:37:30.027061 [info ] [MainThread]: Configuration:
[0m09:37:30.027478 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:37:30.027745 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:37:30.028001 [info ] [MainThread]: Required dependencies:
[0m09:37:30.028279 [debug] [MainThread]: Executing "git --help"
[0m09:37:30.030842 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:37:30.031317 [debug] [MainThread]: STDERR: "b''"
[0m09:37:30.031685 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:37:30.032038 [info ] [MainThread]: Connection:
[0m09:37:30.032358 [info ] [MainThread]:   database: datacore
[0m09:37:30.032603 [info ] [MainThread]:   schema: main
[0m09:37:30.032845 [info ] [MainThread]:   path: datacore.duckdb
[0m09:37:30.033088 [info ] [MainThread]:   config_options: None
[0m09:37:30.033337 [info ] [MainThread]:   extensions: None
[0m09:37:30.033581 [info ] [MainThread]:   settings: {}
[0m09:37:30.033827 [info ] [MainThread]:   external_root: .
[0m09:37:30.034067 [info ] [MainThread]:   use_credential_provider: None
[0m09:37:30.034321 [info ] [MainThread]:   attach: None
[0m09:37:30.034561 [info ] [MainThread]:   filesystems: None
[0m09:37:30.034801 [info ] [MainThread]:   remote: None
[0m09:37:30.035041 [info ] [MainThread]:   plugins: None
[0m09:37:30.035292 [info ] [MainThread]:   disable_transactions: False
[0m09:37:30.035680 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m09:37:30.137774 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m09:37:30.158483 [debug] [MainThread]: Using duckdb connection "debug"
[0m09:37:30.158847 [debug] [MainThread]: On debug: select 1 as id
[0m09:37:30.159106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:37:30.176145 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m09:37:30.177098 [debug] [MainThread]: On debug: Close
[0m09:37:30.177454 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:37:30.177704 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:37:30.178467 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43439636, "process_in_blocks": "0", "process_kernel_time": 0.19996, "process_mem_max_rss": "153104", "process_out_blocks": "32", "process_user_time": 1.74066}
[0m09:37:30.178837 [debug] [MainThread]: Command `cli debug` succeeded at 09:37:30.178757 after 0.43 seconds
[0m09:37:30.179101 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:37:30.179391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49ad8e8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49ad8ea6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49ac607200>]}
[0m09:37:30.179718 [debug] [MainThread]: Flushing usage events
[0m09:37:31.470165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:40:01.770097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721673652450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72167381f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72167258d6d0>]}


============================== 09:40:01.773454 | 0bbb48a9-2271-4686-ad8d-625506b653ff ==============================
[0m09:40:01.773454 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:40:01.773901 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'write_json': 'True', 'quiet': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'use_colors': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt list metrics', 'version_check': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80'}
[0m09:40:01.782456 [info ] [MainThread]: dbt version: 1.10.13
[0m09:40:01.782794 [info ] [MainThread]: python version: 3.12.3
[0m09:40:01.783049 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m09:40:01.783298 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m09:40:01.888817 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m09:40:01.889204 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m09:40:01.889472 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m09:40:01.890606 [info ] [MainThread]: adapter type: duckdb
[0m09:40:01.890867 [info ] [MainThread]: adapter version: 1.10.0
[0m09:40:01.995287 [info ] [MainThread]: Configuration:
[0m09:40:01.995690 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:40:01.995963 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:40:01.996212 [info ] [MainThread]: Required dependencies:
[0m09:40:01.996485 [debug] [MainThread]: Executing "git --help"
[0m09:40:01.998943 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:40:01.999439 [debug] [MainThread]: STDERR: "b''"
[0m09:40:01.999819 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:40:02.000183 [info ] [MainThread]: Connection:
[0m09:40:02.000537 [info ] [MainThread]:   database: datacore
[0m09:40:02.000779 [info ] [MainThread]:   schema: main
[0m09:40:02.001020 [info ] [MainThread]:   path: datacore.duckdb
[0m09:40:02.001260 [info ] [MainThread]:   config_options: None
[0m09:40:02.001505 [info ] [MainThread]:   extensions: None
[0m09:40:02.001743 [info ] [MainThread]:   settings: {}
[0m09:40:02.001984 [info ] [MainThread]:   external_root: .
[0m09:40:02.002221 [info ] [MainThread]:   use_credential_provider: None
[0m09:40:02.002472 [info ] [MainThread]:   attach: None
[0m09:40:02.002707 [info ] [MainThread]:   filesystems: None
[0m09:40:02.002943 [info ] [MainThread]:   remote: None
[0m09:40:02.003178 [info ] [MainThread]:   plugins: None
[0m09:40:02.003425 [info ] [MainThread]:   disable_transactions: False
[0m09:40:02.003790 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m09:40:02.108746 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m09:40:02.129884 [debug] [MainThread]: Using duckdb connection "debug"
[0m09:40:02.130248 [debug] [MainThread]: On debug: select 1 as id
[0m09:40:02.130509 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:40:02.147879 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m09:40:02.148832 [debug] [MainThread]: On debug: Close
[0m09:40:02.149172 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:40:02.149427 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:40:02.150198 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4352756, "process_in_blocks": "0", "process_kernel_time": 0.23085, "process_mem_max_rss": "153264", "process_out_blocks": "32", "process_user_time": 1.789837}
[0m09:40:02.150573 [debug] [MainThread]: Command `cli debug` succeeded at 09:40:02.150495 after 0.44 seconds
[0m09:40:02.150834 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:40:02.151108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721671497590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72167256a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216714b3f80>]}
[0m09:40:02.151433 [debug] [MainThread]: Flushing usage events
[0m09:40:03.356917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:40:05.730007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236d32e20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236d451a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236d2a9ff20>]}


============================== 09:40:05.733276 | d44f4573-38b4-45e2-b829-52b71c775c15 ==============================
[0m09:40:05.733276 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:40:05.733695 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'empty': 'None', 'invocation_command': 'dbt list metrics', 'indirect_selection': 'eager', 'log_format': 'default', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'True', 'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'no_print': 'None', 'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True'}
[0m09:40:05.741456 [info ] [MainThread]: dbt version: 1.10.13
[0m09:40:05.741776 [info ] [MainThread]: python version: 3.12.3
[0m09:40:05.742015 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m09:40:05.742245 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m09:40:05.839409 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m09:40:05.839771 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m09:40:05.840011 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m09:40:05.841048 [info ] [MainThread]: adapter type: duckdb
[0m09:40:05.841288 [info ] [MainThread]: adapter version: 1.10.0
[0m09:40:05.939159 [info ] [MainThread]: Configuration:
[0m09:40:05.939545 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:40:05.939791 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:40:05.940025 [info ] [MainThread]: Required dependencies:
[0m09:40:05.940278 [debug] [MainThread]: Executing "git --help"
[0m09:40:05.943229 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:40:05.943675 [debug] [MainThread]: STDERR: "b''"
[0m09:40:05.944014 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:40:05.944345 [info ] [MainThread]: Connection:
[0m09:40:05.944677 [info ] [MainThread]:   database: datacore
[0m09:40:05.944979 [info ] [MainThread]:   schema: main
[0m09:40:05.945221 [info ] [MainThread]:   path: datacore.duckdb
[0m09:40:05.945462 [info ] [MainThread]:   config_options: None
[0m09:40:05.945684 [info ] [MainThread]:   extensions: None
[0m09:40:05.945906 [info ] [MainThread]:   settings: {}
[0m09:40:05.946133 [info ] [MainThread]:   external_root: .
[0m09:40:05.946360 [info ] [MainThread]:   use_credential_provider: None
[0m09:40:05.946583 [info ] [MainThread]:   attach: None
[0m09:40:05.946803 [info ] [MainThread]:   filesystems: None
[0m09:40:05.947023 [info ] [MainThread]:   remote: None
[0m09:40:05.947244 [info ] [MainThread]:   plugins: None
[0m09:40:05.947474 [info ] [MainThread]:   disable_transactions: False
[0m09:40:05.947815 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m09:40:06.048080 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m09:40:06.068692 [debug] [MainThread]: Using duckdb connection "debug"
[0m09:40:06.069051 [debug] [MainThread]: On debug: select 1 as id
[0m09:40:06.069308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:40:06.086343 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m09:40:06.087293 [debug] [MainThread]: On debug: Close
[0m09:40:06.087630 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:40:06.087874 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:40:06.088632 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.40889663, "process_in_blocks": "0", "process_kernel_time": 0.214708, "process_mem_max_rss": "153316", "process_out_blocks": "16", "process_user_time": 1.674722}
[0m09:40:06.089004 [debug] [MainThread]: Command `cli debug` succeeded at 09:40:06.088925 after 0.41 seconds
[0m09:40:06.089263 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:40:06.089555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236c1cc6c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236d401c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236d2accbf0>]}
[0m09:40:06.089886 [debug] [MainThread]: Flushing usage events
[0m09:40:07.230390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:48:32.060200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c19e4e8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c19c704200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c19d56da30>]}


============================== 09:48:32.063076 | b5ff9a9b-9f4a-41fa-96d3-d8e02cd3edf4 ==============================
[0m09:48:32.063076 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:48:32.063496 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'warn_error': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'static_parser': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'log_format': 'default', 'invocation_command': 'dbt list metrics', 'target_path': 'None'}
[0m09:48:32.071277 [info ] [MainThread]: dbt version: 1.10.13
[0m09:48:32.071591 [info ] [MainThread]: python version: 3.12.3
[0m09:48:32.071826 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m09:48:32.072058 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m09:48:32.170041 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m09:48:32.170414 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m09:48:32.170658 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m09:48:32.171726 [info ] [MainThread]: adapter type: duckdb
[0m09:48:32.171973 [info ] [MainThread]: adapter version: 1.10.0
[0m09:48:32.268798 [info ] [MainThread]: Configuration:
[0m09:48:32.269169 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:48:32.269418 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:48:32.269648 [info ] [MainThread]: Required dependencies:
[0m09:48:32.269894 [debug] [MainThread]: Executing "git --help"
[0m09:48:32.272922 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:48:32.273370 [debug] [MainThread]: STDERR: "b''"
[0m09:48:32.273706 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:48:32.274035 [info ] [MainThread]: Connection:
[0m09:48:32.274363 [info ] [MainThread]:   database: datacore
[0m09:48:32.274605 [info ] [MainThread]:   schema: main
[0m09:48:32.274827 [info ] [MainThread]:   path: datacore.duckdb
[0m09:48:32.275046 [info ] [MainThread]:   config_options: None
[0m09:48:32.275264 [info ] [MainThread]:   extensions: None
[0m09:48:32.275497 [info ] [MainThread]:   settings: {}
[0m09:48:32.275720 [info ] [MainThread]:   external_root: .
[0m09:48:32.275940 [info ] [MainThread]:   use_credential_provider: None
[0m09:48:32.276166 [info ] [MainThread]:   attach: None
[0m09:48:32.276392 [info ] [MainThread]:   filesystems: None
[0m09:48:32.276610 [info ] [MainThread]:   remote: None
[0m09:48:32.276829 [info ] [MainThread]:   plugins: None
[0m09:48:32.277048 [info ] [MainThread]:   disable_transactions: False
[0m09:48:32.277393 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m09:48:32.378431 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m09:48:32.399243 [debug] [MainThread]: Using duckdb connection "debug"
[0m09:48:32.399604 [debug] [MainThread]: On debug: select 1 as id
[0m09:48:32.399854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:48:32.417082 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m09:48:32.418034 [debug] [MainThread]: On debug: Close
[0m09:48:32.418379 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:48:32.418628 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:48:32.419377 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.413859, "process_in_blocks": "0", "process_kernel_time": 0.2231, "process_mem_max_rss": "153092", "process_out_blocks": "24", "process_user_time": 1.736781}
[0m09:48:32.419745 [debug] [MainThread]: Command `cli debug` succeeded at 09:48:32.419667 after 0.41 seconds
[0m09:48:32.420002 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:48:32.420278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c19e4ca8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c19df73d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c19daebe00>]}
[0m09:48:32.420602 [debug] [MainThread]: Flushing usage events
[0m09:48:34.028214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:28.016532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7814424b8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781443841340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781442c32720>]}


============================== 10:14:28.019903 | c1ed1ad8-8947-4181-81bd-ae6bc0f21cdd ==============================
[0m10:14:28.019903 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:14:28.020338 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'invocation_command': 'dbt list metrics', 'use_colors': 'True', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'log_path': '/home/chun/Develop/datacore/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'True', 'empty': 'None', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'warn_error': 'None'}
[0m10:14:28.028335 [info ] [MainThread]: dbt version: 1.10.13
[0m10:14:28.028663 [info ] [MainThread]: python version: 3.12.3
[0m10:14:28.028898 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m10:14:28.029130 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m10:14:28.127003 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m10:14:28.127362 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m10:14:28.127596 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m10:14:28.128624 [info ] [MainThread]: adapter type: duckdb
[0m10:14:28.128863 [info ] [MainThread]: adapter version: 1.10.0
[0m10:14:28.223988 [info ] [MainThread]: Configuration:
[0m10:14:28.224359 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:14:28.224594 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:14:28.224821 [info ] [MainThread]: Required dependencies:
[0m10:14:28.225064 [debug] [MainThread]: Executing "git --help"
[0m10:14:28.228081 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:14:28.228527 [debug] [MainThread]: STDERR: "b''"
[0m10:14:28.228860 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:14:28.229177 [info ] [MainThread]: Connection:
[0m10:14:28.229515 [info ] [MainThread]:   database: datacore
[0m10:14:28.229777 [info ] [MainThread]:   schema: main
[0m10:14:28.229997 [info ] [MainThread]:   path: datacore.duckdb
[0m10:14:28.230218 [info ] [MainThread]:   config_options: None
[0m10:14:28.230448 [info ] [MainThread]:   extensions: None
[0m10:14:28.230669 [info ] [MainThread]:   settings: {}
[0m10:14:28.230892 [info ] [MainThread]:   external_root: .
[0m10:14:28.231115 [info ] [MainThread]:   use_credential_provider: None
[0m10:14:28.231344 [info ] [MainThread]:   attach: None
[0m10:14:28.231562 [info ] [MainThread]:   filesystems: None
[0m10:14:28.231783 [info ] [MainThread]:   remote: None
[0m10:14:28.232001 [info ] [MainThread]:   plugins: None
[0m10:14:28.232220 [info ] [MainThread]:   disable_transactions: False
[0m10:14:28.232564 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:14:28.332198 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:14:28.352971 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:14:28.353341 [debug] [MainThread]: On debug: select 1 as id
[0m10:14:28.353593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:14:28.370767 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m10:14:28.371723 [debug] [MainThread]: On debug: Close
[0m10:14:28.372056 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:14:28.372311 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:14:28.373058 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.40844515, "process_in_blocks": "0", "process_kernel_time": 0.203894, "process_mem_max_rss": "153260", "process_out_blocks": "32", "process_user_time": 1.695123}
[0m10:14:28.373439 [debug] [MainThread]: Command `cli debug` succeeded at 10:14:28.373360 after 0.41 seconds
[0m10:14:28.373701 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:14:28.373976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7814433cda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781442260980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7814415e6e10>]}
[0m10:14:28.374307 [debug] [MainThread]: Flushing usage events
[0m10:14:29.932906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:35.250488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77346c843b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77346ced3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77346c8bec60>]}


============================== 10:34:35.253792 | f4e41797-0330-4f9f-83d8-9e49d15b9b8d ==============================
[0m10:34:35.253792 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:34:35.254200 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'True', 'empty': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt list metrics', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'profiles_dir': '/home/chun/Develop/datacore', 'no_print': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'target_path': 'None', 'version_check': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'indirect_selection': 'eager'}
[0m10:34:35.262052 [info ] [MainThread]: dbt version: 1.10.13
[0m10:34:35.262383 [info ] [MainThread]: python version: 3.12.3
[0m10:34:35.262618 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m10:34:35.262849 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m10:34:35.360241 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m10:34:35.360601 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m10:34:35.360837 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m10:34:35.361876 [info ] [MainThread]: adapter type: duckdb
[0m10:34:35.362113 [info ] [MainThread]: adapter version: 1.10.0
[0m10:34:35.457107 [info ] [MainThread]: Configuration:
[0m10:34:35.457484 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:34:35.457724 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:34:35.457952 [info ] [MainThread]: Required dependencies:
[0m10:34:35.458200 [debug] [MainThread]: Executing "git --help"
[0m10:34:35.460885 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:34:35.461189 [debug] [MainThread]: STDERR: "b''"
[0m10:34:35.461433 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:34:35.461660 [info ] [MainThread]: Connection:
[0m10:34:35.461895 [info ] [MainThread]:   database: datacore
[0m10:34:35.462114 [info ] [MainThread]:   schema: main
[0m10:34:35.462338 [info ] [MainThread]:   path: datacore.duckdb
[0m10:34:35.462556 [info ] [MainThread]:   config_options: None
[0m10:34:35.462772 [info ] [MainThread]:   extensions: None
[0m10:34:35.462999 [info ] [MainThread]:   settings: {}
[0m10:34:35.463221 [info ] [MainThread]:   external_root: .
[0m10:34:35.463464 [info ] [MainThread]:   use_credential_provider: None
[0m10:34:35.463685 [info ] [MainThread]:   attach: None
[0m10:34:35.463899 [info ] [MainThread]:   filesystems: None
[0m10:34:35.464113 [info ] [MainThread]:   remote: None
[0m10:34:35.464332 [info ] [MainThread]:   plugins: None
[0m10:34:35.464548 [info ] [MainThread]:   disable_transactions: False
[0m10:34:35.464884 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:34:35.564628 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:34:35.585422 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:34:35.585808 [debug] [MainThread]: On debug: select 1 as id
[0m10:34:35.586063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:35.603356 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m10:34:35.604298 [debug] [MainThread]: On debug: Close
[0m10:34:35.604646 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:34:35.604890 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:34:35.605640 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.40538168, "process_in_blocks": "0", "process_kernel_time": 0.196968, "process_mem_max_rss": "153040", "process_out_blocks": "32", "process_user_time": 1.674729}
[0m10:34:35.606012 [debug] [MainThread]: Command `cli debug` succeeded at 10:34:35.605932 after 0.41 seconds
[0m10:34:35.606273 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:34:35.606563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77346d246ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77346b964ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77346bb96a50>]}
[0m10:34:35.606887 [debug] [MainThread]: Flushing usage events
[0m10:34:37.117804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:17.611867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc1563110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cbfba5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc0c88bc0>]}


============================== 10:50:17.615077 | 54e38856-1256-4485-a3bb-7f06b8f759a0 ==============================
[0m10:50:17.615077 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:50:17.615500 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt list metrics', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/chun/Develop/datacore', 'printer_width': '80', 'use_colors': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'quiet': 'True', 'static_parser': 'True', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'empty': 'None'}
[0m10:50:17.623578 [info ] [MainThread]: dbt version: 1.10.13
[0m10:50:17.623897 [info ] [MainThread]: python version: 3.12.3
[0m10:50:17.624139 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m10:50:17.624380 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m10:50:17.721691 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m10:50:17.722047 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m10:50:17.722283 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m10:50:17.723333 [info ] [MainThread]: adapter type: duckdb
[0m10:50:17.723572 [info ] [MainThread]: adapter version: 1.10.0
[0m10:50:17.818873 [info ] [MainThread]: Configuration:
[0m10:50:17.819249 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:50:17.819502 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:50:17.819735 [info ] [MainThread]: Required dependencies:
[0m10:50:17.819986 [debug] [MainThread]: Executing "git --help"
[0m10:50:17.823200 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:50:17.823644 [debug] [MainThread]: STDERR: "b''"
[0m10:50:17.823988 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:50:17.824319 [info ] [MainThread]: Connection:
[0m10:50:17.824653 [info ] [MainThread]:   database: datacore
[0m10:50:17.824964 [info ] [MainThread]:   schema: main
[0m10:50:17.825243 [info ] [MainThread]:   path: datacore.duckdb
[0m10:50:17.825472 [info ] [MainThread]:   config_options: None
[0m10:50:17.825693 [info ] [MainThread]:   extensions: None
[0m10:50:17.825917 [info ] [MainThread]:   settings: {}
[0m10:50:17.826142 [info ] [MainThread]:   external_root: .
[0m10:50:17.826371 [info ] [MainThread]:   use_credential_provider: None
[0m10:50:17.826594 [info ] [MainThread]:   attach: None
[0m10:50:17.826814 [info ] [MainThread]:   filesystems: None
[0m10:50:17.827038 [info ] [MainThread]:   remote: None
[0m10:50:17.827260 [info ] [MainThread]:   plugins: None
[0m10:50:17.827491 [info ] [MainThread]:   disable_transactions: False
[0m10:50:17.827834 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:50:17.930489 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:50:17.951577 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:50:17.951941 [debug] [MainThread]: On debug: select 1 as id
[0m10:50:17.952198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:17.969584 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m10:50:17.970550 [debug] [MainThread]: On debug: Close
[0m10:50:17.970891 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:50:17.971140 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:50:17.971911 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43186012, "process_in_blocks": "0", "process_kernel_time": 0.200891, "process_mem_max_rss": "154668", "process_out_blocks": "40", "process_user_time": 1.796033}
[0m10:50:17.972288 [debug] [MainThread]: Command `cli debug` succeeded at 10:50:17.972209 after 0.43 seconds
[0m10:50:17.972558 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:50:17.972836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc208bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cbf958e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc1563110>]}
[0m10:50:17.973159 [debug] [MainThread]: Flushing usage events
[0m10:50:20.482484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:24.095725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f10e069f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f10976ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f10af6570>]}


============================== 10:50:24.098679 | 9be5da09-ec2e-4f38-b4b1-6af6dccd355e ==============================
[0m10:50:24.098679 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:50:24.099093 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_format': 'default', 'empty': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt list metrics', 'static_parser': 'True', 'target_path': 'None'}
[0m10:50:24.106929 [info ] [MainThread]: dbt version: 1.10.13
[0m10:50:24.107248 [info ] [MainThread]: python version: 3.12.3
[0m10:50:24.107501 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m10:50:24.107728 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m10:50:24.207090 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m10:50:24.207494 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m10:50:24.207755 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m10:50:24.208921 [info ] [MainThread]: adapter type: duckdb
[0m10:50:24.209180 [info ] [MainThread]: adapter version: 1.10.0
[0m10:50:24.315964 [info ] [MainThread]: Configuration:
[0m10:50:24.316381 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:50:24.316648 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:50:24.316903 [info ] [MainThread]: Required dependencies:
[0m10:50:24.317175 [debug] [MainThread]: Executing "git --help"
[0m10:50:24.320103 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:50:24.320556 [debug] [MainThread]: STDERR: "b''"
[0m10:50:24.320896 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:50:24.321220 [info ] [MainThread]: Connection:
[0m10:50:24.321512 [info ] [MainThread]:   database: datacore
[0m10:50:24.321737 [info ] [MainThread]:   schema: main
[0m10:50:24.321961 [info ] [MainThread]:   path: datacore.duckdb
[0m10:50:24.322188 [info ] [MainThread]:   config_options: None
[0m10:50:24.322421 [info ] [MainThread]:   extensions: None
[0m10:50:24.322649 [info ] [MainThread]:   settings: {}
[0m10:50:24.322876 [info ] [MainThread]:   external_root: .
[0m10:50:24.323100 [info ] [MainThread]:   use_credential_provider: None
[0m10:50:24.323330 [info ] [MainThread]:   attach: None
[0m10:50:24.323550 [info ] [MainThread]:   filesystems: None
[0m10:50:24.323771 [info ] [MainThread]:   remote: None
[0m10:50:24.323993 [info ] [MainThread]:   plugins: None
[0m10:50:24.324216 [info ] [MainThread]:   disable_transactions: False
[0m10:50:24.324568 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:50:24.425054 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:50:24.446006 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:50:24.446381 [debug] [MainThread]: On debug: select 1 as id
[0m10:50:24.446642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:24.464647 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m10:50:24.465678 [debug] [MainThread]: On debug: Close
[0m10:50:24.466043 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:50:24.466317 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:50:24.467141 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42176253, "process_in_blocks": "0", "process_kernel_time": 0.214577, "process_mem_max_rss": "153476", "process_out_blocks": "16", "process_user_time": 1.800455}
[0m10:50:24.467557 [debug] [MainThread]: Command `cli debug` succeeded at 10:50:24.467471 after 0.42 seconds
[0m10:50:24.467855 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:50:24.468161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f101fd3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f0f85c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f0f85c770>]}
[0m10:50:24.468523 [debug] [MainThread]: Flushing usage events
[0m10:50:25.660882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:55.331255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0dc0c4be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0dc07fcef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0dc0496c30>]}


============================== 10:50:55.334646 | c81e181c-4696-4da4-8220-3431f8f342e4 ==============================
[0m10:50:55.334646 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:50:55.335062 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'invocation_command': 'dbt query --metrics monthly_revenue --group-by city,transaction_date --start-time 2025-11-01 --end-time 2025-12-12 --explain', 'partial_parse': 'True', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'None', 'quiet': 'True', 'printer_width': '80', 'log_path': '/home/chun/Develop/datacore/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'use_colors': 'True', 'static_parser': 'True'}
[0m10:50:55.342957 [info ] [MainThread]: dbt version: 1.10.13
[0m10:50:55.343287 [info ] [MainThread]: python version: 3.12.3
[0m10:50:55.343535 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m10:50:55.343770 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m10:50:55.440907 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m10:50:55.441267 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m10:50:55.441514 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m10:50:55.442565 [info ] [MainThread]: adapter type: duckdb
[0m10:50:55.442808 [info ] [MainThread]: adapter version: 1.10.0
[0m10:50:55.538019 [info ] [MainThread]: Configuration:
[0m10:50:55.538401 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:50:55.538642 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:50:55.538872 [info ] [MainThread]: Required dependencies:
[0m10:50:55.539121 [debug] [MainThread]: Executing "git --help"
[0m10:50:55.541572 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:50:55.542034 [debug] [MainThread]: STDERR: "b''"
[0m10:50:55.542399 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:50:55.542736 [info ] [MainThread]: Connection:
[0m10:50:55.543083 [info ] [MainThread]:   database: datacore
[0m10:50:55.543341 [info ] [MainThread]:   schema: main
[0m10:50:55.543562 [info ] [MainThread]:   path: datacore.duckdb
[0m10:50:55.543783 [info ] [MainThread]:   config_options: None
[0m10:50:55.544002 [info ] [MainThread]:   extensions: None
[0m10:50:55.544224 [info ] [MainThread]:   settings: {}
[0m10:50:55.544458 [info ] [MainThread]:   external_root: .
[0m10:50:55.544678 [info ] [MainThread]:   use_credential_provider: None
[0m10:50:55.544899 [info ] [MainThread]:   attach: None
[0m10:50:55.545120 [info ] [MainThread]:   filesystems: None
[0m10:50:55.545343 [info ] [MainThread]:   remote: None
[0m10:50:55.545560 [info ] [MainThread]:   plugins: None
[0m10:50:55.545778 [info ] [MainThread]:   disable_transactions: False
[0m10:50:55.546114 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:50:55.646823 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:50:55.667766 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:50:55.668127 [debug] [MainThread]: On debug: select 1 as id
[0m10:50:55.668392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:55.673923 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m10:50:55.674252 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m10:50:55.674586 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:50:55.674832 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:50:55.675080 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 349101) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:50:55.675798 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.3994686, "process_in_blocks": "0", "process_kernel_time": 0.203858, "process_mem_max_rss": "149836", "process_out_blocks": "24", "process_user_time": 1.707812}
[0m10:50:55.676172 [debug] [MainThread]: Command `cli debug` failed at 10:50:55.676092 after 0.40 seconds
[0m10:50:55.676452 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:50:55.676729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0dc47b3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0dc1242a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0daf4aae40>]}
[0m10:50:55.677060 [debug] [MainThread]: Flushing usage events
[0m10:50:56.842416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:28.267916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77159c377c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77159c22acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77159b8fc3e0>]}


============================== 10:51:28.271330 | 837ef2b1-3fd5-426c-bb2b-51ac38557466 ==============================
[0m10:51:28.271330 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:51:28.271779 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error': 'None', 'debug': 'False', 'empty': 'None', 'log_format': 'default', 'quiet': 'True', 'partial_parse': 'True', 'introspect': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt query --metrics monthly_revenue --group-by city,vehicle_type_name,transaction_date --start-time 2025-11-01 --end-time 2025-12-12 --explain', 'profiles_dir': '/home/chun/Develop/datacore', 'printer_width': '80', 'send_anonymous_usage_stats': 'True'}
[0m10:51:28.280362 [info ] [MainThread]: dbt version: 1.10.13
[0m10:51:28.280705 [info ] [MainThread]: python version: 3.12.3
[0m10:51:28.280959 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m10:51:28.281209 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m10:51:28.385720 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m10:51:28.386114 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m10:51:28.386382 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m10:51:28.387542 [info ] [MainThread]: adapter type: duckdb
[0m10:51:28.387807 [info ] [MainThread]: adapter version: 1.10.0
[0m10:51:28.492319 [info ] [MainThread]: Configuration:
[0m10:51:28.492718 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:51:28.492977 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:51:28.493223 [info ] [MainThread]: Required dependencies:
[0m10:51:28.493498 [debug] [MainThread]: Executing "git --help"
[0m10:51:28.495937 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:51:28.496442 [debug] [MainThread]: STDERR: "b''"
[0m10:51:28.496821 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:51:28.497181 [info ] [MainThread]: Connection:
[0m10:51:28.497532 [info ] [MainThread]:   database: datacore
[0m10:51:28.497772 [info ] [MainThread]:   schema: main
[0m10:51:28.498015 [info ] [MainThread]:   path: datacore.duckdb
[0m10:51:28.498254 [info ] [MainThread]:   config_options: None
[0m10:51:28.498513 [info ] [MainThread]:   extensions: None
[0m10:51:28.498755 [info ] [MainThread]:   settings: {}
[0m10:51:28.498998 [info ] [MainThread]:   external_root: .
[0m10:51:28.499236 [info ] [MainThread]:   use_credential_provider: None
[0m10:51:28.499484 [info ] [MainThread]:   attach: None
[0m10:51:28.499720 [info ] [MainThread]:   filesystems: None
[0m10:51:28.499956 [info ] [MainThread]:   remote: None
[0m10:51:28.500190 [info ] [MainThread]:   plugins: None
[0m10:51:28.500434 [info ] [MainThread]:   disable_transactions: False
[0m10:51:28.500804 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:51:28.601934 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:51:28.622991 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:51:28.623360 [debug] [MainThread]: On debug: select 1 as id
[0m10:51:28.623619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:28.629183 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m10:51:28.629533 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m10:51:28.629858 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:51:28.630103 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:51:28.630353 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 349101) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:51:28.631074 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.41609043, "process_in_blocks": "0", "process_kernel_time": 0.203999, "process_mem_max_rss": "149844", "process_out_blocks": "16", "process_user_time": 1.733997}
[0m10:51:28.631450 [debug] [MainThread]: Command `cli debug` failed at 10:51:28.631371 after 0.42 seconds
[0m10:51:28.631719 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:51:28.631993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77159c22acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77158ad19250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77159a842bd0>]}
[0m10:51:28.632331 [debug] [MainThread]: Flushing usage events
[0m10:51:30.255491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:19:50.249093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7796fb2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d779649e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7796a3a3f0>]}


============================== 11:19:50.252568 | 5f8c1912-fbb6-4027-8c4c-630d1899e6c3 ==============================
[0m11:19:50.252568 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:19:50.253324 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt list metrics', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'True', 'log_cache_events': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'target_path': 'None', 'introspect': 'True', 'debug': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'profiles_dir': '/home/chun/Develop/datacore', 'no_print': 'None', 'version_check': 'True'}
[0m11:19:50.261212 [info ] [MainThread]: dbt version: 1.10.13
[0m11:19:50.261538 [info ] [MainThread]: python version: 3.12.3
[0m11:19:50.261774 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m11:19:50.262004 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m11:19:50.359884 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m11:19:50.360243 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m11:19:50.360486 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m11:19:50.361541 [info ] [MainThread]: adapter type: duckdb
[0m11:19:50.361778 [info ] [MainThread]: adapter version: 1.10.0
[0m11:19:50.459191 [info ] [MainThread]: Configuration:
[0m11:19:50.459572 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:19:50.459811 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:19:50.460038 [info ] [MainThread]: Required dependencies:
[0m11:19:50.460282 [debug] [MainThread]: Executing "git --help"
[0m11:19:50.462382 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:19:50.462695 [debug] [MainThread]: STDERR: "b''"
[0m11:19:50.462938 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:19:50.463166 [info ] [MainThread]: Connection:
[0m11:19:50.463410 [info ] [MainThread]:   database: datacore
[0m11:19:50.463631 [info ] [MainThread]:   schema: main
[0m11:19:50.463851 [info ] [MainThread]:   path: datacore.duckdb
[0m11:19:50.464070 [info ] [MainThread]:   config_options: None
[0m11:19:50.464288 [info ] [MainThread]:   extensions: None
[0m11:19:50.464515 [info ] [MainThread]:   settings: {}
[0m11:19:50.464736 [info ] [MainThread]:   external_root: .
[0m11:19:50.464953 [info ] [MainThread]:   use_credential_provider: None
[0m11:19:50.465172 [info ] [MainThread]:   attach: None
[0m11:19:50.465398 [info ] [MainThread]:   filesystems: None
[0m11:19:50.465614 [info ] [MainThread]:   remote: None
[0m11:19:50.465831 [info ] [MainThread]:   plugins: None
[0m11:19:50.466049 [info ] [MainThread]:   disable_transactions: False
[0m11:19:50.466399 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:19:50.567905 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:19:50.588697 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:19:50.589057 [debug] [MainThread]: On debug: select 1 as id
[0m11:19:50.589320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:19:50.606516 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m11:19:50.607466 [debug] [MainThread]: On debug: Close
[0m11:19:50.607804 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:19:50.608055 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:19:50.608821 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4150108, "process_in_blocks": "0", "process_kernel_time": 0.206517, "process_mem_max_rss": "153104", "process_out_blocks": "24", "process_user_time": 1.751906}
[0m11:19:50.609194 [debug] [MainThread]: Command `cli debug` succeeded at 11:19:50.609115 after 0.42 seconds
[0m11:19:50.609465 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:19:50.609744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d77956a61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d77956a7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7795571610>]}
[0m11:19:50.610069 [debug] [MainThread]: Flushing usage events
[0m11:19:52.155034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:15.707693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762bb1244d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762bb02e76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762bb02e6c60>]}


============================== 11:40:15.710995 | 445d708c-6794-44c1-a9c8-1e57b0dcd1a1 ==============================
[0m11:40:15.710995 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:40:15.711413 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'fail_fast': 'False', 'quiet': 'True', 'version_check': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'invocation_command': 'dbt list metrics', 'warn_error': 'None', 'log_format': 'default', 'profiles_dir': '/home/chun/Develop/datacore', 'printer_width': '80', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'None', 'indirect_selection': 'eager', 'static_parser': 'True'}
[0m11:40:15.719269 [info ] [MainThread]: dbt version: 1.10.13
[0m11:40:15.719601 [info ] [MainThread]: python version: 3.12.3
[0m11:40:15.719835 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m11:40:15.720064 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m11:40:15.817355 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m11:40:15.817709 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m11:40:15.817942 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m11:40:15.818980 [info ] [MainThread]: adapter type: duckdb
[0m11:40:15.819218 [info ] [MainThread]: adapter version: 1.10.0
[0m11:40:15.914336 [info ] [MainThread]: Configuration:
[0m11:40:15.914707 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:40:15.914945 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:40:15.915172 [info ] [MainThread]: Required dependencies:
[0m11:40:15.915425 [debug] [MainThread]: Executing "git --help"
[0m11:40:15.918225 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:40:15.918547 [debug] [MainThread]: STDERR: "b''"
[0m11:40:15.918784 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:40:15.919010 [info ] [MainThread]: Connection:
[0m11:40:15.919244 [info ] [MainThread]:   database: datacore
[0m11:40:15.919469 [info ] [MainThread]:   schema: main
[0m11:40:15.919687 [info ] [MainThread]:   path: datacore.duckdb
[0m11:40:15.919905 [info ] [MainThread]:   config_options: None
[0m11:40:15.920132 [info ] [MainThread]:   extensions: None
[0m11:40:15.920358 [info ] [MainThread]:   settings: {}
[0m11:40:15.920580 [info ] [MainThread]:   external_root: .
[0m11:40:15.920797 [info ] [MainThread]:   use_credential_provider: None
[0m11:40:15.921021 [info ] [MainThread]:   attach: None
[0m11:40:15.921237 [info ] [MainThread]:   filesystems: None
[0m11:40:15.921460 [info ] [MainThread]:   remote: None
[0m11:40:15.921676 [info ] [MainThread]:   plugins: None
[0m11:40:15.921892 [info ] [MainThread]:   disable_transactions: False
[0m11:40:15.922231 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:40:16.024410 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:40:16.045061 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:40:16.045427 [debug] [MainThread]: On debug: select 1 as id
[0m11:40:16.045679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:40:16.062751 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m11:40:16.063703 [debug] [MainThread]: On debug: Close
[0m11:40:16.064040 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:40:16.064286 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:40:16.065043 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.40723094, "process_in_blocks": "1048", "process_kernel_time": 0.204912, "process_mem_max_rss": "152884", "process_out_blocks": "32", "process_user_time": 1.73026}
[0m11:40:16.065422 [debug] [MainThread]: Command `cli debug` succeeded at 11:40:16.065342 after 0.41 seconds
[0m11:40:16.065684 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:40:16.065963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762bb10395b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762baf021580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b9f291190>]}
[0m11:40:16.066284 [debug] [MainThread]: Flushing usage events
[0m11:40:17.719131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:37.352233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d79ad9be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d79bd26180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d79a845a30>]}


============================== 11:40:37.355503 | 8a8bfd2e-f9e9-480d-a948-9d49ad30394f ==============================
[0m11:40:37.355503 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:40:37.355914 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'use_colors': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'quiet': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'version_check': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'debug': 'False', 'printer_width': '80', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt query --metrics daily_revenue --group-by station_name,transaction_date --start-time 2025-11-14 --end-time 2025-11-14 --explain', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None'}
[0m11:40:37.363712 [info ] [MainThread]: dbt version: 1.10.13
[0m11:40:37.364033 [info ] [MainThread]: python version: 3.12.3
[0m11:40:37.364267 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m11:40:37.364501 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m11:40:37.461649 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m11:40:37.462005 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m11:40:37.462239 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m11:40:37.463277 [info ] [MainThread]: adapter type: duckdb
[0m11:40:37.463521 [info ] [MainThread]: adapter version: 1.10.0
[0m11:40:37.558392 [info ] [MainThread]: Configuration:
[0m11:40:37.558764 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:40:37.559002 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:40:37.559232 [info ] [MainThread]: Required dependencies:
[0m11:40:37.559490 [debug] [MainThread]: Executing "git --help"
[0m11:40:37.562272 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:40:37.562706 [debug] [MainThread]: STDERR: "b''"
[0m11:40:37.563045 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:40:37.563352 [info ] [MainThread]: Connection:
[0m11:40:37.563599 [info ] [MainThread]:   database: datacore
[0m11:40:37.563821 [info ] [MainThread]:   schema: main
[0m11:40:37.564043 [info ] [MainThread]:   path: datacore.duckdb
[0m11:40:37.564273 [info ] [MainThread]:   config_options: None
[0m11:40:37.564501 [info ] [MainThread]:   extensions: None
[0m11:40:37.564725 [info ] [MainThread]:   settings: {}
[0m11:40:37.564951 [info ] [MainThread]:   external_root: .
[0m11:40:37.565172 [info ] [MainThread]:   use_credential_provider: None
[0m11:40:37.565403 [info ] [MainThread]:   attach: None
[0m11:40:37.565622 [info ] [MainThread]:   filesystems: None
[0m11:40:37.565840 [info ] [MainThread]:   remote: None
[0m11:40:37.566060 [info ] [MainThread]:   plugins: None
[0m11:40:37.566280 [info ] [MainThread]:   disable_transactions: False
[0m11:40:37.566632 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:40:37.665832 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:40:37.686498 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:40:37.686863 [debug] [MainThread]: On debug: select 1 as id
[0m11:40:37.687119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:40:37.692687 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m11:40:37.693017 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:40:37.693346 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:40:37.693595 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:40:37.693843 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 349101) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:40:37.694572 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.3930133, "process_in_blocks": "0", "process_kernel_time": 0.187581, "process_mem_max_rss": "149816", "process_out_blocks": "24", "process_user_time": 1.664286}
[0m11:40:37.694946 [debug] [MainThread]: Command `cli debug` failed at 11:40:37.694866 after 0.39 seconds
[0m11:40:37.695217 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:40:37.695497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d79b805430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d79a055dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d7897009e0>]}
[0m11:40:37.695819 [debug] [MainThread]: Flushing usage events
[0m11:40:38.837428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:20.592552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7961262b7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79612648b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796125ecec30>]}


============================== 11:41:20.595714 | cf93f4df-d2e8-4e87-9e6e-88f5c1e4c8de ==============================
[0m11:41:20.595714 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:41:20.596150 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'quiet': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'debug': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'log_path': '/home/chun/Develop/datacore/logs', 'invocation_command': 'dbt query --metrics daily_revenue --group-by station_name,vehicle_type_name,transaction_date --start-time 2025-10-27 --end-time 2025-11-14 --explain', 'no_print': 'None'}
[0m11:41:20.604021 [info ] [MainThread]: dbt version: 1.10.13
[0m11:41:20.604355 [info ] [MainThread]: python version: 3.12.3
[0m11:41:20.604596 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m11:41:20.604827 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m11:41:20.710649 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m11:41:20.711064 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m11:41:20.711347 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m11:41:20.712520 [info ] [MainThread]: adapter type: duckdb
[0m11:41:20.712789 [info ] [MainThread]: adapter version: 1.10.0
[0m11:41:20.819311 [info ] [MainThread]: Configuration:
[0m11:41:20.819728 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:41:20.820000 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:41:20.820256 [info ] [MainThread]: Required dependencies:
[0m11:41:20.820542 [debug] [MainThread]: Executing "git --help"
[0m11:41:20.823411 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:41:20.823775 [debug] [MainThread]: STDERR: "b''"
[0m11:41:20.824051 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:41:20.824311 [info ] [MainThread]: Connection:
[0m11:41:20.824578 [info ] [MainThread]:   database: datacore
[0m11:41:20.824826 [info ] [MainThread]:   schema: main
[0m11:41:20.825069 [info ] [MainThread]:   path: datacore.duckdb
[0m11:41:20.825322 [info ] [MainThread]:   config_options: None
[0m11:41:20.825595 [info ] [MainThread]:   extensions: None
[0m11:41:20.825841 [info ] [MainThread]:   settings: {}
[0m11:41:20.826088 [info ] [MainThread]:   external_root: .
[0m11:41:20.826346 [info ] [MainThread]:   use_credential_provider: None
[0m11:41:20.826593 [info ] [MainThread]:   attach: None
[0m11:41:20.826840 [info ] [MainThread]:   filesystems: None
[0m11:41:20.827081 [info ] [MainThread]:   remote: None
[0m11:41:20.827330 [info ] [MainThread]:   plugins: None
[0m11:41:20.827596 [info ] [MainThread]:   disable_transactions: False
[0m11:41:20.827978 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:41:20.931580 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:41:20.953665 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:41:20.954057 [debug] [MainThread]: On debug: select 1 as id
[0m11:41:20.954337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:20.959923 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m11:41:20.960336 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:41:20.960701 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:41:20.960975 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:41:20.961246 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 349101) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:41:20.962070 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.42361614, "process_in_blocks": "0", "process_kernel_time": 0.221721, "process_mem_max_rss": "149528", "process_out_blocks": "32", "process_user_time": 1.711846}
[0m11:41:20.962502 [debug] [MainThread]: Command `cli debug` failed at 11:41:20.962414 after 0.42 seconds
[0m11:41:20.962814 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:41:20.963122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7961268ed880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796124e27680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796115300410>]}
[0m11:41:20.963494 [debug] [MainThread]: Flushing usage events
[0m11:41:22.207918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:55.098249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732ddfbdfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732ddfaf9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732ddfaf8d40>]}


============================== 11:41:55.101680 | 6dd9ba92-a440-4b9c-9e7e-74e7ccf70162 ==============================
[0m11:41:55.101680 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:41:55.102141 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'log_path': '/home/chun/Develop/datacore/logs', 'empty': 'None', 'introspect': 'True', 'invocation_command': 'dbt query --metrics daily_revenue --group-by station_name,transaction_date --start-time 2025-10-27 --end-time 2025-10-27 --explain', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'True', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False'}
[0m11:41:55.110066 [info ] [MainThread]: dbt version: 1.10.13
[0m11:41:55.110397 [info ] [MainThread]: python version: 3.12.3
[0m11:41:55.110635 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m11:41:55.110868 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m11:41:55.208862 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m11:41:55.209218 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m11:41:55.209459 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m11:41:55.210495 [info ] [MainThread]: adapter type: duckdb
[0m11:41:55.210733 [info ] [MainThread]: adapter version: 1.10.0
[0m11:41:55.306552 [info ] [MainThread]: Configuration:
[0m11:41:55.306920 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:41:55.307160 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:41:55.307396 [info ] [MainThread]: Required dependencies:
[0m11:41:55.307651 [debug] [MainThread]: Executing "git --help"
[0m11:41:55.310425 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:41:55.310730 [debug] [MainThread]: STDERR: "b''"
[0m11:41:55.310968 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:41:55.311190 [info ] [MainThread]: Connection:
[0m11:41:55.311434 [info ] [MainThread]:   database: datacore
[0m11:41:55.311655 [info ] [MainThread]:   schema: main
[0m11:41:55.311875 [info ] [MainThread]:   path: datacore.duckdb
[0m11:41:55.312093 [info ] [MainThread]:   config_options: None
[0m11:41:55.312317 [info ] [MainThread]:   extensions: None
[0m11:41:55.312539 [info ] [MainThread]:   settings: {}
[0m11:41:55.312771 [info ] [MainThread]:   external_root: .
[0m11:41:55.312989 [info ] [MainThread]:   use_credential_provider: None
[0m11:41:55.313207 [info ] [MainThread]:   attach: None
[0m11:41:55.313432 [info ] [MainThread]:   filesystems: None
[0m11:41:55.313648 [info ] [MainThread]:   remote: None
[0m11:41:55.313865 [info ] [MainThread]:   plugins: None
[0m11:41:55.314082 [info ] [MainThread]:   disable_transactions: False
[0m11:41:55.314422 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:41:55.414683 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:41:55.435804 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:41:55.436166 [debug] [MainThread]: On debug: select 1 as id
[0m11:41:55.436428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:55.441891 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m11:41:55.442225 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:41:55.442550 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:41:55.442790 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:41:55.443028 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 349101) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:41:55.443861 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.3961339, "process_in_blocks": "0", "process_kernel_time": 0.191812, "process_mem_max_rss": "149860", "process_out_blocks": "32", "process_user_time": 1.668366}
[0m11:41:55.444237 [debug] [MainThread]: Command `cli debug` failed at 11:41:55.444157 after 0.40 seconds
[0m11:41:55.444515 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:41:55.444789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732dde229190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732ddeecb2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732ddd64dd30>]}
[0m11:41:55.445112 [debug] [MainThread]: Flushing usage events
[0m11:41:57.167298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:15.135638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a7e57fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a7d1dfa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a7f51e7e0>]}


============================== 11:42:15.138781 | 56abf7b8-d3ae-4f10-a77b-20e9723bdcfc ==============================
[0m11:42:15.138781 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:42:15.139196 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt query --metrics daily_revenue --group-by station_name,transaction_date --start-time 2025-10-24 --end-time 2025-10-31 --explain', 'quiet': 'True', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'indirect_selection': 'eager', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True'}
[0m11:42:15.147128 [info ] [MainThread]: dbt version: 1.10.13
[0m11:42:15.147473 [info ] [MainThread]: python version: 3.12.3
[0m11:42:15.147707 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m11:42:15.147937 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m11:42:15.245064 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m11:42:15.245427 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m11:42:15.245662 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m11:42:15.246694 [info ] [MainThread]: adapter type: duckdb
[0m11:42:15.246933 [info ] [MainThread]: adapter version: 1.10.0
[0m11:42:15.342014 [info ] [MainThread]: Configuration:
[0m11:42:15.342375 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:42:15.342609 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:42:15.342835 [info ] [MainThread]: Required dependencies:
[0m11:42:15.343077 [debug] [MainThread]: Executing "git --help"
[0m11:42:15.346134 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:42:15.346571 [debug] [MainThread]: STDERR: "b''"
[0m11:42:15.346904 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:42:15.347227 [info ] [MainThread]: Connection:
[0m11:42:15.347568 [info ] [MainThread]:   database: datacore
[0m11:42:15.347882 [info ] [MainThread]:   schema: main
[0m11:42:15.348169 [info ] [MainThread]:   path: datacore.duckdb
[0m11:42:15.348401 [info ] [MainThread]:   config_options: None
[0m11:42:15.348622 [info ] [MainThread]:   extensions: None
[0m11:42:15.348844 [info ] [MainThread]:   settings: {}
[0m11:42:15.349067 [info ] [MainThread]:   external_root: .
[0m11:42:15.349287 [info ] [MainThread]:   use_credential_provider: None
[0m11:42:15.349525 [info ] [MainThread]:   attach: None
[0m11:42:15.349745 [info ] [MainThread]:   filesystems: None
[0m11:42:15.349964 [info ] [MainThread]:   remote: None
[0m11:42:15.350180 [info ] [MainThread]:   plugins: None
[0m11:42:15.350405 [info ] [MainThread]:   disable_transactions: False
[0m11:42:15.350747 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:42:15.450110 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:42:15.470753 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:42:15.471105 [debug] [MainThread]: On debug: select 1 as id
[0m11:42:15.471364 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:15.476862 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m11:42:15.477199 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:42:15.477530 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:42:15.477775 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:42:15.478022 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 349101) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:42:15.478747 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.39861465, "process_in_blocks": "0", "process_kernel_time": 0.198494, "process_mem_max_rss": "149844", "process_out_blocks": "24", "process_user_time": 1.669751}
[0m11:42:15.479126 [debug] [MainThread]: Command `cli debug` failed at 11:42:15.479046 after 0.40 seconds
[0m11:42:15.479405 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:42:15.479680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a7dad0f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a7cd3bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a7e45b3b0>]}
[0m11:42:15.480007 [debug] [MainThread]: Flushing usage events
[0m11:42:16.623817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:29.291704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccce3b0bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccce51d4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccce3b0bbf0>]}


============================== 11:42:29.295258 | 521b00a4-2268-429a-b4c3-f34f86af7612 ==============================
[0m11:42:29.295258 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:42:29.295726 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt query --metrics daily_revenue --group-by station_name,transaction_date --start-time 2025-10-27 --end-time 2025-10-31 --explain', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'partial_parse': 'True', 'log_format': 'default', 'write_json': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'indirect_selection': 'eager', 'debug': 'False', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'True'}
[0m11:42:29.304261 [info ] [MainThread]: dbt version: 1.10.13
[0m11:42:29.304630 [info ] [MainThread]: python version: 3.12.3
[0m11:42:29.304884 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m11:42:29.305130 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m11:42:29.408376 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m11:42:29.408737 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m11:42:29.408978 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m11:42:29.410136 [info ] [MainThread]: adapter type: duckdb
[0m11:42:29.410385 [info ] [MainThread]: adapter version: 1.10.0
[0m11:42:29.506925 [info ] [MainThread]: Configuration:
[0m11:42:29.507313 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:42:29.507558 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:42:29.507789 [info ] [MainThread]: Required dependencies:
[0m11:42:29.508039 [debug] [MainThread]: Executing "git --help"
[0m11:42:29.510299 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:42:29.510769 [debug] [MainThread]: STDERR: "b''"
[0m11:42:29.511103 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:42:29.511434 [info ] [MainThread]: Connection:
[0m11:42:29.511747 [info ] [MainThread]:   database: datacore
[0m11:42:29.511986 [info ] [MainThread]:   schema: main
[0m11:42:29.512206 [info ] [MainThread]:   path: datacore.duckdb
[0m11:42:29.512435 [info ] [MainThread]:   config_options: None
[0m11:42:29.512656 [info ] [MainThread]:   extensions: None
[0m11:42:29.512878 [info ] [MainThread]:   settings: {}
[0m11:42:29.513102 [info ] [MainThread]:   external_root: .
[0m11:42:29.513333 [info ] [MainThread]:   use_credential_provider: None
[0m11:42:29.513556 [info ] [MainThread]:   attach: None
[0m11:42:29.513785 [info ] [MainThread]:   filesystems: None
[0m11:42:29.514006 [info ] [MainThread]:   remote: None
[0m11:42:29.514227 [info ] [MainThread]:   plugins: None
[0m11:42:29.514454 [info ] [MainThread]:   disable_transactions: False
[0m11:42:29.514796 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:42:29.615872 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:42:29.636553 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:42:29.636908 [debug] [MainThread]: On debug: select 1 as id
[0m11:42:29.637161 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:29.642689 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m11:42:29.643019 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:42:29.643346 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:42:29.643585 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:42:29.643829 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 349101) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:42:29.644538 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.40770084, "process_in_blocks": "0", "process_kernel_time": 0.21222, "process_mem_max_rss": "149500", "process_out_blocks": "32", "process_user_time": 1.717692}
[0m11:42:29.644899 [debug] [MainThread]: Command `cli debug` failed at 11:42:29.644823 after 0.41 seconds
[0m11:42:29.645161 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:42:29.645434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccce2fa9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cccd31cc1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccce2e6f560>]}
[0m11:42:29.645747 [debug] [MainThread]: Flushing usage events
[0m11:42:30.808008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:02.093534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e75eca65a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e75e6e4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e75e7941a0>]}


============================== 00:58:02.097154 | 09525674-4dad-4922-ae7c-bb04efb7ed07 ==============================
[0m00:58:02.097154 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:58:02.097606 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/chun/Develop/datacore/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'quiet': 'True', 'static_parser': 'True', 'introspect': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt list metrics', 'profiles_dir': '/home/chun/Develop/datacore', 'fail_fast': 'False', 'target_path': 'None', 'log_cache_events': 'False'}
[0m00:58:02.106690 [info ] [MainThread]: dbt version: 1.10.13
[0m00:58:02.107055 [info ] [MainThread]: python version: 3.12.3
[0m00:58:02.107299 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m00:58:02.107556 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m00:58:02.208790 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m00:58:02.209203 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m00:58:02.209459 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m00:58:02.210596 [info ] [MainThread]: adapter type: duckdb
[0m00:58:02.210846 [info ] [MainThread]: adapter version: 1.10.0
[0m00:58:02.308476 [info ] [MainThread]: Configuration:
[0m00:58:02.308893 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:58:02.309140 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:58:02.309380 [info ] [MainThread]: Required dependencies:
[0m00:58:02.309635 [debug] [MainThread]: Executing "git --help"
[0m00:58:02.312773 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:58:02.313421 [debug] [MainThread]: STDERR: "b''"
[0m00:58:02.313786 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:58:02.314093 [info ] [MainThread]: Connection:
[0m00:58:02.314348 [info ] [MainThread]:   database: datacore
[0m00:58:02.314574 [info ] [MainThread]:   schema: main
[0m00:58:02.314800 [info ] [MainThread]:   path: datacore.duckdb
[0m00:58:02.315023 [info ] [MainThread]:   config_options: None
[0m00:58:02.315248 [info ] [MainThread]:   extensions: None
[0m00:58:02.315480 [info ] [MainThread]:   settings: {}
[0m00:58:02.315707 [info ] [MainThread]:   external_root: .
[0m00:58:02.315928 [info ] [MainThread]:   use_credential_provider: None
[0m00:58:02.316154 [info ] [MainThread]:   attach: None
[0m00:58:02.316382 [info ] [MainThread]:   filesystems: None
[0m00:58:02.316604 [info ] [MainThread]:   remote: None
[0m00:58:02.316824 [info ] [MainThread]:   plugins: None
[0m00:58:02.317048 [info ] [MainThread]:   disable_transactions: False
[0m00:58:02.317427 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:58:02.417374 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m00:58:02.438099 [debug] [MainThread]: Using duckdb connection "debug"
[0m00:58:02.438472 [debug] [MainThread]: On debug: select 1 as id
[0m00:58:02.438732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:58:02.457038 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m00:58:02.457999 [debug] [MainThread]: On debug: Close
[0m00:58:02.458372 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:58:02.458624 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:58:02.459406 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43711874, "process_in_blocks": "1768", "process_kernel_time": 0.211127, "process_mem_max_rss": "154324", "process_out_blocks": "40", "process_user_time": 1.816094}
[0m00:58:02.459783 [debug] [MainThread]: Command `cli debug` succeeded at 00:58:02.459703 after 0.44 seconds
[0m00:58:02.460049 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:58:02.460340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e75e039160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e75eb69220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e75e39e180>]}
[0m00:58:02.460671 [debug] [MainThread]: Flushing usage events
[0m00:58:03.857387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:59:29.266592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799fa5eb42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799fa5b63380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799fa6850170>]}


============================== 00:59:29.270555 | d7fea710-b997-4dcb-a988-138c6ce78647 ==============================
[0m00:59:29.270555 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:59:29.271041 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'empty': 'None', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'cache_selected_only': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt list metrics', 'log_cache_events': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'quiet': 'True', 'no_print': 'None', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m00:59:29.280461 [info ] [MainThread]: dbt version: 1.10.13
[0m00:59:29.280837 [info ] [MainThread]: python version: 3.12.3
[0m00:59:29.281098 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m00:59:29.281367 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m00:59:29.391294 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m00:59:29.391741 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m00:59:29.392009 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m00:59:29.393248 [info ] [MainThread]: adapter type: duckdb
[0m00:59:29.393530 [info ] [MainThread]: adapter version: 1.10.0
[0m00:59:29.500969 [info ] [MainThread]: Configuration:
[0m00:59:29.501429 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:59:29.501699 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:59:29.501969 [info ] [MainThread]: Required dependencies:
[0m00:59:29.502254 [debug] [MainThread]: Executing "git --help"
[0m00:59:29.505413 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:59:29.506098 [debug] [MainThread]: STDERR: "b''"
[0m00:59:29.506503 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:59:29.506869 [info ] [MainThread]: Connection:
[0m00:59:29.507238 [info ] [MainThread]:   database: datacore
[0m00:59:29.507579 [info ] [MainThread]:   schema: main
[0m00:59:29.507826 [info ] [MainThread]:   path: datacore.duckdb
[0m00:59:29.508050 [info ] [MainThread]:   config_options: None
[0m00:59:29.508270 [info ] [MainThread]:   extensions: None
[0m00:59:29.508507 [info ] [MainThread]:   settings: {}
[0m00:59:29.508733 [info ] [MainThread]:   external_root: .
[0m00:59:29.508956 [info ] [MainThread]:   use_credential_provider: None
[0m00:59:29.509179 [info ] [MainThread]:   attach: None
[0m00:59:29.509409 [info ] [MainThread]:   filesystems: None
[0m00:59:29.509631 [info ] [MainThread]:   remote: None
[0m00:59:29.509855 [info ] [MainThread]:   plugins: None
[0m00:59:29.510077 [info ] [MainThread]:   disable_transactions: False
[0m00:59:29.510456 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:59:29.610761 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m00:59:29.631770 [debug] [MainThread]: Using duckdb connection "debug"
[0m00:59:29.632154 [debug] [MainThread]: On debug: select 1 as id
[0m00:59:29.632421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:59:29.650505 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m00:59:29.651501 [debug] [MainThread]: On debug: Close
[0m00:59:29.651869 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:59:29.652123 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:59:29.652920 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4410547, "process_in_blocks": "464", "process_kernel_time": 0.21391, "process_mem_max_rss": "153228", "process_out_blocks": "24", "process_user_time": 1.760265}
[0m00:59:29.653324 [debug] [MainThread]: Command `cli debug` succeeded at 00:59:29.653237 after 0.44 seconds
[0m00:59:29.653595 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:59:29.653911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799fa51f28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f946bd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799fa4b80bc0>]}
[0m00:59:29.654241 [debug] [MainThread]: Flushing usage events
[0m00:59:30.807616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:01:34.993366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e37b3175430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e37b330ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e37b29051f0>]}


============================== 01:01:34.996824 | 28e22589-c889-4151-ac88-d806b6053322 ==============================
[0m01:01:34.996824 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:01:34.997254 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_colors': 'True', 'invocation_command': 'dbt list metrics', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'profiles_dir': '/home/chun/Develop/datacore', 'warn_error': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'static_parser': 'True', 'no_print': 'None', 'target_path': 'None', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'quiet': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False'}
[0m01:01:35.005300 [info ] [MainThread]: dbt version: 1.10.13
[0m01:01:35.005639 [info ] [MainThread]: python version: 3.12.3
[0m01:01:35.005885 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m01:01:35.006128 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m01:01:35.103379 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m01:01:35.103756 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m01:01:35.103998 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m01:01:35.105043 [info ] [MainThread]: adapter type: duckdb
[0m01:01:35.105293 [info ] [MainThread]: adapter version: 1.10.0
[0m01:01:35.201500 [info ] [MainThread]: Configuration:
[0m01:01:35.201896 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:01:35.202143 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:01:35.202386 [info ] [MainThread]: Required dependencies:
[0m01:01:35.202640 [debug] [MainThread]: Executing "git --help"
[0m01:01:35.205862 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:01:35.206500 [debug] [MainThread]: STDERR: "b''"
[0m01:01:35.206872 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:01:35.207213 [info ] [MainThread]: Connection:
[0m01:01:35.207502 [info ] [MainThread]:   database: datacore
[0m01:01:35.207735 [info ] [MainThread]:   schema: main
[0m01:01:35.207964 [info ] [MainThread]:   path: datacore.duckdb
[0m01:01:35.208194 [info ] [MainThread]:   config_options: None
[0m01:01:35.208429 [info ] [MainThread]:   extensions: None
[0m01:01:35.208658 [info ] [MainThread]:   settings: {}
[0m01:01:35.208891 [info ] [MainThread]:   external_root: .
[0m01:01:35.209119 [info ] [MainThread]:   use_credential_provider: None
[0m01:01:35.209355 [info ] [MainThread]:   attach: None
[0m01:01:35.209607 [info ] [MainThread]:   filesystems: None
[0m01:01:35.209852 [info ] [MainThread]:   remote: None
[0m01:01:35.210101 [info ] [MainThread]:   plugins: None
[0m01:01:35.210357 [info ] [MainThread]:   disable_transactions: False
[0m01:01:35.210820 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:01:35.313013 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m01:01:35.335152 [debug] [MainThread]: Using duckdb connection "debug"
[0m01:01:35.335578 [debug] [MainThread]: On debug: select 1 as id
[0m01:01:35.335850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:01:35.353919 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m01:01:35.354985 [debug] [MainThread]: On debug: Close
[0m01:01:35.355346 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:01:35.355604 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:01:35.356451 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41451666, "process_in_blocks": "184", "process_kernel_time": 0.213029, "process_mem_max_rss": "153284", "process_out_blocks": "24", "process_user_time": 1.714237}
[0m01:01:35.356858 [debug] [MainThread]: Command `cli debug` succeeded at 01:01:35.356774 after 0.42 seconds
[0m01:01:35.357135 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:01:35.357430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e37b2d8dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e37b416b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e37b1a6b920>]}
[0m01:01:35.357786 [debug] [MainThread]: Flushing usage events
[0m01:01:36.500101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:12:24.050340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7c1b363fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7c1866e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7c18e2c890>]}


============================== 01:12:24.054504 | 00b30df0-5e20-473a-b587-36ca1b785ebc ==============================
[0m01:12:24.054504 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:12:24.055141 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/chun/Develop/datacore/logs', 'use_colors': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'introspect': 'True', 'fail_fast': 'False', 'quiet': 'True', 'write_json': 'True', 'invocation_command': 'dbt list metrics', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'empty': 'None'}
[0m01:12:24.064119 [info ] [MainThread]: dbt version: 1.10.13
[0m01:12:24.064461 [info ] [MainThread]: python version: 3.12.3
[0m01:12:24.064701 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m01:12:24.064935 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m01:12:24.162866 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m01:12:24.163251 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m01:12:24.163505 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m01:12:24.164585 [info ] [MainThread]: adapter type: duckdb
[0m01:12:24.164836 [info ] [MainThread]: adapter version: 1.10.0
[0m01:12:24.262162 [info ] [MainThread]: Configuration:
[0m01:12:24.262548 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:12:24.262795 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:12:24.263033 [info ] [MainThread]: Required dependencies:
[0m01:12:24.263289 [debug] [MainThread]: Executing "git --help"
[0m01:12:24.266249 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:12:24.267107 [debug] [MainThread]: STDERR: "b''"
[0m01:12:24.267425 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:12:24.267703 [info ] [MainThread]: Connection:
[0m01:12:24.267987 [info ] [MainThread]:   database: datacore
[0m01:12:24.268240 [info ] [MainThread]:   schema: main
[0m01:12:24.268506 [info ] [MainThread]:   path: datacore.duckdb
[0m01:12:24.268756 [info ] [MainThread]:   config_options: None
[0m01:12:24.269003 [info ] [MainThread]:   extensions: None
[0m01:12:24.269252 [info ] [MainThread]:   settings: {}
[0m01:12:24.269512 [info ] [MainThread]:   external_root: .
[0m01:12:24.269755 [info ] [MainThread]:   use_credential_provider: None
[0m01:12:24.270002 [info ] [MainThread]:   attach: None
[0m01:12:24.270247 [info ] [MainThread]:   filesystems: None
[0m01:12:24.270501 [info ] [MainThread]:   remote: None
[0m01:12:24.270745 [info ] [MainThread]:   plugins: None
[0m01:12:24.270991 [info ] [MainThread]:   disable_transactions: False
[0m01:12:24.271429 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:12:24.374309 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m01:12:24.396504 [debug] [MainThread]: Using duckdb connection "debug"
[0m01:12:24.396911 [debug] [MainThread]: On debug: select 1 as id
[0m01:12:24.397182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:12:24.415819 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m01:12:24.416915 [debug] [MainThread]: On debug: Close
[0m01:12:24.417299 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:12:24.417568 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:12:24.418409 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4190891, "process_in_blocks": "0", "process_kernel_time": 0.222127, "process_mem_max_rss": "153128", "process_out_blocks": "24", "process_user_time": 1.727992}
[0m01:12:24.418807 [debug] [MainThread]: Command `cli debug` succeeded at 01:12:24.418722 after 0.42 seconds
[0m01:12:24.419096 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:12:24.419405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7c17b33350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7c18e2e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7c1a5afc80>]}
[0m01:12:24.419755 [debug] [MainThread]: Flushing usage events
[0m01:12:25.760987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:12:38.379103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccaf9c0aae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccafa62d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccafaa9fec0>]}


============================== 01:12:38.382698 | 1a9bed68-d232-4d81-92ce-7274a9138659 ==============================
[0m01:12:38.382698 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:12:38.383139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/chun/Develop/datacore', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'invocation_command': 'dbt query --metrics daily_revenue --group-by city,transaction_date --start-time 2025-11-06 --end-time 2025-12-18 --explain', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'empty': 'None'}
[0m01:12:38.391167 [info ] [MainThread]: dbt version: 1.10.13
[0m01:12:38.391504 [info ] [MainThread]: python version: 3.12.3
[0m01:12:38.391747 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m01:12:38.391982 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m01:12:38.488420 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m01:12:38.488794 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m01:12:38.489039 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m01:12:38.490085 [info ] [MainThread]: adapter type: duckdb
[0m01:12:38.490336 [info ] [MainThread]: adapter version: 1.10.0
[0m01:12:38.586087 [info ] [MainThread]: Configuration:
[0m01:12:38.586481 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:12:38.586727 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:12:38.586961 [info ] [MainThread]: Required dependencies:
[0m01:12:38.587210 [debug] [MainThread]: Executing "git --help"
[0m01:12:38.590416 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:12:38.591033 [debug] [MainThread]: STDERR: "b''"
[0m01:12:38.591409 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:12:38.591756 [info ] [MainThread]: Connection:
[0m01:12:38.592107 [info ] [MainThread]:   database: datacore
[0m01:12:38.592435 [info ] [MainThread]:   schema: main
[0m01:12:38.592670 [info ] [MainThread]:   path: datacore.duckdb
[0m01:12:38.592895 [info ] [MainThread]:   config_options: None
[0m01:12:38.593117 [info ] [MainThread]:   extensions: None
[0m01:12:38.593348 [info ] [MainThread]:   settings: {}
[0m01:12:38.593573 [info ] [MainThread]:   external_root: .
[0m01:12:38.593793 [info ] [MainThread]:   use_credential_provider: None
[0m01:12:38.594020 [info ] [MainThread]:   attach: None
[0m01:12:38.594242 [info ] [MainThread]:   filesystems: None
[0m01:12:38.594487 [info ] [MainThread]:   remote: None
[0m01:12:38.594710 [info ] [MainThread]:   plugins: None
[0m01:12:38.594932 [info ] [MainThread]:   disable_transactions: False
[0m01:12:38.595315 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:12:38.696203 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m01:12:38.718166 [debug] [MainThread]: Using duckdb connection "debug"
[0m01:12:38.718616 [debug] [MainThread]: On debug: select 1 as id
[0m01:12:38.718882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:12:38.728360 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m01:12:38.728805 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m01:12:38.729158 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:12:38.729450 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:12:38.729709 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 368579) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:12:38.730521 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.40244406, "process_in_blocks": "1832", "process_kernel_time": 0.196078, "process_mem_max_rss": "149684", "process_out_blocks": "24", "process_user_time": 1.657662}
[0m01:12:38.730959 [debug] [MainThread]: Command `cli debug` failed at 01:12:38.730874 after 0.40 seconds
[0m01:12:38.731263 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:12:38.731572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccaf937ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccaf90d2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccae956deb0>]}
[0m01:12:38.731937 [debug] [MainThread]: Flushing usage events
[0m01:12:39.931606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:48:17.395818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1607ea4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e160810b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e160810b200>]}


============================== 05:48:17.399407 | 4fb39a8b-66c2-42bd-93cf-34929a08d574 ==============================
[0m05:48:17.399407 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:48:17.399823 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'empty': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'partial_parse': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt list metrics', 'target_path': 'None', 'use_colors': 'True', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'write_json': 'True', 'indirect_selection': 'eager'}
[0m05:48:17.411194 [info ] [MainThread]: dbt version: 1.10.13
[0m05:48:17.411532 [info ] [MainThread]: python version: 3.12.3
[0m05:48:17.411769 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:48:17.412000 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:48:17.510626 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:48:17.510995 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:48:17.511238 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:48:17.512679 [info ] [MainThread]: adapter type: duckdb
[0m05:48:17.512925 [info ] [MainThread]: adapter version: 1.10.0
[0m05:48:17.609483 [info ] [MainThread]: Configuration:
[0m05:48:17.609871 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:48:17.610118 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:48:17.610362 [info ] [MainThread]: Required dependencies:
[0m05:48:17.610614 [debug] [MainThread]: Executing "git --help"
[0m05:48:17.613608 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:48:17.614063 [debug] [MainThread]: STDERR: "b''"
[0m05:48:17.614426 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:48:17.614749 [info ] [MainThread]: Connection:
[0m05:48:17.615084 [info ] [MainThread]:   database: datacore
[0m05:48:17.615396 [info ] [MainThread]:   schema: main
[0m05:48:17.615639 [info ] [MainThread]:   path: datacore.duckdb
[0m05:48:17.615863 [info ] [MainThread]:   config_options: None
[0m05:48:17.616088 [info ] [MainThread]:   extensions: None
[0m05:48:17.616322 [info ] [MainThread]:   settings: {}
[0m05:48:17.616548 [info ] [MainThread]:   external_root: .
[0m05:48:17.616769 [info ] [MainThread]:   use_credential_provider: None
[0m05:48:17.616994 [info ] [MainThread]:   attach: None
[0m05:48:17.617217 [info ] [MainThread]:   filesystems: None
[0m05:48:17.617445 [info ] [MainThread]:   remote: None
[0m05:48:17.617668 [info ] [MainThread]:   plugins: None
[0m05:48:17.617888 [info ] [MainThread]:   disable_transactions: False
[0m05:48:17.618232 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:48:17.721852 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:48:17.742943 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:48:17.743319 [debug] [MainThread]: On debug: select 1 as id
[0m05:48:17.743580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:48:17.761276 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m05:48:17.762286 [debug] [MainThread]: On debug: Close
[0m05:48:17.762675 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:48:17.762948 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:48:17.763786 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43293738, "process_in_blocks": "2128", "process_kernel_time": 0.209758, "process_mem_max_rss": "154276", "process_out_blocks": "40", "process_user_time": 1.784943}
[0m05:48:17.764202 [debug] [MainThread]: Command `cli debug` succeeded at 05:48:17.764115 after 0.43 seconds
[0m05:48:17.764515 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:48:17.764825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1607bbc3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f6a8fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1606a8e090>]}
[0m05:48:17.765184 [debug] [MainThread]: Flushing usage events
[0m05:48:18.986578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:48:32.677875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5470fff380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b54712a5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5470a5e3c0>]}


============================== 05:48:32.681141 | 97f4e211-71cb-4020-876f-17b05633c18a ==============================
[0m05:48:32.681141 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:48:32.681570 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'partial_parse': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt query --metrics daily_vehicles --group-by vehicle_type_name,transaction_date --start-time 2025-10-28 --end-time 2025-11-01 --explain', 'use_colors': 'True', 'write_json': 'True', 'target_path': 'None', 'quiet': 'True', 'log_format': 'default', 'empty': 'None', 'warn_error': 'None'}
[0m05:48:32.689494 [info ] [MainThread]: dbt version: 1.10.13
[0m05:48:32.689826 [info ] [MainThread]: python version: 3.12.3
[0m05:48:32.690068 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:48:32.690309 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:48:32.787741 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:48:32.788109 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:48:32.788356 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:48:32.789390 [info ] [MainThread]: adapter type: duckdb
[0m05:48:32.789634 [info ] [MainThread]: adapter version: 1.10.0
[0m05:48:32.886120 [info ] [MainThread]: Configuration:
[0m05:48:32.886505 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:48:32.886745 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:48:32.886975 [info ] [MainThread]: Required dependencies:
[0m05:48:32.887226 [debug] [MainThread]: Executing "git --help"
[0m05:48:32.890238 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:48:32.890675 [debug] [MainThread]: STDERR: "b''"
[0m05:48:32.891015 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:48:32.891348 [info ] [MainThread]: Connection:
[0m05:48:32.891632 [info ] [MainThread]:   database: datacore
[0m05:48:32.891859 [info ] [MainThread]:   schema: main
[0m05:48:32.892083 [info ] [MainThread]:   path: datacore.duckdb
[0m05:48:32.892316 [info ] [MainThread]:   config_options: None
[0m05:48:32.892544 [info ] [MainThread]:   extensions: None
[0m05:48:32.892769 [info ] [MainThread]:   settings: {}
[0m05:48:32.892998 [info ] [MainThread]:   external_root: .
[0m05:48:32.893233 [info ] [MainThread]:   use_credential_provider: None
[0m05:48:32.893469 [info ] [MainThread]:   attach: None
[0m05:48:32.893691 [info ] [MainThread]:   filesystems: None
[0m05:48:32.893914 [info ] [MainThread]:   remote: None
[0m05:48:32.894135 [info ] [MainThread]:   plugins: None
[0m05:48:32.894364 [info ] [MainThread]:   disable_transactions: False
[0m05:48:32.894706 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:48:32.995008 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:48:33.016245 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:48:33.016645 [debug] [MainThread]: On debug: select 1 as id
[0m05:48:33.017013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:48:33.024495 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:48:33.024840 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:48:33.025169 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:48:33.025431 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:48:33.025680 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 378004) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:48:33.026409 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.4001792, "process_in_blocks": "168", "process_kernel_time": 0.194973, "process_mem_max_rss": "149748", "process_out_blocks": "24", "process_user_time": 1.698771}
[0m05:48:33.026787 [debug] [MainThread]: Command `cli debug` failed at 05:48:33.026708 after 0.40 seconds
[0m05:48:33.027061 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:48:33.027344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b547093d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b545f8fa180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b546f56c320>]}
[0m05:48:33.027674 [debug] [MainThread]: Flushing usage events
[0m05:48:34.407178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:51:38.791375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a6a08003e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a6a2097cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a6a07139e0>]}


============================== 05:51:38.794858 | 925cc2a7-3d03-43e2-8159-b6afa1110dd4 ==============================
[0m05:51:38.794858 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:51:38.795337 [debug] [MainThread]: running dbt with arguments {'quiet': 'True', 'use_colors': 'True', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'no_print': 'None', 'warn_error': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'invocation_command': 'dbt list metrics', 'static_parser': 'True', 'printer_width': '80', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True'}
[0m05:51:38.804074 [info ] [MainThread]: dbt version: 1.10.13
[0m05:51:38.804440 [info ] [MainThread]: python version: 3.12.3
[0m05:51:38.804730 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:51:38.804997 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:51:38.911046 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:51:38.911469 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:51:38.911751 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:51:38.912939 [info ] [MainThread]: adapter type: duckdb
[0m05:51:38.913217 [info ] [MainThread]: adapter version: 1.10.0
[0m05:51:39.018964 [info ] [MainThread]: Configuration:
[0m05:51:39.019396 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:51:39.019684 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:51:39.019955 [info ] [MainThread]: Required dependencies:
[0m05:51:39.020243 [debug] [MainThread]: Executing "git --help"
[0m05:51:39.023314 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:51:39.023756 [debug] [MainThread]: STDERR: "b''"
[0m05:51:39.024120 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:51:39.024465 [info ] [MainThread]: Connection:
[0m05:51:39.024754 [info ] [MainThread]:   database: datacore
[0m05:51:39.024993 [info ] [MainThread]:   schema: main
[0m05:51:39.025249 [info ] [MainThread]:   path: datacore.duckdb
[0m05:51:39.025523 [info ] [MainThread]:   config_options: None
[0m05:51:39.025779 [info ] [MainThread]:   extensions: None
[0m05:51:39.026036 [info ] [MainThread]:   settings: {}
[0m05:51:39.026296 [info ] [MainThread]:   external_root: .
[0m05:51:39.026561 [info ] [MainThread]:   use_credential_provider: None
[0m05:51:39.026823 [info ] [MainThread]:   attach: None
[0m05:51:39.027082 [info ] [MainThread]:   filesystems: None
[0m05:51:39.027345 [info ] [MainThread]:   remote: None
[0m05:51:39.027614 [info ] [MainThread]:   plugins: None
[0m05:51:39.027869 [info ] [MainThread]:   disable_transactions: False
[0m05:51:39.028255 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:51:39.129577 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:51:39.150848 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:51:39.151270 [debug] [MainThread]: On debug: select 1 as id
[0m05:51:39.151559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:39.169163 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m05:51:39.170151 [debug] [MainThread]: On debug: Close
[0m05:51:39.170514 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:51:39.170777 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:51:39.171637 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43584612, "process_in_blocks": "0", "process_kernel_time": 0.203961, "process_mem_max_rss": "153112", "process_out_blocks": "32", "process_user_time": 1.810661}
[0m05:51:39.172056 [debug] [MainThread]: Command `cli debug` succeeded at 05:51:39.171969 after 0.44 seconds
[0m05:51:39.172360 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:51:39.172675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a69ff6c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a6a1112bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a6a03c7fe0>]}
[0m05:51:39.173041 [debug] [MainThread]: Flushing usage events
[0m05:51:40.981360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:56:31.643431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee63e410b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee63e822f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee63e562f30>]}


============================== 05:56:31.646661 | b0ab3b53-1cce-4dd2-bb18-fc35f3cba590 ==============================
[0m05:56:31.646661 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:56:31.647081 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'quiet': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/chun/Develop/datacore', 'invocation_command': 'dbt list metrics', 'target_path': 'None', 'log_cache_events': 'False'}
[0m05:56:31.654887 [info ] [MainThread]: dbt version: 1.10.13
[0m05:56:31.655216 [info ] [MainThread]: python version: 3.12.3
[0m05:56:31.655469 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:56:31.655707 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:56:31.752669 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:56:31.753042 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:56:31.753286 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:56:31.754368 [info ] [MainThread]: adapter type: duckdb
[0m05:56:31.754614 [info ] [MainThread]: adapter version: 1.10.0
[0m05:56:31.849884 [info ] [MainThread]: Configuration:
[0m05:56:31.850276 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:56:31.850554 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:56:31.850790 [info ] [MainThread]: Required dependencies:
[0m05:56:31.851044 [debug] [MainThread]: Executing "git --help"
[0m05:56:31.853525 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:56:31.853972 [debug] [MainThread]: STDERR: "b''"
[0m05:56:31.854307 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:56:31.854539 [info ] [MainThread]: Connection:
[0m05:56:31.854777 [info ] [MainThread]:   database: datacore
[0m05:56:31.855004 [info ] [MainThread]:   schema: main
[0m05:56:31.855223 [info ] [MainThread]:   path: datacore.duckdb
[0m05:56:31.855453 [info ] [MainThread]:   config_options: None
[0m05:56:31.855674 [info ] [MainThread]:   extensions: None
[0m05:56:31.855896 [info ] [MainThread]:   settings: {}
[0m05:56:31.856121 [info ] [MainThread]:   external_root: .
[0m05:56:31.856350 [info ] [MainThread]:   use_credential_provider: None
[0m05:56:31.856571 [info ] [MainThread]:   attach: None
[0m05:56:31.856791 [info ] [MainThread]:   filesystems: None
[0m05:56:31.857011 [info ] [MainThread]:   remote: None
[0m05:56:31.857230 [info ] [MainThread]:   plugins: None
[0m05:56:31.857458 [info ] [MainThread]:   disable_transactions: False
[0m05:56:31.857796 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:56:31.956198 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:56:31.977003 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:56:31.977384 [debug] [MainThread]: On debug: select 1 as id
[0m05:56:31.977647 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:56:31.995050 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m05:56:31.996014 [debug] [MainThread]: On debug: Close
[0m05:56:31.996367 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:56:31.996631 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:56:31.997405 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.40505287, "process_in_blocks": "0", "process_kernel_time": 0.208142, "process_mem_max_rss": "153332", "process_out_blocks": "32", "process_user_time": 1.682153}
[0m05:56:31.997780 [debug] [MainThread]: Command `cli debug` succeeded at 05:56:31.997701 after 0.41 seconds
[0m05:56:31.998043 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:56:31.998328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee63e842ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee63cf94bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee63d04d7c0>]}
[0m05:56:31.998649 [debug] [MainThread]: Flushing usage events
[0m05:56:33.218407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:56:40.720467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d9d853a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d9d87a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d9eeff4a0>]}


============================== 05:56:40.723774 | de76d3bc-bc16-4c9a-a1a9-b01987877a6b ==============================
[0m05:56:40.723774 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:56:40.724193 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'quiet': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'invocation_command': 'dbt list metrics', 'indirect_selection': 'eager', 'write_json': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m05:56:40.732052 [info ] [MainThread]: dbt version: 1.10.13
[0m05:56:40.732391 [info ] [MainThread]: python version: 3.12.3
[0m05:56:40.732632 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:56:40.732867 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:56:40.830619 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:56:40.830996 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:56:40.831241 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:56:40.832315 [info ] [MainThread]: adapter type: duckdb
[0m05:56:40.832564 [info ] [MainThread]: adapter version: 1.10.0
[0m05:56:40.930277 [info ] [MainThread]: Configuration:
[0m05:56:40.930676 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:56:40.930925 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:56:40.931161 [info ] [MainThread]: Required dependencies:
[0m05:56:40.931423 [debug] [MainThread]: Executing "git --help"
[0m05:56:40.934408 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:56:40.934851 [debug] [MainThread]: STDERR: "b''"
[0m05:56:40.935197 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:56:40.935525 [info ] [MainThread]: Connection:
[0m05:56:40.935794 [info ] [MainThread]:   database: datacore
[0m05:56:40.936020 [info ] [MainThread]:   schema: main
[0m05:56:40.936245 [info ] [MainThread]:   path: datacore.duckdb
[0m05:56:40.936479 [info ] [MainThread]:   config_options: None
[0m05:56:40.936707 [info ] [MainThread]:   extensions: None
[0m05:56:40.936936 [info ] [MainThread]:   settings: {}
[0m05:56:40.937166 [info ] [MainThread]:   external_root: .
[0m05:56:40.937398 [info ] [MainThread]:   use_credential_provider: None
[0m05:56:40.937624 [info ] [MainThread]:   attach: None
[0m05:56:40.937848 [info ] [MainThread]:   filesystems: None
[0m05:56:40.938071 [info ] [MainThread]:   remote: None
[0m05:56:40.938294 [info ] [MainThread]:   plugins: None
[0m05:56:40.938529 [info ] [MainThread]:   disable_transactions: False
[0m05:56:40.938872 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:56:41.039231 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:56:41.060153 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:56:41.060534 [debug] [MainThread]: On debug: select 1 as id
[0m05:56:41.060794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:56:41.078122 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m05:56:41.079112 [debug] [MainThread]: On debug: Close
[0m05:56:41.079463 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:56:41.079712 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:56:41.080487 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4111356, "process_in_blocks": "0", "process_kernel_time": 0.19192, "process_mem_max_rss": "153024", "process_out_blocks": "16", "process_user_time": 1.702295}
[0m05:56:41.080864 [debug] [MainThread]: Command `cli debug` succeeded at 05:56:41.080785 after 0.41 seconds
[0m05:56:41.081129 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:56:41.081415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d9cbc6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d9c872990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d9db66750>]}
[0m05:56:41.081749 [debug] [MainThread]: Flushing usage events
[0m05:56:42.236452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:53:46.932179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7960f1934d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7960f04ba360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7960f04b8740>]}


============================== 06:53:46.934995 | 0fe3430a-ad8a-41f0-b7fe-57251ba08b27 ==============================
[0m06:53:46.934995 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:53:46.935437 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'fail_fast': 'False', 'invocation_command': 'dbt list metrics', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'introspect': 'True', 'quiet': 'True', 'debug': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'write_json': 'True'}
[0m06:53:46.943552 [info ] [MainThread]: dbt version: 1.10.13
[0m06:53:46.943885 [info ] [MainThread]: python version: 3.12.3
[0m06:53:46.944149 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m06:53:46.944409 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m06:53:47.049478 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m06:53:47.049885 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m06:53:47.050167 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m06:53:47.051346 [info ] [MainThread]: adapter type: duckdb
[0m06:53:47.051621 [info ] [MainThread]: adapter version: 1.10.0
[0m06:53:47.156285 [info ] [MainThread]: Configuration:
[0m06:53:47.156711 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:53:47.156995 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:53:47.157259 [info ] [MainThread]: Required dependencies:
[0m06:53:47.157553 [debug] [MainThread]: Executing "git --help"
[0m06:53:47.160106 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:53:47.160475 [debug] [MainThread]: STDERR: "b''"
[0m06:53:47.160751 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:53:47.161014 [info ] [MainThread]: Connection:
[0m06:53:47.161288 [info ] [MainThread]:   database: datacore
[0m06:53:47.161550 [info ] [MainThread]:   schema: main
[0m06:53:47.161804 [info ] [MainThread]:   path: datacore.duckdb
[0m06:53:47.162059 [info ] [MainThread]:   config_options: None
[0m06:53:47.162318 [info ] [MainThread]:   extensions: None
[0m06:53:47.162576 [info ] [MainThread]:   settings: {}
[0m06:53:47.162832 [info ] [MainThread]:   external_root: .
[0m06:53:47.163085 [info ] [MainThread]:   use_credential_provider: None
[0m06:53:47.163350 [info ] [MainThread]:   attach: None
[0m06:53:47.163601 [info ] [MainThread]:   filesystems: None
[0m06:53:47.163853 [info ] [MainThread]:   remote: None
[0m06:53:47.164106 [info ] [MainThread]:   plugins: None
[0m06:53:47.164365 [info ] [MainThread]:   disable_transactions: False
[0m06:53:47.164748 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:53:47.264951 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m06:53:47.285834 [debug] [MainThread]: Using duckdb connection "debug"
[0m06:53:47.286224 [debug] [MainThread]: On debug: select 1 as id
[0m06:53:47.286508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:53:47.304819 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m06:53:47.305889 [debug] [MainThread]: On debug: Close
[0m06:53:47.306276 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:53:47.306565 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:53:47.307418 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43999854, "process_in_blocks": "784", "process_kernel_time": 0.204522, "process_mem_max_rss": "154632", "process_out_blocks": "32", "process_user_time": 1.792816}
[0m06:53:47.307838 [debug] [MainThread]: Command `cli debug` succeeded at 06:53:47.307750 after 0.44 seconds
[0m06:53:47.308135 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:53:47.308470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7960f10ffbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7960f0d5ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7960e076d580>]}
[0m06:53:47.308835 [debug] [MainThread]: Flushing usage events
[0m06:53:48.536046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:59.395483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f461f6f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f461e282c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f460a09130>]}


============================== 10:27:59.399719 | d376b22c-f0c9-4e12-aa5c-97e3cb874758 ==============================
[0m10:27:59.399719 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:27:59.400149 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'quiet': 'True', 'fail_fast': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'cache_selected_only': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'static_parser': 'True', 'warn_error': 'None', 'invocation_command': 'dbt list metrics'}
[0m10:27:59.408520 [info ] [MainThread]: dbt version: 1.10.13
[0m10:27:59.408843 [info ] [MainThread]: python version: 3.12.3
[0m10:27:59.409081 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m10:27:59.409320 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m10:27:59.508653 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m10:27:59.509030 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m10:27:59.509269 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m10:27:59.510340 [info ] [MainThread]: adapter type: duckdb
[0m10:27:59.510581 [info ] [MainThread]: adapter version: 1.10.0
[0m10:27:59.608251 [info ] [MainThread]: Configuration:
[0m10:27:59.608637 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:27:59.608881 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:27:59.609120 [info ] [MainThread]: Required dependencies:
[0m10:27:59.609421 [debug] [MainThread]: Executing "git --help"
[0m10:27:59.612467 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:27:59.613070 [debug] [MainThread]: STDERR: "b''"
[0m10:27:59.613472 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:27:59.613834 [info ] [MainThread]: Connection:
[0m10:27:59.614198 [info ] [MainThread]:   database: datacore
[0m10:27:59.614523 [info ] [MainThread]:   schema: main
[0m10:27:59.614749 [info ] [MainThread]:   path: datacore.duckdb
[0m10:27:59.614971 [info ] [MainThread]:   config_options: None
[0m10:27:59.615193 [info ] [MainThread]:   extensions: None
[0m10:27:59.615424 [info ] [MainThread]:   settings: {}
[0m10:27:59.615647 [info ] [MainThread]:   external_root: .
[0m10:27:59.615867 [info ] [MainThread]:   use_credential_provider: None
[0m10:27:59.616089 [info ] [MainThread]:   attach: None
[0m10:27:59.616315 [info ] [MainThread]:   filesystems: None
[0m10:27:59.616610 [info ] [MainThread]:   remote: None
[0m10:27:59.616922 [info ] [MainThread]:   plugins: None
[0m10:27:59.617236 [info ] [MainThread]:   disable_transactions: False
[0m10:27:59.617675 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:27:59.718328 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:27:59.739504 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:27:59.739869 [debug] [MainThread]: On debug: select 1 as id
[0m10:27:59.740133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:59.757785 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m10:27:59.758763 [debug] [MainThread]: On debug: Close
[0m10:27:59.759120 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:27:59.759381 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:27:59.760148 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4384192, "process_in_blocks": "1864", "process_kernel_time": 0.224064, "process_mem_max_rss": "154044", "process_out_blocks": "40", "process_user_time": 1.814523}
[0m10:27:59.760538 [debug] [MainThread]: Command `cli debug` succeeded at 10:27:59.760458 after 0.44 seconds
[0m10:27:59.760807 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:27:59.761088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f461744c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f462550560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f460935c40>]}
[0m10:27:59.761418 [debug] [MainThread]: Flushing usage events
[0m10:28:01.365520 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:28:07.386280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a8e9b17e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a8e90c8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a8e90c8260>]}


============================== 10:28:07.389953 | 7529b196-04df-4247-a72a-5d9f02b71800 ==============================
[0m10:28:07.389953 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:28:07.390385 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt query --metrics daily_revenue --group-by station_name,transaction_date --start-time 2025-11-15 --end-time 2025-12-31 --explain', 'profiles_dir': '/home/chun/Develop/datacore', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'empty': 'None', 'log_format': 'default', 'use_colors': 'True', 'quiet': 'True', 'warn_error': 'None', 'debug': 'False', 'log_cache_events': 'False', 'version_check': 'True'}
[0m10:28:07.398275 [info ] [MainThread]: dbt version: 1.10.13
[0m10:28:07.398608 [info ] [MainThread]: python version: 3.12.3
[0m10:28:07.398847 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m10:28:07.399082 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m10:28:07.495238 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m10:28:07.495617 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m10:28:07.495858 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m10:28:07.496905 [info ] [MainThread]: adapter type: duckdb
[0m10:28:07.497150 [info ] [MainThread]: adapter version: 1.10.0
[0m10:28:07.592635 [info ] [MainThread]: Configuration:
[0m10:28:07.593019 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:28:07.593261 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:28:07.593501 [info ] [MainThread]: Required dependencies:
[0m10:28:07.593751 [debug] [MainThread]: Executing "git --help"
[0m10:28:07.596813 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:28:07.597366 [debug] [MainThread]: STDERR: "b''"
[0m10:28:07.597705 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:28:07.597957 [info ] [MainThread]: Connection:
[0m10:28:07.598202 [info ] [MainThread]:   database: datacore
[0m10:28:07.598441 [info ] [MainThread]:   schema: main
[0m10:28:07.598668 [info ] [MainThread]:   path: datacore.duckdb
[0m10:28:07.598893 [info ] [MainThread]:   config_options: None
[0m10:28:07.599128 [info ] [MainThread]:   extensions: None
[0m10:28:07.599360 [info ] [MainThread]:   settings: {}
[0m10:28:07.599588 [info ] [MainThread]:   external_root: .
[0m10:28:07.599810 [info ] [MainThread]:   use_credential_provider: None
[0m10:28:07.600032 [info ] [MainThread]:   attach: None
[0m10:28:07.600251 [info ] [MainThread]:   filesystems: None
[0m10:28:07.600479 [info ] [MainThread]:   remote: None
[0m10:28:07.600699 [info ] [MainThread]:   plugins: None
[0m10:28:07.600920 [info ] [MainThread]:   disable_transactions: False
[0m10:28:07.601260 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:28:07.704248 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:28:07.726017 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:28:07.726391 [debug] [MainThread]: On debug: select 1 as id
[0m10:28:07.726650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:07.732274 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m10:28:07.732616 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m10:28:07.732937 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:28:07.733183 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:28:07.733436 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 378004) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:28:07.734144 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.4003037, "process_in_blocks": "0", "process_kernel_time": 0.209924, "process_mem_max_rss": "149116", "process_out_blocks": "24", "process_user_time": 1.710381}
[0m10:28:07.734524 [debug] [MainThread]: Command `cli debug` failed at 10:28:07.734446 after 0.40 seconds
[0m10:28:07.734799 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:28:07.735074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a8e97524b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a8e80748f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a8e808d490>]}
[0m10:28:07.735409 [debug] [MainThread]: Flushing usage events
[0m10:28:08.993289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:28:23.729596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d142d46b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d142dfb2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d142e4bc140>]}


============================== 10:28:23.732952 | c75dbd73-f174-4171-9baf-d8d19e697f7f ==============================
[0m10:28:23.732952 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:28:23.733391 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'quiet': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt query --metrics daily_revenue --group-by station_name,transaction_date --start-time 2025-03-01 --end-time 2026-04-30 --explain', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'empty': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'target_path': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'introspect': 'True'}
[0m10:28:23.741371 [info ] [MainThread]: dbt version: 1.10.13
[0m10:28:23.741710 [info ] [MainThread]: python version: 3.12.3
[0m10:28:23.741974 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m10:28:23.742224 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m10:28:23.848891 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m10:28:23.849284 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m10:28:23.849565 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m10:28:23.850726 [info ] [MainThread]: adapter type: duckdb
[0m10:28:23.850991 [info ] [MainThread]: adapter version: 1.10.0
[0m10:28:23.960196 [info ] [MainThread]: Configuration:
[0m10:28:23.960613 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:28:23.960891 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:28:23.961151 [info ] [MainThread]: Required dependencies:
[0m10:28:23.961442 [debug] [MainThread]: Executing "git --help"
[0m10:28:23.964476 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:28:23.965038 [debug] [MainThread]: STDERR: "b''"
[0m10:28:23.965408 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:28:23.965722 [info ] [MainThread]: Connection:
[0m10:28:23.965975 [info ] [MainThread]:   database: datacore
[0m10:28:23.966201 [info ] [MainThread]:   schema: main
[0m10:28:23.966434 [info ] [MainThread]:   path: datacore.duckdb
[0m10:28:23.966658 [info ] [MainThread]:   config_options: None
[0m10:28:23.966880 [info ] [MainThread]:   extensions: None
[0m10:28:23.967104 [info ] [MainThread]:   settings: {}
[0m10:28:23.967350 [info ] [MainThread]:   external_root: .
[0m10:28:23.967569 [info ] [MainThread]:   use_credential_provider: None
[0m10:28:23.967793 [info ] [MainThread]:   attach: None
[0m10:28:23.968012 [info ] [MainThread]:   filesystems: None
[0m10:28:23.968232 [info ] [MainThread]:   remote: None
[0m10:28:23.968462 [info ] [MainThread]:   plugins: None
[0m10:28:23.968684 [info ] [MainThread]:   disable_transactions: False
[0m10:28:23.969024 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:28:24.069250 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:28:24.091437 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:28:24.091808 [debug] [MainThread]: On debug: select 1 as id
[0m10:28:24.092068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:24.097685 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m10:28:24.098015 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m10:28:24.098350 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:28:24.098596 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:28:24.098842 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 378004) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:28:24.099573 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.4214566, "process_in_blocks": "0", "process_kernel_time": 0.221808, "process_mem_max_rss": "149568", "process_out_blocks": "24", "process_user_time": 1.785458}
[0m10:28:24.099949 [debug] [MainThread]: Command `cli debug` failed at 10:28:24.099870 after 0.42 seconds
[0m10:28:24.100221 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:28:24.100506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d142d2897f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d141bbb0500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d142c61edb0>]}
[0m10:28:24.100831 [debug] [MainThread]: Flushing usage events
[0m10:28:25.239536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:39:55.942828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7205b1a93a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7205b01b3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7205b1e87c50>]}


============================== 00:39:55.946766 | 5a5a9f4c-ffdb-45a2-95c4-427c0e907c53 ==============================
[0m00:39:55.946766 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:39:55.947233 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'True', 'invocation_command': 'dbt list metrics', 'target_path': 'None', 'empty': 'None', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/chun/Develop/datacore', 'log_path': '/home/chun/Develop/datacore/logs', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False'}
[0m00:39:55.956091 [info ] [MainThread]: dbt version: 1.10.13
[0m00:39:55.956445 [info ] [MainThread]: python version: 3.12.3
[0m00:39:55.956704 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m00:39:55.956957 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m00:39:56.054968 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m00:39:56.055353 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m00:39:56.055597 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m00:39:56.056676 [info ] [MainThread]: adapter type: duckdb
[0m00:39:56.056922 [info ] [MainThread]: adapter version: 1.10.0
[0m00:39:56.152845 [info ] [MainThread]: Configuration:
[0m00:39:56.153227 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:39:56.153481 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:39:56.153718 [info ] [MainThread]: Required dependencies:
[0m00:39:56.153970 [debug] [MainThread]: Executing "git --help"
[0m00:39:56.156963 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:39:56.157404 [debug] [MainThread]: STDERR: "b''"
[0m00:39:56.157745 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:39:56.158047 [info ] [MainThread]: Connection:
[0m00:39:56.158297 [info ] [MainThread]:   database: datacore
[0m00:39:56.158532 [info ] [MainThread]:   schema: main
[0m00:39:56.158758 [info ] [MainThread]:   path: datacore.duckdb
[0m00:39:56.158983 [info ] [MainThread]:   config_options: None
[0m00:39:56.159208 [info ] [MainThread]:   extensions: None
[0m00:39:56.159444 [info ] [MainThread]:   settings: {}
[0m00:39:56.159674 [info ] [MainThread]:   external_root: .
[0m00:39:56.159899 [info ] [MainThread]:   use_credential_provider: None
[0m00:39:56.160131 [info ] [MainThread]:   attach: None
[0m00:39:56.160374 [info ] [MainThread]:   filesystems: None
[0m00:39:56.160598 [info ] [MainThread]:   remote: None
[0m00:39:56.160822 [info ] [MainThread]:   plugins: None
[0m00:39:56.161047 [info ] [MainThread]:   disable_transactions: False
[0m00:39:56.161398 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:39:56.261903 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m00:39:56.285461 [debug] [MainThread]: Using duckdb connection "debug"
[0m00:39:56.285834 [debug] [MainThread]: On debug: select 1 as id
[0m00:39:56.286090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:56.304068 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m00:39:56.305044 [debug] [MainThread]: On debug: Close
[0m00:39:56.305405 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:39:56.305661 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:39:56.306426 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4366862, "process_in_blocks": "21144", "process_kernel_time": 0.247035, "process_mem_max_rss": "153996", "process_out_blocks": "40", "process_user_time": 1.852765}
[0m00:39:56.306806 [debug] [MainThread]: Command `cli debug` succeeded at 00:39:56.306727 after 0.44 seconds
[0m00:39:56.307071 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:39:56.307360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7205b023cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7205b1c4dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7205b01848c0>]}
[0m00:39:56.307686 [debug] [MainThread]: Flushing usage events
[0m00:39:57.835146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:00.225342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f6b1b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f6381ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f778b770>]}


============================== 00:40:00.228469 | 62fc7ade-2a95-4814-b603-56b6fe82fb4e ==============================
[0m00:40:00.228469 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:40:00.228880 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt list metrics', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'cache_selected_only': 'False', 'quiet': 'True', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'empty': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'log_path': '/home/chun/Develop/datacore/logs'}
[0m00:40:00.236635 [info ] [MainThread]: dbt version: 1.10.13
[0m00:40:00.236963 [info ] [MainThread]: python version: 3.12.3
[0m00:40:00.237200 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m00:40:00.237438 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m00:40:00.336656 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m00:40:00.337049 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m00:40:00.337317 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m00:40:00.338463 [info ] [MainThread]: adapter type: duckdb
[0m00:40:00.338725 [info ] [MainThread]: adapter version: 1.10.0
[0m00:40:00.441359 [info ] [MainThread]: Configuration:
[0m00:40:00.441743 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:40:00.441987 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:40:00.442220 [info ] [MainThread]: Required dependencies:
[0m00:40:00.442477 [debug] [MainThread]: Executing "git --help"
[0m00:40:00.445275 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:40:00.445727 [debug] [MainThread]: STDERR: "b''"
[0m00:40:00.446088 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:40:00.446425 [info ] [MainThread]: Connection:
[0m00:40:00.446760 [info ] [MainThread]:   database: datacore
[0m00:40:00.447070 [info ] [MainThread]:   schema: main
[0m00:40:00.447328 [info ] [MainThread]:   path: datacore.duckdb
[0m00:40:00.447553 [info ] [MainThread]:   config_options: None
[0m00:40:00.447777 [info ] [MainThread]:   extensions: None
[0m00:40:00.448003 [info ] [MainThread]:   settings: {}
[0m00:40:00.448230 [info ] [MainThread]:   external_root: .
[0m00:40:00.448463 [info ] [MainThread]:   use_credential_provider: None
[0m00:40:00.448688 [info ] [MainThread]:   attach: None
[0m00:40:00.448910 [info ] [MainThread]:   filesystems: None
[0m00:40:00.449132 [info ] [MainThread]:   remote: None
[0m00:40:00.449365 [info ] [MainThread]:   plugins: None
[0m00:40:00.449588 [info ] [MainThread]:   disable_transactions: False
[0m00:40:00.449931 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:40:00.551009 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m00:40:00.571755 [debug] [MainThread]: Using duckdb connection "debug"
[0m00:40:00.572122 [debug] [MainThread]: On debug: select 1 as id
[0m00:40:00.572388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:40:00.590773 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m00:40:00.591741 [debug] [MainThread]: On debug: Close
[0m00:40:00.592103 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:40:00.592359 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:40:00.593114 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41798002, "process_in_blocks": "0", "process_kernel_time": 0.193811, "process_mem_max_rss": "153372", "process_out_blocks": "24", "process_user_time": 1.704344}
[0m00:40:00.593502 [debug] [MainThread]: Command `cli debug` succeeded at 00:40:00.593422 after 0.42 seconds
[0m00:40:00.593770 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:40:00.594053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f5247740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535e554d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f6c87b60>]}
[0m00:40:00.594390 [debug] [MainThread]: Flushing usage events
[0m00:40:01.698000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:59:06.790616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6cc35fa4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6cc256b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6cc17441a0>]}


============================== 01:59:06.794260 | 7ed043d8-38bd-4283-8898-68e47666914d ==============================
[0m01:59:06.794260 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:59:06.794763 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt parse', 'partial_parse': 'True', 'log_format': 'default', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/home/chun/Develop/datacore', 'warn_error': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'target_path': 'None'}
[0m01:59:07.011823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ed043d8-38bd-4283-8898-68e47666914d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6cc37fe7b0>]}
[0m01:59:07.074220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ed043d8-38bd-4283-8898-68e47666914d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6cc0fa9c10>]}
[0m01:59:07.075880 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:59:07.158169 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:59:07.314596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m01:59:07.315300 [debug] [MainThread]: Partial parsing: added file: datacore://models/metrics.yml
[0m01:59:07.315800 [debug] [MainThread]: Partial parsing: updated file: datacore://models/dws/schema.yml
[0m01:59:07.316144 [debug] [MainThread]: Partial parsing: updated file: datacore://macros/metadata/README.md
[0m01:59:07.468514 [error] [MainThread]: Encountered an error:
Parsing Error in metric normal_transaction_rate (models/metrics.yml)
  The metric `normal_transaction_count` does not exist but was referenced.
[0m01:59:07.469818 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.730995, "process_in_blocks": "3480", "process_kernel_time": 0.187157, "process_mem_max_rss": "137688", "process_out_blocks": "8", "process_user_time": 1.774496}
[0m01:59:07.470285 [debug] [MainThread]: Command `dbt parse` failed at 01:59:07.470191 after 0.73 seconds
[0m01:59:07.470670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6cc19dcbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6cc1258920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6cb154df70>]}
[0m01:59:07.471026 [debug] [MainThread]: Flushing usage events
[0m01:59:08.976382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:59:31.622872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755e7acd7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755e7ad71e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755e7c3c2e10>]}


============================== 01:59:31.626262 | 1e55f99d-ba62-4add-8483-80e4fcdc73e0 ==============================
[0m01:59:31.626262 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:59:31.626736 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'log_cache_events': 'False', 'quiet': 'True', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'empty': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m01:59:31.634374 [info ] [MainThread]: dbt version: 1.10.13
[0m01:59:31.634684 [info ] [MainThread]: python version: 3.12.3
[0m01:59:31.634937 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m01:59:31.635187 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m01:59:31.744642 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m01:59:31.745046 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m01:59:31.745312 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m01:59:31.746486 [info ] [MainThread]: adapter type: duckdb
[0m01:59:31.746749 [info ] [MainThread]: adapter version: 1.10.0
[0m01:59:31.854908 [info ] [MainThread]: Configuration:
[0m01:59:31.855335 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:59:31.855599 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:59:31.855850 [info ] [MainThread]: Required dependencies:
[0m01:59:31.856123 [debug] [MainThread]: Executing "git --help"
[0m01:59:31.858867 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:59:31.859510 [debug] [MainThread]: STDERR: "b''"
[0m01:59:31.859809 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:59:31.860055 [info ] [MainThread]: Connection:
[0m01:59:31.860313 [info ] [MainThread]:   database: datacore
[0m01:59:31.860540 [info ] [MainThread]:   schema: main
[0m01:59:31.860763 [info ] [MainThread]:   path: datacore.duckdb
[0m01:59:31.860988 [info ] [MainThread]:   config_options: None
[0m01:59:31.861209 [info ] [MainThread]:   extensions: None
[0m01:59:31.861441 [info ] [MainThread]:   settings: {}
[0m01:59:31.861663 [info ] [MainThread]:   external_root: .
[0m01:59:31.861882 [info ] [MainThread]:   use_credential_provider: None
[0m01:59:31.862102 [info ] [MainThread]:   attach: None
[0m01:59:31.862335 [info ] [MainThread]:   filesystems: None
[0m01:59:31.862553 [info ] [MainThread]:   remote: None
[0m01:59:31.862772 [info ] [MainThread]:   plugins: None
[0m01:59:31.862993 [info ] [MainThread]:   disable_transactions: False
[0m01:59:31.863381 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:59:31.961280 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m01:59:31.982464 [debug] [MainThread]: Using duckdb connection "debug"
[0m01:59:31.982865 [debug] [MainThread]: On debug: select 1 as id
[0m01:59:31.983123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:59:32.001493 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m01:59:32.002547 [debug] [MainThread]: On debug: Close
[0m01:59:32.002925 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:59:32.003178 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:59:32.004017 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43172547, "process_in_blocks": "0", "process_kernel_time": 0.276439, "process_mem_max_rss": "151840", "process_out_blocks": "8", "process_user_time": 1.903143}
[0m01:59:32.004424 [debug] [MainThread]: Command `cli debug` succeeded at 01:59:32.004341 after 0.43 seconds
[0m01:59:32.004699 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:59:32.004988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755e7b703bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755e7b703c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755e7d5a0f80>]}
[0m01:59:32.005338 [debug] [MainThread]: Flushing usage events
[0m01:59:33.145631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:59:39.417671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da3e097b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da3eeed3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da3f2237a0>]}


============================== 01:59:39.421250 | 30bac99b-41ae-4bfc-b3f3-b7572c4a6235 ==============================
[0m01:59:39.421250 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:59:39.421693 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'invocation_command': 'dbt list metrics', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'quiet': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/chun/Develop/datacore', 'introspect': 'True'}
[0m01:59:39.430614 [info ] [MainThread]: dbt version: 1.10.13
[0m01:59:39.430984 [info ] [MainThread]: python version: 3.12.3
[0m01:59:39.431245 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m01:59:39.431509 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m01:59:39.532584 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m01:59:39.532947 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m01:59:39.533185 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m01:59:39.534229 [info ] [MainThread]: adapter type: duckdb
[0m01:59:39.534476 [info ] [MainThread]: adapter version: 1.10.0
[0m01:59:39.629826 [info ] [MainThread]: Configuration:
[0m01:59:39.630207 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:59:39.630457 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:59:39.630692 [info ] [MainThread]: Required dependencies:
[0m01:59:39.630940 [debug] [MainThread]: Executing "git --help"
[0m01:59:39.634005 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:59:39.634771 [debug] [MainThread]: STDERR: "b''"
[0m01:59:39.635143 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:59:39.635477 [info ] [MainThread]: Connection:
[0m01:59:39.635739 [info ] [MainThread]:   database: datacore
[0m01:59:39.635967 [info ] [MainThread]:   schema: main
[0m01:59:39.636190 [info ] [MainThread]:   path: datacore.duckdb
[0m01:59:39.636424 [info ] [MainThread]:   config_options: None
[0m01:59:39.636646 [info ] [MainThread]:   extensions: None
[0m01:59:39.636870 [info ] [MainThread]:   settings: {}
[0m01:59:39.637095 [info ] [MainThread]:   external_root: .
[0m01:59:39.637323 [info ] [MainThread]:   use_credential_provider: None
[0m01:59:39.637547 [info ] [MainThread]:   attach: None
[0m01:59:39.637767 [info ] [MainThread]:   filesystems: None
[0m01:59:39.637987 [info ] [MainThread]:   remote: None
[0m01:59:39.638206 [info ] [MainThread]:   plugins: None
[0m01:59:39.638434 [info ] [MainThread]:   disable_transactions: False
[0m01:59:39.638815 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:59:39.740359 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m01:59:39.761814 [debug] [MainThread]: Using duckdb connection "debug"
[0m01:59:39.762214 [debug] [MainThread]: On debug: select 1 as id
[0m01:59:39.762480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:59:39.768109 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m01:59:39.768467 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m01:59:39.768805 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:59:39.769053 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:59:39.769290 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 735673) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:59:39.770070 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.42673254, "process_in_blocks": "0", "process_kernel_time": 0.206595, "process_mem_max_rss": "150032", "process_out_blocks": "24", "process_user_time": 1.852377}
[0m01:59:39.770480 [debug] [MainThread]: Command `cli debug` failed at 01:59:39.770399 after 0.43 seconds
[0m01:59:39.770768 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:59:39.771052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da3d4db5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da2d73a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da2d495520>]}
[0m01:59:39.771404 [debug] [MainThread]: Flushing usage events
[0m01:59:40.896846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:59:42.963875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b1bc956d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b1bc9c8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b1bc3db6b0>]}


============================== 01:59:42.967280 | 5c808fdd-bdfa-4b51-a522-099919afbb29 ==============================
[0m01:59:42.967280 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:59:42.967711 [debug] [MainThread]: running dbt with arguments {'quiet': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'target_path': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'log_format': 'default', 'introspect': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt query --metrics daily_revenue --group-by transaction_date,city --start-time 2025-01-01 --end-time 2025-01-07 --explain', 'no_print': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'write_json': 'True'}
[0m01:59:42.975822 [info ] [MainThread]: dbt version: 1.10.13
[0m01:59:42.976152 [info ] [MainThread]: python version: 3.12.3
[0m01:59:42.976400 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m01:59:42.976633 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m01:59:43.074795 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m01:59:43.075163 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m01:59:43.075407 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m01:59:43.076447 [info ] [MainThread]: adapter type: duckdb
[0m01:59:43.076687 [info ] [MainThread]: adapter version: 1.10.0
[0m01:59:43.172033 [info ] [MainThread]: Configuration:
[0m01:59:43.172417 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:59:43.172660 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:59:43.172890 [info ] [MainThread]: Required dependencies:
[0m01:59:43.173137 [debug] [MainThread]: Executing "git --help"
[0m01:59:43.175951 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:59:43.176764 [debug] [MainThread]: STDERR: "b''"
[0m01:59:43.177204 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:59:43.177531 [info ] [MainThread]: Connection:
[0m01:59:43.177849 [info ] [MainThread]:   database: datacore
[0m01:59:43.178120 [info ] [MainThread]:   schema: main
[0m01:59:43.178352 [info ] [MainThread]:   path: datacore.duckdb
[0m01:59:43.178573 [info ] [MainThread]:   config_options: None
[0m01:59:43.178791 [info ] [MainThread]:   extensions: None
[0m01:59:43.179015 [info ] [MainThread]:   settings: {}
[0m01:59:43.179237 [info ] [MainThread]:   external_root: .
[0m01:59:43.179466 [info ] [MainThread]:   use_credential_provider: None
[0m01:59:43.179686 [info ] [MainThread]:   attach: None
[0m01:59:43.179903 [info ] [MainThread]:   filesystems: None
[0m01:59:43.180119 [info ] [MainThread]:   remote: None
[0m01:59:43.180345 [info ] [MainThread]:   plugins: None
[0m01:59:43.180562 [info ] [MainThread]:   disable_transactions: False
[0m01:59:43.180934 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:59:43.281778 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m01:59:43.303590 [debug] [MainThread]: Using duckdb connection "debug"
[0m01:59:43.303996 [debug] [MainThread]: On debug: select 1 as id
[0m01:59:43.304258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:59:43.309964 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m01:59:43.310338 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m01:59:43.310679 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:59:43.310933 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:59:43.311181 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 735673) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:59:43.311956 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.3990888, "process_in_blocks": "0", "process_kernel_time": 0.219925, "process_mem_max_rss": "149284", "process_out_blocks": "24", "process_user_time": 1.663435}
[0m01:59:43.312370 [debug] [MainThread]: Command `cli debug` failed at 01:59:43.312280 after 0.40 seconds
[0m01:59:43.312662 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:59:43.312948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b1bc4559d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b1bb57e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b1ab6e0e00>]}
[0m01:59:43.313295 [debug] [MainThread]: Flushing usage events
[0m01:59:44.476553 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:02:10.782325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c1158f4ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c115096570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c115143aa0>]}


============================== 02:02:10.786314 | a3243643-0e42-4709-81fa-0d0059d705ba ==============================
[0m02:02:10.786314 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:02:10.786785 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select mf_time_spine', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'static_parser': 'True', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'no_print': 'None', 'introspect': 'True'}
[0m02:02:11.008597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3243643-0e42-4709-81fa-0d0059d705ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c116b1f140>]}
[0m02:02:11.066339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3243643-0e42-4709-81fa-0d0059d705ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c11581ef30>]}
[0m02:02:11.067892 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:02:11.147544 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:02:11.297756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m02:02:11.298430 [debug] [MainThread]: Partial parsing: added file: datacore://models/metadata/mf_time_spine.sql
[0m02:02:11.298857 [debug] [MainThread]: Partial parsing: added file: datacore://models/metrics.yml
[0m02:02:11.299379 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/schema.yml
[0m02:02:11.299893 [debug] [MainThread]: Partial parsing: updated file: datacore://models/dws/schema.yml
[0m02:02:11.300254 [debug] [MainThread]: Partial parsing: updated file: datacore://macros/metadata/README.md
[0m02:02:11.711040 [error] [MainThread]: Encountered an error:
Parsing Error in metric normal_transaction_rate (models/metrics.yml)
  The metric `normal_transaction_count` does not exist but was referenced.
[0m02:02:11.712155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.98205, "process_in_blocks": "160", "process_kernel_time": 0.207538, "process_mem_max_rss": "142072", "process_out_blocks": "16", "process_user_time": 1.983586}
[0m02:02:11.712626 [debug] [MainThread]: Command `dbt run` failed at 02:02:11.712537 after 0.98 seconds
[0m02:02:11.712996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c1152b8b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c104186420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c104127800>]}
[0m02:02:11.713365 [debug] [MainThread]: Flushing usage events
[0m02:02:13.017148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:02:18.299497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ba9078d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ba92aa5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ba90baf740>]}


============================== 02:02:18.303154 | 5e0540cb-555a-4681-98d3-474c6fe6743e ==============================
[0m02:02:18.303154 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:02:18.303636 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'fail_fast': 'False', 'empty': 'None', 'version_check': 'True', 'write_json': 'True', 'invocation_command': 'dbt parse', 'use_experimental_parser': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'partial_parse': 'True', 'quiet': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'log_cache_events': 'False', 'introspect': 'True', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m02:02:18.520413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e0540cb-555a-4681-98d3-474c6fe6743e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ba8ff69d90>]}
[0m02:02:18.583117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e0540cb-555a-4681-98d3-474c6fe6743e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ba9003fb00>]}
[0m02:02:18.584768 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:02:18.665454 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:02:18.804434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m02:02:18.805179 [debug] [MainThread]: Partial parsing: added file: datacore://models/metrics.yml
[0m02:02:18.805497 [debug] [MainThread]: Partial parsing: added file: datacore://models/metadata/mf_time_spine.sql
[0m02:02:18.806000 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/schema.yml
[0m02:02:18.806479 [debug] [MainThread]: Partial parsing: updated file: datacore://models/dws/schema.yml
[0m02:02:18.806816 [debug] [MainThread]: Partial parsing: updated file: datacore://macros/metadata/README.md
[0m02:02:19.228990 [error] [MainThread]: Encountered an error:
Parsing Error in metric normal_transaction_rate (models/metrics.yml)
  The metric `normal_transaction_count` does not exist but was referenced.
[0m02:02:19.230120 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.98793495, "process_in_blocks": "0", "process_kernel_time": 0.202642, "process_mem_max_rss": "141972", "process_out_blocks": "8", "process_user_time": 2.053381}
[0m02:02:19.230583 [debug] [MainThread]: Command `dbt parse` failed at 02:02:19.230490 after 0.99 seconds
[0m02:02:19.230962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ba913b2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ba7ff832f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ba7c15dc10>]}
[0m02:02:19.231334 [debug] [MainThread]: Flushing usage events
[0m02:02:20.379660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:02:50.149340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7affbd9493a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7affbdaa8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7affbdaa82c0>]}


============================== 02:02:50.152991 | 2f15fc60-d5c6-4fea-90c9-ca4365ff3ab1 ==============================
[0m02:02:50.152991 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:02:50.153483 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'invocation_command': 'dbt parse', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'empty': 'None'}
[0m02:02:50.360423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f15fc60-d5c6-4fea-90c9-ca4365ff3ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7affad612e10>]}
[0m02:02:50.424544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f15fc60-d5c6-4fea-90c9-ca4365ff3ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7affbf93eea0>]}
[0m02:02:50.426376 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:02:50.513707 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:02:50.666986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m02:02:50.667764 [debug] [MainThread]: Partial parsing: added file: datacore://models/metrics.yml
[0m02:02:50.668100 [debug] [MainThread]: Partial parsing: added file: datacore://models/metadata/mf_time_spine.sql
[0m02:02:50.668622 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/schema.yml
[0m02:02:50.669131 [debug] [MainThread]: Partial parsing: updated file: datacore://models/dws/schema.yml
[0m02:02:50.669508 [debug] [MainThread]: Partial parsing: updated file: datacore://macros/metadata/README.md
[0m02:02:51.110987 [error] [MainThread]: An error occurred while checking aggregation time dimension for a semantic model - AssertionError: Aggregation time dimension for measure total_revenue is not set! This should either be set directly on the measure specification in the model, or else defaulted to the primary time dimension in the data source containing the measure.

[0m02:02:51.111502 [error] [MainThread]: The semantic model toll_revenue_semantic_model contains dimensions, but it does not define a primary entity. Either add an entity with type PRIMARY or set a value for the primary_entity key.
[0m02:02:51.111871 [error] [MainThread]: Encountered an error:
Parsing Error
  Semantic Manifest validation failed.
[0m02:02:51.112757 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 1.0157281, "process_in_blocks": "64", "process_kernel_time": 0.197801, "process_mem_max_rss": "141988", "process_out_blocks": "16", "process_user_time": 2.081906}
[0m02:02:51.113205 [debug] [MainThread]: Command `dbt parse` failed at 02:02:51.113115 after 1.02 seconds
[0m02:02:51.113590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7affbec6b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7affac1e95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7affac1b9070>]}
[0m02:02:51.113946 [debug] [MainThread]: Flushing usage events
[0m02:02:52.257624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:09.249150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce775712990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7772e58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce775712900>]}


============================== 02:03:09.252212 | cbc9216f-0f34-4240-859d-27b289918ccc ==============================
[0m02:03:09.252212 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:03:09.252714 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'invocation_command': 'dbt parse', 'version_check': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_path': '/home/chun/Develop/datacore/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'empty': 'None', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True'}
[0m02:03:09.468262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbc9216f-0f34-4240-859d-27b289918ccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce764d3b350>]}
[0m02:03:09.525225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbc9216f-0f34-4240-859d-27b289918ccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce77523d3a0>]}
[0m02:03:09.526639 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:03:09.605534 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:03:09.742424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m02:03:09.743080 [debug] [MainThread]: Partial parsing: added file: datacore://models/metrics.yml
[0m02:03:09.743418 [debug] [MainThread]: Partial parsing: added file: datacore://models/metadata/mf_time_spine.sql
[0m02:03:09.743893 [debug] [MainThread]: Partial parsing: updated file: datacore://models/dws/schema.yml
[0m02:03:09.744373 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/schema.yml
[0m02:03:09.744706 [debug] [MainThread]: Partial parsing: updated file: datacore://macros/metadata/README.md
[0m02:03:10.302898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbc9216f-0f34-4240-859d-27b289918ccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce764168ec0>]}
[0m02:03:10.306457 [info ] [MainThread]: Performance info: /home/chun/Develop/datacore/target/perf_info.json
[0m02:03:10.495695 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:03:10.500764 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:03:10.501625 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.3095334, "process_in_blocks": "16", "process_kernel_time": 0.215012, "process_mem_max_rss": "144668", "process_out_blocks": "2672", "process_user_time": 2.408144}
[0m02:03:10.502007 [debug] [MainThread]: Command `dbt parse` succeeded at 02:03:10.501925 after 1.31 seconds
[0m02:03:10.502326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7647c6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7647c5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7647c6b40>]}
[0m02:03:10.502634 [debug] [MainThread]: Flushing usage events
[0m02:03:11.654379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:15.929657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac050c84ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac0510c8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac051049340>]}


============================== 02:03:15.933662 | 91951eed-bbf0-45f9-bd7c-9f2d4d342527 ==============================
[0m02:03:15.933662 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:03:15.934132 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'invocation_command': 'dbt run --select mf_time_spine', 'cache_selected_only': 'False', 'quiet': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'empty': 'False', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'warn_error': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'log_path': '/home/chun/Develop/datacore/logs'}
[0m02:03:16.135819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91951eed-bbf0-45f9-bd7c-9f2d4d342527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac050858b90>]}
[0m02:03:16.193229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91951eed-bbf0-45f9-bd7c-9f2d4d342527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac0507c0740>]}
[0m02:03:16.194775 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:03:16.274149 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:03:16.444311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:03:16.444712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:03:16.525754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91951eed-bbf0-45f9-bd7c-9f2d4d342527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac040ce0dd0>]}
[0m02:03:16.660173 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:03:16.665449 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:03:16.681259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91951eed-bbf0-45f9-bd7c-9f2d4d342527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac04080daf0>]}
[0m02:03:16.681782 [info ] [MainThread]: Found 1 seed, 20 models, 15 data tests, 4 sources, 11 metrics, 466 macros, 1 semantic model
[0m02:03:16.682091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91951eed-bbf0-45f9-bd7c-9f2d4d342527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac0408934a0>]}
[0m02:03:16.683740 [info ] [MainThread]: 
[0m02:03:16.684050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:03:16.684331 [info ] [MainThread]: 
[0m02:03:16.684785 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:03:16.686005 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:03:16.727254 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:03:16.727637 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:03:16.727912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:16.748030 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m02:03:16.749394 [debug] [ThreadPool]: On list_datacore: Close
[0m02:03:16.750084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m02:03:16.750485 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:03:16.756782 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:03:16.757098 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:03:16.757359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:16.758439 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:03:16.759548 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:03:16.759806 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:03:16.760214 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:03:16.760552 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:03:16.760794 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:03:16.761228 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:03:16.761905 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:03:16.762162 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:03:16.762411 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:03:16.762805 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:03:16.763062 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:03:16.769608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main)
[0m02:03:16.774917 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:03:16.775210 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:03:16.775465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:16.776397 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:03:16.776648 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:03:16.776900 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:03:16.788743 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:03:16.789905 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:03:16.791319 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:03:16.791579 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:03:16.792108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ads)
[0m02:03:16.793734 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:03:16.794000 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:03:16.794240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:16.794845 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:03:16.795095 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:03:16.795353 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:03:16.801555 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m02:03:16.802920 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:03:16.803744 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:03:16.803998 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:03:16.804536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_staging)
[0m02:03:16.807441 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:03:16.808836 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:03:16.809113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:16.809859 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:03:16.810116 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:03:16.810379 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:03:16.813833 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:03:16.815069 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:03:16.815872 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:03:16.816127 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:03:16.816669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_dws)
[0m02:03:16.819441 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:03:16.819718 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:03:16.819957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:16.820526 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:03:16.820772 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:03:16.821020 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:03:16.824311 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:03:16.825475 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:03:16.826252 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:03:16.826516 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:03:16.827040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_dwd)
[0m02:03:16.829581 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:03:16.829870 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:03:16.830119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:16.830685 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:03:16.830934 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:03:16.831188 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:03:16.836243 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:03:16.837395 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:03:16.838177 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:03:16.838437 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:03:16.839073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_metadata)
[0m02:03:16.841112 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:03:16.841402 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:03:16.841646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:16.842215 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:03:16.842475 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:03:16.842730 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:03:16.846075 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:03:16.847266 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:03:16.848075 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:03:16.848336 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:03:16.848855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_ods)
[0m02:03:16.852321 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:03:16.852618 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:03:16.852866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:16.853484 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:03:16.853734 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:03:16.853989 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:03:16.857331 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:03:16.858481 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:03:16.859272 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:03:16.859531 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:03:16.861016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91951eed-bbf0-45f9-bd7c-9f2d4d342527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac04078b680>]}
[0m02:03:16.861812 [debug] [MainThread]: Using duckdb connection "master"
[0m02:03:16.862319 [debug] [MainThread]: On master: BEGIN
[0m02:03:16.862783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:03:16.863861 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:03:16.864364 [debug] [MainThread]: On master: COMMIT
[0m02:03:16.864839 [debug] [MainThread]: Using duckdb connection "master"
[0m02:03:16.865293 [debug] [MainThread]: On master: COMMIT
[0m02:03:16.866071 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:03:16.866574 [debug] [MainThread]: On master: Close
[0m02:03:16.870577 [debug] [Thread-1 (]: Began running node model.datacore.mf_time_spine
[0m02:03:16.871479 [info ] [Thread-1 (]: 1 of 1 START sql table model main_metadata.mf_time_spine ....................... [RUN]
[0m02:03:16.872198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now model.datacore.mf_time_spine)
[0m02:03:16.872815 [debug] [Thread-1 (]: Began compiling node model.datacore.mf_time_spine
[0m02:03:16.882183 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.mf_time_spine"
[0m02:03:16.882710 [debug] [Thread-1 (]: Began executing node model.datacore.mf_time_spine
[0m02:03:16.911980 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.mf_time_spine"
[0m02:03:16.912584 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m02:03:16.912913 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: BEGIN
[0m02:03:16.913214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:03:16.914038 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:03:16.914353 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m02:03:16.914675 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */

  
    
    

    create  table
      "datacore"."main_metadata"."mf_time_spine__dbt_tmp"
  
    as (
      

-- MetricFlow Time Spine Ê®°Âûã
-- ÁîüÊàê‰ªé 2020-01-01 Âà∞ 2030-12-31 ÁöÑÊØèÊó•Êó∂Èó¥Â∫èÂàó
-- Áî®‰∫é MetricFlow ËØ≠‰πâÂ±ÇÁöÑÊó∂Èó¥Áª¥Â∫¶Â°´ÂÖÖ

SELECT
  date_day::DATE AS date_day,
  DATE_TRUNC('week', date_day)::DATE AS date_week,
  DATE_TRUNC('month', date_day)::DATE AS date_month,
  DATE_TRUNC('quarter', date_day)::DATE AS date_quarter,
  DATE_TRUNC('year', date_day)::DATE AS date_year
FROM (
  SELECT 
    DATE '2020-01-01' + INTERVAL (generate_series) DAY AS date_day
  FROM generate_series(0, 4017)  -- Á∫¶ 11 Âπ¥ÁöÑÂ§©Êï∞ (2020-01-01 Âà∞ 2030-12-31)
)
    );
  
  
[0m02:03:16.917581 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:03:16.923056 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m02:03:16.923421 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */
alter table "datacore"."main_metadata"."mf_time_spine__dbt_tmp" rename to "mf_time_spine"
[0m02:03:16.924169 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:16.936011 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: COMMIT
[0m02:03:16.936377 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m02:03:16.936697 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: COMMIT
[0m02:03:16.938776 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:03:16.943653 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m02:03:16.943998 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */

      drop table if exists "datacore"."main_metadata"."mf_time_spine__dbt_backup" cascade
    
[0m02:03:16.944649 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:16.946708 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: Close
[0m02:03:16.948456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91951eed-bbf0-45f9-bd7c-9f2d4d342527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac0530314f0>]}
[0m02:03:16.948999 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_metadata.mf_time_spine .................. [[32mOK[0m in 0.08s]
[0m02:03:16.949509 [debug] [Thread-1 (]: Finished running node model.datacore.mf_time_spine
[0m02:03:16.951179 [debug] [MainThread]: Using duckdb connection "master"
[0m02:03:16.951806 [debug] [MainThread]: On master: BEGIN
[0m02:03:16.952289 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:03:16.953374 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:03:16.953860 [debug] [MainThread]: On master: COMMIT
[0m02:03:16.954349 [debug] [MainThread]: Using duckdb connection "master"
[0m02:03:16.954813 [debug] [MainThread]: On master: COMMIT
[0m02:03:16.955580 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:03:16.956070 [debug] [MainThread]: On master: Close
[0m02:03:16.956766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:16.957217 [debug] [MainThread]: Connection 'model.datacore.mf_time_spine' was properly closed.
[0m02:03:16.957729 [info ] [MainThread]: 
[0m02:03:16.958263 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m02:03:16.959405 [debug] [MainThread]: Command end result
[0m02:03:17.072526 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:03:17.077625 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:03:17.082632 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:03:17.082948 [info ] [MainThread]: 
[0m02:03:17.083336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:03:17.083598 [info ] [MainThread]: 
[0m02:03:17.083887 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:03:17.084709 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2074915, "process_in_blocks": "904", "process_kernel_time": 0.242874, "process_mem_max_rss": "153216", "process_out_blocks": "3168", "process_user_time": 2.25883}
[0m02:03:17.085094 [debug] [MainThread]: Command `dbt run` succeeded at 02:03:17.085017 after 1.21 seconds
[0m02:03:17.085419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac054db33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac050dee990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac0516211f0>]}
[0m02:03:17.085737 [debug] [MainThread]: Flushing usage events
[0m02:03:18.252945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:21.004927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f1b38db950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f1b4511700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f1b38db6b0>]}


============================== 02:03:21.008424 | e8e60767-fa24-43c6-9745-2f5fa72b40d0 ==============================
[0m02:03:21.008424 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:03:21.008852 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt ', 'target_path': 'None', 'quiet': 'True', 'use_colors': 'True', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'debug': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'partial_parse': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False'}
[0m02:03:21.015988 [info ] [MainThread]: dbt version: 1.10.13
[0m02:03:21.016294 [info ] [MainThread]: python version: 3.12.3
[0m02:03:21.016538 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m02:03:21.016768 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m02:03:21.116477 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m02:03:21.116848 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m02:03:21.117085 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m02:03:21.118137 [info ] [MainThread]: adapter type: duckdb
[0m02:03:21.118386 [info ] [MainThread]: adapter version: 1.10.0
[0m02:03:21.213805 [info ] [MainThread]: Configuration:
[0m02:03:21.214200 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:03:21.214449 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:03:21.214680 [info ] [MainThread]: Required dependencies:
[0m02:03:21.214929 [debug] [MainThread]: Executing "git --help"
[0m02:03:21.218208 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:03:21.218916 [debug] [MainThread]: STDERR: "b''"
[0m02:03:21.219279 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:03:21.219609 [info ] [MainThread]: Connection:
[0m02:03:21.219874 [info ] [MainThread]:   database: datacore
[0m02:03:21.220096 [info ] [MainThread]:   schema: main
[0m02:03:21.220322 [info ] [MainThread]:   path: datacore.duckdb
[0m02:03:21.220541 [info ] [MainThread]:   config_options: None
[0m02:03:21.220757 [info ] [MainThread]:   extensions: None
[0m02:03:21.220978 [info ] [MainThread]:   settings: {}
[0m02:03:21.221197 [info ] [MainThread]:   external_root: .
[0m02:03:21.221422 [info ] [MainThread]:   use_credential_provider: None
[0m02:03:21.221640 [info ] [MainThread]:   attach: None
[0m02:03:21.221854 [info ] [MainThread]:   filesystems: None
[0m02:03:21.222067 [info ] [MainThread]:   remote: None
[0m02:03:21.222281 [info ] [MainThread]:   plugins: None
[0m02:03:21.222509 [info ] [MainThread]:   disable_transactions: False
[0m02:03:21.222885 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:03:21.319878 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m02:03:21.341280 [debug] [MainThread]: Using duckdb connection "debug"
[0m02:03:21.341691 [debug] [MainThread]: On debug: select 1 as id
[0m02:03:21.341948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:03:21.360678 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m02:03:21.361742 [debug] [MainThread]: On debug: Close
[0m02:03:21.362115 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:03:21.362376 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:03:21.363240 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.40895483, "process_in_blocks": "0", "process_kernel_time": 0.223754, "process_mem_max_rss": "151692", "process_out_blocks": "16", "process_user_time": 1.7341}
[0m02:03:21.363657 [debug] [MainThread]: Command `cli debug` succeeded at 02:03:21.363574 after 0.41 seconds
[0m02:03:21.363934 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:03:21.364223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f1b38db6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f1b2ddc8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f1a3039bb0>]}
[0m02:03:21.364583 [debug] [MainThread]: Flushing usage events
[0m02:03:22.525255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:24.132534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90a355ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90a43f4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90a3f0e1e0>]}


============================== 02:03:24.136075 | 19b0c987-ec1b-4eea-8817-35d4b6be8449 ==============================
[0m02:03:24.136075 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:03:24.136500 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt list metrics', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'profiles_dir': '/home/chun/Develop/datacore', 'quiet': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m02:03:24.144612 [info ] [MainThread]: dbt version: 1.10.13
[0m02:03:24.144929 [info ] [MainThread]: python version: 3.12.3
[0m02:03:24.145164 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m02:03:24.145402 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m02:03:24.243065 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m02:03:24.243437 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m02:03:24.243674 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m02:03:24.244713 [info ] [MainThread]: adapter type: duckdb
[0m02:03:24.244949 [info ] [MainThread]: adapter version: 1.10.0
[0m02:03:24.340247 [info ] [MainThread]: Configuration:
[0m02:03:24.340629 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:03:24.340866 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:03:24.341092 [info ] [MainThread]: Required dependencies:
[0m02:03:24.341345 [debug] [MainThread]: Executing "git --help"
[0m02:03:24.344358 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:03:24.345067 [debug] [MainThread]: STDERR: "b''"
[0m02:03:24.345525 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:03:24.345937 [info ] [MainThread]: Connection:
[0m02:03:24.346364 [info ] [MainThread]:   database: datacore
[0m02:03:24.346658 [info ] [MainThread]:   schema: main
[0m02:03:24.346937 [info ] [MainThread]:   path: datacore.duckdb
[0m02:03:24.347170 [info ] [MainThread]:   config_options: None
[0m02:03:24.347397 [info ] [MainThread]:   extensions: None
[0m02:03:24.347616 [info ] [MainThread]:   settings: {}
[0m02:03:24.347838 [info ] [MainThread]:   external_root: .
[0m02:03:24.348055 [info ] [MainThread]:   use_credential_provider: None
[0m02:03:24.348274 [info ] [MainThread]:   attach: None
[0m02:03:24.348498 [info ] [MainThread]:   filesystems: None
[0m02:03:24.348714 [info ] [MainThread]:   remote: None
[0m02:03:24.348928 [info ] [MainThread]:   plugins: None
[0m02:03:24.349146 [info ] [MainThread]:   disable_transactions: False
[0m02:03:24.349523 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:03:24.449571 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m02:03:24.470842 [debug] [MainThread]: Using duckdb connection "debug"
[0m02:03:24.471240 [debug] [MainThread]: On debug: select 1 as id
[0m02:03:24.471512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:03:24.477132 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m02:03:24.477490 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m02:03:24.477831 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m02:03:24.478078 [info ] [MainThread]: [31m1 check failed:[0m
[0m02:03:24.478329 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 737242) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m02:03:24.479107 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.39768413, "process_in_blocks": "0", "process_kernel_time": 0.202795, "process_mem_max_rss": "149652", "process_out_blocks": "24", "process_user_time": 1.685304}
[0m02:03:24.479523 [debug] [MainThread]: Command `cli debug` failed at 02:03:24.479441 after 0.40 seconds
[0m02:03:24.479805 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:03:24.480088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90a3455430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90a20497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90a1f49bb0>]}
[0m02:03:24.480441 [debug] [MainThread]: Flushing usage events
[0m02:03:25.591869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:27.761219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fe0424be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fe037a9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fe02a28f80>]}


============================== 02:03:27.765534 | 4df83d83-fd64-42cd-936f-3bf2018a76a7 ==============================
[0m02:03:27.765534 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:03:27.766022 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/chun/Develop/datacore', 'version_check': 'True', 'quiet': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'static_parser': 'True', 'empty': 'None', 'invocation_command': 'dbt query --metrics daily_revenue --group-by transaction_date,city --start-time 2025-01-01 --end-time 2025-01-07 --explain', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'write_json': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'target_path': 'None'}
[0m02:03:27.775261 [info ] [MainThread]: dbt version: 1.10.13
[0m02:03:27.775658 [info ] [MainThread]: python version: 3.12.3
[0m02:03:27.775919 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m02:03:27.776177 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m02:03:27.880080 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m02:03:27.880525 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m02:03:27.880787 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m02:03:27.882014 [info ] [MainThread]: adapter type: duckdb
[0m02:03:27.882274 [info ] [MainThread]: adapter version: 1.10.0
[0m02:03:27.988338 [info ] [MainThread]: Configuration:
[0m02:03:27.988789 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:03:27.989062 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:03:27.989320 [info ] [MainThread]: Required dependencies:
[0m02:03:27.989601 [debug] [MainThread]: Executing "git --help"
[0m02:03:27.992657 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:03:27.993329 [debug] [MainThread]: STDERR: "b''"
[0m02:03:27.993720 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:03:27.994089 [info ] [MainThread]: Connection:
[0m02:03:27.994468 [info ] [MainThread]:   database: datacore
[0m02:03:27.994741 [info ] [MainThread]:   schema: main
[0m02:03:27.994975 [info ] [MainThread]:   path: datacore.duckdb
[0m02:03:27.995203 [info ] [MainThread]:   config_options: None
[0m02:03:27.995446 [info ] [MainThread]:   extensions: None
[0m02:03:27.995672 [info ] [MainThread]:   settings: {}
[0m02:03:27.995900 [info ] [MainThread]:   external_root: .
[0m02:03:27.996122 [info ] [MainThread]:   use_credential_provider: None
[0m02:03:27.996355 [info ] [MainThread]:   attach: None
[0m02:03:27.996577 [info ] [MainThread]:   filesystems: None
[0m02:03:27.996799 [info ] [MainThread]:   remote: None
[0m02:03:27.997023 [info ] [MainThread]:   plugins: None
[0m02:03:27.997245 [info ] [MainThread]:   disable_transactions: False
[0m02:03:27.997610 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:03:28.097048 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m02:03:28.118061 [debug] [MainThread]: Using duckdb connection "debug"
[0m02:03:28.118431 [debug] [MainThread]: On debug: select 1 as id
[0m02:03:28.118702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:03:28.124095 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m02:03:28.124433 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m02:03:28.124761 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m02:03:28.125012 [info ] [MainThread]: [31m1 check failed:[0m
[0m02:03:28.125259 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 737242) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m02:03:28.126024 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.420388, "process_in_blocks": "0", "process_kernel_time": 0.200973, "process_mem_max_rss": "149368", "process_out_blocks": "24", "process_user_time": 1.76077}
[0m02:03:28.126433 [debug] [MainThread]: Command `cli debug` failed at 02:03:28.126352 after 0.42 seconds
[0m02:03:28.126709 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:03:28.126989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fe037037d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fdf2aaabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fdf2ab89e0>]}
[0m02:03:28.127322 [debug] [MainThread]: Flushing usage events
[0m02:03:29.323677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:11.804071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72da3b1c4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72da3b255970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72da3ae1d640>]}


============================== 02:04:11.807469 | 93ad43d9-7872-4942-b0d9-47f500e6f75c ==============================
[0m02:04:11.807469 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:04:11.807898 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/chun/Develop/datacore/logs', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'profiles_dir': '/home/chun/Develop/datacore', 'version_check': 'True', 'invocation_command': 'dbt ', 'write_json': 'True', 'fail_fast': 'False', 'target_path': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'introspect': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False'}
[0m02:04:11.815013 [info ] [MainThread]: dbt version: 1.10.13
[0m02:04:11.815312 [info ] [MainThread]: python version: 3.12.3
[0m02:04:11.815562 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m02:04:11.815791 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m02:04:11.914851 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m02:04:11.915220 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m02:04:11.915467 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m02:04:11.916525 [info ] [MainThread]: adapter type: duckdb
[0m02:04:11.916765 [info ] [MainThread]: adapter version: 1.10.0
[0m02:04:12.018967 [info ] [MainThread]: Configuration:
[0m02:04:12.019385 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:04:12.019651 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:04:12.019906 [info ] [MainThread]: Required dependencies:
[0m02:04:12.020186 [debug] [MainThread]: Executing "git --help"
[0m02:04:12.023503 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:04:12.023985 [debug] [MainThread]: STDERR: "b''"
[0m02:04:12.024367 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:04:12.024723 [info ] [MainThread]: Connection:
[0m02:04:12.025041 [info ] [MainThread]:   database: datacore
[0m02:04:12.025286 [info ] [MainThread]:   schema: main
[0m02:04:12.025538 [info ] [MainThread]:   path: datacore.duckdb
[0m02:04:12.025782 [info ] [MainThread]:   config_options: None
[0m02:04:12.026023 [info ] [MainThread]:   extensions: None
[0m02:04:12.026267 [info ] [MainThread]:   settings: {}
[0m02:04:12.026524 [info ] [MainThread]:   external_root: .
[0m02:04:12.026780 [info ] [MainThread]:   use_credential_provider: None
[0m02:04:12.027039 [info ] [MainThread]:   attach: None
[0m02:04:12.027279 [info ] [MainThread]:   filesystems: None
[0m02:04:12.027527 [info ] [MainThread]:   remote: None
[0m02:04:12.027766 [info ] [MainThread]:   plugins: None
[0m02:04:12.028011 [info ] [MainThread]:   disable_transactions: False
[0m02:04:12.028399 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:04:12.125590 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m02:04:12.147811 [debug] [MainThread]: Using duckdb connection "debug"
[0m02:04:12.148204 [debug] [MainThread]: On debug: select 1 as id
[0m02:04:12.148495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:12.167410 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m02:04:12.168461 [debug] [MainThread]: On debug: Close
[0m02:04:12.168848 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:04:12.169119 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:04:12.169967 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.416641, "process_in_blocks": "0", "process_kernel_time": 0.236225, "process_mem_max_rss": "152340", "process_out_blocks": "24", "process_user_time": 1.809065}
[0m02:04:12.170382 [debug] [MainThread]: Command `cli debug` succeeded at 02:04:12.170290 after 0.42 seconds
[0m02:04:12.170669 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:04:12.170971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72da3ac89460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72da396a3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72da29a493d0>]}
[0m02:04:12.171327 [debug] [MainThread]: Flushing usage events
[0m02:04:13.284631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:14.871138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7303ca187da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7303c9b87410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7303c89961e0>]}


============================== 02:04:14.875553 | 7172038e-36ee-4c2f-a41b-85f9b0fdf60d ==============================
[0m02:04:14.875553 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:04:14.875984 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'profiles_dir': '/home/chun/Develop/datacore', 'no_print': 'None', 'target_path': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt query --metrics daily_revenue --group-by transaction_date,city --start-time 2025-01-01 --end-time 2025-01-07 --explain', 'introspect': 'True', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'empty': 'None', 'quiet': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m02:04:14.884161 [info ] [MainThread]: dbt version: 1.10.13
[0m02:04:14.884497 [info ] [MainThread]: python version: 3.12.3
[0m02:04:14.884734 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m02:04:14.884967 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m02:04:14.983022 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m02:04:14.983390 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m02:04:14.983628 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m02:04:14.984674 [info ] [MainThread]: adapter type: duckdb
[0m02:04:14.984914 [info ] [MainThread]: adapter version: 1.10.0
[0m02:04:15.079390 [info ] [MainThread]: Configuration:
[0m02:04:15.079766 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:04:15.080005 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:04:15.080233 [info ] [MainThread]: Required dependencies:
[0m02:04:15.080485 [debug] [MainThread]: Executing "git --help"
[0m02:04:15.083648 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:04:15.084405 [debug] [MainThread]: STDERR: "b''"
[0m02:04:15.084772 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:04:15.085109 [info ] [MainThread]: Connection:
[0m02:04:15.085450 [info ] [MainThread]:   database: datacore
[0m02:04:15.085695 [info ] [MainThread]:   schema: main
[0m02:04:15.085916 [info ] [MainThread]:   path: datacore.duckdb
[0m02:04:15.086136 [info ] [MainThread]:   config_options: None
[0m02:04:15.086363 [info ] [MainThread]:   extensions: None
[0m02:04:15.086582 [info ] [MainThread]:   settings: {}
[0m02:04:15.086800 [info ] [MainThread]:   external_root: .
[0m02:04:15.087015 [info ] [MainThread]:   use_credential_provider: None
[0m02:04:15.087232 [info ] [MainThread]:   attach: None
[0m02:04:15.087456 [info ] [MainThread]:   filesystems: None
[0m02:04:15.087670 [info ] [MainThread]:   remote: None
[0m02:04:15.087886 [info ] [MainThread]:   plugins: None
[0m02:04:15.088104 [info ] [MainThread]:   disable_transactions: False
[0m02:04:15.088484 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:04:15.188283 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m02:04:15.209638 [debug] [MainThread]: Using duckdb connection "debug"
[0m02:04:15.210030 [debug] [MainThread]: On debug: select 1 as id
[0m02:04:15.210292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:15.215986 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m02:04:15.216340 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m02:04:15.216679 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m02:04:15.216925 [info ] [MainThread]: [31m1 check failed:[0m
[0m02:04:15.217169 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 737623) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m02:04:15.217936 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.39752945, "process_in_blocks": "0", "process_kernel_time": 0.217503, "process_mem_max_rss": "149636", "process_out_blocks": "24", "process_user_time": 1.649231}
[0m02:04:15.218348 [debug] [MainThread]: Command `cli debug` failed at 02:04:15.218256 after 0.40 seconds
[0m02:04:15.218638 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:04:15.218921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7303c9a62630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7303cabd3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7303b88c41a0>]}
[0m02:04:15.219268 [debug] [MainThread]: Flushing usage events
[0m02:04:16.363156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:29.019545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bae333e29c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bae34c86420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bae347ef7a0>]}


============================== 02:04:29.022372 | b38a2b2a-fc89-4c45-a38d-60e401bcc996 ==============================
[0m02:04:29.022372 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:04:29.022780 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/chun/Develop/datacore/logs', 'target_path': 'None', 'empty': 'None', 'log_format': 'default', 'warn_error': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt ', 'quiet': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'static_parser': 'True', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m02:04:29.029713 [info ] [MainThread]: dbt version: 1.10.13
[0m02:04:29.029999 [info ] [MainThread]: python version: 3.12.3
[0m02:04:29.030232 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m02:04:29.030467 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m02:04:29.129199 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m02:04:29.129569 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m02:04:29.129809 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m02:04:29.130848 [info ] [MainThread]: adapter type: duckdb
[0m02:04:29.131086 [info ] [MainThread]: adapter version: 1.10.0
[0m02:04:29.225963 [info ] [MainThread]: Configuration:
[0m02:04:29.226360 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:04:29.226600 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:04:29.226830 [info ] [MainThread]: Required dependencies:
[0m02:04:29.227077 [debug] [MainThread]: Executing "git --help"
[0m02:04:29.230175 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:04:29.230805 [debug] [MainThread]: STDERR: "b''"
[0m02:04:29.231174 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:04:29.231526 [info ] [MainThread]: Connection:
[0m02:04:29.231870 [info ] [MainThread]:   database: datacore
[0m02:04:29.232174 [info ] [MainThread]:   schema: main
[0m02:04:29.232433 [info ] [MainThread]:   path: datacore.duckdb
[0m02:04:29.232652 [info ] [MainThread]:   config_options: None
[0m02:04:29.232869 [info ] [MainThread]:   extensions: None
[0m02:04:29.233089 [info ] [MainThread]:   settings: {}
[0m02:04:29.233316 [info ] [MainThread]:   external_root: .
[0m02:04:29.233533 [info ] [MainThread]:   use_credential_provider: None
[0m02:04:29.233753 [info ] [MainThread]:   attach: None
[0m02:04:29.233968 [info ] [MainThread]:   filesystems: None
[0m02:04:29.234184 [info ] [MainThread]:   remote: None
[0m02:04:29.234407 [info ] [MainThread]:   plugins: None
[0m02:04:29.234627 [info ] [MainThread]:   disable_transactions: False
[0m02:04:29.235001 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:04:29.334016 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m02:04:29.355616 [debug] [MainThread]: Using duckdb connection "debug"
[0m02:04:29.356016 [debug] [MainThread]: On debug: select 1 as id
[0m02:04:29.356272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:29.374880 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m02:04:29.375918 [debug] [MainThread]: On debug: Close
[0m02:04:29.376277 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:04:29.376550 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:04:29.377417 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.40811926, "process_in_blocks": "0", "process_kernel_time": 0.235446, "process_mem_max_rss": "151864", "process_out_blocks": "16", "process_user_time": 1.717961}
[0m02:04:29.377920 [debug] [MainThread]: Command `cli debug` succeeded at 02:04:29.377816 after 0.41 seconds
[0m02:04:29.378272 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:04:29.378656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bae33142f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bae235ad880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bae23450650>]}
[0m02:04:29.379089 [debug] [MainThread]: Flushing usage events
[0m02:04:30.609471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:18:56.695590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ab0075bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8a5138cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8a526b3f20>]}


============================== 03:18:56.698734 | c70e0ad4-a550-4fa5-a02c-38a253372726 ==============================
[0m03:18:56.698734 [info ] [MainThread]: Running with dbt=1.10.13
[0m03:18:56.699158 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'invocation_command': 'dbt main:app --host 0.0.0.0 --port 8090 --reload', 'log_format': 'default', 'quiet': 'True', 'profiles_dir': '/home/chun/Develop/datacore'}
[0m03:18:56.706565 [info ] [MainThread]: dbt version: 1.10.13
[0m03:18:56.706891 [info ] [MainThread]: python version: 3.12.3
[0m03:18:56.707138 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m03:18:56.707383 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m03:18:56.776415 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m03:18:56.776790 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m03:18:56.777039 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m03:18:56.778181 [info ] [MainThread]: adapter type: duckdb
[0m03:18:56.778443 [info ] [MainThread]: adapter version: 1.10.0
[0m03:18:56.875093 [info ] [MainThread]: Configuration:
[0m03:18:56.875498 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:18:56.875754 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:18:56.875990 [info ] [MainThread]: Required dependencies:
[0m03:18:56.876253 [debug] [MainThread]: Executing "git --help"
[0m03:18:56.879271 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:18:56.879741 [debug] [MainThread]: STDERR: "b''"
[0m03:18:56.880091 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:18:56.880408 [info ] [MainThread]: Connection:
[0m03:18:56.880649 [info ] [MainThread]:   database: datacore
[0m03:18:56.880876 [info ] [MainThread]:   schema: main
[0m03:18:56.881100 [info ] [MainThread]:   path: datacore.duckdb
[0m03:18:56.881334 [info ] [MainThread]:   config_options: None
[0m03:18:56.881558 [info ] [MainThread]:   extensions: None
[0m03:18:56.881782 [info ] [MainThread]:   settings: {}
[0m03:18:56.882007 [info ] [MainThread]:   external_root: .
[0m03:18:56.882334 [info ] [MainThread]:   use_credential_provider: None
[0m03:18:56.882560 [info ] [MainThread]:   attach: None
[0m03:18:56.882784 [info ] [MainThread]:   filesystems: None
[0m03:18:56.883010 [info ] [MainThread]:   remote: None
[0m03:18:56.883233 [info ] [MainThread]:   plugins: None
[0m03:18:56.883462 [info ] [MainThread]:   disable_transactions: False
[0m03:18:56.883821 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:18:57.003701 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:18:57.026643 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:18:57.027026 [debug] [MainThread]: On debug: select 1 as id
[0m03:18:57.027295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:18:57.040982 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m03:18:57.041967 [debug] [MainThread]: On debug: Close
[0m03:18:57.042346 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:18:57.042598 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:18:57.043602 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41433194, "process_in_blocks": "1288", "process_kernel_time": 0.302734, "process_mem_max_rss": "172652", "process_out_blocks": "96", "process_user_time": 2.228769}
[0m03:18:57.043992 [debug] [MainThread]: Command `cli debug` succeeded at 03:18:57.043906 after 0.41 seconds
[0m03:18:57.044269 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:18:57.044560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8a51438e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8a4b139520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ab2fe2ba0>]}
[0m03:18:57.044905 [debug] [MainThread]: Flushing usage events
[0m03:18:58.851428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:32:52.485216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cd94e41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cd94e4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cd94e54c0>]}


============================== 03:32:52.489042 | f30db40a-c99c-4b5c-a4e6-e4e3640cac94 ==============================
[0m03:32:52.489042 [info ] [MainThread]: Running with dbt=1.10.13
[0m03:32:52.489551 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt run', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'version_check': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'use_colors': 'True'}
[0m03:32:52.695878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cd915ef00>]}
[0m03:32:52.753822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cd9412cf0>]}
[0m03:32:52.755401 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:32:52.836454 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m03:32:53.009380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:32:53.009785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:32:53.091452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cc95a9e20>]}
[0m03:32:53.244497 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:32:53.250220 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:32:53.266560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cc900bb90>]}
[0m03:32:53.267139 [info ] [MainThread]: Found 1 seed, 20 models, 15 data tests, 4 sources, 11 metrics, 466 macros, 1 semantic model
[0m03:32:53.267483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cc9087260>]}
[0m03:32:53.270243 [info ] [MainThread]: 
[0m03:32:53.270597 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:32:53.270885 [info ] [MainThread]: 
[0m03:32:53.271399 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:32:53.278122 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m03:32:53.311468 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:32:53.311853 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:32:53.312116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:32:53.332332 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m03:32:53.333676 [debug] [ThreadPool]: On list_datacore: Close
[0m03:32:53.335699 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:32:53.336065 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:32:53.336339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.337387 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.338394 [debug] [ThreadPool]: On list_datacore: Close
[0m03:32:53.340098 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:32:53.340444 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:32:53.340703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.341677 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.342662 [debug] [ThreadPool]: On list_datacore: Close
[0m03:32:53.344365 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:32:53.344684 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:32:53.344933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.345849 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.346815 [debug] [ThreadPool]: On list_datacore: Close
[0m03:32:53.349644 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:32:53.350021 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:32:53.350281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.351664 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.352698 [debug] [ThreadPool]: On list_datacore: Close
[0m03:32:53.354413 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:32:53.354735 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:32:53.354995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.355966 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.356964 [debug] [ThreadPool]: On list_datacore: Close
[0m03:32:53.357673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_dwd)
[0m03:32:53.358063 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dwd"
"
[0m03:32:53.364068 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m03:32:53.364383 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:32:53.364642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.365916 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.367015 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m03:32:53.367279 [debug] [ThreadPool]: On create_datacore_main_dwd: BEGIN
[0m03:32:53.367710 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.367959 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m03:32:53.368206 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
    
        create schema if not exists "datacore"."main_dwd"
    
[0m03:32:53.368659 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.369353 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m03:32:53.369613 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m03:32:53.369855 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m03:32:53.370244 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.370507 [debug] [ThreadPool]: On create_datacore_main_dwd: Close
[0m03:32:53.371036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dwd, now create_datacore_main_dws)
[0m03:32:53.371431 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dws"
"
[0m03:32:53.372971 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m03:32:53.373234 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:32:53.373488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.374691 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.375748 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m03:32:53.376007 [debug] [ThreadPool]: On create_datacore_main_dws: BEGIN
[0m03:32:53.376475 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.376717 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m03:32:53.376959 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
    
        create schema if not exists "datacore"."main_dws"
    
[0m03:32:53.377398 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.378069 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m03:32:53.378332 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m03:32:53.378575 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m03:32:53.379002 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.379257 [debug] [ThreadPool]: On create_datacore_main_dws: Close
[0m03:32:53.379771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dws, now create_datacore_main_staging)
[0m03:32:53.380158 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m03:32:53.381659 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m03:32:53.381940 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:32:53.382189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.383083 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.384130 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m03:32:53.384395 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m03:32:53.384794 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.385037 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m03:32:53.385281 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m03:32:53.385720 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.386395 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m03:32:53.386652 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m03:32:53.386898 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m03:32:53.387340 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.387599 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m03:32:53.388164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now create_datacore_main_ods)
[0m03:32:53.388568 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ods"
"
[0m03:32:53.390179 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m03:32:53.390480 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:32:53.390731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.391855 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.393078 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m03:32:53.393380 [debug] [ThreadPool]: On create_datacore_main_ods: BEGIN
[0m03:32:53.393899 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.394153 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m03:32:53.394407 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
    
        create schema if not exists "datacore"."main_ods"
    
[0m03:32:53.394897 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.395639 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m03:32:53.395910 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m03:32:53.396158 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m03:32:53.396708 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.396976 [debug] [ThreadPool]: On create_datacore_main_ods: Close
[0m03:32:53.397574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ods, now create_datacore_main_ads)
[0m03:32:53.397977 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ads"
"
[0m03:32:53.399788 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m03:32:53.400127 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:32:53.400403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.401724 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.403132 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m03:32:53.403483 [debug] [ThreadPool]: On create_datacore_main_ads: BEGIN
[0m03:32:53.404074 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.404369 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m03:32:53.404648 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
    
        create schema if not exists "datacore"."main_ads"
    
[0m03:32:53.405217 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.406150 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m03:32:53.406579 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m03:32:53.406868 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m03:32:53.407474 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.407777 [debug] [ThreadPool]: On create_datacore_main_ads: Close
[0m03:32:53.408443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ads, now create_datacore_main_metadata)
[0m03:32:53.408898 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m03:32:53.410878 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:32:53.411222 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:32:53.411518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.412764 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.414104 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:32:53.414422 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m03:32:53.414957 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.415233 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:32:53.415518 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m03:32:53.416079 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.416915 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:32:53.417216 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:32:53.417502 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:32:53.418080 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:32:53.418400 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m03:32:53.422404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main)
[0m03:32:53.432558 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:32:53.433165 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m03:32:53.433692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.435147 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.435712 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:32:53.436240 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m03:32:53.461526 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m03:32:53.463762 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m03:32:53.465585 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m03:32:53.466078 [debug] [ThreadPool]: On list_datacore_main: Close
[0m03:32:53.467178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_dwd)
[0m03:32:53.470019 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:32:53.470535 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m03:32:53.471000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.471909 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.472282 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:32:53.472675 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m03:32:53.477072 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:32:53.478353 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m03:32:53.479214 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m03:32:53.479496 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m03:32:53.480068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_dws)
[0m03:32:53.483924 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:32:53.484243 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m03:32:53.484521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.485167 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.485444 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:32:53.485717 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m03:32:53.490830 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:32:53.492123 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m03:32:53.492960 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m03:32:53.493231 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m03:32:53.493819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_staging)
[0m03:32:53.553477 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:32:53.553884 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m03:32:53.554134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.554841 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.555094 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:32:53.555357 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m03:32:53.560665 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:32:53.561873 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m03:32:53.562666 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m03:32:53.562917 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m03:32:53.563484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_ods)
[0m03:32:53.566461 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:32:53.566741 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m03:32:53.566982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.567620 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.567868 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:32:53.568118 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m03:32:53.572414 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:32:53.573681 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m03:32:53.574515 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m03:32:53.574789 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m03:32:53.575793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_ads)
[0m03:32:53.578316 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:32:53.578616 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m03:32:53.578877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.579681 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.579948 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:32:53.580221 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m03:32:53.584341 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:32:53.585579 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m03:32:53.586431 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m03:32:53.586705 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m03:32:53.587298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_metadata)
[0m03:32:53.590024 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:32:53.590328 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m03:32:53.590590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:53.591177 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:32:53.591449 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:32:53.591724 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m03:32:53.596942 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:32:53.598243 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m03:32:53.599093 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m03:32:53.599375 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m03:32:53.601879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cc804b140>]}
[0m03:32:53.602739 [debug] [MainThread]: Using duckdb connection "master"
[0m03:32:53.603247 [debug] [MainThread]: On master: BEGIN
[0m03:32:53.603750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:32:53.604780 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:32:53.605322 [debug] [MainThread]: On master: COMMIT
[0m03:32:53.605845 [debug] [MainThread]: Using duckdb connection "master"
[0m03:32:53.606370 [debug] [MainThread]: On master: COMMIT
[0m03:32:53.607192 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:32:53.607745 [debug] [MainThread]: On master: Close
[0m03:32:53.611705 [debug] [Thread-1 (]: Began running node model.datacore.meta_column_info
[0m03:32:53.612274 [info ] [Thread-1 (]: 1 of 20 START sql table model main_metadata.meta_column_info ................... [RUN]
[0m03:32:53.612725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now model.datacore.meta_column_info)
[0m03:32:53.613067 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_column_info
[0m03:32:53.634997 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_column_info"
[0m03:32:53.635681 [debug] [Thread-1 (]: Began executing node model.datacore.meta_column_info
[0m03:32:53.668175 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_column_info"
[0m03:32:53.668915 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:32:53.669264 [debug] [Thread-1 (]: On model.datacore.meta_column_info: BEGIN
[0m03:32:53.669600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:53.670461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.670785 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:32:53.671807 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_column_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÂ≠óÊÆµ‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®Â≠óÊÆµÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- Â≠óÊÆµ‰∏≠ÊñáÂêç‰ªé schema.yml ÁöÑ columns meta Â≠óÊÆµËé∑Âèñ



SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'schema_name' AS column_name, 'Ê®°ÂºèÂêçÁß∞' AS column_name_cn, 'Ê®°ÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'asset_level' AS column_name, 'ËµÑ‰∫ßÁ≠âÁ∫ßÔºöÊ†∏ÂøÉËµÑ‰∫ß/Â∫îÁî®ËµÑ‰∫ß/Âü∫Á°ÄËµÑ‰∫ß' AS column_name_cn, 'ËµÑ‰∫ßÁ≠âÁ∫ßÔºöÊ†∏ÂøÉËµÑ‰∫ß/Â∫îÁî®ËµÑ‰∫ß/Âü∫Á°ÄËµÑ‰∫ß' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'usage_frequency' AS column_name, '‰ΩøÁî®È¢ëÁéáÔºöÈ´òÈ¢ë/‰∏≠È¢ë/‰ΩéÈ¢ë' AS column_name_cn, '‰ΩøÁî®È¢ëÁéáÔºöÈ´òÈ¢ë/‰∏≠È¢ë/‰ΩéÈ¢ë' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'data_freshness' AS column_name, 'Êï∞ÊçÆÊñ∞È≤úÂ∫¶ÔºöÊñ∞È≤ú/ËæÉÊñ∞/ÈôàÊóß' AS column_name_cn, 'Êï∞ÊçÆÊñ∞È≤úÂ∫¶ÔºöÊñ∞È≤ú/ËæÉÊñ∞/ÈôàÊóß' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'metric_date' AS column_name, 'ÊåáÊ†áÊó•Êúü' AS column_name_cn, 'ÊåáÊ†áÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'overall_quality_score' AS column_name, 'ÁªºÂêàË¥®ÈáèÂæóÂàÜ' AS column_name_cn, 'ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'completeness_rate' AS column_name, 'ÂÆåÊï¥ÊÄßÁéá' AS column_name_cn, 'ÂÆåÊï¥ÊÄßÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'accuracy_rate' AS column_name, 'ÂáÜÁ°ÆÁéá' AS column_name_cn, 'ÂáÜÁ°ÆÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'consistency_rate' AS column_name, '‰∏ÄËá¥Áéá' AS column_name_cn, '‰∏ÄËá¥Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_type' AS column_name, 'Â≠óÂÖ∏Á±ªÂûã' AS column_name_cn, 'Â≠óÂÖ∏Á±ªÂûã' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_code' AS column_name, 'Â≠óÂÖ∏ÁºñÁ†Å' AS column_name_cn, 'Â≠óÂÖ∏ÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_name' AS column_name, 'Â≠óÂÖ∏ÂêçÁß∞' AS column_name_cn, 'Â≠óÂÖ∏ÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_desc' AS column_name, 'Â≠óÂÖ∏ÊèèËø∞' AS column_name_cn, 'Â≠óÂÖ∏ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_value' AS column_name, 'Â≠óÂÖ∏ÂÄº' AS column_name_cn, 'Â≠óÂÖ∏ÂÄº' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_source' AS column_name, 'Â≠óÂÖ∏Êù•Ê∫ê' AS column_name_cn, 'Â≠óÂÖ∏Êù•Ê∫ê' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôIDÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'station_name' AS column_name, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_name_cn, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'city' AS column_name, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_name_cn, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'highway_code' AS column_name, 'È´òÈÄüÂÖ¨Ë∑ØÁºñÁ†Å' AS column_name_cn, 'È´òÈÄüÂÖ¨Ë∑ØÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'transaction_id' AS column_name, '‰∫§ÊòìID' AS column_name_cn, '‰∫§ÊòìIDÔºåÂîØ‰∏ÄÊ†áËØÜ‰∏ÄÁ¨î‰∫§Êòì' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'vehicle_plate' AS column_name, 'ËΩ¶ÁâåÂè∑' AS column_name_cn, 'ËΩ¶ÁâåÂè∑ÔºàÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'vehicle_type_code' AS column_name, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_name_cn, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'entry_time' AS column_name, 'ÂÖ•Âè£Êó∂Èó¥' AS column_name_cn, 'ÂÖ•Âè£Êó∂Èó¥' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'exit_time' AS column_name, 'Âá∫Âè£Êó∂Èó¥' AS column_name_cn, 'Âá∫Âè£Êó∂Èó¥ÔºàÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'travel_minutes' AS column_name, 'ÈÄöË°åÊó∂Èïø' AS column_name_cn, 'ÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'toll_amount' AS column_name, 'Â∫îÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Â∫îÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'actual_amount' AS column_name, 'ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'ÂÆûÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºåÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'data_quality_flag' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞ÔºöÊ≠£Â∏∏/Êï∞ÊçÆÁº∫Â§±/Êî∂Ë¥πÁ´ôÁº∫Â§±/ËΩ¶ÁâåÁº∫Â§±/Êó∂Èó¥ÂºÇÂ∏∏/ÈáëÈ¢ùÂºÇÂ∏∏' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'payment_method_code' AS column_name, 'ÊîØ‰ªòÊñπÂºèÁºñÁ†Å' AS column_name_cn, 'ÊîØ‰ªòÊñπÂºèÁºñÁ†ÅÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'payment_method_name' AS column_name, 'ÊîØ‰ªòÊñπÂºèÂêçÁß∞' AS column_name_cn, 'ÊîØ‰ªòÊñπÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'vehicle_type_code' AS column_name, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_name_cn, 'ËΩ¶ÂûãÁºñÁ†ÅÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'vehicle_type_name' AS column_name, 'ËΩ¶ÂûãÂêçÁß∞' AS column_name_cn, 'ËΩ¶ÂûãÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'toll_rate_multiplier' AS column_name, 'Êî∂Ë¥πË¥πÁéáÁ≥ªÊï∞' AS column_name_cn, 'Êî∂Ë¥πË¥πÁéáÁ≥ªÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'schema_name' AS column_name, 'Ê®°ÂºèÂêçÁß∞' AS column_name_cn, 'Ê®°ÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_name_cn' AS column_name, '‰∏≠ÊñáË°®Âêç' AS column_name_cn, '‰∏≠ÊñáË°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_description' AS column_name, 'Ë°®ÊèèËø∞' AS column_name_cn, 'Ë°®ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'business_domain' AS column_name, '‰∏öÂä°Âüü' AS column_name_cn, '‰∏öÂä°Âüü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'data_source' AS column_name, 'Êï∞ÊçÆÊ∫ê' AS column_name_cn, 'Êï∞ÊçÆÊ∫ê' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'update_frequency' AS column_name, 'Êõ¥Êñ∞È¢ëÁéá' AS column_name_cn, 'Êõ¥Êñ∞È¢ëÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'owner' AS column_name, 'Ë¥üË¥£‰∫∫' AS column_name_cn, 'Ë¥üË¥£‰∫∫/ÈÉ®Èó®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'data_layer' AS column_name, 'Êï∞ÊçÆÂàÜÂ±Ç' AS column_name_cn, 'Êï∞ÊçÆÂàÜÂ±Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'total_actual_amount' AS column_name, 'Êó•ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Êó•ÂÆûÊî∂ÈáëÈ¢ùÊ±áÊÄªÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'transaction_count' AS column_name, '‰∫§ÊòìÁ¨îÊï∞' AS column_name_cn, '‰∫§ÊòìÁ¨îÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'vehicle_count' AS column_name, 'ËΩ¶ËæÜÊï∞' AS column_name_cn, 'ËΩ¶ËæÜÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'total_revenue' AS column_name, 'Êó•Êî∂ÂÖ•' AS column_name_cn, 'Êó•Êî∂ÂÖ•ÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'data_quality_rate' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'etc_rate' AS column_name, 'ETC‰ΩøÁî®Áéá' AS column_name_cn, 'ETC‰ΩøÁî®Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'total_vehicles' AS column_name, 'ÊÄªËΩ¶ÊµÅÈáè' AS column_name_cn, 'ÊÄªËΩ¶ÊµÅÈáè' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'unique_vehicles' AS column_name, 'ÂîØ‰∏ÄËΩ¶ËæÜÊï∞' AS column_name_cn, 'ÂîØ‰∏ÄËΩ¶ËæÜÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'time_period' AS column_name, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_name_cn, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'daily_vehicles' AS column_name, 'Êó•ËΩ¶ÊµÅÈáè' AS column_name_cn, 'Êó•ËΩ¶ÊµÅÈáè' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'etc_usage_rate' AS column_name, 'ETC‰ΩøÁî®Áéá' AS column_name_cn, 'ETC‰ΩøÁî®Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'city' AS column_name, 'ÂüéÂ∏Ç' AS column_name_cn, 'ÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'daily_revenue' AS column_name, 'Êó•Êî∂ÂÖ•' AS column_name_cn, 'Êó•Êî∂ÂÖ•ÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'daily_transactions' AS column_name, 'Êó•‰∫§ÊòìÁ¨îÊï∞' AS column_name_cn, 'Êó•‰∫§ÊòìÁ¨îÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'data_quality_rate' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'alert_status' AS column_name, 'ÂëäË≠¶Áä∂ÊÄÅ' AS column_name_cn, 'ÂëäË≠¶Áä∂ÊÄÅÔºöÊ≠£Â∏∏/ÂëäË≠¶' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'transaction_id' AS column_name, '‰∫§ÊòìID' AS column_name_cn, '‰∫§ÊòìID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'station_name' AS column_name, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_name_cn, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'city' AS column_name, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_name_cn, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'vehicle_plate' AS column_name, 'ËΩ¶ÁâåÂè∑' AS column_name_cn, 'ËΩ¶ÁâåÂè∑' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'vehicle_type_name' AS column_name, 'ËΩ¶ÂûãÂêçÁß∞' AS column_name_cn, 'ËΩ¶ÂûãÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'toll_amount' AS column_name, 'Â∫îÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Â∫îÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'actual_amount' AS column_name, 'ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'ÂÆûÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'time_period' AS column_name, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_name_cn, 'Êó∂ÊÆµÂàÜÁ±ªÔºöÊó©È´òÂ≥∞/ÊôöÈ´òÂ≥∞/Âπ≥Â≥∞/Â§úÈó¥' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'day_type' AS column_name, 'Êó•ÊúüÁ±ªÂûã' AS column_name_cn, 'Êó•ÊúüÁ±ªÂûãÔºöÂ∑•‰ΩúÊó•/Âë®Êú´' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'source_table' AS column_name, 'Ê∫êË°®' AS column_name_cn, 'Ê∫êË°®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'target_table' AS column_name, 'ÁõÆÊ†áË°®' AS column_name_cn, 'ÁõÆÊ†áË°®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'transformation_type' AS column_name, 'ËΩ¨Êç¢Á±ªÂûãÔºöÊ∏ÖÊ¥ó/ÂÖ≥ËÅî/ËΩ¨Êç¢/Ê±áÊÄª/ËÅöÂêà' AS column_name_cn, 'ËΩ¨Êç¢Á±ªÂûãÔºöÊ∏ÖÊ¥ó/ÂÖ≥ËÅî/ËΩ¨Êç¢/Ê±áÊÄª/ËÅöÂêà' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'transformation_desc' AS column_name, 'ËΩ¨Êç¢ÊèèËø∞' AS column_name_cn, 'ËΩ¨Êç¢ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'date_day' AS column_name, 'Êó•Êúü' AS column_name_cn, 'Êó•ÊúüÔºàÊó•Á≤íÂ∫¶Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'date_week' AS column_name, 'Êó•Êúü' AS column_name_cn, 'Êó•ÊúüÔºàÂë®Á≤íÂ∫¶Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'date_month' AS column_name, 'Êó•Êúü' AS column_name_cn, 'Êó•ÊúüÔºàÊúàÁ≤íÂ∫¶Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'date_quarter' AS column_name, 'Êó•Êúü' AS column_name_cn, 'Êó•ÊúüÔºàÂ≠£Â∫¶Á≤íÂ∫¶Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'date_year' AS column_name, 'Êó•Êúü' AS column_name_cn, 'Êó•ÊúüÔºàÂπ¥Á≤íÂ∫¶Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m03:32:53.691271 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m03:32:53.697247 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:32:53.697662 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_column_info'
  
[0m03:32:53.698998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.700227 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:32:53.700586 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_column_info'
  
[0m03:32:53.701825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.708047 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:32:53.708439 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */
alter table "datacore"."main_metadata"."meta_column_info" rename to "meta_column_info__dbt_backup"
[0m03:32:53.709366 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.712031 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:32:53.712385 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */
alter table "datacore"."main_metadata"."meta_column_info__dbt_tmp" rename to "meta_column_info"
[0m03:32:53.713051 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.727890 [debug] [Thread-1 (]: On model.datacore.meta_column_info: COMMIT
[0m03:32:53.728295 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:32:53.728635 [debug] [Thread-1 (]: On model.datacore.meta_column_info: COMMIT
[0m03:32:53.730671 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:32:53.737758 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:32:53.738178 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

      drop table if exists "datacore"."main_metadata"."meta_column_info__dbt_backup" cascade
    
[0m03:32:53.739832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.742158 [debug] [Thread-1 (]: On model.datacore.meta_column_info: Close
[0m03:32:53.744210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cd91d2000>]}
[0m03:32:53.744815 [info ] [Thread-1 (]: 1 of 20 OK created sql table model main_metadata.meta_column_info .............. [[32mOK[0m in 0.13s]
[0m03:32:53.745364 [debug] [Thread-1 (]: Finished running node model.datacore.meta_column_info
[0m03:32:53.745753 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m03:32:53.746260 [info ] [Thread-1 (]: 2 of 20 START sql table model main_metadata.meta_data_lineage .................. [RUN]
[0m03:32:53.746660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_column_info, now model.datacore.meta_data_lineage)
[0m03:32:53.746997 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m03:32:53.766720 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m03:32:53.767420 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m03:32:53.770287 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m03:32:53.770854 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:32:53.771194 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m03:32:53.771530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:53.772353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.772684 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:32:53.773163 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÊ∫ØÊ∫êÂÖ≥Á≥ªË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊï∞ÊçÆË°®‰πãÈó¥ÁöÑÊ∫ØÊ∫êÂÖ≥Á≥ª
-- Ëá™Âä®ËØÜÂà´ ref() Âíå source() ‰æùËµñÂÖ≥Á≥ª



SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ads.ads_toll_revenue_report' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_metadata.meta_table_info' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_quality_metrics' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_station' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_transaction' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_payment_method_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_vehicle_type_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_toll_revenue_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_station_performance_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_traffic_flow_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_transaction' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_station' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_ads.ads_traffic_trend_analysis' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_ads.ads_toll_revenue_report' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_ads.ads_quality_monitoring_dashboard' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ods.ods_toll_transaction' AS source_table, 'main_dwd.dwd_toll_transaction_detail' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
    );
  
  
[0m03:32:53.777004 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:32:53.778090 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:32:53.778444 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m03:32:53.779418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.780573 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:32:53.780914 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m03:32:53.781850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.784767 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:32:53.785132 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m03:32:53.785820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.788289 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:32:53.788655 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m03:32:53.789298 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.790542 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m03:32:53.790893 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:32:53.791338 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m03:32:53.792856 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.794948 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:32:53.795314 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m03:32:53.796644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.797878 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m03:32:53.798543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cd92046e0>]}
[0m03:32:53.799103 [info ] [Thread-1 (]: 2 of 20 OK created sql table model main_metadata.meta_data_lineage ............. [[32mOK[0m in 0.05s]
[0m03:32:53.799639 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m03:32:53.800014 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m03:32:53.800510 [info ] [Thread-1 (]: 3 of 20 START sql table model main_metadata.meta_table_info .................... [RUN]
[0m03:32:53.800886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_table_info)
[0m03:32:53.801224 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m03:32:53.815927 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m03:32:53.816522 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m03:32:53.818991 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m03:32:53.819505 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:32:53.819819 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m03:32:53.820116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:53.820863 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.821163 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:32:53.821668 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï' AS table_name_cn, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®' AS table_name_cn, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_column_info' AS table_name, 'meta_column_info' AS table_name_cn, '' AS table_description, 'Êú™ÂàÜÁ±ª' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®' AS table_name_cn, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªË°®' AS table_name_cn, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªË°®' AS table_name_cn, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêË°®' AS table_name_cn, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®' AS table_name_cn, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆÊ∫ØÊ∫êÂÖ≥Á≥ªË°®' AS table_name_cn, 'Êï∞ÊçÆÊ∫ØÊ∫êÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑÊ∫ØÊ∫êÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'MetricFlow Êó∂Èó¥ËÑäÊü±Ë°®' AS table_name_cn, 'MetricFlow Êó∂Èó¥ËÑäÊü±Ë°®ÔºåÁî®‰∫éËØ≠‰πâÂ±ÇÊó∂Èó¥Áª¥Â∫¶Â°´ÂÖÖ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'MetricFlow' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m03:32:53.826650 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m03:32:53.827802 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:32:53.828130 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:32:53.829105 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.830157 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:32:53.830481 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:32:53.831408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.833989 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:32:53.834326 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m03:32:53.834985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.838692 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:32:53.839052 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m03:32:53.839751 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.840914 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:32:53.841236 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:32:53.841544 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:32:53.842992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.844901 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:32:53.845231 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m03:32:53.846640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.847760 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m03:32:53.848679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca947dd90>]}
[0m03:32:53.849194 [info ] [Thread-1 (]: 3 of 20 OK created sql table model main_metadata.meta_table_info ............... [[32mOK[0m in 0.05s]
[0m03:32:53.849686 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m03:32:53.850030 [debug] [Thread-1 (]: Began running node model.datacore.mf_time_spine
[0m03:32:53.850474 [info ] [Thread-1 (]: 4 of 20 START sql table model main_metadata.mf_time_spine ...................... [RUN]
[0m03:32:53.850818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.mf_time_spine)
[0m03:32:53.851124 [debug] [Thread-1 (]: Began compiling node model.datacore.mf_time_spine
[0m03:32:53.853573 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.mf_time_spine"
[0m03:32:53.854071 [debug] [Thread-1 (]: Began executing node model.datacore.mf_time_spine
[0m03:32:53.856492 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.mf_time_spine"
[0m03:32:53.856987 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:32:53.857299 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: BEGIN
[0m03:32:53.857607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:53.858341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.858642 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:32:53.858966 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */

  
    
    

    create  table
      "datacore"."main_metadata"."mf_time_spine__dbt_tmp"
  
    as (
      

-- MetricFlow Time Spine Ê®°Âûã
-- ÁîüÊàê‰ªé 2020-01-01 Âà∞ 2030-12-31 ÁöÑÊØèÊó•Êó∂Èó¥Â∫èÂàó
-- Áî®‰∫é MetricFlow ËØ≠‰πâÂ±ÇÁöÑÊó∂Èó¥Áª¥Â∫¶Â°´ÂÖÖ

SELECT
  date_day::DATE AS date_day,
  DATE_TRUNC('week', date_day)::DATE AS date_week,
  DATE_TRUNC('month', date_day)::DATE AS date_month,
  DATE_TRUNC('quarter', date_day)::DATE AS date_quarter,
  DATE_TRUNC('year', date_day)::DATE AS date_year
FROM (
  SELECT 
    DATE '2020-01-01' + INTERVAL (generate_series) DAY AS date_day
  FROM generate_series(0, 4017)  -- Á∫¶ 11 Âπ¥ÁöÑÂ§©Êï∞ (2020-01-01 Âà∞ 2030-12-31)
)
    );
  
  
[0m03:32:53.861228 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:32:53.862182 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:32:53.862504 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'mf_time_spine'
  
[0m03:32:53.863419 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.864494 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:32:53.864810 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'mf_time_spine'
  
[0m03:32:53.865753 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.868387 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:32:53.868715 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */
alter table "datacore"."main_metadata"."mf_time_spine" rename to "mf_time_spine__dbt_backup"
[0m03:32:53.869378 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.871627 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:32:53.871952 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */
alter table "datacore"."main_metadata"."mf_time_spine__dbt_tmp" rename to "mf_time_spine"
[0m03:32:53.872552 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.873763 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: COMMIT
[0m03:32:53.874082 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:32:53.874391 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: COMMIT
[0m03:32:53.876007 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.877917 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:32:53.878236 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */

      drop table if exists "datacore"."main_metadata"."mf_time_spine__dbt_backup" cascade
    
[0m03:32:53.879622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.880749 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: Close
[0m03:32:53.881360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cd90ead50>]}
[0m03:32:53.881870 [info ] [Thread-1 (]: 4 of 20 OK created sql table model main_metadata.mf_time_spine ................. [[32mOK[0m in 0.03s]
[0m03:32:53.882363 [debug] [Thread-1 (]: Finished running node model.datacore.mf_time_spine
[0m03:32:53.882714 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m03:32:53.883153 [info ] [Thread-1 (]: 5 of 20 START sql view model main_staging.stg_payment_method_dict .............. [RUN]
[0m03:32:53.883511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.mf_time_spine, now model.datacore.stg_payment_method_dict)
[0m03:32:53.883823 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m03:32:53.886605 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m03:32:53.887115 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m03:32:53.903210 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m03:32:53.903826 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:32:53.904144 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m03:32:53.904452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:53.905203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.905514 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:32:53.905824 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."payment_method_dict"
  );

[0m03:32:53.906646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.909160 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:32:53.909499 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict" rename to "stg_payment_method_dict__dbt_backup"
[0m03:32:53.910144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.913930 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:32:53.914285 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" rename to "stg_payment_method_dict"
[0m03:32:53.915005 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.916111 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m03:32:53.916448 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:32:53.916757 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m03:32:53.918163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.920053 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:32:53.920387 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

      drop view if exists "datacore"."main_staging"."stg_payment_method_dict__dbt_backup" cascade
    
[0m03:32:53.921726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.922838 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m03:32:53.923397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca94168d0>]}
[0m03:32:53.923921 [info ] [Thread-1 (]: 5 of 20 OK created sql view model main_staging.stg_payment_method_dict ......... [[32mOK[0m in 0.04s]
[0m03:32:53.924417 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m03:32:53.924767 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m03:32:53.925211 [info ] [Thread-1 (]: 6 of 20 START sql view model main_staging.stg_toll_station ..................... [RUN]
[0m03:32:53.925570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m03:32:53.925880 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m03:32:53.928640 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m03:32:53.929152 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m03:32:53.931554 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m03:32:53.932049 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:32:53.932373 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m03:32:53.932675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:53.933412 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.933722 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:32:53.934037 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."toll_station"
  );

[0m03:32:53.934876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.937288 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:32:53.937622 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station" rename to "stg_toll_station__dbt_backup"
[0m03:32:53.938270 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.940526 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:32:53.940851 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station__dbt_tmp" rename to "stg_toll_station"
[0m03:32:53.941456 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.942532 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m03:32:53.942854 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:32:53.943156 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m03:32:53.945062 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:32:53.946950 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:32:53.947280 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

      drop view if exists "datacore"."main_staging"."stg_toll_station__dbt_backup" cascade
    
[0m03:32:53.949339 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:32:53.950458 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m03:32:53.951244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca941ddf0>]}
[0m03:32:53.951770 [info ] [Thread-1 (]: 6 of 20 OK created sql view model main_staging.stg_toll_station ................ [[32mOK[0m in 0.03s]
[0m03:32:53.952259 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m03:32:53.952620 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m03:32:53.953084 [info ] [Thread-1 (]: 7 of 20 START sql view model main_staging.stg_toll_transaction ................. [RUN]
[0m03:32:53.953602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m03:32:53.953938 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m03:32:53.957147 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m03:32:53.957666 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m03:32:53.960146 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m03:32:53.960657 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:32:53.960972 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m03:32:53.961274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:53.962027 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.962340 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:32:53.962733 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "datacore"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST(EXTRACT(EPOCH FROM (exit_time - entry_time)) AS INTEGER) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m03:32:53.964888 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:32:53.967377 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:32:53.967709 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction" rename to "stg_toll_transaction__dbt_backup"
[0m03:32:53.968446 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.970670 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:32:53.970998 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" rename to "stg_toll_transaction"
[0m03:32:53.971666 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.972714 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m03:32:53.973038 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:32:53.973347 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m03:32:53.975142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.978579 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:32:53.978936 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

      drop view if exists "datacore"."main_staging"."stg_toll_transaction__dbt_backup" cascade
    
[0m03:32:53.980428 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.981564 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m03:32:53.982115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca94acda0>]}
[0m03:32:53.982636 [info ] [Thread-1 (]: 7 of 20 OK created sql view model main_staging.stg_toll_transaction ............ [[32mOK[0m in 0.03s]
[0m03:32:53.983117 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m03:32:53.983468 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m03:32:53.983905 [info ] [Thread-1 (]: 8 of 20 START sql view model main_staging.stg_vehicle_type_dict ................ [RUN]
[0m03:32:53.984251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m03:32:53.984579 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m03:32:53.987319 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m03:32:53.987831 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m03:32:53.990299 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m03:32:53.990805 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:32:53.991120 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m03:32:53.991426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:53.992150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:53.992459 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:32:53.992771 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."vehicle_type_dict"
  );

[0m03:32:53.993585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.996014 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:32:53.996353 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict" rename to "stg_vehicle_type_dict__dbt_backup"
[0m03:32:53.996993 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:53.999215 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:32:53.999550 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" rename to "stg_vehicle_type_dict"
[0m03:32:54.000158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:54.001224 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m03:32:54.001556 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:32:54.001861 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m03:32:54.003142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.004979 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:32:54.005315 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

      drop view if exists "datacore"."main_staging"."stg_vehicle_type_dict__dbt_backup" cascade
    
[0m03:32:54.006568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.007686 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m03:32:54.008225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cc9181220>]}
[0m03:32:54.008753 [info ] [Thread-1 (]: 8 of 20 OK created sql view model main_staging.stg_vehicle_type_dict ........... [[32mOK[0m in 0.02s]
[0m03:32:54.009249 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m03:32:54.009607 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_station
[0m03:32:54.010077 [info ] [Thread-1 (]: 9 of 20 START sql table model main_ods.ods_toll_station ........................ [RUN]
[0m03:32:54.010571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_vehicle_type_dict, now model.datacore.ods_toll_station)
[0m03:32:54.010887 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_station
[0m03:32:54.013628 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_station"
[0m03:32:54.014140 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_station
[0m03:32:54.016454 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_station"
[0m03:32:54.016949 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:32:54.017265 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: BEGIN
[0m03:32:54.017577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:54.018323 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.018627 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:32:54.018949 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_station__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®



SELECT 
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    open_date,
    -- ‰∏öÂä°Â≠óÊÆµ
    CASE 
        WHEN station_type = '‰∏ªÁ∫øÊî∂Ë¥πÁ´ô' THEN 1
        ELSE 0
    END AS is_main_station,
    CURRENT_DATE - open_date AS days_since_open,
    etl_time
FROM "datacore"."main_staging"."stg_toll_station"
    );
  
  
[0m03:32:54.021401 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:32:54.022388 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:32:54.022710 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m03:32:54.023619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.024680 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:32:54.025003 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m03:32:54.025927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.028554 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:32:54.028978 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station" rename to "ods_toll_station__dbt_backup"
[0m03:32:54.029669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:54.031894 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:32:54.032225 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station__dbt_tmp" rename to "ods_toll_station"
[0m03:32:54.032823 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:54.033949 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m03:32:54.034279 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:32:54.034590 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m03:32:54.036051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.039514 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:32:54.039869 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

      drop table if exists "datacore"."main_ods"."ods_toll_station__dbt_backup" cascade
    
[0m03:32:54.041385 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.042521 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: Close
[0m03:32:54.043130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca94cf0b0>]}
[0m03:32:54.043652 [info ] [Thread-1 (]: 9 of 20 OK created sql table model main_ods.ods_toll_station ................... [[32mOK[0m in 0.03s]
[0m03:32:54.044140 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_station
[0m03:32:54.044489 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m03:32:54.044942 [info ] [Thread-1 (]: 10 of 20 START sql table model main_metadata.meta_data_dictionary .............. [RUN]
[0m03:32:54.045292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_station, now model.datacore.meta_data_dictionary)
[0m03:32:54.045618 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m03:32:54.048777 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m03:32:54.049293 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m03:32:54.051752 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m03:32:54.052253 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:32:54.052574 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m03:32:54.052872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:54.053594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.053896 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:32:54.054256 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m03:32:54.058512 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m03:32:54.059667 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:32:54.060020 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m03:32:54.060987 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.062179 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:32:54.062536 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m03:32:54.063491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.066444 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:32:54.066805 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary" rename to "meta_data_dictionary__dbt_backup"
[0m03:32:54.067600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:54.070036 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:32:54.070399 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m03:32:54.071021 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:54.072245 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m03:32:54.072605 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:32:54.072933 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m03:32:54.074426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.076486 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:32:54.076840 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m03:32:54.078246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.079453 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m03:32:54.080353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cc90db170>]}
[0m03:32:54.080913 [info ] [Thread-1 (]: 10 of 20 OK created sql table model main_metadata.meta_data_dictionary ......... [[32mOK[0m in 0.04s]
[0m03:32:54.081452 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m03:32:54.081835 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_transaction
[0m03:32:54.082329 [info ] [Thread-1 (]: 11 of 20 START sql table model main_ods.ods_toll_transaction ................... [RUN]
[0m03:32:54.082714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.ods_toll_transaction)
[0m03:32:54.083056 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_transaction
[0m03:32:54.087168 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_transaction"
[0m03:32:54.087733 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_transaction
[0m03:32:54.090325 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_transaction"
[0m03:32:54.090865 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:32:54.091212 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: BEGIN
[0m03:32:54.091555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:54.092456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.092793 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:32:54.093183 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_transaction__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®
-- ÂäüËÉΩÔºö‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ



SELECT 
    t.transaction_id,
    t.station_id,
    s.station_name,
    s.city,
    s.highway_code,
    s.station_type,
    t.lane_id,
    t.vehicle_plate,
    t.vehicle_type_code,
    vt.vehicle_type_name,
    vt.vehicle_type_desc,
    t.entry_station_id,
    es.station_name AS entry_station_name,
    t.entry_time,
    t.exit_time,
    t.travel_minutes,
    t.payment_method_code,
    pm.payment_method_name,
    pm.payment_method_desc,
    t.toll_amount,
    t.actual_amount,
    t.discount_amount,
    t.transaction_status,
    t.data_quality_flag,
    -- ‰∏öÂä°Â≠óÊÆµ
    DATE(t.exit_time) AS transaction_date,
    EXTRACT(HOUR FROM t.exit_time) AS transaction_hour,
    EXTRACT(DOW FROM t.exit_time) AS day_of_week,
    CASE 
        WHEN t.transaction_status = 'Ê≠£Â∏∏' THEN 1 
        ELSE 0 
    END AS is_normal_transaction,
    t.create_time,
    t.update_time,
    t.etl_time
FROM "datacore"."main_staging"."stg_toll_transaction" t
LEFT JOIN "datacore"."main_staging"."stg_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_toll_station" es ON t.entry_station_id = es.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
    );
  
  
[0m03:32:54.300282 [debug] [Thread-1 (]: SQL status: OK in 0.207 seconds
[0m03:32:54.301535 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:32:54.301895 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_transaction'
  
[0m03:32:54.303067 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.304225 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:32:54.304584 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_transaction'
  
[0m03:32:54.305579 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.308514 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:32:54.308896 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */
alter table "datacore"."main_ods"."ods_toll_transaction" rename to "ods_toll_transaction__dbt_backup"
[0m03:32:54.309631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:54.312179 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:32:54.312553 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */
alter table "datacore"."main_ods"."ods_toll_transaction__dbt_tmp" rename to "ods_toll_transaction"
[0m03:32:54.313220 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:54.314551 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m03:32:54.314908 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:32:54.315243 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m03:32:54.554539 [debug] [Thread-1 (]: SQL status: OK in 0.239 seconds
[0m03:32:54.558272 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:32:54.558636 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

      drop table if exists "datacore"."main_ods"."ods_toll_transaction__dbt_backup" cascade
    
[0m03:32:54.560291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.561464 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: Close
[0m03:32:54.571868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca94f3f50>]}
[0m03:32:54.572495 [info ] [Thread-1 (]: 11 of 20 OK created sql table model main_ods.ods_toll_transaction .............. [[32mOK[0m in 0.49s]
[0m03:32:54.572977 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_transaction
[0m03:32:54.573847 [debug] [Thread-1 (]: Began running node model.datacore.dwd_toll_transaction_detail
[0m03:32:54.574236 [info ] [Thread-1 (]: 12 of 20 START sql table model main_dwd.dwd_toll_transaction_detail ............ [RUN]
[0m03:32:54.574597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_transaction, now model.datacore.dwd_toll_transaction_detail)
[0m03:32:54.574904 [debug] [Thread-1 (]: Began compiling node model.datacore.dwd_toll_transaction_detail
[0m03:32:54.577828 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dwd_toll_transaction_detail"
[0m03:32:54.578352 [debug] [Thread-1 (]: Began executing node model.datacore.dwd_toll_transaction_detail
[0m03:32:54.580698 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dwd_toll_transaction_detail"
[0m03:32:54.581197 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:32:54.581544 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: BEGIN
[0m03:32:54.581844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:54.582610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.582917 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:32:54.583267 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

  
    
    

    create  table
      "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp"
  
    as (
      -- DWDÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆ
-- ÂäüËÉΩÔºö‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÔºå‰æø‰∫éÂêéÁª≠ÂàÜÊûê



SELECT 
    transaction_id,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    vehicle_type_name,
    vehicle_type_desc,
    entry_station_id,
    entry_station_name,
    entry_time,
    exit_time,
    travel_minutes,
    -- ËÆ°ÁÆóÈÄöË°åË∑ùÁ¶ªÔºà‰º∞ÁÆóÔºåÂü∫‰∫éÊó∂Èó¥Ôºâ
    CASE 
        WHEN travel_minutes > 0 THEN 
            ROUND(travel_minutes * 60 / 100.0, 2)  -- ÂÅáËÆæÂπ≥ÂùáÈÄüÂ∫¶100km/h
        ELSE 0
    END AS estimated_distance_km,
    payment_method_code,
    payment_method_name,
    payment_method_desc,
    toll_amount,
    actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    transaction_date,
    transaction_hour,
    day_of_week,
    is_normal_transaction,
    -- ‰∏öÂä°ÂàÜÁ±ª
    CASE 
        WHEN transaction_hour BETWEEN 6 AND 9 THEN 'Êó©È´òÂ≥∞'
        WHEN transaction_hour BETWEEN 17 AND 20 THEN 'ÊôöÈ´òÂ≥∞'
        WHEN transaction_hour BETWEEN 22 AND 6 THEN 'Â§úÈó¥'
        ELSE 'Âπ≥Â≥∞'
    END AS time_period,
    CASE 
        WHEN day_of_week IN (0, 6) THEN 'Âë®Êú´'  -- DOW: 0=Âë®Êó•, 6=Âë®ÂÖ≠
        ELSE 'Â∑•‰ΩúÊó•'
    END AS day_type,
    create_time,
    update_time,
    etl_time
FROM "datacore"."main_ods"."ods_toll_transaction"
    );
  
  
[0m03:32:54.760760 [debug] [Thread-1 (]: SQL status: OK in 0.177 seconds
[0m03:32:54.762362 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:32:54.762700 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dwd'
      AND table_name = 'dwd_toll_transaction_detail'
  
[0m03:32:54.763759 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.764874 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:32:54.765209 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dwd'
      AND table_name = 'dwd_toll_transaction_detail'
  
[0m03:32:54.766540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:54.769583 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:32:54.769929 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */
alter table "datacore"."main_dwd"."dwd_toll_transaction_detail" rename to "dwd_toll_transaction_detail__dbt_backup"
[0m03:32:54.770633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:54.772911 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:32:54.773240 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */
alter table "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp" rename to "dwd_toll_transaction_detail"
[0m03:32:54.773864 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:54.775127 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m03:32:54.775463 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:32:54.775771 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m03:32:55.010013 [debug] [Thread-1 (]: SQL status: OK in 0.234 seconds
[0m03:32:55.012217 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:32:55.012557 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

      drop table if exists "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_backup" cascade
    
[0m03:32:55.014100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.015355 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: Close
[0m03:32:55.023387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cd94c67e0>]}
[0m03:32:55.024016 [info ] [Thread-1 (]: 12 of 20 OK created sql table model main_dwd.dwd_toll_transaction_detail ....... [[32mOK[0m in 0.45s]
[0m03:32:55.024549 [debug] [Thread-1 (]: Finished running node model.datacore.dwd_toll_transaction_detail
[0m03:32:55.025896 [debug] [Thread-1 (]: Began running node model.datacore.ads_quality_monitoring_dashboard
[0m03:32:55.026314 [info ] [Thread-1 (]: 13 of 20 START sql table model main_ads.ads_quality_monitoring_dashboard ....... [RUN]
[0m03:32:55.026682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dwd_toll_transaction_detail, now model.datacore.ads_quality_monitoring_dashboard)
[0m03:32:55.027003 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_quality_monitoring_dashboard
[0m03:32:55.030307 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_quality_monitoring_dashboard"
[0m03:32:55.030854 [debug] [Thread-1 (]: Began executing node model.datacore.ads_quality_monitoring_dashboard
[0m03:32:55.033252 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_quality_monitoring_dashboard"
[0m03:32:55.033765 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:32:55.034081 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: BEGIN
[0m03:32:55.034397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:55.035225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.035547 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:32:55.035916 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø
-- ÂäüËÉΩÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶



SELECT 
    transaction_date,
    -- ÊÄª‰ΩìË¥®ÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transactions,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal,
    -- Ë¥®ÈáèÁéá
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÂºÇÂ∏∏Á±ªÂûãÂàÜÂ∏É
    SUM(CASE WHEN transaction_status = 'ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS status_abnormal_count,
    SUM(CASE WHEN transaction_status = 'ÈÄÉË¥π' THEN 1 ELSE 0 END) AS status_evasion_count,
    SUM(CASE WHEN transaction_status = 'ËÆæÂ§áÊïÖÈöú' THEN 1 ELSE 0 END) AS status_equipment_failure_count,
    SUM(CASE WHEN transaction_status = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS status_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êî∂Ë¥πÁ´ôÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_station_missing_count,
    SUM(CASE WHEN data_quality_flag = 'ËΩ¶ÁâåÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_plate_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êó∂Èó¥ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_time_abnormal_count,
    SUM(CASE WHEN data_quality_flag = 'ÈáëÈ¢ùÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_amount_abnormal_count,
    -- ÂëäË≠¶Ê†áËÆ∞
    CASE 
        WHEN SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 90 THEN 'ÂëäË≠¶'
        WHEN SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 95 THEN 'ÂëäË≠¶'
        ELSE 'Ê≠£Â∏∏'
    END AS alert_status,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m03:32:55.044964 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m03:32:55.046033 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:32:55.046375 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_quality_monitoring_dashboard'
  
[0m03:32:55.047352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.048438 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:32:55.048768 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_quality_monitoring_dashboard'
  
[0m03:32:55.050098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.052712 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:32:55.053057 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */
alter table "datacore"."main_ads"."ads_quality_monitoring_dashboard" rename to "ads_quality_monitoring_dashboard__dbt_backup"
[0m03:32:55.053741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.056005 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:32:55.056344 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */
alter table "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp" rename to "ads_quality_monitoring_dashboard"
[0m03:32:55.056955 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.058156 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m03:32:55.058487 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:32:55.058793 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m03:32:55.060332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.063805 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:32:55.064184 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

      drop table if exists "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_backup" cascade
    
[0m03:32:55.065654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.066806 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: Close
[0m03:32:55.067497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca9093dd0>]}
[0m03:32:55.068017 [info ] [Thread-1 (]: 13 of 20 OK created sql table model main_ads.ads_quality_monitoring_dashboard .. [[32mOK[0m in 0.04s]
[0m03:32:55.068512 [debug] [Thread-1 (]: Finished running node model.datacore.ads_quality_monitoring_dashboard
[0m03:32:55.068859 [debug] [Thread-1 (]: Began running node model.datacore.dws_station_performance_daily
[0m03:32:55.069315 [info ] [Thread-1 (]: 14 of 20 START sql table model main_dws.dws_station_performance_daily .......... [RUN]
[0m03:32:55.069663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_quality_monitoring_dashboard, now model.datacore.dws_station_performance_daily)
[0m03:32:55.069974 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_station_performance_daily
[0m03:32:55.072875 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_station_performance_daily"
[0m03:32:55.073400 [debug] [Thread-1 (]: Began executing node model.datacore.dws_station_performance_daily
[0m03:32:55.075781 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_station_performance_daily"
[0m03:32:55.076286 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:32:55.076617 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: BEGIN
[0m03:32:55.076922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:55.077671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.077983 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:32:55.078336 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄª
-- ÂäüËÉΩÔºöÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    -- ‰∫§ÊòìÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    COUNT(DISTINCT lane_id) AS active_lanes,
    -- Êî∂ÂÖ•ÊåáÊ†á
    SUM(actual_amount) AS total_revenue,
    AVG(actual_amount) AS avg_revenue_per_transaction,
    -- ÊïàÁéáÊåáÊ†á
    AVG(travel_minutes) AS avg_processing_time_minutes,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS etc_rate,
    -- È´òÂ≥∞Êó∂ÊÆµÂç†ÊØî
    SUM(CASE WHEN time_period IN ('Êó©È´òÂ≥∞', 'ÊôöÈ´òÂ≥∞') THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS peak_hour_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type
    );
  
  
[0m03:32:55.131074 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m03:32:55.132415 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:32:55.132789 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_station_performance_daily'
  
[0m03:32:55.133915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.135117 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:32:55.135485 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_station_performance_daily'
  
[0m03:32:55.136409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.139390 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:32:55.139773 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */
alter table "datacore"."main_dws"."dws_station_performance_daily" rename to "dws_station_performance_daily__dbt_backup"
[0m03:32:55.140490 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.143019 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:32:55.143397 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */
alter table "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp" rename to "dws_station_performance_daily"
[0m03:32:55.144052 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.145286 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m03:32:55.145659 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:32:55.145998 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m03:32:55.149012 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:32:55.151294 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:32:55.151670 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

      drop table if exists "datacore"."main_dws"."dws_station_performance_daily__dbt_backup" cascade
    
[0m03:32:55.153202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.154458 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: Close
[0m03:32:55.163883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca94829f0>]}
[0m03:32:55.164529 [info ] [Thread-1 (]: 14 of 20 OK created sql table model main_dws.dws_station_performance_daily ..... [[32mOK[0m in 0.09s]
[0m03:32:55.165032 [debug] [Thread-1 (]: Finished running node model.datacore.dws_station_performance_daily
[0m03:32:55.165398 [debug] [Thread-1 (]: Began running node model.datacore.dws_toll_revenue_daily
[0m03:32:55.165789 [info ] [Thread-1 (]: 15 of 20 START sql table model main_dws.dws_toll_revenue_daily ................. [RUN]
[0m03:32:55.166232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_station_performance_daily, now model.datacore.dws_toll_revenue_daily)
[0m03:32:55.166566 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_toll_revenue_daily
[0m03:32:55.169603 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_toll_revenue_daily"
[0m03:32:55.170127 [debug] [Thread-1 (]: Began executing node model.datacore.dws_toll_revenue_daily
[0m03:32:55.172459 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_toll_revenue_daily"
[0m03:32:55.172960 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:32:55.173278 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: BEGIN
[0m03:32:55.173589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:55.174356 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.174663 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:32:55.175019 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name,
    -- Ê±áÊÄªÊåáÊ†á
    COUNT(*) AS transaction_count,
    COUNT(DISTINCT vehicle_plate) AS vehicle_count,
    SUM(toll_amount) AS total_toll_amount,
    SUM(actual_amount) AS total_actual_amount,
    SUM(discount_amount) AS total_discount_amount,
    AVG(actual_amount) AS avg_transaction_amount,
    MAX(actual_amount) AS max_transaction_amount,
    MIN(actual_amount) AS min_transaction_amount,
    -- Ê≠£Â∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transaction_count,
    SUM(CASE WHEN is_normal_transaction = 1 THEN actual_amount ELSE 0 END) AS normal_transaction_amount,
    -- ÂºÇÂ∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transaction_count,
    -- Êï∞ÊçÆË¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal_count,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name
    );
  
  
[0m03:32:55.250024 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m03:32:55.251228 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:32:55.251571 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_toll_revenue_daily'
  
[0m03:32:55.252616 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.253703 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:32:55.254033 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_toll_revenue_daily'
  
[0m03:32:55.254932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.257580 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:32:55.257927 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */
alter table "datacore"."main_dws"."dws_toll_revenue_daily" rename to "dws_toll_revenue_daily__dbt_backup"
[0m03:32:55.258605 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.260852 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:32:55.261181 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */
alter table "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp" rename to "dws_toll_revenue_daily"
[0m03:32:55.261813 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.263047 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m03:32:55.263387 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:32:55.263698 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m03:32:55.275544 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m03:32:55.279355 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:32:55.279709 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

      drop table if exists "datacore"."main_dws"."dws_toll_revenue_daily__dbt_backup" cascade
    
[0m03:32:55.281291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.282484 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: Close
[0m03:32:55.295542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca90a00b0>]}
[0m03:32:55.296198 [info ] [Thread-1 (]: 15 of 20 OK created sql table model main_dws.dws_toll_revenue_daily ............ [[32mOK[0m in 0.13s]
[0m03:32:55.296693 [debug] [Thread-1 (]: Finished running node model.datacore.dws_toll_revenue_daily
[0m03:32:55.297039 [debug] [Thread-1 (]: Began running node model.datacore.dws_traffic_flow_daily
[0m03:32:55.297688 [info ] [Thread-1 (]: 16 of 20 START sql table model main_dws.dws_traffic_flow_daily ................. [RUN]
[0m03:32:55.298050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_toll_revenue_daily, now model.datacore.dws_traffic_flow_daily)
[0m03:32:55.298369 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_traffic_flow_daily
[0m03:32:55.301351 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_traffic_flow_daily"
[0m03:32:55.301876 [debug] [Thread-1 (]: Began executing node model.datacore.dws_traffic_flow_daily
[0m03:32:55.304258 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_traffic_flow_daily"
[0m03:32:55.304785 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:32:55.305107 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: BEGIN
[0m03:32:55.305420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:55.306261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.306583 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:32:55.306933 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•ËΩ¶ÊµÅÈáèÊ±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type,
    -- ËΩ¶ÊµÅÈáèÊåáÊ†á
    COUNT(*) AS total_vehicles,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' THEN 1 ELSE 0 END) AS passenger_vehicle_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code != 'V01' THEN 1 ELSE 0 END) AS bus_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code >= 'V05' THEN 1 ELSE 0 END) AS truck_count,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(travel_minutes) AS avg_travel_minutes,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) AS etc_count,
    SUM(CASE WHEN payment_method_code != 'P01' THEN 1 ELSE 0 END) AS non_etc_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type
    );
  
  
[0m03:32:55.354878 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m03:32:55.356098 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:32:55.356468 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_traffic_flow_daily'
  
[0m03:32:55.357649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.358839 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:32:55.359185 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_traffic_flow_daily'
  
[0m03:32:55.360165 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.362883 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:32:55.363249 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */
alter table "datacore"."main_dws"."dws_traffic_flow_daily" rename to "dws_traffic_flow_daily__dbt_backup"
[0m03:32:55.363942 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.366267 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:32:55.366611 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */
alter table "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp" rename to "dws_traffic_flow_daily"
[0m03:32:55.367236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.368375 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m03:32:55.368701 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:32:55.369007 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m03:32:55.372185 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:32:55.374293 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:32:55.374635 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

      drop table if exists "datacore"."main_dws"."dws_traffic_flow_daily__dbt_backup" cascade
    
[0m03:32:55.376103 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.377248 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: Close
[0m03:32:55.386179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cdb873f80>]}
[0m03:32:55.386819 [info ] [Thread-1 (]: 16 of 20 OK created sql table model main_dws.dws_traffic_flow_daily ............ [[32mOK[0m in 0.09s]
[0m03:32:55.387324 [debug] [Thread-1 (]: Finished running node model.datacore.dws_traffic_flow_daily
[0m03:32:55.387675 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m03:32:55.388321 [info ] [Thread-1 (]: 17 of 20 START sql table model main_metadata.meta_data_quality_metrics ......... [RUN]
[0m03:32:55.388705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_traffic_flow_daily, now model.datacore.meta_data_quality_metrics)
[0m03:32:55.389033 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_quality_metrics
[0m03:32:55.392090 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_quality_metrics"
[0m03:32:55.392672 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_quality_metrics
[0m03:32:55.395185 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_quality_metrics"
[0m03:32:55.395747 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:32:55.396082 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: BEGIN
[0m03:32:55.396426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:55.397223 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.397576 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:32:55.397989 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø



SELECT 
    transaction_date AS metric_date,
    'dwd_toll_transaction_detail' AS table_name,
    -- ÂÆåÊï¥ÊÄßÊåáÊ†á
    COUNT(*) AS total_records,
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_transaction_id,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_station_id,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) AS complete_vehicle_plate,
    -- ÂÆåÊï¥ÊÄßÁéá
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS transaction_id_completeness_rate,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS station_id_completeness_rate,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS vehicle_plate_completeness_rate,
    -- ÂáÜÁ°ÆÊÄßÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS accuracy_rate,
    -- ‰∏ÄËá¥ÊÄßÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS consistent_records,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS consistency_rate,
    -- ÂèäÊó∂ÊÄßÊåáÊ†á
    MAX(etl_time) AS last_etl_time,
    CURRENT_TIMESTAMP - MAX(etl_time) AS etl_delay,
    -- ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ
    (
        (SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2
    ) AS overall_quality_score,
    CURRENT_TIMESTAMP AS metric_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m03:32:55.408390 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m03:32:55.409609 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:32:55.409979 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m03:32:55.411018 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.412172 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:32:55.412538 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m03:32:55.413646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.416559 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:32:55.416938 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics" rename to "meta_data_quality_metrics__dbt_backup"
[0m03:32:55.417644 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.420135 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:32:55.420513 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp" rename to "meta_data_quality_metrics"
[0m03:32:55.421168 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.422410 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m03:32:55.422768 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:32:55.423109 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m03:32:55.424710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.426840 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:32:55.427202 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

      drop table if exists "datacore"."main_metadata"."meta_data_quality_metrics__dbt_backup" cascade
    
[0m03:32:55.428538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.429761 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: Close
[0m03:32:55.432352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca941eea0>]}
[0m03:32:55.432938 [info ] [Thread-1 (]: 17 of 20 OK created sql table model main_metadata.meta_data_quality_metrics .... [[32mOK[0m in 0.04s]
[0m03:32:55.433488 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m03:32:55.433882 [debug] [Thread-1 (]: Began running node model.datacore.ads_toll_revenue_report
[0m03:32:55.434386 [info ] [Thread-1 (]: 18 of 20 START sql table model main_ads.ads_toll_revenue_report ................ [RUN]
[0m03:32:55.434776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_quality_metrics, now model.datacore.ads_toll_revenue_report)
[0m03:32:55.435134 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_toll_revenue_report
[0m03:32:55.440173 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_toll_revenue_report"
[0m03:32:55.440826 [debug] [Thread-1 (]: Began executing node model.datacore.ads_toll_revenue_report
[0m03:32:55.443531 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_toll_revenue_report"
[0m03:32:55.444113 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:32:55.444485 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: BEGIN
[0m03:32:55.444829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:55.445645 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.445990 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:32:55.446390 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®
-- ÂäüËÉΩÔºöÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®



SELECT 
    transaction_date,
    city,
    highway_code,
    -- ÊÄª‰ΩìÊåáÊ†á
    SUM(total_actual_amount) AS daily_revenue,
    SUM(transaction_count) AS daily_transactions,
    SUM(vehicle_count) AS daily_vehicles,
    AVG(avg_transaction_amount) AS avg_transaction_amount,
    -- ÊåâÊîØ‰ªòÊñπÂºè
    SUM(CASE WHEN payment_method_code = 'P01' THEN total_actual_amount ELSE 0 END) AS etc_revenue,
    SUM(CASE WHEN payment_method_code != 'P01' THEN total_actual_amount ELSE 0 END) AS non_etc_revenue,
    -- ÊåâËΩ¶Âûã
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code < 'V05' THEN total_actual_amount ELSE 0 END) AS passenger_revenue,
    SUM(CASE WHEN vehicle_type_code >= 'V05' THEN total_actual_amount ELSE 0 END) AS truck_revenue,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(normal_transaction_count) * 100.0 / SUM(transaction_count) AS normal_rate,
    SUM(quality_normal_count) * 100.0 / SUM(transaction_count) AS data_quality_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_toll_revenue_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code
    );
  
  
[0m03:32:55.457624 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m03:32:55.458755 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:32:55.459115 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_toll_revenue_report'
  
[0m03:32:55.460194 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.461396 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:32:55.461767 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_toll_revenue_report'
  
[0m03:32:55.462744 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.465706 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:32:55.466096 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */
alter table "datacore"."main_ads"."ads_toll_revenue_report" rename to "ads_toll_revenue_report__dbt_backup"
[0m03:32:55.466822 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.469340 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:32:55.469713 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */
alter table "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp" rename to "ads_toll_revenue_report"
[0m03:32:55.470375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.471605 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m03:32:55.471972 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:32:55.472328 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m03:32:55.475051 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:32:55.477327 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:32:55.477699 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

      drop table if exists "datacore"."main_ads"."ads_toll_revenue_report__dbt_backup" cascade
    
[0m03:32:55.479113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.480356 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: Close
[0m03:32:55.484085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca94be840>]}
[0m03:32:55.484703 [info ] [Thread-1 (]: 18 of 20 OK created sql table model main_ads.ads_toll_revenue_report ........... [[32mOK[0m in 0.05s]
[0m03:32:55.485246 [debug] [Thread-1 (]: Finished running node model.datacore.ads_toll_revenue_report
[0m03:32:55.485643 [debug] [Thread-1 (]: Began running node model.datacore.ads_traffic_trend_analysis
[0m03:32:55.486134 [info ] [Thread-1 (]: 19 of 20 START sql table model main_ads.ads_traffic_trend_analysis ............. [RUN]
[0m03:32:55.486751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_toll_revenue_report, now model.datacore.ads_traffic_trend_analysis)
[0m03:32:55.487120 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_traffic_trend_analysis
[0m03:32:55.490353 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_traffic_trend_analysis"
[0m03:32:55.490949 [debug] [Thread-1 (]: Began executing node model.datacore.ads_traffic_trend_analysis
[0m03:32:55.493672 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_traffic_trend_analysis"
[0m03:32:55.494249 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:32:55.494610 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: BEGIN
[0m03:32:55.494947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:55.495791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.496137 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:32:55.496533 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê
-- ÂäüËÉΩÔºöËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê



SELECT 
    transaction_date,
    city,
    highway_code,
    day_type,
    -- ËΩ¶ÊµÅÈáèË∂ãÂäø
    SUM(total_vehicles) AS daily_vehicles,
    SUM(unique_vehicles) AS daily_unique_vehicles,
    -- Êó∂ÊÆµÂàÜÂ∏É
    SUM(CASE WHEN time_period = 'Êó©È´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS morning_peak_vehicles,
    SUM(CASE WHEN time_period = 'ÊôöÈ´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS evening_peak_vehicles,
    SUM(CASE WHEN time_period = 'Âπ≥Â≥∞' THEN total_vehicles ELSE 0 END) AS normal_vehicles,
    SUM(CASE WHEN time_period = 'Â§úÈó¥' THEN total_vehicles ELSE 0 END) AS night_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(passenger_vehicle_count) AS passenger_vehicles,
    SUM(bus_count) AS bus_vehicles,
    SUM(truck_count) AS truck_vehicles,
    -- ETC‰ΩøÁî®Áéá
    SUM(etc_count) * 100.0 / SUM(total_vehicles) AS etc_usage_rate,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(avg_travel_minutes) AS avg_travel_minutes,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_traffic_flow_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code,
    day_type
    );
  
  
[0m03:32:55.503885 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m03:32:55.505174 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:32:55.505562 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_traffic_trend_analysis'
  
[0m03:32:55.506697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.507889 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:32:55.508260 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_traffic_trend_analysis'
  
[0m03:32:55.509228 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.512158 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:32:55.512551 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */
alter table "datacore"."main_ads"."ads_traffic_trend_analysis" rename to "ads_traffic_trend_analysis__dbt_backup"
[0m03:32:55.513252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.515729 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:32:55.516104 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */
alter table "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp" rename to "ads_traffic_trend_analysis"
[0m03:32:55.516805 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.518091 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m03:32:55.518465 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:32:55.518811 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m03:32:55.521749 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:32:55.524041 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:32:55.524424 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

      drop table if exists "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_backup" cascade
    
[0m03:32:55.525792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.527042 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: Close
[0m03:32:55.529925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cd90ea270>]}
[0m03:32:55.530483 [info ] [Thread-1 (]: 19 of 20 OK created sql table model main_ads.ads_traffic_trend_analysis ........ [[32mOK[0m in 0.04s]
[0m03:32:55.531011 [debug] [Thread-1 (]: Finished running node model.datacore.ads_traffic_trend_analysis
[0m03:32:55.531422 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m03:32:55.531902 [info ] [Thread-1 (]: 20 of 20 START sql table model main_metadata.meta_data_asset_catalog ........... [RUN]
[0m03:32:55.532297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_traffic_trend_analysis, now model.datacore.meta_data_asset_catalog)
[0m03:32:55.532667 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_asset_catalog
[0m03:32:55.538695 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_asset_catalog"
[0m03:32:55.539353 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_asset_catalog
[0m03:32:55.542094 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_asset_catalog"
[0m03:32:55.542686 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:32:55.543043 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: BEGIN
[0m03:32:55.543393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:32:55.544266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.544620 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:32:55.545152 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï
-- ÂäüËÉΩÔºöÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞



WITH table_stats AS (
    SELECT 
        'dwd.dwd_toll_transaction_detail' AS table_name,
        COUNT(*) AS record_count,
        MAX(etl_time) AS last_update_time
    FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_toll_revenue_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_toll_revenue_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_traffic_flow_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_traffic_flow_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'ads.ads_toll_revenue_report',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_ads"."ads_toll_revenue_report"
    GROUP BY 1
)

SELECT 
    ti.schema_name,
    ti.table_name,
    ti.table_description,
    ti.business_domain,
    ti.data_layer,
    ti.owner,
    COALESCE(ts.record_count, 0) AS record_count,
    COALESCE(ts.last_update_time, CURRENT_TIMESTAMP) AS last_update_time,
    -- ËµÑ‰∫ßÁ≠âÁ∫ßËØÑ‰º∞
    CASE 
        WHEN ti.data_layer IN ('dwd', 'dws') THEN 'Ê†∏ÂøÉËµÑ‰∫ß'
        WHEN ti.data_layer = 'ads' THEN 'Â∫îÁî®ËµÑ‰∫ß'
        ELSE 'Âü∫Á°ÄËµÑ‰∫ß'
    END AS asset_level,
    -- ‰ΩøÁî®È¢ëÁéáËØÑ‰º∞ÔºàÂü∫‰∫éÊõ¥Êñ∞È¢ëÁéáÔºâ
    CASE 
        WHEN ti.update_frequency = 'ÂÆûÊó∂' THEN 'È´òÈ¢ë'
        WHEN ti.update_frequency = 'Êó•' THEN '‰∏≠È¢ë'
        ELSE '‰ΩéÈ¢ë'
    END AS usage_frequency,
    -- Êï∞ÊçÆÊñ∞È≤úÂ∫¶
    CASE 
        WHEN ts.last_update_time IS NULL THEN 'Êú™Áü•'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 1 DAY THEN 'Êñ∞È≤ú'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 7 DAY THEN 'ËæÉÊñ∞'
        ELSE 'ÈôàÊóß'
    END AS data_freshness,
    CURRENT_TIMESTAMP AS catalog_time
FROM "datacore"."main_metadata"."meta_table_info" ti
LEFT JOIN table_stats ts ON CONCAT(ti.schema_name, '.', ti.table_name) = ts.table_name
    );
  
  
[0m03:32:55.553244 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m03:32:55.554563 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:32:55.554942 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m03:32:55.556051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.557263 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:32:55.557644 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m03:32:55.558823 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.561785 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:32:55.562174 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog" rename to "meta_data_asset_catalog__dbt_backup"
[0m03:32:55.562909 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.565439 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:32:55.565809 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp" rename to "meta_data_asset_catalog"
[0m03:32:55.566471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:32:55.567707 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m03:32:55.568070 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:32:55.568421 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m03:32:55.570042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.572156 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:32:55.572531 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

      drop table if exists "datacore"."main_metadata"."meta_data_asset_catalog__dbt_backup" cascade
    
[0m03:32:55.573881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:32:55.575111 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: Close
[0m03:32:55.579084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30db40a-c99c-4b5c-a4e6-e4e3640cac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cd94e7980>]}
[0m03:32:55.579672 [info ] [Thread-1 (]: 20 of 20 OK created sql table model main_metadata.meta_data_asset_catalog ...... [[32mOK[0m in 0.05s]
[0m03:32:55.580196 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m03:32:55.582505 [debug] [MainThread]: Using duckdb connection "master"
[0m03:32:55.583245 [debug] [MainThread]: On master: BEGIN
[0m03:32:55.583788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:32:55.585398 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:32:55.585938 [debug] [MainThread]: On master: COMMIT
[0m03:32:55.586481 [debug] [MainThread]: Using duckdb connection "master"
[0m03:32:55.586992 [debug] [MainThread]: On master: COMMIT
[0m03:32:55.587822 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:32:55.588374 [debug] [MainThread]: On master: Close
[0m03:32:55.589190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:32:55.589748 [debug] [MainThread]: Connection 'model.datacore.meta_data_asset_catalog' was properly closed.
[0m03:32:55.590660 [info ] [MainThread]: 
[0m03:32:55.591455 [info ] [MainThread]: Finished running 16 table models, 4 view models in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m03:32:55.598213 [debug] [MainThread]: Command end result
[0m03:32:55.647532 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:32:55.653544 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:32:55.660261 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m03:32:55.660616 [info ] [MainThread]: 
[0m03:32:55.660980 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:32:55.661258 [info ] [MainThread]: 
[0m03:32:55.661597 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=20
[0m03:32:55.662949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2345653, "process_in_blocks": "2120", "process_kernel_time": 0.761422, "process_mem_max_rss": "291704", "process_out_blocks": "33744", "process_user_time": 4.764677}
[0m03:32:55.663502 [debug] [MainThread]: Command `dbt run` succeeded at 03:32:55.663407 after 3.24 seconds
[0m03:32:55.663905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cdd92f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9cc92da060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9ca94b1af0>]}
[0m03:32:55.664247 [debug] [MainThread]: Flushing usage events
[0m03:32:57.468865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:33:03.181436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fcd025430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fceb6d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fccffe5a0>]}


============================== 03:33:03.185149 | 6f6b8239-30ce-4f29-adeb-75c4a3f59913 ==============================
[0m03:33:03.185149 [info ] [MainThread]: Running with dbt=1.10.13
[0m03:33:03.185622 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'printer_width': '80', 'introspect': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt parse', 'partial_parse': 'True', 'log_path': '/home/chun/Develop/datacore/logs'}
[0m03:33:03.404214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f6b8239-30ce-4f29-adeb-75c4a3f59913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbc6075c0>]}
[0m03:33:03.468795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f6b8239-30ce-4f29-adeb-75c4a3f59913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fccd3d0a0>]}
[0m03:33:03.470566 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:33:03.551351 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m03:33:03.732448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:33:03.732857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:33:03.817513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f6b8239-30ce-4f29-adeb-75c4a3f59913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbc400f20>]}
[0m03:33:03.821005 [info ] [MainThread]: Performance info: /home/chun/Develop/datacore/target/perf_info.json
[0m03:33:03.965119 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:33:03.970969 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:33:03.972030 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.84802496, "process_in_blocks": "0", "process_kernel_time": 0.198144, "process_mem_max_rss": "138680", "process_out_blocks": "1368", "process_user_time": 1.943412}
[0m03:33:03.972484 [debug] [MainThread]: Command `dbt parse` succeeded at 03:33:03.972393 after 0.85 seconds
[0m03:33:03.972855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fcc5bc440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fccdd1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fd05032f0>]}
[0m03:33:03.973221 [debug] [MainThread]: Flushing usage events
[0m03:33:05.110397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:41:43.833370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301f9a0e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301fad7f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301f9a0e030>]}


============================== 03:41:43.836313 | dfe54e5e-9a3d-40df-b86f-8ec182054040 ==============================
[0m03:41:43.836313 [info ] [MainThread]: Running with dbt=1.10.13
[0m03:41:43.837677 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'static_parser': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'indirect_selection': 'eager', 'empty': 'False', 'version_check': 'True', 'warn_error': 'None'}
[0m03:41:44.040190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301e8f0f830>]}
[0m03:41:44.097267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301f89c1460>]}
[0m03:41:44.098702 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:41:44.177654 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m03:41:44.347391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:41:44.347763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:41:44.426937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301e8d10f80>]}
[0m03:41:44.567033 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:41:44.572491 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:41:44.588038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301e8a37fb0>]}
[0m03:41:44.588551 [info ] [MainThread]: Found 1 seed, 20 models, 15 data tests, 4 sources, 11 metrics, 466 macros, 1 semantic model
[0m03:41:44.588881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301e8ac3770>]}
[0m03:41:44.591527 [info ] [MainThread]: 
[0m03:41:44.591870 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:41:44.592160 [info ] [MainThread]: 
[0m03:41:44.592645 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:41:44.598845 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m03:41:44.640326 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:41:44.640756 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:41:44.641029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:44.660953 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m03:41:44.662380 [debug] [ThreadPool]: On list_datacore: Close
[0m03:41:44.664551 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:41:44.664911 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:41:44.665182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.666354 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.667395 [debug] [ThreadPool]: On list_datacore: Close
[0m03:41:44.669194 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:41:44.669533 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:41:44.669789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.670884 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.671943 [debug] [ThreadPool]: On list_datacore: Close
[0m03:41:44.673745 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:41:44.674073 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:41:44.674344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.675430 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.676451 [debug] [ThreadPool]: On list_datacore: Close
[0m03:41:44.679426 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:41:44.679832 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:41:44.680095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.681408 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.682464 [debug] [ThreadPool]: On list_datacore: Close
[0m03:41:44.684279 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:41:44.684605 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:41:44.684865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.685923 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.686929 [debug] [ThreadPool]: On list_datacore: Close
[0m03:41:44.687628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_staging)
[0m03:41:44.688031 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m03:41:44.694111 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m03:41:44.694454 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:41:44.694716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.695997 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.697151 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m03:41:44.697421 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m03:41:44.697863 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.698113 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m03:41:44.698369 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m03:41:44.698972 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.699675 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m03:41:44.699940 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m03:41:44.700185 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m03:41:44.700591 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.700851 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m03:41:44.701427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now create_datacore_main_ods)
[0m03:41:44.701825 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ods"
"
[0m03:41:44.703470 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m03:41:44.703738 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:41:44.703989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.705315 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.706414 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m03:41:44.706674 [debug] [ThreadPool]: On create_datacore_main_ods: BEGIN
[0m03:41:44.707098 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.707354 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m03:41:44.707603 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
    
        create schema if not exists "datacore"."main_ods"
    
[0m03:41:44.708039 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.708723 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m03:41:44.708989 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m03:41:44.709238 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m03:41:44.709697 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.709960 [debug] [ThreadPool]: On create_datacore_main_ods: Close
[0m03:41:44.710493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ods, now create_datacore_main_ads)
[0m03:41:44.710902 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ads"
"
[0m03:41:44.712462 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m03:41:44.712736 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:41:44.712990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.714155 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.715229 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m03:41:44.715495 [debug] [ThreadPool]: On create_datacore_main_ads: BEGIN
[0m03:41:44.715973 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.716215 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m03:41:44.716468 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
    
        create schema if not exists "datacore"."main_ads"
    
[0m03:41:44.716901 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.717579 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m03:41:44.717836 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m03:41:44.718078 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m03:41:44.718488 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.718741 [debug] [ThreadPool]: On create_datacore_main_ads: Close
[0m03:41:44.719255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ads, now create_datacore_main_dws)
[0m03:41:44.719685 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dws"
"
[0m03:41:44.721254 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m03:41:44.721532 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:41:44.721784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.722755 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.723848 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m03:41:44.724108 [debug] [ThreadPool]: On create_datacore_main_dws: BEGIN
[0m03:41:44.724525 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.724767 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m03:41:44.725010 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
    
        create schema if not exists "datacore"."main_dws"
    
[0m03:41:44.725465 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.726121 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m03:41:44.726387 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m03:41:44.726643 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m03:41:44.727057 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.727319 [debug] [ThreadPool]: On create_datacore_main_dws: Close
[0m03:41:44.727862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dws, now create_datacore_main_metadata)
[0m03:41:44.728279 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m03:41:44.729866 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:41:44.730151 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:41:44.730411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.731415 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.732536 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:41:44.732796 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m03:41:44.733218 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.733473 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:41:44.733719 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m03:41:44.734164 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.734844 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:41:44.735102 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:41:44.735349 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:41:44.735742 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.735997 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m03:41:44.736552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now create_datacore_main_dwd)
[0m03:41:44.736964 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dwd"
"
[0m03:41:44.738576 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m03:41:44.738848 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:41:44.739103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.740075 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.741145 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m03:41:44.741410 [debug] [ThreadPool]: On create_datacore_main_dwd: BEGIN
[0m03:41:44.741878 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.742121 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m03:41:44.742372 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
    
        create schema if not exists "datacore"."main_dwd"
    
[0m03:41:44.742854 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.743538 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m03:41:44.743797 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m03:41:44.744037 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m03:41:44.744445 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:41:44.744697 [debug] [ThreadPool]: On create_datacore_main_dwd: Close
[0m03:41:44.748382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dwd, now list_datacore_main_staging)
[0m03:41:44.753803 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:41:44.754122 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m03:41:44.754388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.755117 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.755387 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:41:44.755645 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m03:41:44.767788 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m03:41:44.769265 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m03:41:44.770324 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m03:41:44.770590 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m03:41:44.771223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_ods)
[0m03:41:44.774538 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:41:44.774889 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m03:41:44.775139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.775790 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.776057 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:41:44.776320 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m03:41:44.781564 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:41:44.782772 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m03:41:44.783582 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m03:41:44.783836 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m03:41:44.784400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main)
[0m03:41:44.788084 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:41:44.788395 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m03:41:44.788648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.789318 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.789569 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:41:44.789826 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m03:41:44.794901 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:41:44.796121 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m03:41:44.797022 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m03:41:44.797340 [debug] [ThreadPool]: On list_datacore_main: Close
[0m03:41:44.798044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ads)
[0m03:41:44.877783 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:41:44.878230 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m03:41:44.878497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.879335 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.879592 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:41:44.879851 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m03:41:44.885080 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:41:44.886336 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m03:41:44.887114 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m03:41:44.887371 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m03:41:44.888333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_dws)
[0m03:41:44.891146 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:41:44.891450 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m03:41:44.891702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.892342 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.892594 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:41:44.892848 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m03:41:44.897981 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:41:44.899212 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m03:41:44.900005 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m03:41:44.900260 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m03:41:44.900831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_metadata)
[0m03:41:44.903491 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:41:44.903786 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m03:41:44.904038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.904745 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.904999 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:41:44.905258 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m03:41:44.908841 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:41:44.910139 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m03:41:44.910932 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m03:41:44.911190 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m03:41:44.911758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dwd)
[0m03:41:44.915564 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:41:44.915865 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m03:41:44.916120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:44.916976 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:41:44.917231 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:41:44.917500 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m03:41:44.921539 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:41:44.922892 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m03:41:44.923687 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m03:41:44.923949 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m03:41:44.925188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301e8b066c0>]}
[0m03:41:44.926115 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:44.926688 [debug] [MainThread]: On master: BEGIN
[0m03:41:44.927221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:41:44.928279 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:41:44.928841 [debug] [MainThread]: On master: COMMIT
[0m03:41:44.929389 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:44.929912 [debug] [MainThread]: On master: COMMIT
[0m03:41:44.930727 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:41:44.931273 [debug] [MainThread]: On master: Close
[0m03:41:44.934891 [debug] [Thread-1 (]: Began running node model.datacore.meta_column_info
[0m03:41:44.935623 [info ] [Thread-1 (]: 1 of 20 START sql table model main_metadata.meta_column_info ................... [RUN]
[0m03:41:44.936250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now model.datacore.meta_column_info)
[0m03:41:44.936807 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_column_info
[0m03:41:44.962454 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_column_info"
[0m03:41:44.963197 [debug] [Thread-1 (]: Began executing node model.datacore.meta_column_info
[0m03:41:44.993580 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_column_info"
[0m03:41:44.994371 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:41:44.994703 [debug] [Thread-1 (]: On model.datacore.meta_column_info: BEGIN
[0m03:41:44.995013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:44.995894 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:44.996204 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:41:44.997107 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_column_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÂ≠óÊÆµ‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®Â≠óÊÆµÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- Â≠óÊÆµ‰∏≠ÊñáÂêç‰ªé schema.yml ÁöÑ columns meta Â≠óÊÆµËé∑Âèñ



SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'schema_name' AS column_name, 'Ê®°ÂºèÂêçÁß∞' AS column_name_cn, 'Ê®°ÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'asset_level' AS column_name, 'ËµÑ‰∫ßÁ≠âÁ∫ßÔºöÊ†∏ÂøÉËµÑ‰∫ß/Â∫îÁî®ËµÑ‰∫ß/Âü∫Á°ÄËµÑ‰∫ß' AS column_name_cn, 'ËµÑ‰∫ßÁ≠âÁ∫ßÔºöÊ†∏ÂøÉËµÑ‰∫ß/Â∫îÁî®ËµÑ‰∫ß/Âü∫Á°ÄËµÑ‰∫ß' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'usage_frequency' AS column_name, '‰ΩøÁî®È¢ëÁéáÔºöÈ´òÈ¢ë/‰∏≠È¢ë/‰ΩéÈ¢ë' AS column_name_cn, '‰ΩøÁî®È¢ëÁéáÔºöÈ´òÈ¢ë/‰∏≠È¢ë/‰ΩéÈ¢ë' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'data_freshness' AS column_name, 'Êï∞ÊçÆÊñ∞È≤úÂ∫¶ÔºöÊñ∞È≤ú/ËæÉÊñ∞/ÈôàÊóß' AS column_name_cn, 'Êï∞ÊçÆÊñ∞È≤úÂ∫¶ÔºöÊñ∞È≤ú/ËæÉÊñ∞/ÈôàÊóß' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'metric_date' AS column_name, 'ÊåáÊ†áÊó•Êúü' AS column_name_cn, 'ÊåáÊ†áÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'overall_quality_score' AS column_name, 'ÁªºÂêàË¥®ÈáèÂæóÂàÜ' AS column_name_cn, 'ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'completeness_rate' AS column_name, 'ÂÆåÊï¥ÊÄßÁéá' AS column_name_cn, 'ÂÆåÊï¥ÊÄßÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'accuracy_rate' AS column_name, 'ÂáÜÁ°ÆÁéá' AS column_name_cn, 'ÂáÜÁ°ÆÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'consistency_rate' AS column_name, '‰∏ÄËá¥Áéá' AS column_name_cn, '‰∏ÄËá¥Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_type' AS column_name, 'Â≠óÂÖ∏Á±ªÂûã' AS column_name_cn, 'Â≠óÂÖ∏Á±ªÂûã' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_code' AS column_name, 'Â≠óÂÖ∏ÁºñÁ†Å' AS column_name_cn, 'Â≠óÂÖ∏ÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_name' AS column_name, 'Â≠óÂÖ∏ÂêçÁß∞' AS column_name_cn, 'Â≠óÂÖ∏ÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_desc' AS column_name, 'Â≠óÂÖ∏ÊèèËø∞' AS column_name_cn, 'Â≠óÂÖ∏ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_value' AS column_name, 'Â≠óÂÖ∏ÂÄº' AS column_name_cn, 'Â≠óÂÖ∏ÂÄº' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_source' AS column_name, 'Â≠óÂÖ∏Êù•Ê∫ê' AS column_name_cn, 'Â≠óÂÖ∏Êù•Ê∫ê' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôIDÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'station_name' AS column_name, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_name_cn, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'city' AS column_name, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_name_cn, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'highway_code' AS column_name, 'È´òÈÄüÂÖ¨Ë∑ØÁºñÁ†Å' AS column_name_cn, 'È´òÈÄüÂÖ¨Ë∑ØÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'transaction_id' AS column_name, '‰∫§ÊòìID' AS column_name_cn, '‰∫§ÊòìIDÔºåÂîØ‰∏ÄÊ†áËØÜ‰∏ÄÁ¨î‰∫§Êòì' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'vehicle_plate' AS column_name, 'ËΩ¶ÁâåÂè∑' AS column_name_cn, 'ËΩ¶ÁâåÂè∑ÔºàÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'vehicle_type_code' AS column_name, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_name_cn, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'entry_time' AS column_name, 'ÂÖ•Âè£Êó∂Èó¥' AS column_name_cn, 'ÂÖ•Âè£Êó∂Èó¥' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'exit_time' AS column_name, 'Âá∫Âè£Êó∂Èó¥' AS column_name_cn, 'Âá∫Âè£Êó∂Èó¥ÔºàÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'travel_minutes' AS column_name, 'ÈÄöË°åÊó∂Èïø' AS column_name_cn, 'ÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'toll_amount' AS column_name, 'Â∫îÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Â∫îÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'actual_amount' AS column_name, 'ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'ÂÆûÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºåÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'data_quality_flag' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞ÔºöÊ≠£Â∏∏/Êï∞ÊçÆÁº∫Â§±/Êî∂Ë¥πÁ´ôÁº∫Â§±/ËΩ¶ÁâåÁº∫Â§±/Êó∂Èó¥ÂºÇÂ∏∏/ÈáëÈ¢ùÂºÇÂ∏∏' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'payment_method_code' AS column_name, 'ÊîØ‰ªòÊñπÂºèÁºñÁ†Å' AS column_name_cn, 'ÊîØ‰ªòÊñπÂºèÁºñÁ†ÅÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'payment_method_name' AS column_name, 'ÊîØ‰ªòÊñπÂºèÂêçÁß∞' AS column_name_cn, 'ÊîØ‰ªòÊñπÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'vehicle_type_code' AS column_name, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_name_cn, 'ËΩ¶ÂûãÁºñÁ†ÅÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'vehicle_type_name' AS column_name, 'ËΩ¶ÂûãÂêçÁß∞' AS column_name_cn, 'ËΩ¶ÂûãÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'toll_rate_multiplier' AS column_name, 'Êî∂Ë¥πË¥πÁéáÁ≥ªÊï∞' AS column_name_cn, 'Êî∂Ë¥πË¥πÁéáÁ≥ªÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'schema_name' AS column_name, 'Ê®°ÂºèÂêçÁß∞' AS column_name_cn, 'Ê®°ÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_name_cn' AS column_name, '‰∏≠ÊñáË°®Âêç' AS column_name_cn, '‰∏≠ÊñáË°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_description' AS column_name, 'Ë°®ÊèèËø∞' AS column_name_cn, 'Ë°®ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'business_domain' AS column_name, '‰∏öÂä°Âüü' AS column_name_cn, '‰∏öÂä°Âüü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'data_source' AS column_name, 'Êï∞ÊçÆÊ∫ê' AS column_name_cn, 'Êï∞ÊçÆÊ∫ê' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'update_frequency' AS column_name, 'Êõ¥Êñ∞È¢ëÁéá' AS column_name_cn, 'Êõ¥Êñ∞È¢ëÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'owner' AS column_name, 'Ë¥üË¥£‰∫∫' AS column_name_cn, 'Ë¥üË¥£‰∫∫/ÈÉ®Èó®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'data_layer' AS column_name, 'Êï∞ÊçÆÂàÜÂ±Ç' AS column_name_cn, 'Êï∞ÊçÆÂàÜÂ±Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'total_actual_amount' AS column_name, 'Êó•ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Êó•ÂÆûÊî∂ÈáëÈ¢ùÊ±áÊÄªÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'transaction_count' AS column_name, '‰∫§ÊòìÁ¨îÊï∞' AS column_name_cn, '‰∫§ÊòìÁ¨îÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'vehicle_count' AS column_name, 'ËΩ¶ËæÜÊï∞' AS column_name_cn, 'ËΩ¶ËæÜÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'total_revenue' AS column_name, 'Êó•Êî∂ÂÖ•' AS column_name_cn, 'Êó•Êî∂ÂÖ•ÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'data_quality_rate' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'etc_rate' AS column_name, 'ETC‰ΩøÁî®Áéá' AS column_name_cn, 'ETC‰ΩøÁî®Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'total_vehicles' AS column_name, 'ÊÄªËΩ¶ÊµÅÈáè' AS column_name_cn, 'ÊÄªËΩ¶ÊµÅÈáè' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'unique_vehicles' AS column_name, 'ÂîØ‰∏ÄËΩ¶ËæÜÊï∞' AS column_name_cn, 'ÂîØ‰∏ÄËΩ¶ËæÜÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'time_period' AS column_name, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_name_cn, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'daily_vehicles' AS column_name, 'Êó•ËΩ¶ÊµÅÈáè' AS column_name_cn, 'Êó•ËΩ¶ÊµÅÈáè' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'etc_usage_rate' AS column_name, 'ETC‰ΩøÁî®Áéá' AS column_name_cn, 'ETC‰ΩøÁî®Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'city' AS column_name, 'ÂüéÂ∏Ç' AS column_name_cn, 'ÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'daily_revenue' AS column_name, 'Êó•Êî∂ÂÖ•' AS column_name_cn, 'Êó•Êî∂ÂÖ•ÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'daily_transactions' AS column_name, 'Êó•‰∫§ÊòìÁ¨îÊï∞' AS column_name_cn, 'Êó•‰∫§ÊòìÁ¨îÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'data_quality_rate' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'alert_status' AS column_name, 'ÂëäË≠¶Áä∂ÊÄÅ' AS column_name_cn, 'ÂëäË≠¶Áä∂ÊÄÅÔºöÊ≠£Â∏∏/ÂëäË≠¶' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'transaction_id' AS column_name, '‰∫§ÊòìID' AS column_name_cn, '‰∫§ÊòìID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'station_name' AS column_name, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_name_cn, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'city' AS column_name, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_name_cn, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'vehicle_plate' AS column_name, 'ËΩ¶ÁâåÂè∑' AS column_name_cn, 'ËΩ¶ÁâåÂè∑' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'vehicle_type_name' AS column_name, 'ËΩ¶ÂûãÂêçÁß∞' AS column_name_cn, 'ËΩ¶ÂûãÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'toll_amount' AS column_name, 'Â∫îÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Â∫îÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'actual_amount' AS column_name, 'ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'ÂÆûÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'time_period' AS column_name, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_name_cn, 'Êó∂ÊÆµÂàÜÁ±ªÔºöÊó©È´òÂ≥∞/ÊôöÈ´òÂ≥∞/Âπ≥Â≥∞/Â§úÈó¥' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'day_type' AS column_name, 'Êó•ÊúüÁ±ªÂûã' AS column_name_cn, 'Êó•ÊúüÁ±ªÂûãÔºöÂ∑•‰ΩúÊó•/Âë®Êú´' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'source_table' AS column_name, 'Ê∫êË°®' AS column_name_cn, 'Ê∫êË°®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'target_table' AS column_name, 'ÁõÆÊ†áË°®' AS column_name_cn, 'ÁõÆÊ†áË°®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'transformation_type' AS column_name, 'ËΩ¨Êç¢Á±ªÂûãÔºöÊ∏ÖÊ¥ó/ÂÖ≥ËÅî/ËΩ¨Êç¢/Ê±áÊÄª/ËÅöÂêà' AS column_name_cn, 'ËΩ¨Êç¢Á±ªÂûãÔºöÊ∏ÖÊ¥ó/ÂÖ≥ËÅî/ËΩ¨Êç¢/Ê±áÊÄª/ËÅöÂêà' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'transformation_desc' AS column_name, 'ËΩ¨Êç¢ÊèèËø∞' AS column_name_cn, 'ËΩ¨Êç¢ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'date_day' AS column_name, 'Êó•Êúü' AS column_name_cn, 'Êó•ÊúüÔºàÊó•Á≤íÂ∫¶Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'date_week' AS column_name, 'Êó•Êúü' AS column_name_cn, 'Êó•ÊúüÔºàÂë®Á≤íÂ∫¶Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'date_month' AS column_name, 'Êó•Êúü' AS column_name_cn, 'Êó•ÊúüÔºàÊúàÁ≤íÂ∫¶Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'date_quarter' AS column_name, 'Êó•Êúü' AS column_name_cn, 'Êó•ÊúüÔºàÂ≠£Â∫¶Á≤íÂ∫¶Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'date_year' AS column_name, 'Êó•Êúü' AS column_name_cn, 'Êó•ÊúüÔºàÂπ¥Á≤íÂ∫¶Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m03:41:45.013986 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m03:41:45.019539 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:41:45.019932 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_column_info'
  
[0m03:41:45.021119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.022295 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:41:45.022631 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_column_info'
  
[0m03:41:45.023785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.029784 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:41:45.030168 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */
alter table "datacore"."main_metadata"."meta_column_info" rename to "meta_column_info__dbt_backup"
[0m03:41:45.030997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.033567 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:41:45.033895 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */
alter table "datacore"."main_metadata"."meta_column_info__dbt_tmp" rename to "meta_column_info"
[0m03:41:45.034546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.049742 [debug] [Thread-1 (]: On model.datacore.meta_column_info: COMMIT
[0m03:41:45.050190 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:41:45.050507 [debug] [Thread-1 (]: On model.datacore.meta_column_info: COMMIT
[0m03:41:45.052833 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:41:45.057981 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:41:45.058355 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

      drop table if exists "datacore"."main_metadata"."meta_column_info__dbt_backup" cascade
    
[0m03:41:45.059963 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.062167 [debug] [Thread-1 (]: On model.datacore.meta_column_info: Close
[0m03:41:45.064110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301e893b6b0>]}
[0m03:41:45.064691 [info ] [Thread-1 (]: 1 of 20 OK created sql table model main_metadata.meta_column_info .............. [[32mOK[0m in 0.13s]
[0m03:41:45.065203 [debug] [Thread-1 (]: Finished running node model.datacore.meta_column_info
[0m03:41:45.065578 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m03:41:45.066061 [info ] [Thread-1 (]: 2 of 20 START sql table model main_metadata.meta_data_lineage .................. [RUN]
[0m03:41:45.066445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_column_info, now model.datacore.meta_data_lineage)
[0m03:41:45.066770 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m03:41:45.084308 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m03:41:45.084993 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m03:41:45.087666 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m03:41:45.088202 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:41:45.088526 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m03:41:45.088829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:45.089690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.089997 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:41:45.090454 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÊ∫ØÊ∫êÂÖ≥Á≥ªË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊï∞ÊçÆË°®‰πãÈó¥ÁöÑÊ∫ØÊ∫êÂÖ≥Á≥ª
-- Ëá™Âä®ËØÜÂà´ ref() Âíå source() ‰æùËµñÂÖ≥Á≥ª



SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ads.ads_toll_revenue_report' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_metadata.meta_table_info' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_quality_metrics' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_station' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_transaction' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_payment_method_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_vehicle_type_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_toll_revenue_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_station_performance_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_traffic_flow_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_transaction' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_station' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_ads.ads_traffic_trend_analysis' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_ads.ads_toll_revenue_report' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_ads.ads_quality_monitoring_dashboard' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ods.ods_toll_transaction' AS source_table, 'main_dwd.dwd_toll_transaction_detail' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
    );
  
  
[0m03:41:45.093720 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:41:45.094751 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:41:45.095076 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m03:41:45.096049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.097150 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:41:45.097484 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m03:41:45.098903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.101761 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:41:45.102100 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m03:41:45.102837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.105106 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:41:45.105441 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m03:41:45.106062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.107220 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m03:41:45.107551 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:41:45.107853 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m03:41:45.109184 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.111142 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m03:41:45.111473 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m03:41:45.112779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.114103 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m03:41:45.114775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198fa8a10>]}
[0m03:41:45.115339 [info ] [Thread-1 (]: 2 of 20 OK created sql table model main_metadata.meta_data_lineage ............. [[32mOK[0m in 0.05s]
[0m03:41:45.115845 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m03:41:45.116204 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m03:41:45.116687 [info ] [Thread-1 (]: 3 of 20 START sql table model main_metadata.meta_table_info .................... [RUN]
[0m03:41:45.117050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_table_info)
[0m03:41:45.117380 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m03:41:45.131821 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m03:41:45.132533 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m03:41:45.135255 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m03:41:45.135807 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:41:45.136127 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m03:41:45.136438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:45.137358 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.137674 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:41:45.138172 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï' AS table_name_cn, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®' AS table_name_cn, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_column_info' AS table_name, 'meta_column_info' AS table_name_cn, '' AS table_description, 'Êú™ÂàÜÁ±ª' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®' AS table_name_cn, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªË°®' AS table_name_cn, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªË°®' AS table_name_cn, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêË°®' AS table_name_cn, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®' AS table_name_cn, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆÊ∫ØÊ∫êÂÖ≥Á≥ªË°®' AS table_name_cn, 'Êï∞ÊçÆÊ∫ØÊ∫êÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑÊ∫ØÊ∫êÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'mf_time_spine' AS table_name, 'MetricFlow Êó∂Èó¥ËÑäÊü±Ë°®' AS table_name_cn, 'MetricFlow Êó∂Èó¥ËÑäÊü±Ë°®ÔºåÁî®‰∫éËØ≠‰πâÂ±ÇÊó∂Èó¥Áª¥Â∫¶Â°´ÂÖÖ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'MetricFlow' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m03:41:45.143658 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m03:41:45.144709 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:41:45.145030 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:41:45.145954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.147029 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:41:45.147363 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:41:45.148394 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.151091 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:41:45.151445 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m03:41:45.152169 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.156298 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:41:45.156681 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m03:41:45.157570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.158766 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:41:45.159092 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:41:45.159401 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:41:45.161185 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.163205 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:41:45.163538 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m03:41:45.165110 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.166429 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m03:41:45.167395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198e718e0>]}
[0m03:41:45.167939 [info ] [Thread-1 (]: 3 of 20 OK created sql table model main_metadata.meta_table_info ............... [[32mOK[0m in 0.05s]
[0m03:41:45.168454 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m03:41:45.168806 [debug] [Thread-1 (]: Began running node model.datacore.mf_time_spine
[0m03:41:45.169261 [info ] [Thread-1 (]: 4 of 20 START sql table model main_metadata.mf_time_spine ...................... [RUN]
[0m03:41:45.169637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.mf_time_spine)
[0m03:41:45.169955 [debug] [Thread-1 (]: Began compiling node model.datacore.mf_time_spine
[0m03:41:45.172544 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.mf_time_spine"
[0m03:41:45.173101 [debug] [Thread-1 (]: Began executing node model.datacore.mf_time_spine
[0m03:41:45.175582 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.mf_time_spine"
[0m03:41:45.176098 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:41:45.176427 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: BEGIN
[0m03:41:45.176734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:45.177708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.178020 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:41:45.178361 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */

  
    
    

    create  table
      "datacore"."main_metadata"."mf_time_spine__dbt_tmp"
  
    as (
      

-- MetricFlow Time Spine Ê®°Âûã
-- ÁîüÊàê‰ªé 2020-01-01 Âà∞ 2030-12-31 ÁöÑÊØèÊó•Êó∂Èó¥Â∫èÂàó
-- Áî®‰∫é MetricFlow ËØ≠‰πâÂ±ÇÁöÑÊó∂Èó¥Áª¥Â∫¶Â°´ÂÖÖ

SELECT
  date_day::DATE AS date_day,
  DATE_TRUNC('week', date_day)::DATE AS date_week,
  DATE_TRUNC('month', date_day)::DATE AS date_month,
  DATE_TRUNC('quarter', date_day)::DATE AS date_quarter,
  DATE_TRUNC('year', date_day)::DATE AS date_year
FROM (
  SELECT 
    DATE '2020-01-01' + INTERVAL (generate_series) DAY AS date_day
  FROM generate_series(0, 4017)  -- Á∫¶ 11 Âπ¥ÁöÑÂ§©Êï∞ (2020-01-01 Âà∞ 2030-12-31)
)
    );
  
  
[0m03:41:45.180906 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:41:45.181927 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:41:45.182249 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'mf_time_spine'
  
[0m03:41:45.183262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.184356 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:41:45.184673 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'mf_time_spine'
  
[0m03:41:45.185714 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.188632 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:41:45.189023 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */
alter table "datacore"."main_metadata"."mf_time_spine" rename to "mf_time_spine__dbt_backup"
[0m03:41:45.190028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.192392 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:41:45.192719 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */
alter table "datacore"."main_metadata"."mf_time_spine__dbt_tmp" rename to "mf_time_spine"
[0m03:41:45.193405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.194533 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: COMMIT
[0m03:41:45.194853 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:41:45.195149 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: COMMIT
[0m03:41:45.196855 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.198897 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.mf_time_spine"
[0m03:41:45.199220 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.mf_time_spine"} */

      drop table if exists "datacore"."main_metadata"."mf_time_spine__dbt_backup" cascade
    
[0m03:41:45.200692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.201885 [debug] [Thread-1 (]: On model.datacore.mf_time_spine: Close
[0m03:41:45.202575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301e8f0cdd0>]}
[0m03:41:45.203125 [info ] [Thread-1 (]: 4 of 20 OK created sql table model main_metadata.mf_time_spine ................. [[32mOK[0m in 0.03s]
[0m03:41:45.203643 [debug] [Thread-1 (]: Finished running node model.datacore.mf_time_spine
[0m03:41:45.204007 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m03:41:45.204469 [info ] [Thread-1 (]: 5 of 20 START sql view model main_staging.stg_payment_method_dict .............. [RUN]
[0m03:41:45.204832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.mf_time_spine, now model.datacore.stg_payment_method_dict)
[0m03:41:45.205152 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m03:41:45.208090 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m03:41:45.208655 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m03:41:45.224826 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m03:41:45.225530 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:41:45.225855 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m03:41:45.226160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:45.227003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.227319 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:41:45.227639 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."payment_method_dict"
  );

[0m03:41:45.228497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.232777 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:41:45.233165 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict" rename to "stg_payment_method_dict__dbt_backup"
[0m03:41:45.233979 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.236390 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:41:45.236731 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" rename to "stg_payment_method_dict"
[0m03:41:45.237365 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.238458 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m03:41:45.238783 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:41:45.239104 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m03:41:45.240611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.242547 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m03:41:45.242877 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

      drop view if exists "datacore"."main_staging"."stg_payment_method_dict__dbt_backup" cascade
    
[0m03:41:45.244129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.245322 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m03:41:45.245905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198e61220>]}
[0m03:41:45.246457 [info ] [Thread-1 (]: 5 of 20 OK created sql view model main_staging.stg_payment_method_dict ......... [[32mOK[0m in 0.04s]
[0m03:41:45.246960 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m03:41:45.247328 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m03:41:45.247798 [info ] [Thread-1 (]: 6 of 20 START sql view model main_staging.stg_toll_station ..................... [RUN]
[0m03:41:45.248163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m03:41:45.248490 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m03:41:45.251364 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m03:41:45.251919 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m03:41:45.254374 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m03:41:45.254890 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:41:45.255211 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m03:41:45.255523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:45.256337 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.256650 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:41:45.256965 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."toll_station"
  );

[0m03:41:45.257858 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.260428 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:41:45.260763 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station" rename to "stg_toll_station__dbt_backup"
[0m03:41:45.261426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.263713 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:41:45.264042 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station__dbt_tmp" rename to "stg_toll_station"
[0m03:41:45.264669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.265762 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m03:41:45.266087 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:41:45.266399 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m03:41:45.267671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.269594 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m03:41:45.269923 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

      drop view if exists "datacore"."main_staging"."stg_toll_station__dbt_backup" cascade
    
[0m03:41:45.271213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.272386 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m03:41:45.273226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198faa900>]}
[0m03:41:45.273779 [info ] [Thread-1 (]: 6 of 20 OK created sql view model main_staging.stg_toll_station ................ [[32mOK[0m in 0.03s]
[0m03:41:45.274280 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m03:41:45.274640 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m03:41:45.275278 [info ] [Thread-1 (]: 7 of 20 START sql view model main_staging.stg_toll_transaction ................. [RUN]
[0m03:41:45.275650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m03:41:45.275968 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m03:41:45.279292 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m03:41:45.279871 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m03:41:45.282494 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m03:41:45.283147 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:41:45.283492 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m03:41:45.283812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:45.284684 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.285014 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:41:45.285428 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "datacore"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST(EXTRACT(EPOCH FROM (exit_time - entry_time)) AS INTEGER) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m03:41:45.287384 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:41:45.290125 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:41:45.290484 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction" rename to "stg_toll_transaction__dbt_backup"
[0m03:41:45.291240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.295258 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:41:45.295638 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" rename to "stg_toll_transaction"
[0m03:41:45.296446 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.297576 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m03:41:45.297906 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:41:45.298211 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m03:41:45.300030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.302050 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m03:41:45.302388 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

      drop view if exists "datacore"."main_staging"."stg_toll_transaction__dbt_backup" cascade
    
[0m03:41:45.303735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.304937 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m03:41:45.305547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198eda690>]}
[0m03:41:45.306092 [info ] [Thread-1 (]: 7 of 20 OK created sql view model main_staging.stg_toll_transaction ............ [[32mOK[0m in 0.03s]
[0m03:41:45.306599 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m03:41:45.306956 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m03:41:45.307419 [info ] [Thread-1 (]: 8 of 20 START sql view model main_staging.stg_vehicle_type_dict ................ [RUN]
[0m03:41:45.307776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m03:41:45.308092 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m03:41:45.310961 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m03:41:45.311528 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m03:41:45.314074 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m03:41:45.314608 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:41:45.314932 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m03:41:45.315242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:45.316069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.316385 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:41:45.316700 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."vehicle_type_dict"
  );

[0m03:41:45.317574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.320147 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:41:45.320495 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict" rename to "stg_vehicle_type_dict__dbt_backup"
[0m03:41:45.321147 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.323413 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:41:45.323744 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" rename to "stg_vehicle_type_dict"
[0m03:41:45.324365 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.325443 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m03:41:45.325769 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:41:45.326074 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m03:41:45.328034 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:41:45.329928 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m03:41:45.330253 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

      drop view if exists "datacore"."main_staging"."stg_vehicle_type_dict__dbt_backup" cascade
    
[0m03:41:45.332219 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:41:45.333411 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m03:41:45.333990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198e8ea20>]}
[0m03:41:45.334535 [info ] [Thread-1 (]: 8 of 20 OK created sql view model main_staging.stg_vehicle_type_dict ........... [[32mOK[0m in 0.03s]
[0m03:41:45.335038 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m03:41:45.335406 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_station
[0m03:41:45.336034 [info ] [Thread-1 (]: 9 of 20 START sql table model main_ods.ods_toll_station ........................ [RUN]
[0m03:41:45.336409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_vehicle_type_dict, now model.datacore.ods_toll_station)
[0m03:41:45.336724 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_station
[0m03:41:45.339568 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_station"
[0m03:41:45.340125 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_station
[0m03:41:45.342486 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_station"
[0m03:41:45.343005 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:41:45.343338 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: BEGIN
[0m03:41:45.343649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:45.344468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.344788 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:41:45.345106 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_station__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®



SELECT 
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    open_date,
    -- ‰∏öÂä°Â≠óÊÆµ
    CASE 
        WHEN station_type = '‰∏ªÁ∫øÊî∂Ë¥πÁ´ô' THEN 1
        ELSE 0
    END AS is_main_station,
    CURRENT_DATE - open_date AS days_since_open,
    etl_time
FROM "datacore"."main_staging"."stg_toll_station"
    );
  
  
[0m03:41:45.347964 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:41:45.349053 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:41:45.349384 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m03:41:45.350361 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.351604 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:41:45.351934 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m03:41:45.352862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.355559 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:41:45.355899 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station" rename to "ods_toll_station__dbt_backup"
[0m03:41:45.356590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.360536 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:41:45.360909 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station__dbt_tmp" rename to "ods_toll_station"
[0m03:41:45.361649 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.362863 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m03:41:45.363191 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:41:45.363510 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m03:41:45.364952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.367267 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m03:41:45.367610 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

      drop table if exists "datacore"."main_ods"."ods_toll_station__dbt_backup" cascade
    
[0m03:41:45.369045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.370254 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: Close
[0m03:41:45.370894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198ec5730>]}
[0m03:41:45.371440 [info ] [Thread-1 (]: 9 of 20 OK created sql table model main_ods.ods_toll_station ................... [[32mOK[0m in 0.03s]
[0m03:41:45.371938 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_station
[0m03:41:45.372290 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m03:41:45.372744 [info ] [Thread-1 (]: 10 of 20 START sql table model main_metadata.meta_data_dictionary .............. [RUN]
[0m03:41:45.373099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_station, now model.datacore.meta_data_dictionary)
[0m03:41:45.373418 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m03:41:45.376718 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m03:41:45.377277 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m03:41:45.379783 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m03:41:45.380322 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:41:45.380646 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m03:41:45.380955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:45.381868 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.382179 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:41:45.382557 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m03:41:45.386760 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m03:41:45.387893 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:41:45.388226 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m03:41:45.389389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.390460 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:41:45.390779 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m03:41:45.391713 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.394479 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:41:45.394818 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary" rename to "meta_data_dictionary__dbt_backup"
[0m03:41:45.395608 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.397950 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:41:45.398279 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m03:41:45.398901 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.400052 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m03:41:45.400384 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:41:45.400690 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m03:41:45.402240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.404270 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m03:41:45.404647 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m03:41:45.406297 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.407604 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m03:41:45.408533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301e899f6b0>]}
[0m03:41:45.409105 [info ] [Thread-1 (]: 10 of 20 OK created sql table model main_metadata.meta_data_dictionary ......... [[32mOK[0m in 0.04s]
[0m03:41:45.409627 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m03:41:45.409994 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_transaction
[0m03:41:45.410461 [info ] [Thread-1 (]: 11 of 20 START sql table model main_ods.ods_toll_transaction ................... [RUN]
[0m03:41:45.410856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.ods_toll_transaction)
[0m03:41:45.411179 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_transaction
[0m03:41:45.415150 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_transaction"
[0m03:41:45.415749 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_transaction
[0m03:41:45.418340 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_transaction"
[0m03:41:45.418964 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:41:45.419290 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: BEGIN
[0m03:41:45.419609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:45.420456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.420771 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:41:45.421132 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_transaction__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®
-- ÂäüËÉΩÔºö‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ



SELECT 
    t.transaction_id,
    t.station_id,
    s.station_name,
    s.city,
    s.highway_code,
    s.station_type,
    t.lane_id,
    t.vehicle_plate,
    t.vehicle_type_code,
    vt.vehicle_type_name,
    vt.vehicle_type_desc,
    t.entry_station_id,
    es.station_name AS entry_station_name,
    t.entry_time,
    t.exit_time,
    t.travel_minutes,
    t.payment_method_code,
    pm.payment_method_name,
    pm.payment_method_desc,
    t.toll_amount,
    t.actual_amount,
    t.discount_amount,
    t.transaction_status,
    t.data_quality_flag,
    -- ‰∏öÂä°Â≠óÊÆµ
    DATE(t.exit_time) AS transaction_date,
    EXTRACT(HOUR FROM t.exit_time) AS transaction_hour,
    EXTRACT(DOW FROM t.exit_time) AS day_of_week,
    CASE 
        WHEN t.transaction_status = 'Ê≠£Â∏∏' THEN 1 
        ELSE 0 
    END AS is_normal_transaction,
    t.create_time,
    t.update_time,
    t.etl_time
FROM "datacore"."main_staging"."stg_toll_transaction" t
LEFT JOIN "datacore"."main_staging"."stg_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_toll_station" es ON t.entry_station_id = es.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
    );
  
  
[0m03:41:45.887518 [debug] [Thread-1 (]: SQL status: OK in 0.466 seconds
[0m03:41:45.888772 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:41:45.889107 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_transaction'
  
[0m03:41:45.890241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.891352 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:41:45.891679 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_transaction'
  
[0m03:41:45.892618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.895395 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:41:45.895817 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */
alter table "datacore"."main_ods"."ods_toll_transaction" rename to "ods_toll_transaction__dbt_backup"
[0m03:41:45.896547 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:45.900480 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:41:45.900861 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */
alter table "datacore"."main_ods"."ods_toll_transaction__dbt_tmp" rename to "ods_toll_transaction"
[0m03:41:45.901788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.902996 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m03:41:45.903336 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:41:45.903642 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m03:41:45.988956 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m03:41:45.991648 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m03:41:45.991998 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

      drop table if exists "datacore"."main_ods"."ods_toll_transaction__dbt_backup" cascade
    
[0m03:41:45.993669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:45.995014 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: Close
[0m03:41:46.003628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198eec0e0>]}
[0m03:41:46.004272 [info ] [Thread-1 (]: 11 of 20 OK created sql table model main_ods.ods_toll_transaction .............. [[32mOK[0m in 0.59s]
[0m03:41:46.004808 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_transaction
[0m03:41:46.006279 [debug] [Thread-1 (]: Began running node model.datacore.dwd_toll_transaction_detail
[0m03:41:46.007135 [info ] [Thread-1 (]: 12 of 20 START sql table model main_dwd.dwd_toll_transaction_detail ............ [RUN]
[0m03:41:46.007521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_transaction, now model.datacore.dwd_toll_transaction_detail)
[0m03:41:46.007849 [debug] [Thread-1 (]: Began compiling node model.datacore.dwd_toll_transaction_detail
[0m03:41:46.011044 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dwd_toll_transaction_detail"
[0m03:41:46.011610 [debug] [Thread-1 (]: Began executing node model.datacore.dwd_toll_transaction_detail
[0m03:41:46.014046 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dwd_toll_transaction_detail"
[0m03:41:46.014574 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:41:46.014900 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: BEGIN
[0m03:41:46.015216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:46.016102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.016444 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:41:46.016807 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

  
    
    

    create  table
      "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp"
  
    as (
      -- DWDÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆ
-- ÂäüËÉΩÔºö‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÔºå‰æø‰∫éÂêéÁª≠ÂàÜÊûê



SELECT 
    transaction_id,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    vehicle_type_name,
    vehicle_type_desc,
    entry_station_id,
    entry_station_name,
    entry_time,
    exit_time,
    travel_minutes,
    -- ËÆ°ÁÆóÈÄöË°åË∑ùÁ¶ªÔºà‰º∞ÁÆóÔºåÂü∫‰∫éÊó∂Èó¥Ôºâ
    CASE 
        WHEN travel_minutes > 0 THEN 
            ROUND(travel_minutes * 60 / 100.0, 2)  -- ÂÅáËÆæÂπ≥ÂùáÈÄüÂ∫¶100km/h
        ELSE 0
    END AS estimated_distance_km,
    payment_method_code,
    payment_method_name,
    payment_method_desc,
    toll_amount,
    actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    transaction_date,
    transaction_hour,
    day_of_week,
    is_normal_transaction,
    -- ‰∏öÂä°ÂàÜÁ±ª
    CASE 
        WHEN transaction_hour BETWEEN 6 AND 9 THEN 'Êó©È´òÂ≥∞'
        WHEN transaction_hour BETWEEN 17 AND 20 THEN 'ÊôöÈ´òÂ≥∞'
        WHEN transaction_hour BETWEEN 22 AND 6 THEN 'Â§úÈó¥'
        ELSE 'Âπ≥Â≥∞'
    END AS time_period,
    CASE 
        WHEN day_of_week IN (0, 6) THEN 'Âë®Êú´'  -- DOW: 0=Âë®Êó•, 6=Âë®ÂÖ≠
        ELSE 'Â∑•‰ΩúÊó•'
    END AS day_type,
    create_time,
    update_time,
    etl_time
FROM "datacore"."main_ods"."ods_toll_transaction"
    );
  
  
[0m03:41:46.503423 [debug] [Thread-1 (]: SQL status: OK in 0.486 seconds
[0m03:41:46.504586 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:41:46.504921 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dwd'
      AND table_name = 'dwd_toll_transaction_detail'
  
[0m03:41:46.505945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.507165 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:41:46.507510 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dwd'
      AND table_name = 'dwd_toll_transaction_detail'
  
[0m03:41:46.508450 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.511072 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:41:46.511435 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */
alter table "datacore"."main_dwd"."dwd_toll_transaction_detail" rename to "dwd_toll_transaction_detail__dbt_backup"
[0m03:41:46.512105 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:46.514373 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:41:46.514713 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */
alter table "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp" rename to "dwd_toll_transaction_detail"
[0m03:41:46.515343 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:46.516488 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m03:41:46.516823 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:41:46.517137 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m03:41:46.556992 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m03:41:46.559210 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m03:41:46.559569 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

      drop table if exists "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_backup" cascade
    
[0m03:41:46.561315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.563172 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: Close
[0m03:41:46.570639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301f89924b0>]}
[0m03:41:46.571236 [info ] [Thread-1 (]: 12 of 20 OK created sql table model main_dwd.dwd_toll_transaction_detail ....... [[32mOK[0m in 0.56s]
[0m03:41:46.571775 [debug] [Thread-1 (]: Finished running node model.datacore.dwd_toll_transaction_detail
[0m03:41:46.572605 [debug] [Thread-1 (]: Began running node model.datacore.ads_quality_monitoring_dashboard
[0m03:41:46.573037 [info ] [Thread-1 (]: 13 of 20 START sql table model main_ads.ads_quality_monitoring_dashboard ....... [RUN]
[0m03:41:46.573434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dwd_toll_transaction_detail, now model.datacore.ads_quality_monitoring_dashboard)
[0m03:41:46.573783 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_quality_monitoring_dashboard
[0m03:41:46.577103 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_quality_monitoring_dashboard"
[0m03:41:46.577684 [debug] [Thread-1 (]: Began executing node model.datacore.ads_quality_monitoring_dashboard
[0m03:41:46.580366 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_quality_monitoring_dashboard"
[0m03:41:46.580926 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:41:46.581279 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: BEGIN
[0m03:41:46.581632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:46.582428 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.582770 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:41:46.583182 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø
-- ÂäüËÉΩÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶



SELECT 
    transaction_date,
    -- ÊÄª‰ΩìË¥®ÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transactions,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal,
    -- Ë¥®ÈáèÁéá
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÂºÇÂ∏∏Á±ªÂûãÂàÜÂ∏É
    SUM(CASE WHEN transaction_status = 'ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS status_abnormal_count,
    SUM(CASE WHEN transaction_status = 'ÈÄÉË¥π' THEN 1 ELSE 0 END) AS status_evasion_count,
    SUM(CASE WHEN transaction_status = 'ËÆæÂ§áÊïÖÈöú' THEN 1 ELSE 0 END) AS status_equipment_failure_count,
    SUM(CASE WHEN transaction_status = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS status_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êî∂Ë¥πÁ´ôÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_station_missing_count,
    SUM(CASE WHEN data_quality_flag = 'ËΩ¶ÁâåÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_plate_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êó∂Èó¥ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_time_abnormal_count,
    SUM(CASE WHEN data_quality_flag = 'ÈáëÈ¢ùÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_amount_abnormal_count,
    -- ÂëäË≠¶Ê†áËÆ∞
    CASE 
        WHEN SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 90 THEN 'ÂëäË≠¶'
        WHEN SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 95 THEN 'ÂëäË≠¶'
        ELSE 'Ê≠£Â∏∏'
    END AS alert_status,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m03:41:46.601582 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m03:41:46.602648 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:41:46.602982 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_quality_monitoring_dashboard'
  
[0m03:41:46.603926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.605126 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:41:46.605468 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_quality_monitoring_dashboard'
  
[0m03:41:46.606716 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.609290 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:41:46.609642 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */
alter table "datacore"."main_ads"."ads_quality_monitoring_dashboard" rename to "ads_quality_monitoring_dashboard__dbt_backup"
[0m03:41:46.610309 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:46.614113 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:41:46.614492 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */
alter table "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp" rename to "ads_quality_monitoring_dashboard"
[0m03:41:46.615180 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:46.616359 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m03:41:46.616692 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:41:46.617002 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m03:41:46.618624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.620528 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m03:41:46.620881 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

      drop table if exists "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_backup" cascade
    
[0m03:41:46.622398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.623660 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: Close
[0m03:41:46.624438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198a8aa50>]}
[0m03:41:46.625008 [info ] [Thread-1 (]: 13 of 20 OK created sql table model main_ads.ads_quality_monitoring_dashboard .. [[32mOK[0m in 0.05s]
[0m03:41:46.625559 [debug] [Thread-1 (]: Finished running node model.datacore.ads_quality_monitoring_dashboard
[0m03:41:46.625941 [debug] [Thread-1 (]: Began running node model.datacore.dws_station_performance_daily
[0m03:41:46.626412 [info ] [Thread-1 (]: 14 of 20 START sql table model main_dws.dws_station_performance_daily .......... [RUN]
[0m03:41:46.626790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_quality_monitoring_dashboard, now model.datacore.dws_station_performance_daily)
[0m03:41:46.627129 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_station_performance_daily
[0m03:41:46.630278 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_station_performance_daily"
[0m03:41:46.630844 [debug] [Thread-1 (]: Began executing node model.datacore.dws_station_performance_daily
[0m03:41:46.633464 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_station_performance_daily"
[0m03:41:46.634005 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:41:46.634365 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: BEGIN
[0m03:41:46.634704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:46.635480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.635826 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:41:46.636208 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄª
-- ÂäüËÉΩÔºöÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    -- ‰∫§ÊòìÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    COUNT(DISTINCT lane_id) AS active_lanes,
    -- Êî∂ÂÖ•ÊåáÊ†á
    SUM(actual_amount) AS total_revenue,
    AVG(actual_amount) AS avg_revenue_per_transaction,
    -- ÊïàÁéáÊåáÊ†á
    AVG(travel_minutes) AS avg_processing_time_minutes,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS etc_rate,
    -- È´òÂ≥∞Êó∂ÊÆµÂç†ÊØî
    SUM(CASE WHEN time_period IN ('Êó©È´òÂ≥∞', 'ÊôöÈ´òÂ≥∞') THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS peak_hour_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type
    );
  
  
[0m03:41:46.726353 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m03:41:46.727664 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:41:46.728042 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_station_performance_daily'
  
[0m03:41:46.729129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.730314 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:41:46.730679 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_station_performance_daily'
  
[0m03:41:46.731716 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.734655 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:41:46.735041 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */
alter table "datacore"."main_dws"."dws_station_performance_daily" rename to "dws_station_performance_daily__dbt_backup"
[0m03:41:46.735871 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:46.738410 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:41:46.738782 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */
alter table "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp" rename to "dws_station_performance_daily"
[0m03:41:46.739455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:46.740708 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m03:41:46.741074 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:41:46.741426 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m03:41:46.744416 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:41:46.746651 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m03:41:46.747017 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

      drop table if exists "datacore"."main_dws"."dws_station_performance_daily__dbt_backup" cascade
    
[0m03:41:46.748391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.749636 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: Close
[0m03:41:46.760210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198a9ffe0>]}
[0m03:41:46.761595 [info ] [Thread-1 (]: 14 of 20 OK created sql table model main_dws.dws_station_performance_daily ..... [[32mOK[0m in 0.13s]
[0m03:41:46.762840 [debug] [Thread-1 (]: Finished running node model.datacore.dws_station_performance_daily
[0m03:41:46.763471 [debug] [Thread-1 (]: Began running node model.datacore.dws_toll_revenue_daily
[0m03:41:46.764177 [info ] [Thread-1 (]: 15 of 20 START sql table model main_dws.dws_toll_revenue_daily ................. [RUN]
[0m03:41:46.764607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_station_performance_daily, now model.datacore.dws_toll_revenue_daily)
[0m03:41:46.765183 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_toll_revenue_daily
[0m03:41:46.768756 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_toll_revenue_daily"
[0m03:41:46.769298 [debug] [Thread-1 (]: Began executing node model.datacore.dws_toll_revenue_daily
[0m03:41:46.771952 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_toll_revenue_daily"
[0m03:41:46.772577 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:41:46.772946 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: BEGIN
[0m03:41:46.773293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:46.774100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.774462 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:41:46.774870 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name,
    -- Ê±áÊÄªÊåáÊ†á
    COUNT(*) AS transaction_count,
    COUNT(DISTINCT vehicle_plate) AS vehicle_count,
    SUM(toll_amount) AS total_toll_amount,
    SUM(actual_amount) AS total_actual_amount,
    SUM(discount_amount) AS total_discount_amount,
    AVG(actual_amount) AS avg_transaction_amount,
    MAX(actual_amount) AS max_transaction_amount,
    MIN(actual_amount) AS min_transaction_amount,
    -- Ê≠£Â∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transaction_count,
    SUM(CASE WHEN is_normal_transaction = 1 THEN actual_amount ELSE 0 END) AS normal_transaction_amount,
    -- ÂºÇÂ∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transaction_count,
    -- Êï∞ÊçÆË¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal_count,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name
    );
  
  
[0m03:41:46.899008 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m03:41:46.900222 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:41:46.900584 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_toll_revenue_daily'
  
[0m03:41:46.901866 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.903184 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:41:46.903558 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_toll_revenue_daily'
  
[0m03:41:46.904686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.907636 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:41:46.908028 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */
alter table "datacore"."main_dws"."dws_toll_revenue_daily" rename to "dws_toll_revenue_daily__dbt_backup"
[0m03:41:46.908766 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:46.912950 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:41:46.913383 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */
alter table "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp" rename to "dws_toll_revenue_daily"
[0m03:41:46.914160 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:46.915495 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m03:41:46.915873 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:41:46.916228 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m03:41:46.931270 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m03:41:46.933725 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m03:41:46.934115 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

      drop table if exists "datacore"."main_dws"."dws_toll_revenue_daily__dbt_backup" cascade
    
[0m03:41:46.935561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.936851 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: Close
[0m03:41:46.952364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198aa6de0>]}
[0m03:41:46.953063 [info ] [Thread-1 (]: 15 of 20 OK created sql table model main_dws.dws_toll_revenue_daily ............ [[32mOK[0m in 0.19s]
[0m03:41:46.953591 [debug] [Thread-1 (]: Finished running node model.datacore.dws_toll_revenue_daily
[0m03:41:46.953979 [debug] [Thread-1 (]: Began running node model.datacore.dws_traffic_flow_daily
[0m03:41:46.954455 [info ] [Thread-1 (]: 16 of 20 START sql table model main_dws.dws_traffic_flow_daily ................. [RUN]
[0m03:41:46.954914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_toll_revenue_daily, now model.datacore.dws_traffic_flow_daily)
[0m03:41:46.955316 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_traffic_flow_daily
[0m03:41:46.958647 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_traffic_flow_daily"
[0m03:41:46.959248 [debug] [Thread-1 (]: Began executing node model.datacore.dws_traffic_flow_daily
[0m03:41:46.961947 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_traffic_flow_daily"
[0m03:41:46.962544 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:41:46.962906 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: BEGIN
[0m03:41:46.963252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:46.964054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:46.964411 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:41:46.964804 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•ËΩ¶ÊµÅÈáèÊ±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type,
    -- ËΩ¶ÊµÅÈáèÊåáÊ†á
    COUNT(*) AS total_vehicles,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' THEN 1 ELSE 0 END) AS passenger_vehicle_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code != 'V01' THEN 1 ELSE 0 END) AS bus_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code >= 'V05' THEN 1 ELSE 0 END) AS truck_count,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(travel_minutes) AS avg_travel_minutes,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) AS etc_count,
    SUM(CASE WHEN payment_method_code != 'P01' THEN 1 ELSE 0 END) AS non_etc_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type
    );
  
  
[0m03:41:47.031604 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m03:41:47.032822 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:41:47.033184 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_traffic_flow_daily'
  
[0m03:41:47.034333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.035532 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:41:47.035902 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_traffic_flow_daily'
  
[0m03:41:47.036998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.039944 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:41:47.040358 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */
alter table "datacore"."main_dws"."dws_traffic_flow_daily" rename to "dws_traffic_flow_daily__dbt_backup"
[0m03:41:47.041082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:47.043628 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:41:47.043994 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */
alter table "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp" rename to "dws_traffic_flow_daily"
[0m03:41:47.044679 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:47.046052 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m03:41:47.046431 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:41:47.046781 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m03:41:47.054489 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m03:41:47.056551 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m03:41:47.056895 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

      drop table if exists "datacore"."main_dws"."dws_traffic_flow_daily__dbt_backup" cascade
    
[0m03:41:47.058259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.059441 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: Close
[0m03:41:47.070455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198a86e70>]}
[0m03:41:47.071117 [info ] [Thread-1 (]: 16 of 20 OK created sql table model main_dws.dws_traffic_flow_daily ............ [[32mOK[0m in 0.12s]
[0m03:41:47.071642 [debug] [Thread-1 (]: Finished running node model.datacore.dws_traffic_flow_daily
[0m03:41:47.072005 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m03:41:47.072484 [info ] [Thread-1 (]: 17 of 20 START sql table model main_metadata.meta_data_quality_metrics ......... [RUN]
[0m03:41:47.072931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_traffic_flow_daily, now model.datacore.meta_data_quality_metrics)
[0m03:41:47.073342 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_quality_metrics
[0m03:41:47.076685 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_quality_metrics"
[0m03:41:47.077287 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_quality_metrics
[0m03:41:47.079957 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_quality_metrics"
[0m03:41:47.080544 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:41:47.080900 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: BEGIN
[0m03:41:47.081238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:47.082023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.082375 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:41:47.082803 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø



SELECT 
    transaction_date AS metric_date,
    'dwd_toll_transaction_detail' AS table_name,
    -- ÂÆåÊï¥ÊÄßÊåáÊ†á
    COUNT(*) AS total_records,
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_transaction_id,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_station_id,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) AS complete_vehicle_plate,
    -- ÂÆåÊï¥ÊÄßÁéá
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS transaction_id_completeness_rate,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS station_id_completeness_rate,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS vehicle_plate_completeness_rate,
    -- ÂáÜÁ°ÆÊÄßÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS accuracy_rate,
    -- ‰∏ÄËá¥ÊÄßÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS consistent_records,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS consistency_rate,
    -- ÂèäÊó∂ÊÄßÊåáÊ†á
    MAX(etl_time) AS last_etl_time,
    CURRENT_TIMESTAMP - MAX(etl_time) AS etl_delay,
    -- ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ
    (
        (SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2
    ) AS overall_quality_score,
    CURRENT_TIMESTAMP AS metric_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m03:41:47.100829 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m03:41:47.102379 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:41:47.102744 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m03:41:47.103927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.105098 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:41:47.105461 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m03:41:47.106400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.109279 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:41:47.109670 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics" rename to "meta_data_quality_metrics__dbt_backup"
[0m03:41:47.110387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:47.112899 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:41:47.113272 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp" rename to "meta_data_quality_metrics"
[0m03:41:47.113931 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:47.117045 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m03:41:47.117453 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:41:47.117794 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m03:41:47.119583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.121682 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m03:41:47.122044 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

      drop table if exists "datacore"."main_metadata"."meta_data_quality_metrics__dbt_backup" cascade
    
[0m03:41:47.123455 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.124724 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: Close
[0m03:41:47.125582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198abef00>]}
[0m03:41:47.126147 [info ] [Thread-1 (]: 17 of 20 OK created sql table model main_metadata.meta_data_quality_metrics .... [[32mOK[0m in 0.05s]
[0m03:41:47.126688 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m03:41:47.127066 [debug] [Thread-1 (]: Began running node model.datacore.ads_toll_revenue_report
[0m03:41:47.127554 [info ] [Thread-1 (]: 18 of 20 START sql table model main_ads.ads_toll_revenue_report ................ [RUN]
[0m03:41:47.127932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_quality_metrics, now model.datacore.ads_toll_revenue_report)
[0m03:41:47.128273 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_toll_revenue_report
[0m03:41:47.131463 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_toll_revenue_report"
[0m03:41:47.132031 [debug] [Thread-1 (]: Began executing node model.datacore.ads_toll_revenue_report
[0m03:41:47.136937 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_toll_revenue_report"
[0m03:41:47.137663 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:41:47.138012 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: BEGIN
[0m03:41:47.138355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:47.140175 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:41:47.140538 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:41:47.140944 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®
-- ÂäüËÉΩÔºöÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®



SELECT 
    transaction_date,
    city,
    highway_code,
    -- ÊÄª‰ΩìÊåáÊ†á
    SUM(total_actual_amount) AS daily_revenue,
    SUM(transaction_count) AS daily_transactions,
    SUM(vehicle_count) AS daily_vehicles,
    AVG(avg_transaction_amount) AS avg_transaction_amount,
    -- ÊåâÊîØ‰ªòÊñπÂºè
    SUM(CASE WHEN payment_method_code = 'P01' THEN total_actual_amount ELSE 0 END) AS etc_revenue,
    SUM(CASE WHEN payment_method_code != 'P01' THEN total_actual_amount ELSE 0 END) AS non_etc_revenue,
    -- ÊåâËΩ¶Âûã
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code < 'V05' THEN total_actual_amount ELSE 0 END) AS passenger_revenue,
    SUM(CASE WHEN vehicle_type_code >= 'V05' THEN total_actual_amount ELSE 0 END) AS truck_revenue,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(normal_transaction_count) * 100.0 / SUM(transaction_count) AS normal_rate,
    SUM(quality_normal_count) * 100.0 / SUM(transaction_count) AS data_quality_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_toll_revenue_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code
    );
  
  
[0m03:41:47.152552 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m03:41:47.153851 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:41:47.154190 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_toll_revenue_report'
  
[0m03:41:47.155295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.156517 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:41:47.156876 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_toll_revenue_report'
  
[0m03:41:47.157857 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.160578 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:41:47.160933 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */
alter table "datacore"."main_ads"."ads_toll_revenue_report" rename to "ads_toll_revenue_report__dbt_backup"
[0m03:41:47.161638 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:47.163942 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:41:47.164281 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */
alter table "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp" rename to "ads_toll_revenue_report"
[0m03:41:47.164898 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:47.166130 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m03:41:47.166469 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:41:47.166783 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m03:41:47.169372 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:41:47.171501 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m03:41:47.171839 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

      drop table if exists "datacore"."main_ads"."ads_toll_revenue_report__dbt_backup" cascade
    
[0m03:41:47.173920 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:41:47.175094 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: Close
[0m03:41:47.179528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301e89386b0>]}
[0m03:41:47.180117 [info ] [Thread-1 (]: 18 of 20 OK created sql table model main_ads.ads_toll_revenue_report ........... [[32mOK[0m in 0.05s]
[0m03:41:47.180642 [debug] [Thread-1 (]: Finished running node model.datacore.ads_toll_revenue_report
[0m03:41:47.181022 [debug] [Thread-1 (]: Began running node model.datacore.ads_traffic_trend_analysis
[0m03:41:47.181510 [info ] [Thread-1 (]: 19 of 20 START sql table model main_ads.ads_traffic_trend_analysis ............. [RUN]
[0m03:41:47.181986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_toll_revenue_report, now model.datacore.ads_traffic_trend_analysis)
[0m03:41:47.182321 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_traffic_trend_analysis
[0m03:41:47.185447 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_traffic_trend_analysis"
[0m03:41:47.185997 [debug] [Thread-1 (]: Began executing node model.datacore.ads_traffic_trend_analysis
[0m03:41:47.188542 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_traffic_trend_analysis"
[0m03:41:47.189061 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:41:47.189398 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: BEGIN
[0m03:41:47.189714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:47.190508 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.190833 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:41:47.191188 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê
-- ÂäüËÉΩÔºöËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê



SELECT 
    transaction_date,
    city,
    highway_code,
    day_type,
    -- ËΩ¶ÊµÅÈáèË∂ãÂäø
    SUM(total_vehicles) AS daily_vehicles,
    SUM(unique_vehicles) AS daily_unique_vehicles,
    -- Êó∂ÊÆµÂàÜÂ∏É
    SUM(CASE WHEN time_period = 'Êó©È´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS morning_peak_vehicles,
    SUM(CASE WHEN time_period = 'ÊôöÈ´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS evening_peak_vehicles,
    SUM(CASE WHEN time_period = 'Âπ≥Â≥∞' THEN total_vehicles ELSE 0 END) AS normal_vehicles,
    SUM(CASE WHEN time_period = 'Â§úÈó¥' THEN total_vehicles ELSE 0 END) AS night_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(passenger_vehicle_count) AS passenger_vehicles,
    SUM(bus_count) AS bus_vehicles,
    SUM(truck_count) AS truck_vehicles,
    -- ETC‰ΩøÁî®Áéá
    SUM(etc_count) * 100.0 / SUM(total_vehicles) AS etc_usage_rate,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(avg_travel_minutes) AS avg_travel_minutes,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_traffic_flow_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code,
    day_type
    );
  
  
[0m03:41:47.199222 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m03:41:47.200397 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:41:47.200738 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_traffic_trend_analysis'
  
[0m03:41:47.201780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.202889 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:41:47.203225 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_traffic_trend_analysis'
  
[0m03:41:47.204167 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.206802 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:41:47.207159 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */
alter table "datacore"."main_ads"."ads_traffic_trend_analysis" rename to "ads_traffic_trend_analysis__dbt_backup"
[0m03:41:47.207830 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:47.210105 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:41:47.210456 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */
alter table "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp" rename to "ads_traffic_trend_analysis"
[0m03:41:47.211070 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:47.212258 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m03:41:47.212606 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:41:47.212922 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m03:41:47.215707 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:41:47.219524 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m03:41:47.219906 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

      drop table if exists "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_backup" cascade
    
[0m03:41:47.221410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.222615 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: Close
[0m03:41:47.225240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198aeb200>]}
[0m03:41:47.225792 [info ] [Thread-1 (]: 19 of 20 OK created sql table model main_ads.ads_traffic_trend_analysis ........ [[32mOK[0m in 0.04s]
[0m03:41:47.226290 [debug] [Thread-1 (]: Finished running node model.datacore.ads_traffic_trend_analysis
[0m03:41:47.226647 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m03:41:47.227085 [info ] [Thread-1 (]: 20 of 20 START sql table model main_metadata.meta_data_asset_catalog ........... [RUN]
[0m03:41:47.227448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_traffic_trend_analysis, now model.datacore.meta_data_asset_catalog)
[0m03:41:47.227761 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_asset_catalog
[0m03:41:47.231577 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_asset_catalog"
[0m03:41:47.232114 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_asset_catalog
[0m03:41:47.234650 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_asset_catalog"
[0m03:41:47.235165 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:41:47.235490 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: BEGIN
[0m03:41:47.235794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:47.236516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.236837 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:41:47.237208 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï
-- ÂäüËÉΩÔºöÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞



WITH table_stats AS (
    SELECT 
        'dwd.dwd_toll_transaction_detail' AS table_name,
        COUNT(*) AS record_count,
        MAX(etl_time) AS last_update_time
    FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_toll_revenue_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_toll_revenue_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_traffic_flow_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_traffic_flow_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'ads.ads_toll_revenue_report',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_ads"."ads_toll_revenue_report"
    GROUP BY 1
)

SELECT 
    ti.schema_name,
    ti.table_name,
    ti.table_description,
    ti.business_domain,
    ti.data_layer,
    ti.owner,
    COALESCE(ts.record_count, 0) AS record_count,
    COALESCE(ts.last_update_time, CURRENT_TIMESTAMP) AS last_update_time,
    -- ËµÑ‰∫ßÁ≠âÁ∫ßËØÑ‰º∞
    CASE 
        WHEN ti.data_layer IN ('dwd', 'dws') THEN 'Ê†∏ÂøÉËµÑ‰∫ß'
        WHEN ti.data_layer = 'ads' THEN 'Â∫îÁî®ËµÑ‰∫ß'
        ELSE 'Âü∫Á°ÄËµÑ‰∫ß'
    END AS asset_level,
    -- ‰ΩøÁî®È¢ëÁéáËØÑ‰º∞ÔºàÂü∫‰∫éÊõ¥Êñ∞È¢ëÁéáÔºâ
    CASE 
        WHEN ti.update_frequency = 'ÂÆûÊó∂' THEN 'È´òÈ¢ë'
        WHEN ti.update_frequency = 'Êó•' THEN '‰∏≠È¢ë'
        ELSE '‰ΩéÈ¢ë'
    END AS usage_frequency,
    -- Êï∞ÊçÆÊñ∞È≤úÂ∫¶
    CASE 
        WHEN ts.last_update_time IS NULL THEN 'Êú™Áü•'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 1 DAY THEN 'Êñ∞È≤ú'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 7 DAY THEN 'ËæÉÊñ∞'
        ELSE 'ÈôàÊóß'
    END AS data_freshness,
    CURRENT_TIMESTAMP AS catalog_time
FROM "datacore"."main_metadata"."meta_table_info" ti
LEFT JOIN table_stats ts ON CONCAT(ti.schema_name, '.', ti.table_name) = ts.table_name
    );
  
  
[0m03:41:47.244602 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m03:41:47.245768 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:41:47.246107 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m03:41:47.247101 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.248185 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:41:47.248523 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m03:41:47.249488 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.252082 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:41:47.252440 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog" rename to "meta_data_asset_catalog__dbt_backup"
[0m03:41:47.253110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:47.255404 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:41:47.255743 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp" rename to "meta_data_asset_catalog"
[0m03:41:47.256361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:41:47.257494 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m03:41:47.257824 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:41:47.258136 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m03:41:47.259800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.261752 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m03:41:47.262091 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

      drop table if exists "datacore"."main_metadata"."meta_data_asset_catalog__dbt_backup" cascade
    
[0m03:41:47.263429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:41:47.264568 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: Close
[0m03:41:47.267455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe54e5e-9a3d-40df-b86f-8ec182054040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730198e806b0>]}
[0m03:41:47.267996 [info ] [Thread-1 (]: 20 of 20 OK created sql table model main_metadata.meta_data_asset_catalog ...... [[32mOK[0m in 0.04s]
[0m03:41:47.268504 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m03:41:47.270162 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:47.270799 [debug] [MainThread]: On master: BEGIN
[0m03:41:47.271238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:41:47.272437 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:41:47.272871 [debug] [MainThread]: On master: COMMIT
[0m03:41:47.273300 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:47.273727 [debug] [MainThread]: On master: COMMIT
[0m03:41:47.274392 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:41:47.274823 [debug] [MainThread]: On master: Close
[0m03:41:47.275434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:41:47.275830 [debug] [MainThread]: Connection 'model.datacore.meta_data_asset_catalog' was properly closed.
[0m03:41:47.276440 [info ] [MainThread]: 
[0m03:41:47.276935 [info ] [MainThread]: Finished running 16 table models, 4 view models in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m03:41:47.281878 [debug] [MainThread]: Command end result
[0m03:41:47.337603 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:41:47.344222 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:41:47.352330 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m03:41:47.352894 [info ] [MainThread]: 
[0m03:41:47.353433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:41:47.353876 [info ] [MainThread]: 
[0m03:41:47.354367 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=20
[0m03:41:47.355775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.575591, "process_in_blocks": "120", "process_kernel_time": 0.802354, "process_mem_max_rss": "324524", "process_out_blocks": "41792", "process_user_time": 6.029123}
[0m03:41:47.356353 [debug] [MainThread]: Command `dbt run` succeeded at 03:41:47.356231 after 3.58 seconds
[0m03:41:47.356755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301f8e46ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301e8acff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301e8ace690>]}
[0m03:41:47.357156 [debug] [MainThread]: Flushing usage events
[0m03:41:49.070908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:41:53.976871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcb9ae33b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcb9a4046e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcb9a5b20f0>]}


============================== 03:41:53.981114 | 6b9b8af8-b417-47dc-a286-c30bd57dd5d0 ==============================
[0m03:41:53.981114 [info ] [MainThread]: Running with dbt=1.10.13
[0m03:41:53.981588 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'fail_fast': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt parse', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/home/chun/Develop/datacore/logs', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m03:41:54.187439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b9b8af8-b417-47dc-a286-c30bd57dd5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcb99c340e0>]}
[0m03:41:54.245779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b9b8af8-b417-47dc-a286-c30bd57dd5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcb9aaf2f30>]}
[0m03:41:54.247342 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:41:54.328279 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m03:41:54.499893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:41:54.500296 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:41:54.580533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b9b8af8-b417-47dc-a286-c30bd57dd5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcb8a0f3710>]}
[0m03:41:54.583726 [info ] [MainThread]: Performance info: /home/chun/Develop/datacore/target/perf_info.json
[0m03:41:54.718525 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:41:54.723727 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:41:54.724629 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.8033593, "process_in_blocks": "0", "process_kernel_time": 0.190762, "process_mem_max_rss": "138440", "process_out_blocks": "1368", "process_user_time": 1.895642}
[0m03:41:54.725047 [debug] [MainThread]: Command `dbt parse` succeeded at 03:41:54.724963 after 0.80 seconds
[0m03:41:54.725389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcb9a4046e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcb9e1ff2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcb99ba22d0>]}
[0m03:41:54.725707 [debug] [MainThread]: Flushing usage events
[0m03:41:55.855375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:40:52.063464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edda4e21c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edda4b0ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edda5bda510>]}


============================== 08:40:52.066221 | 65bd1506-9fb6-4da8-a919-b07783fb029e ==============================
[0m08:40:52.066221 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:40:52.066647 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'write_json': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'empty': 'None', 'printer_width': '80', 'profiles_dir': '/home/chun/Develop/datacore', 'invocation_command': 'dbt query --metrics data_quality_rate --group-by station_name,transaction_date --start-time 2025-11-04 --end-time 2025-11-22 --explain', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'use_colors': 'True', 'version_check': 'True', 'quiet': 'True', 'partial_parse': 'True'}
[0m08:40:52.074656 [info ] [MainThread]: dbt version: 1.10.13
[0m08:40:52.074990 [info ] [MainThread]: python version: 3.12.3
[0m08:40:52.075252 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m08:40:52.075510 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m08:40:52.180506 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m08:40:52.180904 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m08:40:52.181169 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m08:40:52.182333 [info ] [MainThread]: adapter type: duckdb
[0m08:40:52.182601 [info ] [MainThread]: adapter version: 1.10.0
[0m08:40:52.287681 [info ] [MainThread]: Configuration:
[0m08:40:52.288095 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:40:52.288371 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:40:52.288631 [info ] [MainThread]: Required dependencies:
[0m08:40:52.288907 [debug] [MainThread]: Executing "git --help"
[0m08:40:52.291788 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:40:52.292142 [debug] [MainThread]: STDERR: "b''"
[0m08:40:52.292418 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:40:52.292673 [info ] [MainThread]: Connection:
[0m08:40:52.292935 [info ] [MainThread]:   database: datacore
[0m08:40:52.293182 [info ] [MainThread]:   schema: main
[0m08:40:52.293435 [info ] [MainThread]:   path: datacore.duckdb
[0m08:40:52.293681 [info ] [MainThread]:   config_options: None
[0m08:40:52.293926 [info ] [MainThread]:   extensions: None
[0m08:40:52.294172 [info ] [MainThread]:   settings: {}
[0m08:40:52.294430 [info ] [MainThread]:   external_root: .
[0m08:40:52.294674 [info ] [MainThread]:   use_credential_provider: None
[0m08:40:52.294918 [info ] [MainThread]:   attach: None
[0m08:40:52.295161 [info ] [MainThread]:   filesystems: None
[0m08:40:52.295413 [info ] [MainThread]:   remote: None
[0m08:40:52.295658 [info ] [MainThread]:   plugins: None
[0m08:40:52.295902 [info ] [MainThread]:   disable_transactions: False
[0m08:40:52.296276 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:40:52.397943 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:40:52.418851 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:40:52.419223 [debug] [MainThread]: On debug: select 1 as id
[0m08:40:52.419487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:40:52.424914 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m08:40:52.425245 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m08:40:52.425604 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m08:40:52.425852 [info ] [MainThread]: [31m1 check failed:[0m
[0m08:40:52.426093 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m08:40:52.426821 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.41593617, "process_in_blocks": "0", "process_kernel_time": 0.223948, "process_mem_max_rss": "150804", "process_out_blocks": "32", "process_user_time": 1.748599}
[0m08:40:52.427194 [debug] [MainThread]: Command `cli debug` failed at 08:40:52.427115 after 0.42 seconds
[0m08:40:52.427486 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:40:52.427766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edda46d2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edda349a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edda4e21c40>]}
[0m08:40:52.428106 [debug] [MainThread]: Flushing usage events
[0m08:40:53.928249 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:23:40.024076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d6dedb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d6dedbad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d6deda510>]}


============================== 01:23:40.027878 | 3e579c94-0bdc-4fb7-8bd0-7e0824e05a06 ==============================
[0m01:23:40.027878 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:23:40.028316 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'debug': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'profiles_dir': '/home/chun/Develop/datacore', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'introspect': 'True', 'invocation_command': 'dbt query --metrics abnormal_transaction_rate --group-by city,transaction_date --start-time 2025-11-01 --end-time 2025-11-15 --explain', 'log_cache_events': 'False', 'write_json': 'True', 'version_check': 'True'}
[0m01:23:40.036752 [info ] [MainThread]: dbt version: 1.10.13
[0m01:23:40.037077 [info ] [MainThread]: python version: 3.12.3
[0m01:23:40.037331 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m01:23:40.037567 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m01:23:40.141289 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m01:23:40.141700 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m01:23:40.141963 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m01:23:40.143132 [info ] [MainThread]: adapter type: duckdb
[0m01:23:40.143403 [info ] [MainThread]: adapter version: 1.10.0
[0m01:23:40.248654 [info ] [MainThread]: Configuration:
[0m01:23:40.249066 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:23:40.249342 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:23:40.249598 [info ] [MainThread]: Required dependencies:
[0m01:23:40.249871 [debug] [MainThread]: Executing "git --help"
[0m01:23:40.252793 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:23:40.253123 [debug] [MainThread]: STDERR: "b''"
[0m01:23:40.253380 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:23:40.253631 [info ] [MainThread]: Connection:
[0m01:23:40.253891 [info ] [MainThread]:   database: datacore
[0m01:23:40.254137 [info ] [MainThread]:   schema: main
[0m01:23:40.254401 [info ] [MainThread]:   path: datacore.duckdb
[0m01:23:40.254646 [info ] [MainThread]:   config_options: None
[0m01:23:40.254890 [info ] [MainThread]:   extensions: None
[0m01:23:40.255135 [info ] [MainThread]:   settings: {}
[0m01:23:40.255392 [info ] [MainThread]:   external_root: .
[0m01:23:40.255635 [info ] [MainThread]:   use_credential_provider: None
[0m01:23:40.255881 [info ] [MainThread]:   attach: None
[0m01:23:40.256125 [info ] [MainThread]:   filesystems: None
[0m01:23:40.256378 [info ] [MainThread]:   remote: None
[0m01:23:40.256621 [info ] [MainThread]:   plugins: None
[0m01:23:40.256866 [info ] [MainThread]:   disable_transactions: False
[0m01:23:40.257242 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:23:40.362089 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m01:23:40.383396 [debug] [MainThread]: Using duckdb connection "debug"
[0m01:23:40.383830 [debug] [MainThread]: On debug: select 1 as id
[0m01:23:40.384094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:23:40.389764 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m01:23:40.390099 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m01:23:40.390436 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:23:40.390688 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:23:40.390929 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:23:40.391696 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.44218332, "process_in_blocks": "1168", "process_kernel_time": 0.215709, "process_mem_max_rss": "150432", "process_out_blocks": "32", "process_user_time": 1.779602}
[0m01:23:40.392124 [debug] [MainThread]: Command `cli debug` failed at 01:23:40.392038 after 0.44 seconds
[0m01:23:40.392441 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:23:40.392752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d6dd301a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d6ddfd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793d5ddbc470>]}
[0m01:23:40.393134 [debug] [MainThread]: Flushing usage events
[0m01:23:41.624007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:42:58.404865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c106ddb0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c106cb5d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c106e174c80>]}


============================== 05:42:58.408803 | 3ff03f27-9044-4933-b03c-786329facd37 ==============================
[0m05:42:58.408803 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:42:58.409224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'invocation_command': 'dbt query --metrics abnormal_transaction_count_metric --group-by city,transaction_date --start-time 2025-10-31 --end-time 2025-11-13 --explain', 'profiles_dir': '/home/chun/Develop/datacore', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'quiet': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default'}
[0m05:42:58.421539 [info ] [MainThread]: dbt version: 1.10.13
[0m05:42:58.421866 [info ] [MainThread]: python version: 3.12.3
[0m05:42:58.422104 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:42:58.422348 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:42:58.543154 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:42:58.543525 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:42:58.543763 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:42:58.545205 [info ] [MainThread]: adapter type: duckdb
[0m05:42:58.545451 [info ] [MainThread]: adapter version: 1.10.0
[0m05:42:58.643000 [info ] [MainThread]: Configuration:
[0m05:42:58.643379 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:42:58.643622 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:42:58.643855 [info ] [MainThread]: Required dependencies:
[0m05:42:58.644105 [debug] [MainThread]: Executing "git --help"
[0m05:42:58.647453 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:42:58.647790 [debug] [MainThread]: STDERR: "b''"
[0m05:42:58.648035 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:42:58.648264 [info ] [MainThread]: Connection:
[0m05:42:58.648510 [info ] [MainThread]:   database: datacore
[0m05:42:58.648731 [info ] [MainThread]:   schema: main
[0m05:42:58.648953 [info ] [MainThread]:   path: datacore.duckdb
[0m05:42:58.649173 [info ] [MainThread]:   config_options: None
[0m05:42:58.649406 [info ] [MainThread]:   extensions: None
[0m05:42:58.649629 [info ] [MainThread]:   settings: {}
[0m05:42:58.649852 [info ] [MainThread]:   external_root: .
[0m05:42:58.650071 [info ] [MainThread]:   use_credential_provider: None
[0m05:42:58.650294 [info ] [MainThread]:   attach: None
[0m05:42:58.650518 [info ] [MainThread]:   filesystems: None
[0m05:42:58.650736 [info ] [MainThread]:   remote: None
[0m05:42:58.650961 [info ] [MainThread]:   plugins: None
[0m05:42:58.651181 [info ] [MainThread]:   disable_transactions: False
[0m05:42:58.651533 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:42:58.757039 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:42:58.788210 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:42:58.788610 [debug] [MainThread]: On debug: select 1 as id
[0m05:42:58.788873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:42:58.799375 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:42:58.799751 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:42:58.800096 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:42:58.800357 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:42:58.800603 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:42:58.801342 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.46159306, "process_in_blocks": "96856", "process_kernel_time": 0.285848, "process_mem_max_rss": "150396", "process_out_blocks": "32", "process_user_time": 1.859533}
[0m05:42:58.801730 [debug] [MainThread]: Command `cli debug` failed at 05:42:58.801648 after 0.46 seconds
[0m05:42:58.802008 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:42:58.802290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c106dc68fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c106c87cec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c106d8e9220>]}
[0m05:42:58.802640 [debug] [MainThread]: Flushing usage events
[0m05:43:00.324912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:39:48.806493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5ebb6c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5eb7c7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5eac8b5f0>]}


============================== 05:39:48.810273 | 9d7d59dc-1f17-441e-aaf7-c464faf56d9b ==============================
[0m05:39:48.810273 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:39:48.810704 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'indirect_selection': 'eager', 'log_path': '/home/chun/Develop/datacore/logs', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/chun/Develop/datacore', 'version_check': 'True', 'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt query --metrics abnormal_transaction_count_metric --group-by transaction_date --start-time 2025-11-01 --end-time 2025-11-09 --explain', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'True', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False'}
[0m05:39:48.823019 [info ] [MainThread]: dbt version: 1.10.13
[0m05:39:48.823381 [info ] [MainThread]: python version: 3.12.3
[0m05:39:48.823638 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:39:48.823892 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:39:48.937750 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:39:48.938146 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:39:48.938429 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:39:48.939989 [info ] [MainThread]: adapter type: duckdb
[0m05:39:48.940264 [info ] [MainThread]: adapter version: 1.10.0
[0m05:39:49.047713 [info ] [MainThread]: Configuration:
[0m05:39:49.048118 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:39:49.048396 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:39:49.048651 [info ] [MainThread]: Required dependencies:
[0m05:39:49.048922 [debug] [MainThread]: Executing "git --help"
[0m05:39:49.051856 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:39:49.052355 [debug] [MainThread]: STDERR: "b''"
[0m05:39:49.052697 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:39:49.053020 [info ] [MainThread]: Connection:
[0m05:39:49.053357 [info ] [MainThread]:   database: datacore
[0m05:39:49.053667 [info ] [MainThread]:   schema: main
[0m05:39:49.053985 [info ] [MainThread]:   path: datacore.duckdb
[0m05:39:49.054333 [info ] [MainThread]:   config_options: None
[0m05:39:49.054650 [info ] [MainThread]:   extensions: None
[0m05:39:49.054968 [info ] [MainThread]:   settings: {}
[0m05:39:49.055281 [info ] [MainThread]:   external_root: .
[0m05:39:49.055606 [info ] [MainThread]:   use_credential_provider: None
[0m05:39:49.055926 [info ] [MainThread]:   attach: None
[0m05:39:49.056270 [info ] [MainThread]:   filesystems: None
[0m05:39:49.056795 [info ] [MainThread]:   remote: None
[0m05:39:49.057130 [info ] [MainThread]:   plugins: None
[0m05:39:49.057449 [info ] [MainThread]:   disable_transactions: False
[0m05:39:49.057933 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:39:49.168153 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:39:49.193260 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:39:49.193645 [debug] [MainThread]: On debug: select 1 as id
[0m05:39:49.193910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:39:49.209908 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:39:49.210317 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:39:49.210658 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:39:49.210908 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:39:49.211151 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:39:49.211889 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.47781914, "process_in_blocks": "51176", "process_kernel_time": 0.281644, "process_mem_max_rss": "150404", "process_out_blocks": "32", "process_user_time": 1.91037}
[0m05:39:49.212268 [debug] [MainThread]: Command `cli debug` failed at 05:39:49.212187 after 0.48 seconds
[0m05:39:49.212588 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:39:49.212875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5ecaca570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5eb07f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5ea097e30>]}
[0m05:39:49.213251 [debug] [MainThread]: Flushing usage events
[0m05:39:50.516542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:45:10.911866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b671b87a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b671bd43440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b671c152390>]}


============================== 05:45:10.915055 | cdacc9e0-a92c-4d53-9491-79ffc49b7d62 ==============================
[0m05:45:10.915055 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:45:10.915523 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/chun/Develop/datacore', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'quiet': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt query --metrics data_quality_rate --group-by transaction_date --start-time 2025-11-01 --end-time 2025-11-09 --explain', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'write_json': 'True', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'empty': 'None', 'log_path': '/home/chun/Develop/datacore/logs'}
[0m05:45:10.924308 [info ] [MainThread]: dbt version: 1.10.13
[0m05:45:10.924657 [info ] [MainThread]: python version: 3.12.3
[0m05:45:10.924912 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:45:10.925162 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:45:11.025330 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:45:11.025732 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:45:11.026001 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:45:11.027200 [info ] [MainThread]: adapter type: duckdb
[0m05:45:11.027475 [info ] [MainThread]: adapter version: 1.10.0
[0m05:45:11.136087 [info ] [MainThread]: Configuration:
[0m05:45:11.136501 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:45:11.136765 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:45:11.137018 [info ] [MainThread]: Required dependencies:
[0m05:45:11.137310 [debug] [MainThread]: Executing "git --help"
[0m05:45:11.140309 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:45:11.140639 [debug] [MainThread]: STDERR: "b''"
[0m05:45:11.140882 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:45:11.141115 [info ] [MainThread]: Connection:
[0m05:45:11.141373 [info ] [MainThread]:   database: datacore
[0m05:45:11.141620 [info ] [MainThread]:   schema: main
[0m05:45:11.141864 [info ] [MainThread]:   path: datacore.duckdb
[0m05:45:11.142107 [info ] [MainThread]:   config_options: None
[0m05:45:11.142360 [info ] [MainThread]:   extensions: None
[0m05:45:11.142606 [info ] [MainThread]:   settings: {}
[0m05:45:11.142880 [info ] [MainThread]:   external_root: .
[0m05:45:11.143124 [info ] [MainThread]:   use_credential_provider: None
[0m05:45:11.143378 [info ] [MainThread]:   attach: None
[0m05:45:11.143623 [info ] [MainThread]:   filesystems: None
[0m05:45:11.143869 [info ] [MainThread]:   remote: None
[0m05:45:11.144111 [info ] [MainThread]:   plugins: None
[0m05:45:11.144364 [info ] [MainThread]:   disable_transactions: False
[0m05:45:11.144744 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:45:11.247010 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:45:11.268517 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:45:11.268879 [debug] [MainThread]: On debug: select 1 as id
[0m05:45:11.269140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:11.274789 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:45:11.275133 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:45:11.275468 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:45:11.275711 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:45:11.275956 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:45:11.276689 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.422169, "process_in_blocks": "1576", "process_kernel_time": 0.266328, "process_mem_max_rss": "149784", "process_out_blocks": "24", "process_user_time": 1.765549}
[0m05:45:11.277064 [debug] [MainThread]: Command `cli debug` failed at 05:45:11.276986 after 0.42 seconds
[0m05:45:11.277360 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:45:11.277664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b671b8ec350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b671b4e41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b670a9c0500>]}
[0m05:45:11.278037 [debug] [MainThread]: Flushing usage events
[0m05:45:12.389480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:45:32.939904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745219019f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745218d45730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745219045100>]}


============================== 05:45:32.943472 | 11d7cc76-85f6-4235-81ca-de34150fbd6b ==============================
[0m05:45:32.943472 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:45:32.943923 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error': 'None', 'empty': 'None', 'invocation_command': 'dbt query --metrics daily_revenue --group-by transaction_date --start-time 2025-11-01 --end-time 2025-11-09 --explain', 'log_cache_events': 'False', 'fail_fast': 'False', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/chun/Develop/datacore/logs', 'version_check': 'True', 'static_parser': 'True', 'quiet': 'True', 'printer_width': '80', 'profiles_dir': '/home/chun/Develop/datacore', 'target_path': 'None'}
[0m05:45:32.952655 [info ] [MainThread]: dbt version: 1.10.13
[0m05:45:32.953019 [info ] [MainThread]: python version: 3.12.3
[0m05:45:32.953277 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:45:32.953541 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:45:33.060415 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:45:33.060812 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:45:33.061079 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:45:33.062261 [info ] [MainThread]: adapter type: duckdb
[0m05:45:33.062536 [info ] [MainThread]: adapter version: 1.10.0
[0m05:45:33.169706 [info ] [MainThread]: Configuration:
[0m05:45:33.170109 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:45:33.170380 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:45:33.170633 [info ] [MainThread]: Required dependencies:
[0m05:45:33.170902 [debug] [MainThread]: Executing "git --help"
[0m05:45:33.173811 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:45:33.174136 [debug] [MainThread]: STDERR: "b''"
[0m05:45:33.174388 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:45:33.174618 [info ] [MainThread]: Connection:
[0m05:45:33.174856 [info ] [MainThread]:   database: datacore
[0m05:45:33.175080 [info ] [MainThread]:   schema: main
[0m05:45:33.175310 [info ] [MainThread]:   path: datacore.duckdb
[0m05:45:33.175534 [info ] [MainThread]:   config_options: None
[0m05:45:33.175757 [info ] [MainThread]:   extensions: None
[0m05:45:33.175981 [info ] [MainThread]:   settings: {}
[0m05:45:33.176204 [info ] [MainThread]:   external_root: .
[0m05:45:33.176440 [info ] [MainThread]:   use_credential_provider: None
[0m05:45:33.176663 [info ] [MainThread]:   attach: None
[0m05:45:33.176881 [info ] [MainThread]:   filesystems: None
[0m05:45:33.177101 [info ] [MainThread]:   remote: None
[0m05:45:33.177329 [info ] [MainThread]:   plugins: None
[0m05:45:33.177550 [info ] [MainThread]:   disable_transactions: False
[0m05:45:33.177892 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:45:33.287468 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:45:33.310993 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:45:33.311401 [debug] [MainThread]: On debug: select 1 as id
[0m05:45:33.311684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:33.317756 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:45:33.318135 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:45:33.318494 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:45:33.318757 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:45:33.319024 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:45:33.319802 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.43569267, "process_in_blocks": "0", "process_kernel_time": 0.199944, "process_mem_max_rss": "149436", "process_out_blocks": "16", "process_user_time": 1.838485}
[0m05:45:33.320203 [debug] [MainThread]: Command `cli debug` failed at 05:45:33.320119 after 0.44 seconds
[0m05:45:33.320503 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:45:33.320795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74521937a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452179f4b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74521794b350>]}
[0m05:45:33.321145 [debug] [MainThread]: Flushing usage events
[0m05:45:34.408123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:45:44.664085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782abbda42f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782abcb16a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782abc580e90>]}


============================== 05:45:44.667104 | c06ce546-31fb-410e-9301-e62049d4dba0 ==============================
[0m05:45:44.667104 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:45:44.667539 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_path': '/home/chun/Develop/datacore/logs', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'empty': 'None', 'invocation_command': 'dbt query --metrics abnormal_transaction_rate --group-by transaction_date --start-time 2025-11-01 --end-time 2025-11-09 --explain', 'profiles_dir': '/home/chun/Develop/datacore', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:45:44.675503 [info ] [MainThread]: dbt version: 1.10.13
[0m05:45:44.675823 [info ] [MainThread]: python version: 3.12.3
[0m05:45:44.676061 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:45:44.676297 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:45:44.773602 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:45:44.773964 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:45:44.774205 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:45:44.775254 [info ] [MainThread]: adapter type: duckdb
[0m05:45:44.775505 [info ] [MainThread]: adapter version: 1.10.0
[0m05:45:44.878591 [info ] [MainThread]: Configuration:
[0m05:45:44.878959 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:45:44.879201 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:45:44.879438 [info ] [MainThread]: Required dependencies:
[0m05:45:44.879686 [debug] [MainThread]: Executing "git --help"
[0m05:45:44.882630 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:45:44.882955 [debug] [MainThread]: STDERR: "b''"
[0m05:45:44.883201 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:45:44.883440 [info ] [MainThread]: Connection:
[0m05:45:44.883679 [info ] [MainThread]:   database: datacore
[0m05:45:44.883903 [info ] [MainThread]:   schema: main
[0m05:45:44.884130 [info ] [MainThread]:   path: datacore.duckdb
[0m05:45:44.884362 [info ] [MainThread]:   config_options: None
[0m05:45:44.884586 [info ] [MainThread]:   extensions: None
[0m05:45:44.884812 [info ] [MainThread]:   settings: {}
[0m05:45:44.885038 [info ] [MainThread]:   external_root: .
[0m05:45:44.885266 [info ] [MainThread]:   use_credential_provider: None
[0m05:45:44.885502 [info ] [MainThread]:   attach: None
[0m05:45:44.885725 [info ] [MainThread]:   filesystems: None
[0m05:45:44.885947 [info ] [MainThread]:   remote: None
[0m05:45:44.886175 [info ] [MainThread]:   plugins: None
[0m05:45:44.886406 [info ] [MainThread]:   disable_transactions: False
[0m05:45:44.886756 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:45:44.987473 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:45:45.008716 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:45:45.009098 [debug] [MainThread]: On debug: select 1 as id
[0m05:45:45.009369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:45.014952 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:45:45.015293 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:45:45.015636 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:45:45.015887 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:45:45.016138 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:45:45.016856 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.40433645, "process_in_blocks": "0", "process_kernel_time": 0.210609, "process_mem_max_rss": "149736", "process_out_blocks": "24", "process_user_time": 1.694853}
[0m05:45:45.017229 [debug] [MainThread]: Command `cli debug` failed at 05:45:45.017150 after 0.40 seconds
[0m05:45:45.017506 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:45:45.017778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782abc5c8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782abcb173e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782abcb16e40>]}
[0m05:45:45.018098 [debug] [MainThread]: Flushing usage events
[0m05:45:46.124654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:45:57.276099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32e3e23c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32e286ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32e4a8bcb0>]}


============================== 05:45:57.279313 | 526d9ba5-c4e8-4c90-b68d-76b8a902f62e ==============================
[0m05:45:57.279313 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:45:57.279767 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'fail_fast': 'False', 'quiet': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt query --metrics normal_transaction_rate --group-by transaction_date --start-time 2025-11-01 --end-time 2025-11-09 --explain', 'version_check': 'True', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'partial_parse': 'True'}
[0m05:45:57.288425 [info ] [MainThread]: dbt version: 1.10.13
[0m05:45:57.288772 [info ] [MainThread]: python version: 3.12.3
[0m05:45:57.289026 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:45:57.289278 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:45:57.388327 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:45:57.388687 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:45:57.388937 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:45:57.389988 [info ] [MainThread]: adapter type: duckdb
[0m05:45:57.390232 [info ] [MainThread]: adapter version: 1.10.0
[0m05:45:57.486963 [info ] [MainThread]: Configuration:
[0m05:45:57.487342 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:45:57.487587 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:45:57.487817 [info ] [MainThread]: Required dependencies:
[0m05:45:57.488069 [debug] [MainThread]: Executing "git --help"
[0m05:45:57.491125 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:45:57.491589 [debug] [MainThread]: STDERR: "b''"
[0m05:45:57.491928 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:45:57.492258 [info ] [MainThread]: Connection:
[0m05:45:57.492606 [info ] [MainThread]:   database: datacore
[0m05:45:57.492883 [info ] [MainThread]:   schema: main
[0m05:45:57.493109 [info ] [MainThread]:   path: datacore.duckdb
[0m05:45:57.493344 [info ] [MainThread]:   config_options: None
[0m05:45:57.493569 [info ] [MainThread]:   extensions: None
[0m05:45:57.493796 [info ] [MainThread]:   settings: {}
[0m05:45:57.494023 [info ] [MainThread]:   external_root: .
[0m05:45:57.494246 [info ] [MainThread]:   use_credential_provider: None
[0m05:45:57.494498 [info ] [MainThread]:   attach: None
[0m05:45:57.494721 [info ] [MainThread]:   filesystems: None
[0m05:45:57.494942 [info ] [MainThread]:   remote: None
[0m05:45:57.495163 [info ] [MainThread]:   plugins: None
[0m05:45:57.495412 [info ] [MainThread]:   disable_transactions: False
[0m05:45:57.495760 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:45:57.599704 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:45:57.620791 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:45:57.621162 [debug] [MainThread]: On debug: select 1 as id
[0m05:45:57.621428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:57.627066 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:45:57.627453 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:45:57.627807 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:45:57.628073 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:45:57.628347 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:45:57.629136 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.40751314, "process_in_blocks": "0", "process_kernel_time": 0.216458, "process_mem_max_rss": "149836", "process_out_blocks": "24", "process_user_time": 1.822441}
[0m05:45:57.629570 [debug] [MainThread]: Command `cli debug` failed at 05:45:57.629484 after 0.41 seconds
[0m05:45:57.629866 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:45:57.630161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32e3a5b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32e23a6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32d24c0b90>]}
[0m05:45:57.630522 [debug] [MainThread]: Flushing usage events
[0m05:45:58.719192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:47:09.068246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cfcbaee240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cfcaf50500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cfcbb53aa0>]}


============================== 05:47:09.071448 | 3940114a-66d1-4e5e-afb5-72e77791df7f ==============================
[0m05:47:09.071448 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:47:09.071906 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'target_path': 'None', 'partial_parse': 'True', 'empty': 'None', 'write_json': 'True', 'quiet': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'invocation_command': 'dbt query --metrics avg_transaction_amount --group-by transaction_date --start-time 2025-11-01 --end-time 2025-11-09 --explain', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default'}
[0m05:47:09.080479 [info ] [MainThread]: dbt version: 1.10.13
[0m05:47:09.080832 [info ] [MainThread]: python version: 3.12.3
[0m05:47:09.081088 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:47:09.081347 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:47:09.187376 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:47:09.187787 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:47:09.188071 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:47:09.189349 [info ] [MainThread]: adapter type: duckdb
[0m05:47:09.189638 [info ] [MainThread]: adapter version: 1.10.0
[0m05:47:09.297540 [info ] [MainThread]: Configuration:
[0m05:47:09.297909 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:47:09.298154 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:47:09.298398 [info ] [MainThread]: Required dependencies:
[0m05:47:09.298651 [debug] [MainThread]: Executing "git --help"
[0m05:47:09.301632 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:47:09.301965 [debug] [MainThread]: STDERR: "b''"
[0m05:47:09.302210 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:47:09.302450 [info ] [MainThread]: Connection:
[0m05:47:09.302688 [info ] [MainThread]:   database: datacore
[0m05:47:09.302912 [info ] [MainThread]:   schema: main
[0m05:47:09.303134 [info ] [MainThread]:   path: datacore.duckdb
[0m05:47:09.303368 [info ] [MainThread]:   config_options: None
[0m05:47:09.303592 [info ] [MainThread]:   extensions: None
[0m05:47:09.303817 [info ] [MainThread]:   settings: {}
[0m05:47:09.304043 [info ] [MainThread]:   external_root: .
[0m05:47:09.304266 [info ] [MainThread]:   use_credential_provider: None
[0m05:47:09.304500 [info ] [MainThread]:   attach: None
[0m05:47:09.304721 [info ] [MainThread]:   filesystems: None
[0m05:47:09.304941 [info ] [MainThread]:   remote: None
[0m05:47:09.305162 [info ] [MainThread]:   plugins: None
[0m05:47:09.305391 [info ] [MainThread]:   disable_transactions: False
[0m05:47:09.305736 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:47:09.405874 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:47:09.426950 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:47:09.427323 [debug] [MainThread]: On debug: select 1 as id
[0m05:47:09.427580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:47:09.433076 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:47:09.433416 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:47:09.433736 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:47:09.433980 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:47:09.434223 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:47:09.434932 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.42223036, "process_in_blocks": "0", "process_kernel_time": 0.223955, "process_mem_max_rss": "149592", "process_out_blocks": "32", "process_user_time": 1.730653}
[0m05:47:09.435309 [debug] [MainThread]: Command `cli debug` failed at 05:47:09.435223 after 0.42 seconds
[0m05:47:09.435579 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:47:09.435850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cfcbbcae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cfcad33b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cfcaf7e7e0>]}
[0m05:47:09.436167 [debug] [MainThread]: Flushing usage events
[0m05:47:10.532421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:47:24.367353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7641fdc8f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7641fe2479e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7641fe245f40>]}


============================== 05:47:24.370314 | a7f04bd3-4b10-4bbf-851a-13745fbd0a16 ==============================
[0m05:47:24.370314 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:47:24.370739 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error': 'None', 'printer_width': '80', 'fail_fast': 'False', 'log_format': 'default', 'quiet': 'True', 'invocation_command': 'dbt query --metrics avg_transaction_amount --group-by station_name,vehicle_type_name,payment_method_name,transaction_date --start-time 2025-11-01 --end-time 2025-11-09 --explain', 'cache_selected_only': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'debug': 'False', 'version_check': 'True', 'empty': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:47:24.378706 [info ] [MainThread]: dbt version: 1.10.13
[0m05:47:24.379028 [info ] [MainThread]: python version: 3.12.3
[0m05:47:24.379269 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:47:24.379510 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:47:24.477097 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:47:24.477475 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:47:24.477718 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:47:24.478761 [info ] [MainThread]: adapter type: duckdb
[0m05:47:24.479004 [info ] [MainThread]: adapter version: 1.10.0
[0m05:47:24.575550 [info ] [MainThread]: Configuration:
[0m05:47:24.575923 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:47:24.576165 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:47:24.576404 [info ] [MainThread]: Required dependencies:
[0m05:47:24.576656 [debug] [MainThread]: Executing "git --help"
[0m05:47:24.579558 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:47:24.579995 [debug] [MainThread]: STDERR: "b''"
[0m05:47:24.580265 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:47:24.580509 [info ] [MainThread]: Connection:
[0m05:47:24.580754 [info ] [MainThread]:   database: datacore
[0m05:47:24.580985 [info ] [MainThread]:   schema: main
[0m05:47:24.581207 [info ] [MainThread]:   path: datacore.duckdb
[0m05:47:24.581441 [info ] [MainThread]:   config_options: None
[0m05:47:24.581665 [info ] [MainThread]:   extensions: None
[0m05:47:24.581890 [info ] [MainThread]:   settings: {}
[0m05:47:24.582115 [info ] [MainThread]:   external_root: .
[0m05:47:24.582343 [info ] [MainThread]:   use_credential_provider: None
[0m05:47:24.582567 [info ] [MainThread]:   attach: None
[0m05:47:24.582786 [info ] [MainThread]:   filesystems: None
[0m05:47:24.583006 [info ] [MainThread]:   remote: None
[0m05:47:24.583227 [info ] [MainThread]:   plugins: None
[0m05:47:24.583454 [info ] [MainThread]:   disable_transactions: False
[0m05:47:24.583803 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:47:24.686195 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:47:24.707970 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:47:24.708341 [debug] [MainThread]: On debug: select 1 as id
[0m05:47:24.708610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:47:24.714176 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:47:24.714524 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:47:24.714851 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:47:24.715100 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:47:24.715353 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:47:24.716098 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.4013034, "process_in_blocks": "0", "process_kernel_time": 0.220807, "process_mem_max_rss": "149276", "process_out_blocks": "24", "process_user_time": 1.79344}
[0m05:47:24.716484 [debug] [MainThread]: Command `cli debug` failed at 05:47:24.716403 after 0.40 seconds
[0m05:47:24.716759 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:47:24.717038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7641fc90e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7641ec70aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7641fc2f8c50>]}
[0m05:47:24.717372 [debug] [MainThread]: Flushing usage events
[0m05:47:25.877127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:47:43.975873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45afe4ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45b0316570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45b026b8f0>]}


============================== 05:47:43.979005 | 37df76a6-44ad-4f6e-8439-93e55621e35f ==============================
[0m05:47:43.979005 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:47:43.979481 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'target_path': 'None', 'fail_fast': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'quiet': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'empty': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt query --metrics avg_transaction_amount --group-by payment_method_name,city,transaction_date --start-time 2025-11-01 --end-time 2025-11-09 --explain', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m05:47:43.987992 [info ] [MainThread]: dbt version: 1.10.13
[0m05:47:43.988343 [info ] [MainThread]: python version: 3.12.3
[0m05:47:43.988604 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:47:43.988855 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:47:44.094363 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:47:44.094756 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:47:44.095011 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:47:44.096181 [info ] [MainThread]: adapter type: duckdb
[0m05:47:44.096455 [info ] [MainThread]: adapter version: 1.10.0
[0m05:47:44.203747 [info ] [MainThread]: Configuration:
[0m05:47:44.204149 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:47:44.204416 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:47:44.204669 [info ] [MainThread]: Required dependencies:
[0m05:47:44.204937 [debug] [MainThread]: Executing "git --help"
[0m05:47:44.207851 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:47:44.208282 [debug] [MainThread]: STDERR: "b''"
[0m05:47:44.208551 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:47:44.208796 [info ] [MainThread]: Connection:
[0m05:47:44.209055 [info ] [MainThread]:   database: datacore
[0m05:47:44.209295 [info ] [MainThread]:   schema: main
[0m05:47:44.209543 [info ] [MainThread]:   path: datacore.duckdb
[0m05:47:44.209783 [info ] [MainThread]:   config_options: None
[0m05:47:44.210023 [info ] [MainThread]:   extensions: None
[0m05:47:44.210261 [info ] [MainThread]:   settings: {}
[0m05:47:44.210512 [info ] [MainThread]:   external_root: .
[0m05:47:44.210747 [info ] [MainThread]:   use_credential_provider: None
[0m05:47:44.210987 [info ] [MainThread]:   attach: None
[0m05:47:44.211224 [info ] [MainThread]:   filesystems: None
[0m05:47:44.211473 [info ] [MainThread]:   remote: None
[0m05:47:44.211711 [info ] [MainThread]:   plugins: None
[0m05:47:44.211948 [info ] [MainThread]:   disable_transactions: False
[0m05:47:44.212327 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:47:44.321363 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:47:44.344716 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:47:44.345111 [debug] [MainThread]: On debug: select 1 as id
[0m05:47:44.345402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:47:44.351163 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:47:44.351527 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:47:44.351846 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:47:44.352092 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:47:44.352352 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:47:44.353126 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.431971, "process_in_blocks": "0", "process_kernel_time": 0.22895, "process_mem_max_rss": "149504", "process_out_blocks": "32", "process_user_time": 1.827608}
[0m05:47:44.353541 [debug] [MainThread]: Command `cli debug` failed at 05:47:44.353454 after 0.43 seconds
[0m05:47:44.353839 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:47:44.354143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45aff3c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45aefa3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45aeff1ac0>]}
[0m05:47:44.354520 [debug] [MainThread]: Flushing usage events
[0m05:47:45.467291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:47:53.080684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755a8ccc0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755a8bf5a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755a8c1a26f0>]}


============================== 05:47:53.083865 | e07261a9-bbe7-46fa-9842-55f3da539f4d ==============================
[0m05:47:53.083865 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:47:53.084344 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_format': 'default', 'invocation_command': 'dbt query --metrics avg_transaction_amount --group-by payment_method_name,transaction_date --start-time 2025-11-01 --end-time 2025-11-09 --explain', 'version_check': 'True', 'introspect': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'indirect_selection': 'eager'}
[0m05:47:53.093117 [info ] [MainThread]: dbt version: 1.10.13
[0m05:47:53.093482 [info ] [MainThread]: python version: 3.12.3
[0m05:47:53.093744 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:47:53.094006 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:47:53.200594 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:47:53.200986 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:47:53.201651 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:47:53.202807 [info ] [MainThread]: adapter type: duckdb
[0m05:47:53.203073 [info ] [MainThread]: adapter version: 1.10.0
[0m05:47:53.310163 [info ] [MainThread]: Configuration:
[0m05:47:53.310573 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:47:53.310837 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:47:53.311094 [info ] [MainThread]: Required dependencies:
[0m05:47:53.311375 [debug] [MainThread]: Executing "git --help"
[0m05:47:53.314218 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:47:53.314564 [debug] [MainThread]: STDERR: "b''"
[0m05:47:53.314809 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:47:53.315039 [info ] [MainThread]: Connection:
[0m05:47:53.315282 [info ] [MainThread]:   database: datacore
[0m05:47:53.315515 [info ] [MainThread]:   schema: main
[0m05:47:53.315740 [info ] [MainThread]:   path: datacore.duckdb
[0m05:47:53.315964 [info ] [MainThread]:   config_options: None
[0m05:47:53.316188 [info ] [MainThread]:   extensions: None
[0m05:47:53.316423 [info ] [MainThread]:   settings: {}
[0m05:47:53.316648 [info ] [MainThread]:   external_root: .
[0m05:47:53.316871 [info ] [MainThread]:   use_credential_provider: None
[0m05:47:53.317095 [info ] [MainThread]:   attach: None
[0m05:47:53.317323 [info ] [MainThread]:   filesystems: None
[0m05:47:53.317545 [info ] [MainThread]:   remote: None
[0m05:47:53.317766 [info ] [MainThread]:   plugins: None
[0m05:47:53.317988 [info ] [MainThread]:   disable_transactions: False
[0m05:47:53.318339 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:47:53.427003 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:47:53.450537 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:47:53.450944 [debug] [MainThread]: On debug: select 1 as id
[0m05:47:53.451225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:47:53.457158 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:47:53.457538 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:47:53.457888 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:47:53.458155 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:47:53.458432 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:47:53.459220 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.43480504, "process_in_blocks": "0", "process_kernel_time": 0.211078, "process_mem_max_rss": "149760", "process_out_blocks": "24", "process_user_time": 1.828677}
[0m05:47:53.459640 [debug] [MainThread]: Command `cli debug` failed at 05:47:53.459547 after 0.44 seconds
[0m05:47:53.459937 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:47:53.460231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755a8c7042f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755a7b6041d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755a7b606150>]}
[0m05:47:53.460596 [debug] [MainThread]: Flushing usage events
[0m05:47:54.564952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:48:05.289010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627af98fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627af6d6d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627ae977b30>]}


============================== 05:48:05.292200 | bec71f40-63a1-4d8e-8f47-3d1cc3a905fb ==============================
[0m05:48:05.292200 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:48:05.292665 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'version_check': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'partial_parse': 'True', 'invocation_command': 'dbt query --metrics avg_transaction_amount --group-by payment_method_name,vehicle_type_name,transaction_date --start-time 2025-11-01 --end-time 2025-11-09 --explain', 'empty': 'None', 'static_parser': 'True', 'warn_error': 'None', 'write_json': 'True', 'log_format': 'default'}
[0m05:48:05.301339 [info ] [MainThread]: dbt version: 1.10.13
[0m05:48:05.301686 [info ] [MainThread]: python version: 3.12.3
[0m05:48:05.301940 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m05:48:05.302191 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m05:48:05.408848 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m05:48:05.409243 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m05:48:05.409849 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m05:48:05.411026 [info ] [MainThread]: adapter type: duckdb
[0m05:48:05.411287 [info ] [MainThread]: adapter version: 1.10.0
[0m05:48:05.517460 [info ] [MainThread]: Configuration:
[0m05:48:05.517860 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:48:05.518123 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:48:05.518383 [info ] [MainThread]: Required dependencies:
[0m05:48:05.518654 [debug] [MainThread]: Executing "git --help"
[0m05:48:05.521673 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:48:05.521997 [debug] [MainThread]: STDERR: "b''"
[0m05:48:05.522239 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:48:05.522477 [info ] [MainThread]: Connection:
[0m05:48:05.522715 [info ] [MainThread]:   database: datacore
[0m05:48:05.522939 [info ] [MainThread]:   schema: main
[0m05:48:05.523160 [info ] [MainThread]:   path: datacore.duckdb
[0m05:48:05.523392 [info ] [MainThread]:   config_options: None
[0m05:48:05.523614 [info ] [MainThread]:   extensions: None
[0m05:48:05.523837 [info ] [MainThread]:   settings: {}
[0m05:48:05.524066 [info ] [MainThread]:   external_root: .
[0m05:48:05.524286 [info ] [MainThread]:   use_credential_provider: None
[0m05:48:05.524517 [info ] [MainThread]:   attach: None
[0m05:48:05.524735 [info ] [MainThread]:   filesystems: None
[0m05:48:05.524954 [info ] [MainThread]:   remote: None
[0m05:48:05.525178 [info ] [MainThread]:   plugins: None
[0m05:48:05.525406 [info ] [MainThread]:   disable_transactions: False
[0m05:48:05.525747 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:48:05.632667 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m05:48:05.655575 [debug] [MainThread]: Using duckdb connection "debug"
[0m05:48:05.655974 [debug] [MainThread]: On debug: select 1 as id
[0m05:48:05.656251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:48:05.662070 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m05:48:05.662436 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m05:48:05.662761 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m05:48:05.663006 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:48:05.663251 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/home/chun/Develop/datacore/datacore.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 764383) by user chun. See also https://duckdb.org/docs/stable/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m05:48:05.663979 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.430781, "process_in_blocks": "0", "process_kernel_time": 0.218606, "process_mem_max_rss": "149572", "process_out_blocks": "24", "process_user_time": 1.80375}
[0m05:48:05.664363 [debug] [MainThread]: Command `cli debug` failed at 05:48:05.664274 after 0.43 seconds
[0m05:48:05.664634 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:48:05.664907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627b091a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627ade1b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627ae007b00>]}
[0m05:48:05.665235 [debug] [MainThread]: Flushing usage events
[0m05:48:07.599476 [debug] [MainThread]: An error was encountered while trying to flush usage events
